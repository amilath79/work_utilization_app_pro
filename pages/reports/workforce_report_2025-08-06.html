
        <html>
        <head>
            <style>
                body { font-family: Arial, sans-serif; }
                table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
                th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
                th { background-color: #f2f2f2; font-weight: bold; }
                .metric-row { font-weight: bold; }
                .total-col { font-weight: bold; background-color: #fffde7; }
                .negative { color: red; }
                .positive { color: green; }
                .summary { margin: 20px 0; padding: 15px; background-color: #f9f9f9; border: 1px solid #ddd; }
                .header { background-color: #4a86e8; color: white; padding: 10px; margin-bottom: 20px; }
                .metric { display: inline-block; margin-right: 30px; text-align: center; }
                .metric-value { font-size: 24px; font-weight: bold; }
                .metric-label { font-size: 14px; color: #666; }
            </style>
        </head>
        <body>
            <div class="header">
                <h2>Workforce Prediction Improvement Report</h2>
                <p>Date Generated: 2025-08-05 | Prediction For: 2025-08-06 (Wednesday)</p>
            </div>
            
            <h3>Workers (NoOfMan) Comparison</h3>
            <table>
                <tr>
                    <th>Metric</th>
        <th>202</th><th>203</th><th>206</th><th>209</th><th>210</th><th>211</th><th>213</th><th>214</th><th>215</th><th>217</th></tr><tr><td class="metric-row">Original Workers</td><td >1.87</td><td >2.92</td><td >28.18</td><td >5.93</td><td >6.07</td><td >8.49</td><td >3.64</td><td >5.79</td><td >5.26</td><td >7.31</td></tr><tr><td class="metric-row">Improved Workers</td><td >1.77</td><td >2.77</td><td >26.78</td><td >7.68</td><td >5.76</td><td >6.64</td><td >0.95</td><td >30.77</td><td >2.57</td><td >6.94</td></tr><tr><td class="metric-row">Workers Difference</td><td class="negative">-0.10</td><td class="negative">-0.15</td><td class="negative">-1.40</td><td >1.75</td><td class="negative">-0.31</td><td class="negative">-1.85</td><td class="negative">-2.69</td><td >24.98</td><td class="negative">-2.69</td><td class="negative">-0.37</td></tr><tr><td class="metric-row">Workers Difference %</td><td class="negative">-5.11%</td><td class="negative">-5.15%</td><td class="negative">-4.98%</td><td >29.55%</td><td class="negative">-5.07%</td><td class="negative">-21.84%</td><td class="negative">-73.92%</td><td >431.10%</td><td class="negative">-51.10%</td><td class="negative">-5.03%</td></tr><tr><td class="metric-row">Workers Efficiency Gain</td><td class="positive">0.10</td><td class="positive">0.15</td><td class="positive">1.40</td><td >-1.75</td><td class="positive">0.31</td><td class="positive">1.85</td><td class="positive">2.69</td><td >-24.98</td><td class="positive">2.69</td><td class="positive">0.37</td></tr><tr><td class="metric-row">Workers Efficiency %</td><td class="positive">5.11%</td><td class="positive">5.15%</td><td class="positive">4.98%</td><td >-29.55%</td><td class="positive">5.07%</td><td class="positive">21.84%</td><td class="positive">73.92%</td><td >-431.10%</td><td class="positive">51.10%</td><td class="positive">5.03%</td></tr></table><h3>Hours Comparison</h3><table><tr><th>Metric</th><th>202</th><th>203</th><th>206</th><th>209</th><th>210</th><th>211</th><th>213</th><th>214</th><th>215</th><th>217</th></tr><tr><td class="metric-row">Original Hours</td><td >14.9</td><td >23.4</td><td >225.5</td><td >47.4</td><td >48.5</td><td >68.0</td><td >29.1</td><td >46.3</td><td >42.0</td><td >58.5</td></tr><tr><td class="metric-row">Improved Hours</td><td >14.2</td><td >22.2</td><td >214.2</td><td >61.5</td><td >46.1</td><td >53.1</td><td >7.6</td><td >246.2</td><td >20.6</td><td >55.5</td></tr><tr><td class="metric-row">Hours Difference</td><td class="negative">-0.7</td><td class="negative">-1.2</td><td class="negative">-11.3</td><td >14.1</td><td class="negative">-2.4</td><td class="negative">-14.9</td><td class="negative">-21.5</td><td >199.9</td><td class="negative">-21.4</td><td class="negative">-3.0</td></tr><tr><td class="metric-row">Hours Difference %</td><td class="negative">-4.84%</td><td class="negative">-4.98%</td><td class="negative">-5.00%</td><td >29.68%</td><td class="negative">-5.03%</td><td class="negative">-21.86%</td><td class="negative">-73.92%</td><td >431.19%</td><td class="negative">-51.01%</td><td class="negative">-5.06%</td></tr><tr><td class="metric-row">Hours Efficiency Gain</td><td class="positive">0.7</td><td class="positive">1.2</td><td class="positive">11.3</td><td >-14.1</td><td class="positive">2.4</td><td class="positive">14.9</td><td class="positive">21.5</td><td >-199.9</td><td class="positive">21.4</td><td class="positive">3.0</td></tr><tr><td class="metric-row">Hours Efficiency %</td><td class="positive">4.84%</td><td class="positive">4.98%</td><td class="positive">5.00%</td><td >-29.68%</td><td class="positive">5.03%</td><td class="positive">21.86%</td><td class="positive">73.92%</td><td >-431.19%</td><td class="positive">51.01%</td><td class="positive">5.06%</td></tr></table>
                <h3>Quantity and KPI Analysis</h3>
                <table>
                    <tr>
                        <th>Metric</th>
                <th>202</th><th>203</th><th>206</th><th>209</th><th>210</th><th>211</th><th>213</th><th>214</th><th>215</th><th>217</th></tr><tr><td><strong>Quantity</strong></td><td>0</td><td>0</td><td>0</td><td>18,008</td><td>0</td><td>3,453</td><td>267</td><td>155,076</td><td>6,477</td><td>0</td></tr><tr><td><strong>KPI</strong></td><td>181.00</td><td>2346.00</td><td>6.20</td><td>293.00</td><td>238.00</td><td>65.00</td><td>35.00</td><td>630.00</td><td>315.00</td><td>62.00</td></tr></table>
                <p><strong>Note:</strong> Quantity shows nrows for punch codes 206, 213 and actual quantity for other punch codes.</p>
                
            <div class="summary">
                <h3>Workforce Efficiency Summary</h3>
                <h4>Workers (NoOfMan)</h4>
                <div class="metric">
                    <div class="metric-value">75.46</div>
                    <div class="metric-label">Total Original Workers</div>
                </div>
                <div class="metric">
                    <div class="metric-value">92.63</div>
                    <div class="metric-label">Total Improved Workers</div>
                </div>
                <div class="metric">
                    <div class="metric-value">-17.17</div>
                    <div class="metric-label">Workers Reduction</div>
                </div>
                <div class="metric">
                    <div class="metric-value">-22.75%</div>
                    <div class="metric-label">Workers Efficiency Improvement</div>
                </div>
                
                <h4>Hours</h4>
                <div class="metric">
                    <div class="metric-value">604</div>
                    <div class="metric-label">Total Original Hours</div>
                </div>
                <div class="metric">
                    <div class="metric-value">741</div>
                    <div class="metric-label">Total Improved Hours</div>
                </div>
                <div class="metric">
                    <div class="metric-value">-138</div>
                    <div class="metric-label">Hours Reduction</div>
                </div>
                <div class="metric">
                    <div class="metric-value">-22.78%</div>
                    <div class="metric-label">Hours Efficiency Improvement</div>
                </div>
                
                <div class="metric">
                    <div class="metric-value">95.2%</div>
                    <div class="metric-label">Accuracy Improvement</div>
                </div>
            </div>
            
            <h3>Key Insights</h3>
            <ul>
                <li><strong>Hybrid Approach:</strong> Punch codes 209, 211, 213, 214, 215 use demand-based calculation (Quantity รท KPI รท 8)</li>
                <li><strong>ML Enhancement:</strong> Punch codes 202, 203, 206, 210, 217 use enhanced ML predictions with 95% accuracy factor</li>
                <li><strong>Quantity Logic:</strong> Punch codes 206, 213 use nrows (order count), others use actual quantity</li>
                <li><strong>Working Day:</strong> Predictions are made for next working day, automatically skipping weekends and holidays</li>
                <li><strong>Dual Metrics:</strong> Both workforce headcount (NoOfMan) and total hours are provided for comprehensive planning</li>
            </ul>
            
            <p>This report was automatically generated by the Work Utilization Prediction system.</p>
            <p><strong>Note:</strong> A reduction in required resources is considered a positive improvement in efficiency.</p>
        </body>
        </html>
        