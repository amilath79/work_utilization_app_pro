2025-05-18 08:31:13,773 - utils.sql_data_connector - INFO - Connecting to 192.168.1.43/ABC
2025-05-18 08:31:14,469 - utils.sql_data_connector - INFO - Fetched chunk of 10000 rows
2025-05-18 08:31:14,719 - utils.sql_data_connector - INFO - Fetched chunk of 5415 rows
2025-05-18 08:31:14,723 - utils.sql_data_connector - INFO - Total rows fetched: 15415
2025-05-18 08:31:14,832 - __main__ - INFO - Loaded 15415 records from WorkUtilizationData
2025-05-18 08:31:14,872 - utils.feature_engineering - INFO - Engineering features
2025-05-18 08:31:14,942 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-18 08:31:15,033 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-18 08:31:15,771 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-18 08:31:15,772 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-18 08:31:17,358 - __main__ - INFO - Models loaded successfully. Number of models: 10
2025-05-18 08:31:17,360 - __main__ - INFO - Successfully loaded 10 models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:31:17,362 - utils.sql_data_connector - INFO - Testing connection to primary database fsystemp before loading forecast data
2025-05-18 08:31:17,684 - utils.sql_data_connector - INFO - Loading demand forecast data from 192.168.1.43/fsystemp
2025-05-18 08:31:17,931 - utils.sql_data_connector - INFO - Fetched chunk of 13 rows
2025-05-18 08:31:17,933 - utils.sql_data_connector - INFO - Total rows fetched: 13
2025-05-18 08:31:17,974 - utils.sql_data_connector - INFO - Successfully loaded forecast data from fsystemp. Shape: (13, 4)
2025-05-18 08:31:17,976 - __main__ - INFO - Loaded demand forecast data: 13 records
2025-05-18 08:31:17,978 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:31:37,513 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:31:38,486 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:31:59,392 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:31:59,422 - utils.prediction - INFO - Predicting for the next 7 days
2025-05-18 08:31:59,482 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:31:59,484 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:31:59,485 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-15
2025-05-18 08:31:59,486 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:31:59,487 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:31:59,555 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:31:59,707 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:31:59,748 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:31:59,751 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:31:59,799 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:31:59,802 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:31:59,845 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:31:59,847 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:31:59,848 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:31:59,850 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:31:59,851 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:31:59,852 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:31:59,854 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:31:59,855 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:31:59,857 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:31:59,859 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:31:59,861 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:31:59,862 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:31:59,863 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:31:59,865 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:31:59,866 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:31:59,868 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:31:59,869 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:31:59,870 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:31:59,872 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:31:59,874 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:31:59,876 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:31:59,878 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:31:59,879 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:31:59,880 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:31:59,882 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:31:59,883 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:31:59,997 - utils.prediction - INFO - RandomForest predicted 0.20 workers for WorkType 209
2025-05-18 08:32:00,042 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,045 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,047 - utils.prediction - INFO - Generated predictions for 2025-05-15 00:00:00: {'209': np.float64(0.20394375000000015)}
2025-05-18 08:32:00,061 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:00,062 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:00,062 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-16
2025-05-18 08:32:00,063 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:00,063 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:00,090 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,094 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,125 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,128 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,163 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,165 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,200 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,201 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:00,202 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:00,204 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:00,205 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:00,206 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:00,208 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:00,209 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:00,211 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,212 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:00,213 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:00,215 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,216 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:00,217 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:00,218 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:00,220 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:00,222 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,223 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:00,224 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,225 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,227 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:00,228 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,229 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,230 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:00,232 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:00,233 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:00,297 - utils.prediction - INFO - RandomForest predicted 0.11 workers for WorkType 209
2025-05-18 08:32:00,328 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,333 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,338 - utils.prediction - INFO - Generated predictions for 2025-05-16 00:00:00: {'209': np.float64(0.11324375000000007)}
2025-05-18 08:32:00,367 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:32:00,369 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:32:00,370 - utils.prediction - INFO - Date 2025-05-17 is a non-working day: Saturday (Weekend)
2025-05-18 08:32:00,371 - utils.prediction - INFO - No work is carried out on this day. Setting all predictions to 0.
2025-05-18 08:32:00,397 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:00,398 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:00,399 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-18
2025-05-18 08:32:00,401 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:00,402 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:00,491 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,496 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,553 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,557 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,593 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,597 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,641 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,643 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:00,644 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:00,645 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:00,647 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:00,648 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:00,649 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:00,650 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:00,652 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,653 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:00,655 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:00,657 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,659 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:00,660 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:00,662 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:00,663 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:00,664 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,666 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:00,667 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,668 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,670 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:00,672 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:00,674 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:00,675 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:00,677 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:00,678 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:00,756 - utils.prediction - INFO - RandomForest predicted 0.09 workers for WorkType 209
2025-05-18 08:32:00,791 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,794 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,795 - utils.prediction - INFO - Generated predictions for 2025-05-18 00:00:00: {'209': np.float64(0.09035000000000004)}
2025-05-18 08:32:00,813 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:00,815 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:00,818 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-19
2025-05-18 08:32:00,820 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:00,821 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:00,890 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,895 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:00,968 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:00,974 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,048 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,061 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,101 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,102 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:01,104 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:01,105 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:01,108 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:01,109 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:01,111 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:01,113 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:01,114 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,115 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:01,117 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,118 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,120 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,121 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,123 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:01,125 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,126 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,128 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:01,130 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,131 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,133 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:01,134 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,136 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,138 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:01,140 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:01,141 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:01,222 - utils.prediction - INFO - RandomForest predicted 0.12 workers for WorkType 209
2025-05-18 08:32:01,277 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,282 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,284 - utils.prediction - INFO - Generated predictions for 2025-05-19 00:00:00: {'209': np.float64(0.11746875000000007)}
2025-05-18 08:32:01,311 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:01,312 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:01,314 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-20
2025-05-18 08:32:01,315 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:01,316 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:01,392 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,397 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,495 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,497 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,531 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,534 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,568 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,570 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:01,571 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:01,573 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:01,574 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:01,575 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:01,577 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:01,578 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:01,579 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,580 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:01,581 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,582 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,583 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,584 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,585 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:01,586 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,588 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,590 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:01,592 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,593 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,594 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:01,596 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,597 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,598 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:01,599 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:01,600 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:01,668 - utils.prediction - INFO - RandomForest predicted 0.12 workers for WorkType 209
2025-05-18 08:32:01,714 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,717 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,718 - utils.prediction - INFO - Generated predictions for 2025-05-20 00:00:00: {'209': np.float64(0.11746875000000007)}
2025-05-18 08:32:01,731 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:01,731 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:01,732 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-21
2025-05-18 08:32:01,733 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:01,733 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:01,805 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,809 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,853 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,857 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,897 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:01,900 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:01,930 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,932 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:01,933 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:01,934 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:01,935 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:01,937 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:01,938 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:01,939 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:01,940 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,942 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:01,943 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,945 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,946 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:01,947 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,948 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:01,949 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:01,950 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,951 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:01,953 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,954 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,955 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:01,956 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:01,957 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:01,959 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:01,960 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:01,961 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:02,031 - utils.prediction - INFO - RandomForest predicted 0.13 workers for WorkType 209
2025-05-18 08:32:02,075 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:02,078 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:02,081 - utils.prediction - INFO - Generated predictions for 2025-05-21 00:00:00: {'209': np.float64(0.1321437500000001)}
2025-05-18 08:32:02,099 - utils.prediction - INFO - Predictions completed for 7 days
2025-05-18 08:32:02,106 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:02,107 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:02,111 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:02,112 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:02,115 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:32:02,116 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:32:02,117 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:02,118 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:02,119 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:02,121 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:02,122 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:02,123 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:02,124 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:02,125 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:02,130 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:02,130 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:02,131 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:02,131 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:02,132 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:32:02,133 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:32:02,133 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:02,134 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:02,134 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:02,135 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:02,135 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:02,136 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:02,137 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:02,138 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:02,139 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:02,139 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:02,140 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:02,141 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:02,141 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:32:02,142 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:32:02,143 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:02,144 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:02,144 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:02,144 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:02,145 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:02,145 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:02,145 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:02,146 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:02,170 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:02,171 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:02,173 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:02,173 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:02,174 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:32:02,175 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:32:02,176 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:32:02,176 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:32:02,177 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:32:02,178 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:32:02,178 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:32:02,179 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:32:02,179 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:32:02,180 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:32:43,208 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:47,488 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:51,603 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:55,026 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:56,278 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:57,708 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:32:57,737 - utils.prediction - INFO - Predicting for the next 7 days
2025-05-18 08:32:57,785 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:57,786 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:57,787 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-15
2025-05-18 08:32:57,787 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:32:57,788 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:32:57,823 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:57,827 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:57,861 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:57,865 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:57,897 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:57,901 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:57,928 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:57,931 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:57,933 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:57,934 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:57,936 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:57,938 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:57,939 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:57,941 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:57,942 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:57,943 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:57,944 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:57,946 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:57,948 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:57,949 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:57,951 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:57,952 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:57,954 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:57,955 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:57,956 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:57,957 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:57,958 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:57,959 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:57,961 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:57,963 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:57,964 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:57,966 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:58,031 - utils.prediction - INFO - RandomForest predicted 0.20 workers for WorkType 209
2025-05-18 08:32:58,060 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:58,063 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:58,094 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:58,096 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:32:58,097 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:32:58,098 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:32:58,099 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:32:58,101 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:32:58,103 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:32:58,104 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:32:58,105 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:32:58,106 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:32:58,107 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:32:58,108 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:32:58,109 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:32:58,110 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:32:58,111 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:32:58,113 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:32:58,114 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:58,116 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:32:58,120 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:58,124 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:58,126 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:32:58,131 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:58,137 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:58,141 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:32:58,144 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:32:58,147 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:32:58,250 - utils.prediction - INFO - RandomForest predicted 1.59 workers for WorkType 211
2025-05-18 08:32:58,276 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:58,277 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:32:58,279 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:32:58,280 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:32:58,282 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:32:58,283 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:32:58,284 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:32:58,285 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:32:58,286 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:32:58,287 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:32:58,288 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:32:58,289 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:32:58,290 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:32:58,291 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:32:58,292 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:32:58,294 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:32:58,295 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:58,297 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:32:58,299 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:58,300 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:58,302 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:32:58,303 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:58,304 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:58,318 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:32:58,319 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:32:58,321 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:32:58,385 - utils.prediction - INFO - RandomForest predicted 1.77 workers for WorkType 213
2025-05-18 08:32:58,414 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:58,415 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:32:58,416 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:32:58,417 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:32:58,418 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:32:58,419 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:32:58,420 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:32:58,422 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:32:58,423 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:32:58,424 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:32:58,425 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:32:58,426 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:32:58,427 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:32:58,428 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:32:58,431 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:32:58,433 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:32:58,434 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:58,435 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:32:58,436 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:58,437 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:58,438 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:32:58,439 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:58,441 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:58,442 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:32:58,443 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:32:58,444 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:32:58,508 - utils.prediction - INFO - RandomForest predicted 2.67 workers for WorkType 214
2025-05-18 08:32:58,536 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:32:58,538 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:32:58,539 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:32:58,540 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:32:58,541 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:32:58,542 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:32:58,543 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:32:58,544 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:32:58,545 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:32:58,546 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:32:58,547 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:32:58,549 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:32:58,550 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:32:58,552 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:32:58,553 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:32:58,554 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:32:58,555 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:32:58,556 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:32:58,557 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:32:58,558 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:32:58,559 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:32:58,560 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:32:58,562 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:32:58,563 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:32:58,565 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:32:58,567 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:32:58,637 - utils.prediction - INFO - RandomForest predicted 1.11 workers for WorkType 215
2025-05-18 08:32:58,704 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:58,709 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:58,713 - utils.prediction - INFO - Generated predictions for 2025-05-15 00:00:00: {'209': np.float64(0.20394375000000015), '211': np.float64(1.586868749999997), '213': np.float64(1.7654975000000008), '214': np.float64(2.66863125), '215': np.float64(1.1055750000000004)}
2025-05-18 08:32:58,738 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:58,740 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:58,741 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-16
2025-05-18 08:32:58,742 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:32:58,743 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:32:58,813 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:58,817 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:58,880 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:58,885 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:58,953 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:58,957 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:59,024 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:59,026 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:32:59,029 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:32:59,032 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:32:59,034 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:32:59,037 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:32:59,040 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:32:59,043 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:32:59,047 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:32:59,049 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:32:59,052 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:32:59,055 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:32:59,058 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:32:59,060 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:32:59,064 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:32:59,067 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:32:59,070 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:59,073 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:32:59,075 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:59,078 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:59,082 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:32:59,084 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:32:59,087 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:32:59,090 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:32:59,092 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:32:59,094 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:32:59,239 - utils.prediction - INFO - RandomForest predicted 0.11 workers for WorkType 209
2025-05-18 08:32:59,275 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:32:59,278 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:32:59,311 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:59,313 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:32:59,315 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:32:59,316 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:32:59,317 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:32:59,318 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:32:59,319 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:32:59,321 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:32:59,322 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:32:59,323 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:32:59,324 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:32:59,325 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:32:59,326 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:32:59,328 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:32:59,330 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:32:59,332 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:32:59,334 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:59,335 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:32:59,336 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:59,338 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:59,339 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:32:59,340 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:32:59,341 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:32:59,342 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:32:59,343 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:32:59,345 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:32:59,407 - utils.prediction - INFO - RandomForest predicted 3.83 workers for WorkType 211
2025-05-18 08:32:59,456 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:59,458 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:32:59,460 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:32:59,463 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:32:59,466 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:32:59,468 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:32:59,471 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:32:59,474 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:32:59,477 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:32:59,480 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:32:59,483 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:32:59,486 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:32:59,489 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:32:59,492 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:32:59,495 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:32:59,499 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:32:59,502 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:59,505 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:32:59,508 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:59,511 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:59,514 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:32:59,517 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:32:59,521 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:32:59,523 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:32:59,526 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:32:59,531 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:32:59,694 - utils.prediction - INFO - RandomForest predicted 3.71 workers for WorkType 213
2025-05-18 08:32:59,764 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:59,767 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:32:59,769 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:32:59,771 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:32:59,774 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:32:59,776 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:32:59,781 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:32:59,784 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:32:59,788 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:32:59,791 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:32:59,793 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:32:59,797 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:32:59,800 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:32:59,804 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:32:59,806 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:32:59,808 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:32:59,811 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:59,815 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:32:59,818 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:59,822 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:59,826 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:32:59,829 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:32:59,833 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:32:59,836 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:32:59,839 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:32:59,842 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:32:59,983 - utils.prediction - INFO - RandomForest predicted 2.70 workers for WorkType 214
2025-05-18 08:33:00,048 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:00,049 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:33:00,051 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:33:00,052 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:33:00,053 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:33:00,055 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:33:00,056 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:33:00,057 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:33:00,059 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:33:00,060 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:33:00,062 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:33:00,064 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:33:00,066 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:33:00,067 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:33:00,069 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:33:00,071 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:33:00,073 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:00,074 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:33:00,075 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:00,077 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:00,078 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:33:00,080 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:00,081 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:00,083 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:33:00,085 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:33:00,087 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:33:00,173 - utils.prediction - INFO - RandomForest predicted 0.74 workers for WorkType 215
2025-05-18 08:33:00,242 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:00,249 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:00,252 - utils.prediction - INFO - Generated predictions for 2025-05-16 00:00:00: {'209': np.float64(0.11324375000000007), '211': np.float64(3.8317562499999984), '213': np.float64(3.7104687499999995), '214': np.float64(2.7009062499999974), '215': np.float64(0.7443625)}
2025-05-18 08:33:00,276 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:33:00,277 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:33:00,278 - utils.prediction - INFO - Date 2025-05-17 is a non-working day: Saturday (Weekend)
2025-05-18 08:33:00,280 - utils.prediction - INFO - No work is carried out on this day. Setting all predictions to 0.
2025-05-18 08:33:00,307 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:00,309 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:00,310 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-18
2025-05-18 08:33:00,312 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:00,314 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:00,387 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:00,392 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:00,462 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:00,468 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:00,542 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:00,548 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:00,638 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:00,641 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:33:00,643 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:33:00,647 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:33:00,650 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:33:00,653 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:33:00,656 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:33:00,659 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:33:00,662 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:33:00,665 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:33:00,667 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:33:00,670 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:33:00,673 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:33:00,676 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:33:00,680 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:33:00,683 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:33:00,686 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:00,688 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:33:00,691 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:00,694 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:00,698 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:33:00,701 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:00,704 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:00,706 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:33:00,709 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:33:00,713 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:33:00,852 - utils.prediction - INFO - RandomForest predicted 0.09 workers for WorkType 209
2025-05-18 08:33:00,919 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:00,924 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:01,007 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:01,009 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:33:01,012 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:33:01,015 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:33:01,018 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:33:01,021 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:33:01,024 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:33:01,027 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:33:01,030 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:33:01,033 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:33:01,038 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:33:01,048 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:33:01,051 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:33:01,055 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:33:01,058 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:33:01,061 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:33:01,066 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:01,069 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:33:01,072 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:01,075 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:01,080 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:33:01,083 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:01,086 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:01,089 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:33:01,092 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:33:01,097 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:33:01,225 - utils.prediction - INFO - RandomForest predicted 2.65 workers for WorkType 211
2025-05-18 08:33:01,258 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:01,259 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:33:01,260 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:33:01,262 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:33:01,264 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:33:01,265 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:33:01,266 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:33:01,268 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:33:01,269 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:33:01,271 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:33:01,272 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:33:01,273 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:33:01,274 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:33:01,275 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:33:01,277 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:33:01,278 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:33:01,280 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:01,281 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:33:01,282 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:01,284 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:01,285 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:33:01,287 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:01,288 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:01,289 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:33:01,290 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:33:01,291 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:33:01,382 - utils.prediction - INFO - RandomForest predicted 4.20 workers for WorkType 213
2025-05-18 08:33:01,422 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:01,424 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:33:01,425 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:33:01,426 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:33:01,427 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:33:01,428 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:33:01,429 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:33:01,431 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:33:01,432 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:33:01,433 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:33:01,434 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:33:01,435 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:33:01,436 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:33:01,438 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:33:01,439 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:33:01,440 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:33:01,441 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:01,442 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:33:01,443 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:01,445 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:01,446 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:33:01,447 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:01,448 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:01,449 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:33:01,451 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:33:01,452 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:33:01,510 - utils.prediction - INFO - RandomForest predicted 1.78 workers for WorkType 214
2025-05-18 08:33:01,538 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:01,539 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:33:01,541 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:33:01,542 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:33:01,543 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:33:01,544 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:33:01,545 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:33:01,547 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:33:01,548 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:33:01,549 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:33:01,550 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:33:01,551 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:33:01,553 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:33:01,554 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:33:01,555 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:33:01,556 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:33:01,557 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:01,558 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:33:01,559 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:01,560 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:01,562 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:33:01,563 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:01,565 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:01,566 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:33:01,567 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:33:01,569 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:33:01,641 - utils.prediction - INFO - RandomForest predicted 0.20 workers for WorkType 215
2025-05-18 08:33:01,708 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:01,715 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:01,718 - utils.prediction - INFO - Generated predictions for 2025-05-18 00:00:00: {'209': np.float64(0.09035000000000004), '211': np.float64(2.647218750000001), '213': np.float64(4.195075000000002), '214': np.float64(1.7805249999999986), '215': np.float64(0.19954375)}
2025-05-18 08:33:01,745 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:01,746 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:01,748 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-19
2025-05-18 08:33:01,750 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:01,751 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:01,822 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:01,830 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:01,901 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:01,907 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:01,980 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:01,986 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:02,065 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:02,067 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:33:02,070 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:33:02,072 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:33:02,075 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:33:02,077 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:33:02,082 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:33:02,085 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:33:02,088 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:33:02,091 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:33:02,093 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:33:02,097 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:33:02,101 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:33:02,104 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:33:02,106 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:33:02,109 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:33:02,111 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:02,115 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:33:02,118 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:02,120 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:02,123 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:33:02,126 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:02,129 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:02,134 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:33:02,137 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:33:02,140 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:33:02,276 - utils.prediction - INFO - RandomForest predicted 0.12 workers for WorkType 209
2025-05-18 08:33:02,310 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:02,315 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:02,352 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:02,354 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:33:02,355 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:33:02,356 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:33:02,357 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:33:02,359 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:33:02,360 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:33:02,362 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:33:02,363 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:33:02,365 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:33:02,366 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:33:02,368 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:33:02,369 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:33:02,371 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:33:02,372 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:33:02,373 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:33:02,374 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:02,376 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:33:02,377 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:02,379 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:02,381 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:33:02,382 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:02,384 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:02,385 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:33:02,387 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:33:02,388 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:33:02,469 - utils.prediction - INFO - RandomForest predicted 0.77 workers for WorkType 211
2025-05-18 08:33:02,542 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:02,544 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:33:02,548 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:33:02,551 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:33:02,553 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:33:02,555 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:33:02,558 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:33:02,561 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:33:02,564 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:33:02,566 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:33:02,570 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:33:02,573 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:33:02,576 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:33:02,580 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:33:02,583 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:33:02,587 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:33:02,590 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:02,594 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:33:02,598 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:02,602 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:02,607 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:33:02,610 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:02,615 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:02,619 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:33:02,622 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:33:02,627 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:33:02,781 - utils.prediction - INFO - RandomForest predicted 0.71 workers for WorkType 213
2025-05-18 08:33:02,856 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:02,859 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:33:02,861 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:33:02,864 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:33:02,867 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:33:02,869 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:33:02,872 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:33:02,875 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:33:02,879 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:33:02,883 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:33:02,886 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:33:02,889 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:33:02,892 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:33:02,897 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:33:02,900 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:33:02,903 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:33:02,907 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:02,910 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:33:02,915 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:02,919 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:02,923 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:33:02,926 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:02,931 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:02,935 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:33:02,939 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:33:02,943 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:33:03,094 - utils.prediction - INFO - RandomForest predicted 1.13 workers for WorkType 214
2025-05-18 08:33:03,125 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:03,126 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:33:03,127 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:33:03,129 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:33:03,130 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:33:03,132 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:33:03,133 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:33:03,134 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:33:03,135 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:33:03,137 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:33:03,139 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:33:03,140 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:33:03,141 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:33:03,142 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:33:03,143 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:33:03,144 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:33:03,146 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:03,147 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:33:03,149 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:03,150 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:03,152 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:33:03,153 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:03,155 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:03,156 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:33:03,157 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:33:03,159 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:33:03,227 - utils.prediction - INFO - RandomForest predicted 0.21 workers for WorkType 215
2025-05-18 08:33:03,253 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:03,255 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:03,257 - utils.prediction - INFO - Generated predictions for 2025-05-19 00:00:00: {'209': np.float64(0.11746875000000007), '211': np.float64(0.7711875000000004), '213': np.float64(0.7085864583333331), '214': np.float64(1.1287750000000005), '215': np.float64(0.20883749999999998)}
2025-05-18 08:33:03,271 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:03,272 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:03,273 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-20
2025-05-18 08:33:03,273 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:03,274 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:03,305 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:03,308 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:03,339 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:03,343 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:03,376 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:03,380 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:03,412 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:03,413 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:33:03,414 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:33:03,416 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:33:03,417 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:33:03,418 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:33:03,419 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:33:03,420 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:33:03,421 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:33:03,422 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:33:03,423 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:33:03,424 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:33:03,425 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:33:03,426 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:33:03,428 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:33:03,429 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:33:03,430 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:03,432 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:33:03,433 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:03,434 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:03,435 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:33:03,437 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:03,438 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:03,439 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:33:03,440 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:33:03,441 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:33:03,543 - utils.prediction - INFO - RandomForest predicted 0.12 workers for WorkType 209
2025-05-18 08:33:03,605 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:03,609 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:03,656 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:03,658 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:33:03,659 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:33:03,660 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:33:03,662 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:33:03,664 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:33:03,665 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:33:03,667 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:33:03,669 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:33:03,671 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:33:03,673 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:33:03,674 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:33:03,676 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:33:03,678 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:33:03,680 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:33:03,682 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:33:03,684 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:03,686 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:33:03,688 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:03,689 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:03,691 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:33:03,692 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:03,694 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:03,696 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:33:03,698 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:33:03,700 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:33:03,785 - utils.prediction - INFO - RandomForest predicted 2.67 workers for WorkType 211
2025-05-18 08:33:03,848 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:03,851 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:33:03,853 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:33:03,856 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:33:03,859 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:33:03,861 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:33:03,865 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:33:03,868 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:33:03,871 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:33:03,874 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:33:03,877 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:33:03,881 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:33:03,884 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:33:03,889 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:33:03,892 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:33:03,897 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:33:03,900 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:03,905 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:33:03,907 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:03,910 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:03,914 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:33:03,918 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:03,922 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:03,926 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:33:03,932 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:33:03,937 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:33:04,107 - utils.prediction - INFO - RandomForest predicted 4.53 workers for WorkType 213
2025-05-18 08:33:04,150 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:04,152 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:33:04,153 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:33:04,155 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:33:04,156 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:33:04,158 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:33:04,159 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:33:04,161 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:33:04,163 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:33:04,165 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:33:04,167 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:33:04,169 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:33:04,170 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:33:04,172 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:33:04,174 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:33:04,175 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:33:04,176 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:04,178 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:33:04,180 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:04,182 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:04,184 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:33:04,185 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:04,187 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:04,188 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:33:04,189 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:33:04,190 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:33:04,276 - utils.prediction - INFO - RandomForest predicted 1.47 workers for WorkType 214
2025-05-18 08:33:04,326 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:04,328 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:33:04,330 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:33:04,332 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:33:04,333 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:33:04,335 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:33:04,336 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:33:04,337 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:33:04,338 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:33:04,340 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:33:04,342 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:33:04,343 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:33:04,346 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:33:04,348 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:33:04,349 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:33:04,351 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:33:04,352 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:04,354 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:33:04,356 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:04,357 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:04,359 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:33:04,360 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:04,362 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:04,363 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:33:04,365 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:33:04,367 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:33:04,442 - utils.prediction - INFO - RandomForest predicted 0.21 workers for WorkType 215
2025-05-18 08:33:04,493 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:04,499 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:04,503 - utils.prediction - INFO - Generated predictions for 2025-05-20 00:00:00: {'209': np.float64(0.11746875000000007), '211': np.float64(2.674150000000001), '213': np.float64(4.529481250000006), '214': np.float64(1.4715437500000004), '215': np.float64(0.20883749999999998)}
2025-05-18 08:33:04,539 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:04,541 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:33:04,543 - utils.prediction - INFO - Predicting NoOfMan for 2025-05-21
2025-05-18 08:33:04,544 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:04,546 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:33:04,644 - utils.prediction - ERROR - Error predicting for WorkType 202: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:04,651 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:04,737 - utils.prediction - ERROR - Error predicting for WorkType 203: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:04,743 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:04,848 - utils.prediction - ERROR - Error predicting for WorkType 206: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:04,854 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:04,899 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:04,902 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 209
2025-05-18 08:33:04,905 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 209
2025-05-18 08:33:04,909 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 209
2025-05-18 08:33:04,913 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 209
2025-05-18 08:33:04,915 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 209
2025-05-18 08:33:04,917 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 209
2025-05-18 08:33:04,919 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 209
2025-05-18 08:33:04,920 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 209
2025-05-18 08:33:04,921 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 209
2025-05-18 08:33:04,922 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 209
2025-05-18 08:33:04,923 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 209
2025-05-18 08:33:04,924 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 209
2025-05-18 08:33:04,925 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 209
2025-05-18 08:33:04,927 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 209
2025-05-18 08:33:04,928 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 209
2025-05-18 08:33:04,929 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:04,930 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 209
2025-05-18 08:33:04,931 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:04,933 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:04,935 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 209
2025-05-18 08:33:04,938 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 209
2025-05-18 08:33:04,941 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 209
2025-05-18 08:33:04,942 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 209
2025-05-18 08:33:04,944 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 209
2025-05-18 08:33:04,945 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 209
2025-05-18 08:33:05,003 - utils.prediction - INFO - RandomForest predicted 0.13 workers for WorkType 209
2025-05-18 08:33:05,052 - utils.prediction - ERROR - Error predicting for WorkType 210: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:05,055 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:05,088 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:05,088 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 211
2025-05-18 08:33:05,089 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 211
2025-05-18 08:33:05,090 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 211
2025-05-18 08:33:05,091 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 211
2025-05-18 08:33:05,092 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 211
2025-05-18 08:33:05,093 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 211
2025-05-18 08:33:05,094 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 211
2025-05-18 08:33:05,095 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 211
2025-05-18 08:33:05,096 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 211
2025-05-18 08:33:05,098 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 211
2025-05-18 08:33:05,099 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 211
2025-05-18 08:33:05,101 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 211
2025-05-18 08:33:05,102 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 211
2025-05-18 08:33:05,104 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 211
2025-05-18 08:33:05,105 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 211
2025-05-18 08:33:05,106 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:05,107 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 211
2025-05-18 08:33:05,108 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:05,110 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:05,111 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 211
2025-05-18 08:33:05,112 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 211
2025-05-18 08:33:05,114 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 211
2025-05-18 08:33:05,115 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 211
2025-05-18 08:33:05,117 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 211
2025-05-18 08:33:05,118 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 211
2025-05-18 08:33:05,181 - utils.prediction - INFO - RandomForest predicted 2.83 workers for WorkType 211
2025-05-18 08:33:05,208 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:05,210 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 213
2025-05-18 08:33:05,211 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 213
2025-05-18 08:33:05,212 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 213
2025-05-18 08:33:05,215 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 213
2025-05-18 08:33:05,218 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 213
2025-05-18 08:33:05,221 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 213
2025-05-18 08:33:05,223 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 213
2025-05-18 08:33:05,226 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 213
2025-05-18 08:33:05,229 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 213
2025-05-18 08:33:05,232 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 213
2025-05-18 08:33:05,235 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 213
2025-05-18 08:33:05,238 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 213
2025-05-18 08:33:05,240 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 213
2025-05-18 08:33:05,243 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 213
2025-05-18 08:33:05,246 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 213
2025-05-18 08:33:05,250 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:05,253 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 213
2025-05-18 08:33:05,256 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:05,258 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:05,263 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 213
2025-05-18 08:33:05,266 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 213
2025-05-18 08:33:05,270 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 213
2025-05-18 08:33:05,273 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 213
2025-05-18 08:33:05,276 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 213
2025-05-18 08:33:05,283 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 213
2025-05-18 08:33:05,436 - utils.prediction - INFO - RandomForest predicted 0.93 workers for WorkType 213
2025-05-18 08:33:05,504 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:05,507 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 214
2025-05-18 08:33:05,509 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 214
2025-05-18 08:33:05,514 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 214
2025-05-18 08:33:05,516 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 214
2025-05-18 08:33:05,519 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 214
2025-05-18 08:33:05,521 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 214
2025-05-18 08:33:05,524 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 214
2025-05-18 08:33:05,527 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 214
2025-05-18 08:33:05,531 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 214
2025-05-18 08:33:05,534 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 214
2025-05-18 08:33:05,538 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 214
2025-05-18 08:33:05,541 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 214
2025-05-18 08:33:05,545 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 214
2025-05-18 08:33:05,549 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 214
2025-05-18 08:33:05,552 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 214
2025-05-18 08:33:05,556 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:05,559 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 214
2025-05-18 08:33:05,564 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:05,567 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:05,570 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 214
2025-05-18 08:33:05,574 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 214
2025-05-18 08:33:05,577 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 214
2025-05-18 08:33:05,581 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 214
2025-05-18 08:33:05,585 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 214
2025-05-18 08:33:05,589 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 214
2025-05-18 08:33:05,722 - utils.prediction - INFO - RandomForest predicted 1.56 workers for WorkType 214
2025-05-18 08:33:05,757 - utils.prediction - INFO - Added missing column 'SystemKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:05,758 - utils.prediction - INFO - Added missing column 'Quantity_lag_7' for WorkType 215
2025-05-18 08:33:05,760 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_1' for WorkType 215
2025-05-18 08:33:05,762 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio' for WorkType 215
2025-05-18 08:33:05,763 - utils.prediction - INFO - Added missing column 'Workers_Predicted_from_Quantity' for WorkType 215
2025-05-18 08:33:05,765 - utils.prediction - INFO - Added missing column 'Relative_Quantity' for WorkType 215
2025-05-18 08:33:05,767 - utils.prediction - INFO - Added missing column 'Quantity_1day_trend' for WorkType 215
2025-05-18 08:33:05,768 - utils.prediction - INFO - Added missing column 'Quantity_same_dow_lag' for WorkType 215
2025-05-18 08:33:05,770 - utils.prediction - INFO - Added missing column 'Quantity_rolling_mean_7' for WorkType 215
2025-05-18 08:33:05,772 - utils.prediction - INFO - Added missing column 'Quantity_7day_trend' for WorkType 215
2025-05-18 08:33:05,773 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity' for WorkType 215
2025-05-18 08:33:05,773 - utils.prediction - INFO - Added missing column 'Quantity_lag_1' for WorkType 215
2025-05-18 08:33:05,775 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity' for WorkType 215
2025-05-18 08:33:05,776 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_1' for WorkType 215
2025-05-18 08:33:05,778 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker' for WorkType 215
2025-05-18 08:33:05,779 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_1' for WorkType 215
2025-05-18 08:33:05,780 - utils.prediction - INFO - Added missing column 'ResourceKPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:05,782 - utils.prediction - INFO - Added missing column 'Hours_SystemHours_Ratio_lag_1' for WorkType 215
2025-05-18 08:33:05,783 - utils.prediction - INFO - Added missing column 'Hours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:05,785 - utils.prediction - INFO - Added missing column 'SystemHours_per_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:05,786 - utils.prediction - INFO - Added missing column 'Quantity_per_Worker_lag_1' for WorkType 215
2025-05-18 08:33:05,787 - utils.prediction - INFO - Added missing column 'Relative_Quantity_lag_1' for WorkType 215
2025-05-18 08:33:05,789 - utils.prediction - INFO - Added missing column 'Combined_KPI_rolling_mean_7' for WorkType 215
2025-05-18 08:33:05,789 - utils.prediction - INFO - Added missing column 'Combined_KPI_lag_7' for WorkType 215
2025-05-18 08:33:05,790 - utils.prediction - INFO - Added missing column 'ResourceKPI_lag_7' for WorkType 215
2025-05-18 08:33:05,791 - utils.prediction - INFO - Added missing column 'SystemKPI_lag_7' for WorkType 215
2025-05-18 08:33:05,867 - utils.prediction - INFO - RandomForest predicted 0.34 workers for WorkType 215
2025-05-18 08:33:05,894 - utils.prediction - ERROR - Error predicting for WorkType 217: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}
2025-05-18 08:33:05,897 - utils.prediction - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\prediction.py", line 408, in predict_next_day
    prediction = model.predict(X_pred)[0]
                 ~~~~~~~~~~~~~^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 787, in predict
    Xt = transform.transform(Xt)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1090, in transform
    raise ValueError(f"columns are missing: {diff}")
ValueError: columns are missing: {'Relative_Quantity', 'SystemKPI_lag_1', 'Quantity_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Hours_SystemHours_Ratio_lag_1', 'Quantity_1day_trend', 'Quantity_rolling_mean_7', 'Combined_KPI_lag_1', 'Quantity_lag_7', 'Quantity_7day_trend', 'Quantity_per_Worker', 'ResourceKPI_lag_1', 'Quantity_same_dow_lag', 'Workers_Predicted_from_Quantity'}

2025-05-18 08:33:05,899 - utils.prediction - INFO - Generated predictions for 2025-05-21 00:00:00: {'209': np.float64(0.1321437500000001), '211': np.float64(2.8292187500000012), '213': np.float64(0.9283208333333335), '214': np.float64(1.5562125), '215': np.float64(0.3355625)}
2025-05-18 08:33:05,911 - utils.prediction - INFO - Predictions completed for 7 days
2025-05-18 08:33:05,916 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:33:05,916 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:33:05,918 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:33:05,918 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:33:05,919 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:33:05,919 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:33:05,920 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:05,920 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:05,921 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:05,922 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:05,923 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:05,923 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:05,924 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:05,925 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:33:05,929 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:33:05,929 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:33:05,930 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:33:05,930 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:33:05,931 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:33:05,932 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:33:05,932 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:05,932 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:05,933 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:05,934 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:05,934 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:05,935 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:05,935 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:05,936 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:33:05,936 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:33:05,937 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:33:05,937 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:33:05,938 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:33:05,938 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:33:05,939 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:33:05,939 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:05,940 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:05,940 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:05,941 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:05,941 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:05,942 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:05,942 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:05,943 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:33:05,965 - utils.holiday_utils - INFO - Checking if date 2025-05-15 (weekday: 3) is a non-working day
2025-05-18 08:33:05,966 - utils.holiday_utils - INFO - Date 2025-05-15 is a normal working day
2025-05-18 08:33:05,968 - utils.holiday_utils - INFO - Checking if date 2025-05-16 (weekday: 4) is a non-working day
2025-05-18 08:33:05,969 - utils.holiday_utils - INFO - Date 2025-05-16 is a normal working day
2025-05-18 08:33:05,970 - utils.holiday_utils - INFO - Checking if date 2025-05-17 (weekday: 5) is a non-working day
2025-05-18 08:33:05,971 - utils.holiday_utils - INFO - Date 2025-05-17 is a Saturday
2025-05-18 08:33:05,972 - utils.holiday_utils - INFO - Checking if date 2025-05-18 (weekday: 6) is a non-working day
2025-05-18 08:33:05,972 - utils.holiday_utils - INFO - Date 2025-05-18 is a normal working day
2025-05-18 08:33:05,974 - utils.holiday_utils - INFO - Checking if date 2025-05-19 (weekday: 0) is a non-working day
2025-05-18 08:33:05,974 - utils.holiday_utils - INFO - Date 2025-05-19 is a normal working day
2025-05-18 08:33:05,975 - utils.holiday_utils - INFO - Checking if date 2025-05-20 (weekday: 1) is a non-working day
2025-05-18 08:33:05,976 - utils.holiday_utils - INFO - Date 2025-05-20 is a normal working day
2025-05-18 08:33:05,976 - utils.holiday_utils - INFO - Checking if date 2025-05-21 (weekday: 2) is a non-working day
2025-05-18 08:33:05,977 - utils.holiday_utils - INFO - Date 2025-05-21 is a normal working day
2025-05-18 08:34:13,895 - utils.sql_data_connector - INFO - Connecting to 192.168.1.43/ABC
2025-05-18 08:34:14,805 - utils.sql_data_connector - INFO - Fetched chunk of 10000 rows
2025-05-18 08:34:14,969 - utils.sql_data_connector - INFO - Fetched chunk of 5415 rows
2025-05-18 08:34:14,972 - utils.sql_data_connector - INFO - Total rows fetched: 15415
2025-05-18 08:34:15,081 - __main__ - INFO - Loaded 15415 records from WorkUtilizationData
2025-05-18 08:34:15,127 - utils.feature_engineering - INFO - Engineering features
2025-05-18 08:34:15,212 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-18 08:34:15,285 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-18 08:34:15,974 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-18 08:34:15,975 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-18 08:34:16,794 - __main__ - INFO - Models loaded successfully. Number of models: 10
2025-05-18 08:34:16,796 - __main__ - INFO - Successfully loaded 10 models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
2025-05-18 08:34:16,799 - utils.sql_data_connector - INFO - Testing connection to primary database fsystemp before loading forecast data
2025-05-18 08:34:16,966 - utils.sql_data_connector - INFO - Loading demand forecast data from 192.168.1.43/fsystemp
2025-05-18 08:34:17,437 - utils.sql_data_connector - INFO - Fetched chunk of 13 rows
2025-05-18 08:34:17,440 - utils.sql_data_connector - INFO - Total rows fetched: 13
2025-05-18 08:34:17,482 - utils.sql_data_connector - INFO - Successfully loaded forecast data from fsystemp. Shape: (13, 4)
2025-05-18 08:34:17,485 - __main__ - INFO - Loaded demand forecast data: 13 records
2025-05-18 08:34:17,489 - __main__ - INFO - Available models: ['202', '203', '206', '209', '210', '211', '213', '214', '215', '217']
