2025-05-10 12:05:08,915 - train_models - INFO - Starting the model training process
2025-05-10 12:05:08,916 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:07:50,330 - train_models - INFO - Starting the model training process
2025-05-10 12:07:50,331 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:08:29,705 - train_models - INFO - Starting the model training process
2025-05-10 12:08:29,706 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:09:14,500 - train_models - INFO - Starting the model training process
2025-05-10 12:09:14,513 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-10 12:09:14,693 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-10 12:09:14,694 - train_models - INFO - Engineering features
2025-05-10 12:09:14,737 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-10 12:09:14,750 - train_models - INFO - Created 15 new features
2025-05-10 12:09:14,751 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-10 12:09:14,751 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-10 12:09:14,756 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-10 12:09:14,824 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-10 12:09:14,996 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-10 12:09:14,997 - train_models - INFO - Found 5 unique work types
2025-05-10 12:09:14,998 - train_models - INFO - Building models for 5 work types
2025-05-10 12:09:14,998 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-10 12:09:14,998 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-10 12:09:14,999 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-10 12:09:14,999 - train_models - INFO - Building model for WorkType: 209
2025-05-10 12:09:15,006 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:11:21,487 - train_models - INFO - Starting the model training process
2025-05-10 12:11:21,489 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-10 12:11:21,584 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-10 12:11:21,585 - train_models - INFO - Engineering features
2025-05-10 12:11:21,645 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-10 12:11:21,669 - train_models - INFO - Created 15 new features
2025-05-10 12:11:21,670 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-10 12:11:21,671 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-10 12:11:21,680 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-10 12:11:21,779 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-10 12:11:21,983 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-10 12:11:21,987 - train_models - INFO - Found 5 unique work types
2025-05-10 12:11:21,988 - train_models - INFO - Building models for 5 work types
2025-05-10 12:11:21,990 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-10 12:11:21,992 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-10 12:11:21,993 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-10 12:11:21,994 - train_models - INFO - Building model for WorkType: 209
2025-05-10 12:11:22,013 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:12:44,616 - train_models - INFO - Model for 209 - MAE: 0.4612, RMSE: 0.8679, R²: 0.9585, MAPE: 6.52%
2025-05-10 12:12:44,628 - train_models - INFO - Top 10 most important features for 209:
2025-05-10 12:12:44,628 - train_models - INFO -   Relative_Quantity: 0.6846
2025-05-10 12:12:44,629 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1485
2025-05-10 12:12:44,629 - train_models - INFO -   Hours_per_Quantity: 0.0548
2025-05-10 12:12:44,629 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-10 12:12:44,630 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0246
2025-05-10 12:12:44,630 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-10 12:12:44,631 - train_models - INFO -   NoOfMan_7day_trend: 0.0048
2025-05-10 12:12:44,631 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-10 12:12:44,632 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0026
2025-05-10 12:12:44,632 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-10 12:12:44,632 - train_models - INFO - Cross-validation details for 209:
2025-05-10 12:12:44,633 - train_models - INFO -   Fold 1: MAE=0.6603, RMSE=0.9510, R²=0.9399, MAPE=9.45%
2025-05-10 12:12:44,633 - train_models - INFO -   Fold 2: MAE=0.4873, RMSE=1.0376, R²=0.9461, MAPE=7.50%
2025-05-10 12:12:44,634 - train_models - INFO -   Fold 3: MAE=0.3704, RMSE=0.7427, R²=0.9586, MAPE=4.63%
2025-05-10 12:12:44,634 - train_models - INFO -   Fold 4: MAE=0.3784, RMSE=0.8627, R²=0.9649, MAPE=5.06%
2025-05-10 12:12:44,635 - train_models - INFO -   Fold 5: MAE=0.4094, RMSE=0.7454, R²=0.9831, MAPE=5.95%
2025-05-10 12:12:44,635 - train_models - INFO - Building model for WorkType: 211
2025-05-10 12:12:44,643 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:14:00,841 - train_models - INFO - Model for 211 - MAE: 0.6606, RMSE: 0.9850, R²: 0.9151, MAPE: 9.94%
2025-05-10 12:14:00,841 - train_models - INFO - Top 10 most important features for 211:
2025-05-10 12:14:00,842 - train_models - INFO -   Relative_Quantity: 0.4668
2025-05-10 12:14:00,842 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1591
2025-05-10 12:14:00,843 - train_models - INFO -   NoOfMan_7day_trend: 0.1100
2025-05-10 12:14:00,844 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0861
2025-05-10 12:14:00,844 - train_models - INFO -   NoOfMan_1day_trend: 0.0458
2025-05-10 12:14:00,845 - train_models - INFO -   NoOfMan_lag_1: 0.0258
2025-05-10 12:14:00,845 - train_models - INFO -   NoOfMan_lag_7: 0.0236
2025-05-10 12:14:00,845 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-10 12:14:00,846 - train_models - INFO -   Hours_per_Quantity: 0.0106
2025-05-10 12:14:00,846 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0052
2025-05-10 12:14:00,847 - train_models - INFO - Cross-validation details for 211:
2025-05-10 12:14:00,848 - train_models - INFO -   Fold 1: MAE=1.1096, RMSE=1.7041, R²=0.8114, MAPE=13.47%
2025-05-10 12:14:00,849 - train_models - INFO -   Fold 2: MAE=0.5611, RMSE=0.8506, R²=0.9317, MAPE=6.27%
2025-05-10 12:14:00,850 - train_models - INFO -   Fold 3: MAE=0.5784, RMSE=0.9275, R²=0.9325, MAPE=12.58%
2025-05-10 12:14:00,850 - train_models - INFO -   Fold 4: MAE=0.4559, RMSE=0.6714, R²=0.9616, MAPE=6.61%
2025-05-10 12:14:00,851 - train_models - INFO -   Fold 5: MAE=0.5981, RMSE=0.7712, R²=0.9385, MAPE=10.79%
2025-05-10 12:14:00,851 - train_models - INFO - Building model for WorkType: 213
2025-05-10 12:14:00,862 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:15:24,031 - train_models - INFO - Model for 213 - MAE: 0.4370, RMSE: 0.6455, R²: 0.8717, MAPE: 17.05%
2025-05-10 12:15:24,032 - train_models - INFO - Top 10 most important features for 213:
2025-05-10 12:15:24,033 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4479
2025-05-10 12:15:24,034 - train_models - INFO -   NoOfMan_7day_trend: 0.1968
2025-05-10 12:15:24,035 - train_models - INFO -   NoOfMan_1day_trend: 0.1472
2025-05-10 12:15:24,036 - train_models - INFO -   NoOfMan_lag_1: 0.0431
2025-05-10 12:15:24,037 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0419
2025-05-10 12:15:24,038 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0339
2025-05-10 12:15:24,040 - train_models - INFO -   NoOfMan_lag_7: 0.0248
2025-05-10 12:15:24,041 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0073
2025-05-10 12:15:24,042 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0064
2025-05-10 12:15:24,043 - train_models - INFO -   Relative_Quantity: 0.0064
2025-05-10 12:15:24,044 - train_models - INFO - Cross-validation details for 213:
2025-05-10 12:15:24,044 - train_models - INFO -   Fold 1: MAE=0.6100, RMSE=0.9201, R²=0.8055, MAPE=15.01%
2025-05-10 12:15:24,045 - train_models - INFO -   Fold 2: MAE=0.5253, RMSE=0.7163, R²=0.8335, MAPE=26.89%
2025-05-10 12:15:24,046 - train_models - INFO -   Fold 3: MAE=0.3567, RMSE=0.5451, R²=0.8953, MAPE=16.78%
2025-05-10 12:15:24,047 - train_models - INFO -   Fold 4: MAE=0.3548, RMSE=0.5172, R²=0.9087, MAPE=14.18%
2025-05-10 12:15:24,048 - train_models - INFO -   Fold 5: MAE=0.3382, RMSE=0.5287, R²=0.9155, MAPE=12.37%
2025-05-10 12:15:24,049 - train_models - INFO - Building model for WorkType: 214
2025-05-10 12:15:24,068 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:16:33,791 - train_models - INFO - Model for 214 - MAE: 0.4972, RMSE: 0.7220, R²: 0.8884, MAPE: 10.69%
2025-05-10 12:16:33,792 - train_models - INFO - Top 10 most important features for 214:
2025-05-10 12:16:33,792 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4705
2025-05-10 12:16:33,793 - train_models - INFO -   NoOfMan_7day_trend: 0.1602
2025-05-10 12:16:33,794 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-10 12:16:33,795 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0732
2025-05-10 12:16:33,796 - train_models - INFO -   NoOfMan_1day_trend: 0.0535
2025-05-10 12:16:33,797 - train_models - INFO -   NoOfMan_lag_7: 0.0438
2025-05-10 12:16:33,798 - train_models - INFO -   NoOfMan_lag_1: 0.0215
2025-05-10 12:16:33,800 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0084
2025-05-10 12:16:33,801 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0082
2025-05-10 12:16:33,802 - train_models - INFO -   Hours_per_Quantity: 0.0068
2025-05-10 12:16:33,803 - train_models - INFO - Cross-validation details for 214:
2025-05-10 12:16:33,804 - train_models - INFO -   Fold 1: MAE=0.4903, RMSE=0.6447, R²=0.8420, MAPE=11.18%
2025-05-10 12:16:33,805 - train_models - INFO -   Fold 2: MAE=0.4974, RMSE=0.6454, R²=0.8988, MAPE=11.58%
2025-05-10 12:16:33,806 - train_models - INFO -   Fold 3: MAE=0.3390, RMSE=0.4263, R²=0.9480, MAPE=8.88%
2025-05-10 12:16:33,807 - train_models - INFO -   Fold 4: MAE=0.3620, RMSE=0.5929, R²=0.9209, MAPE=7.18%
2025-05-10 12:16:33,807 - train_models - INFO -   Fold 5: MAE=0.7975, RMSE=1.3006, R²=0.8325, MAPE=14.62%
2025-05-10 12:16:33,808 - train_models - INFO - Building model for WorkType: 215
2025-05-10 12:16:33,826 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:17:38,200 - train_models - INFO - Model for 215 - MAE: 0.3156, RMSE: 0.6723, R²: 0.9556, MAPE: 6.74%
2025-05-10 12:17:38,200 - train_models - INFO - Top 10 most important features for 215:
2025-05-10 12:17:38,201 - train_models - INFO -   Relative_Quantity: 0.8666
2025-05-10 12:17:38,201 - train_models - INFO -   Hours_per_Quantity: 0.0557
2025-05-10 12:17:38,202 - train_models - INFO -   Quantity_per_Worker: 0.0412
2025-05-10 12:17:38,202 - train_models - INFO -   NoOfMan_1day_trend: 0.0070
2025-05-10 12:17:38,203 - train_models - INFO -   NoOfMan_7day_trend: 0.0064
2025-05-10 12:17:38,203 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0052
2025-05-10 12:17:38,204 - train_models - INFO -   Quantity_1day_trend: 0.0020
2025-05-10 12:17:38,204 - train_models - INFO -   SystemHours_per_Quantity: 0.0015
2025-05-10 12:17:38,205 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0014
2025-05-10 12:17:38,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0009
2025-05-10 12:17:38,206 - train_models - INFO - Cross-validation details for 215:
2025-05-10 12:17:38,208 - train_models - INFO -   Fold 1: MAE=0.6173, RMSE=1.2636, R²=0.8741, MAPE=12.09%
2025-05-10 12:17:38,208 - train_models - INFO -   Fold 2: MAE=0.2775, RMSE=0.4333, R²=0.9831, MAPE=7.01%
2025-05-10 12:17:38,209 - train_models - INFO -   Fold 3: MAE=0.2540, RMSE=0.6595, R²=0.9671, MAPE=5.42%
2025-05-10 12:17:38,210 - train_models - INFO -   Fold 4: MAE=0.2019, RMSE=0.4208, R²=0.9808, MAPE=5.02%
2025-05-10 12:17:38,210 - train_models - INFO -   Fold 5: MAE=0.2274, RMSE=0.5841, R²=0.9731, MAPE=4.13%
2025-05-10 12:17:38,211 - train_models - INFO - Saving 5 models to C:/forlogssystems/Models
2025-05-10 12:17:39,511 - train_models - INFO - Model files saved successfully
2025-05-10 12:17:39,512 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-10 12:17:39,512 - train_models - INFO - Model training completed
2025-05-14 14:27:29,518 - train_models - INFO - Starting the model training process
2025-05-14 14:27:29,520 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:27:29,561 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-14 14:27:29,561 - train_models - INFO - Engineering features
2025-05-14 14:27:29,576 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-14 14:27:29,580 - train_models - INFO - Created 15 new features
2025-05-14 14:27:29,581 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-14 14:27:29,581 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-14 14:27:29,583 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-14 14:27:29,616 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-14 14:27:29,677 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-14 14:27:29,679 - train_models - INFO - Found 5 unique work types
2025-05-14 14:27:29,679 - train_models - INFO - Building models for 5 work types
2025-05-14 14:27:29,679 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-14 14:27:29,680 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-14 14:27:29,680 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-14 14:27:29,680 - train_models - INFO - Building model for WorkType: 209
2025-05-14 14:27:29,685 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:27:57,696 - train_models - INFO - Model for 209 - MAE: 0.4612, RMSE: 0.8679, R²: 0.9585, MAPE: 6.52%
2025-05-14 14:27:57,697 - train_models - INFO - Top 10 most important features for 209:
2025-05-14 14:27:57,697 - train_models - INFO -   Relative_Quantity: 0.6846
2025-05-14 14:27:57,697 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1485
2025-05-14 14:27:57,697 - train_models - INFO -   Hours_per_Quantity: 0.0548
2025-05-14 14:27:57,698 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-14 14:27:57,698 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0246
2025-05-14 14:27:57,698 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_7day_trend: 0.0048
2025-05-14 14:27:57,699 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0026
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-14 14:27:57,700 - train_models - INFO - Cross-validation details for 209:
2025-05-14 14:27:57,700 - train_models - INFO -   Fold 1: MAE=0.6603, RMSE=0.9510, R²=0.9399, MAPE=9.45%
2025-05-14 14:27:57,700 - train_models - INFO -   Fold 2: MAE=0.4873, RMSE=1.0376, R²=0.9461, MAPE=7.50%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 3: MAE=0.3704, RMSE=0.7427, R²=0.9586, MAPE=4.63%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 4: MAE=0.3784, RMSE=0.8627, R²=0.9649, MAPE=5.06%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 5: MAE=0.4094, RMSE=0.7454, R²=0.9831, MAPE=5.95%
2025-05-14 14:27:57,701 - train_models - INFO - Building model for WorkType: 211
2025-05-14 14:27:57,711 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:28:26,838 - train_models - INFO - Model for 211 - MAE: 0.6606, RMSE: 0.9850, R²: 0.9151, MAPE: 9.94%
2025-05-14 14:28:26,839 - train_models - INFO - Top 10 most important features for 211:
2025-05-14 14:28:26,839 - train_models - INFO -   Relative_Quantity: 0.4668
2025-05-14 14:28:26,839 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1591
2025-05-14 14:28:26,839 - train_models - INFO -   NoOfMan_7day_trend: 0.1100
2025-05-14 14:28:26,840 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0861
2025-05-14 14:28:26,840 - train_models - INFO -   NoOfMan_1day_trend: 0.0458
2025-05-14 14:28:26,841 - train_models - INFO -   NoOfMan_lag_1: 0.0258
2025-05-14 14:28:26,841 - train_models - INFO -   NoOfMan_lag_7: 0.0236
2025-05-14 14:28:26,841 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-14 14:28:26,841 - train_models - INFO -   Hours_per_Quantity: 0.0106
2025-05-14 14:28:26,842 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0052
2025-05-14 14:28:26,842 - train_models - INFO - Cross-validation details for 211:
2025-05-14 14:28:26,842 - train_models - INFO -   Fold 1: MAE=1.1096, RMSE=1.7041, R²=0.8114, MAPE=13.47%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 2: MAE=0.5611, RMSE=0.8506, R²=0.9317, MAPE=6.27%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 3: MAE=0.5784, RMSE=0.9275, R²=0.9325, MAPE=12.58%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 4: MAE=0.4559, RMSE=0.6714, R²=0.9616, MAPE=6.61%
2025-05-14 14:28:26,844 - train_models - INFO -   Fold 5: MAE=0.5981, RMSE=0.7712, R²=0.9385, MAPE=10.79%
2025-05-14 14:28:26,844 - train_models - INFO - Building model for WorkType: 213
2025-05-14 14:28:26,849 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:33:20,038 - train_models - INFO - Starting the model training process
2025-05-14 14:33:20,039 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:33:20,067 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-14 14:33:20,067 - train_models - INFO - Engineering features
2025-05-14 14:33:20,085 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-14 14:33:20,092 - train_models - INFO - Created 15 new features
2025-05-14 14:33:20,092 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-14 14:33:20,092 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-14 14:33:20,095 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-14 14:33:20,132 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-14 14:33:20,216 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-14 14:33:20,217 - train_models - INFO - Found 5 unique work types
2025-05-14 14:33:20,218 - train_models - INFO - Building models for 5 work types
2025-05-14 14:33:20,218 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-14 14:33:20,218 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-14 14:33:20,218 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-14 14:33:20,219 - train_models - INFO - Building model for WorkType: 209
2025-05-14 14:33:20,226 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:36:49,290 - train_models - INFO - Starting the model training process
2025-05-14 14:36:49,291 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:37:36,411 - train_models - INFO - Starting the model training process
2025-05-14 14:37:36,412 - train_models - INFO - Training from SQL database (command line argument)
2025-05-14 14:37:36,416 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-14 14:37:36,530 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-14 14:37:37,119 - train_models - INFO - Read chunk of 10000 rows
2025-05-14 14:37:37,228 - train_models - INFO - Read chunk of 8386 rows
2025-05-14 14:37:37,246 - train_models - INFO - Data loaded successfully. Total rows: 18386
2025-05-14 14:37:37,248 - train_models - INFO - Engineering features
2025-05-14 14:37:37,249 - train_models - ERROR - Error in train_from_sql: Can only use .dt accessor with datetimelike values
2025-05-14 14:37:37,250 - train_models - INFO - Model training completed
2025-05-17 10:30:45,679 - train_models - INFO - Starting the model training process
2025-05-17 10:30:45,680 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-17 10:31:04,945 - train_models - INFO - Starting the model training process
2025-05-17 10:31:04,945 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:31:04,952 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:31:05,377 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-17 10:31:06,105 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:31:06,250 - train_models - INFO - Read chunk of 8397 rows
2025-05-17 10:31:06,297 - train_models - INFO - Data loaded successfully. Total rows: 18397
2025-05-17 10:31:06,302 - train_models - INFO - Engineering features...
2025-05-17 10:31:06,776 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:31:06,777 - utils.feature_engineering - ERROR - Error engineering features: Can only use .dt accessor with datetimelike values
2025-05-17 10:31:06,849 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 37, in engineer_features
    data['Year_feat'] = data['Date'].dt.year
                        ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\accessors.py", line 643, in __new__
    raise AttributeError("Can only use .dt accessor with datetimelike values")
AttributeError: Can only use .dt accessor with datetimelike values

2025-05-17 10:31:06,851 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: Can only use .dt accessor with datetimelike values
2025-05-17 10:31:06,853 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 37, in engineer_features
    data['Year_feat'] = data['Date'].dt.year
                        ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\accessors.py", line 643, in __new__
    raise AttributeError("Can only use .dt accessor with datetimelike values")
AttributeError: Can only use .dt accessor with datetimelike values

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 330, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 111, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: Can only use .dt accessor with datetimelike values

2025-05-17 10:31:06,854 - train_models - INFO - Model training completed successfully
2025-05-17 10:40:05,148 - train_models - INFO - Starting the model training process
2025-05-17 10:40:05,148 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:40:05,153 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:40:05,494 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-17 10:40:06,153 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:40:06,301 - train_models - INFO - Read chunk of 8397 rows
2025-05-17 10:40:06,356 - train_models - INFO - Data loaded successfully. Total rows: 18397
2025-05-17 10:40:06,358 - train_models - INFO - Converting Date column to datetime format
2025-05-17 10:40:06,379 - train_models - INFO - Engineering features...
2025-05-17 10:40:06,838 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:40:06,886 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-17 10:40:06,893 - train_models - INFO - Creating lag features...
2025-05-17 10:40:06,903 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-17 10:40:07,123 - utils.feature_engineering - INFO - Lag features created. Dropped 4520 rows with NaN values.
2025-05-17 10:40:07,123 - utils.feature_engineering - INFO - Final shape: (13877, 72)
2025-05-17 10:40:07,138 - train_models - INFO - Found 12 unique work types
2025-05-17 10:40:07,138 - train_models - INFO - Building models for 12 work types
2025-05-17 10:40:07,138 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-17 10:40:07,138 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-17 10:40:07,139 - train_models - INFO - Building model for WorkType: 201
2025-05-17 10:40:07,143 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:19,082 - train_models - INFO - Model for 201 - MAE: 21.5560, RMSE: 27.6092, R²: -7.0596, MAPE: 600.70%
2025-05-17 10:40:19,083 - train_models - INFO - Top 10 most important features for 201:
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6657
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0870
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0631
2025-05-17 10:40:19,084 - train_models - INFO -   Relative_Quantity: 0.0563
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_lag_1: 0.0266
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_7day_trend: 0.0262
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_1day_trend: 0.0157
2025-05-17 10:40:19,086 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0086
2025-05-17 10:40:19,086 - train_models - INFO -   Quantity_per_Worker: 0.0083
2025-05-17 10:40:19,086 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-17 10:40:19,086 - train_models - INFO - Cross-validation details for 201:
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 1: MAE=28.3978, RMSE=40.9448, R²=0.7913, MAPE=27.14%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 2: MAE=33.9669, RMSE=49.5103, R²=0.7835, MAPE=135.47%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 3: MAE=45.0065, RMSE=46.1921, R²=-21.3890, MAPE=2805.39%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 4: MAE=0.3318, RMSE=0.9450, R²=-16.2019, MAPE=32.79%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 5: MAE=0.0770, RMSE=0.4539, R²=0.7180, MAPE=2.71%
2025-05-17 10:40:19,088 - train_models - INFO - Building model for WorkType: 202
2025-05-17 10:40:19,092 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:34,690 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-17 10:40:34,690 - train_models - INFO - Top 10 most important features for 202:
2025-05-17 10:40:34,690 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-17 10:40:34,692 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-17 10:40:34,692 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-17 10:40:34,692 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-17 10:40:34,693 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-17 10:40:34,693 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-17 10:40:34,693 - train_models - INFO - Cross-validation details for 202:
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-17 10:40:34,695 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-17 10:40:34,695 - train_models - INFO - Building model for WorkType: 203
2025-05-17 10:40:34,699 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:50,933 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-17 10:40:50,933 - train_models - INFO - Top 10 most important features for 203:
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-17 10:40:50,936 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-17 10:40:50,936 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-17 10:40:50,936 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-17 10:40:50,937 - train_models - INFO - Cross-validation details for 203:
2025-05-17 10:40:50,937 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-17 10:40:50,937 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-17 10:40:50,938 - train_models - INFO - Building model for WorkType: 206
2025-05-17 10:40:50,943 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:12,606 - train_models - INFO - Model for 206 - MAE: 1.3115, RMSE: 2.1334, R²: 0.9311, MAPE: 10.37%
2025-05-17 10:41:12,606 - train_models - INFO - Top 10 most important features for 206:
2025-05-17 10:41:12,607 - train_models - INFO -   Relative_Quantity: 0.6873
2025-05-17 10:41:12,608 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1237
2025-05-17 10:41:12,608 - train_models - INFO -   Hours_per_Quantity: 0.0417
2025-05-17 10:41:12,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0415
2025-05-17 10:41:12,609 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0313
2025-05-17 10:41:12,609 - train_models - INFO -   Quantity_per_Worker: 0.0277
2025-05-17 10:41:12,609 - train_models - INFO -   NoOfMan_1day_trend: 0.0102
2025-05-17 10:41:12,610 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-17 10:41:12,610 - train_models - INFO -   NoOfMan_lag_1: 0.0044
2025-05-17 10:41:12,610 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-17 10:41:12,610 - train_models - INFO - Cross-validation details for 206:
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 1: MAE=1.8039, RMSE=2.4177, R²=0.9220, MAPE=9.19%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 2: MAE=1.3929, RMSE=1.9463, R²=0.9430, MAPE=8.36%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 3: MAE=1.1018, RMSE=2.3244, R²=0.8987, MAPE=6.02%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 4: MAE=0.9892, RMSE=1.8699, R²=0.9362, MAPE=14.06%
2025-05-17 10:41:12,612 - train_models - INFO -   Fold 5: MAE=1.2697, RMSE=2.1087, R²=0.9559, MAPE=14.25%
2025-05-17 10:41:12,612 - train_models - INFO - Building model for WorkType: 209
2025-05-17 10:41:12,620 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:29,543 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-17 10:41:29,543 - train_models - INFO - Top 10 most important features for 209:
2025-05-17 10:41:29,544 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-17 10:41:29,544 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-17 10:41:29,544 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-17 10:41:29,544 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-17 10:41:29,546 - train_models - INFO - Cross-validation details for 209:
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-17 10:41:29,548 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-17 10:41:29,548 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-17 10:41:29,548 - train_models - INFO - Building model for WorkType: 210
2025-05-17 10:41:29,554 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:45,773 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-17 10:41:45,773 - train_models - INFO - Top 10 most important features for 210:
2025-05-17 10:41:45,773 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-17 10:41:45,774 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-17 10:41:45,774 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-17 10:41:45,774 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-17 10:41:45,774 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-17 10:41:45,775 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-17 10:41:45,775 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-17 10:41:45,775 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-17 10:41:45,776 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:41:45,776 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-17 10:41:45,776 - train_models - INFO - Cross-validation details for 210:
2025-05-17 10:41:45,776 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-17 10:41:45,776 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-17 10:41:45,778 - train_models - INFO - Building model for WorkType: 211
2025-05-17 10:41:45,781 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:04,156 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-17 10:42:04,156 - train_models - INFO - Top 10 most important features for 211:
2025-05-17 10:42:04,157 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-17 10:42:04,157 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-17 10:42:04,157 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-17 10:42:04,158 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-17 10:42:04,158 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-17 10:42:04,159 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-17 10:42:04,159 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-17 10:42:04,159 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-17 10:42:04,160 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-17 10:42:04,160 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-17 10:42:04,160 - train_models - INFO - Cross-validation details for 211:
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-17 10:42:04,162 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-17 10:42:04,162 - train_models - INFO - Building model for WorkType: 213
2025-05-17 10:42:04,167 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:20,765 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-17 10:42:20,766 - train_models - INFO - Top 10 most important features for 213:
2025-05-17 10:42:20,766 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-17 10:42:20,766 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-17 10:42:20,768 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-17 10:42:20,768 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-17 10:42:20,768 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-17 10:42:20,769 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-17 10:42:20,769 - train_models - INFO - Cross-validation details for 213:
2025-05-17 10:42:20,769 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-17 10:42:20,769 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-17 10:42:20,770 - train_models - INFO - Building model for WorkType: 214
2025-05-17 10:42:20,774 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:37,218 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-17 10:42:37,218 - train_models - INFO - Top 10 most important features for 214:
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-17 10:42:37,219 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-17 10:42:37,221 - train_models - INFO - Cross-validation details for 214:
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-17 10:42:37,223 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-17 10:42:37,223 - train_models - INFO - Building model for WorkType: 215
2025-05-17 10:42:37,228 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:57,594 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-17 10:42:57,594 - train_models - INFO - Top 10 most important features for 215:
2025-05-17 10:42:57,595 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-17 10:42:57,595 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-17 10:42:57,595 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-17 10:42:57,595 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-17 10:42:57,596 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-17 10:42:57,597 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:42:57,597 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-17 10:42:57,597 - train_models - INFO - Cross-validation details for 215:
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-17 10:42:57,599 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-17 10:42:57,599 - train_models - INFO - Building model for WorkType: 217
2025-05-17 10:42:57,607 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:43:13,832 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-17 10:43:13,833 - train_models - INFO - Top 10 most important features for 217:
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-17 10:43:13,834 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-17 10:43:13,835 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-17 10:43:13,835 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-17 10:43:13,835 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-17 10:43:13,835 - train_models - INFO - Cross-validation details for 217:
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-17 10:43:13,837 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-17 10:43:13,837 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-17 10:43:13,837 - train_models - INFO - Building model for WorkType: 221
2025-05-17 10:43:13,842 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:43:32,303 - train_models - INFO - Model for 221 - MAE: 3.1396, RMSE: 4.4881, R²: 0.8766, MAPE: 41.03%
2025-05-17 10:43:32,304 - train_models - INFO - Top 10 most important features for 221:
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_7day_trend: 0.4825
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_1day_trend: 0.1925
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1145
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_lag_1: 0.0728
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_lag_7: 0.0657
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0208
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0053
2025-05-17 10:43:32,306 - train_models - INFO -   DayOfWeek_feat_6: 0.0039
2025-05-17 10:43:32,306 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0026
2025-05-17 10:43:32,306 - train_models - INFO - Cross-validation details for 221:
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 1: MAE=7.2098, RMSE=10.0122, R²=0.6202, MAPE=51.42%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 2: MAE=2.1735, RMSE=2.7722, R²=0.9405, MAPE=35.44%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 3: MAE=2.0096, RMSE=2.8182, R²=0.9471, MAPE=28.31%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 4: MAE=2.4982, RMSE=3.7345, R²=0.9374, MAPE=44.42%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 5: MAE=1.8069, RMSE=3.1033, R²=0.9376, MAPE=45.56%
2025-05-17 10:43:32,308 - train_models - INFO - Saving 12 models to C:/forlogssystems/Models
2025-05-17 10:43:33,264 - train_models - INFO - Model files saved successfully
2025-05-17 10:43:33,264 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-17 10:43:33,268 - train_models - INFO - Model training completed successfully
2025-05-17 10:45:13,278 - train_models - INFO - Starting the model training process
2025-05-17 10:45:13,278 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:45:13,281 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:45:13,609 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-17 10:45:14,273 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:45:14,380 - train_models - INFO - Read chunk of 5416 rows
2025-05-17 10:45:14,432 - train_models - INFO - Data loaded successfully. Total rows: 15416
2025-05-17 10:45:14,434 - train_models - INFO - Converting Date column to datetime format
2025-05-17 10:45:14,444 - train_models - INFO - Engineering features...
2025-05-17 10:45:14,772 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:45:14,802 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-17 10:45:14,810 - train_models - INFO - Creating lag features...
2025-05-17 10:45:14,820 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-17 10:45:14,998 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-17 10:45:14,999 - utils.feature_engineering - INFO - Final shape: (11761, 72)
2025-05-17 10:45:15,013 - train_models - INFO - Found 10 unique work types
2025-05-17 10:45:15,014 - train_models - INFO - Building models for 10 work types
2025-05-17 10:45:15,014 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-17 10:45:15,014 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-17 10:45:15,014 - train_models - INFO - Building model for WorkType: 202
2025-05-17 10:45:15,018 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:45:30,239 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-17 10:45:30,240 - train_models - INFO - Top 10 most important features for 202:
2025-05-17 10:45:30,240 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-17 10:45:30,240 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-17 10:45:30,242 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-17 10:45:30,242 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-17 10:45:30,242 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-17 10:45:30,242 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-17 10:45:30,243 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-17 10:45:30,243 - train_models - INFO - Cross-validation details for 202:
2025-05-17 10:45:30,243 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-17 10:45:30,243 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-17 10:45:30,245 - train_models - INFO - Building model for WorkType: 203
2025-05-17 10:45:30,249 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:45:46,307 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-17 10:45:46,308 - train_models - INFO - Top 10 most important features for 203:
2025-05-17 10:45:46,308 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-17 10:45:46,308 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-17 10:45:46,310 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-17 10:45:46,310 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-17 10:45:46,310 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-17 10:45:46,311 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-17 10:45:46,311 - train_models - INFO - Cross-validation details for 203:
2025-05-17 10:45:46,311 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-17 10:45:46,311 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-17 10:45:46,312 - train_models - INFO - Building model for WorkType: 206
2025-05-17 10:45:46,319 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:08,029 - train_models - INFO - Model for 206 - MAE: 1.3115, RMSE: 2.1334, R²: 0.9311, MAPE: 10.37%
2025-05-17 10:46:08,029 - train_models - INFO - Top 10 most important features for 206:
2025-05-17 10:46:08,029 - train_models - INFO -   Relative_Quantity: 0.6873
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1237
2025-05-17 10:46:08,030 - train_models - INFO -   Hours_per_Quantity: 0.0417
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0415
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0313
2025-05-17 10:46:08,031 - train_models - INFO -   Quantity_per_Worker: 0.0277
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_1day_trend: 0.0102
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_lag_1: 0.0044
2025-05-17 10:46:08,032 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-17 10:46:08,032 - train_models - INFO - Cross-validation details for 206:
2025-05-17 10:46:08,032 - train_models - INFO -   Fold 1: MAE=1.8039, RMSE=2.4177, R²=0.9220, MAPE=9.19%
2025-05-17 10:46:08,032 - train_models - INFO -   Fold 2: MAE=1.3929, RMSE=1.9463, R²=0.9430, MAPE=8.36%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 3: MAE=1.1018, RMSE=2.3244, R²=0.8987, MAPE=6.02%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 4: MAE=0.9892, RMSE=1.8699, R²=0.9362, MAPE=14.06%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 5: MAE=1.2697, RMSE=2.1087, R²=0.9559, MAPE=14.25%
2025-05-17 10:46:08,033 - train_models - INFO - Building model for WorkType: 209
2025-05-17 10:46:08,039 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:25,170 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-17 10:46:25,170 - train_models - INFO - Top 10 most important features for 209:
2025-05-17 10:46:25,171 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-17 10:46:25,171 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-17 10:46:25,171 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-17 10:46:25,172 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-17 10:46:25,172 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-17 10:46:25,172 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-17 10:46:25,174 - train_models - INFO - Cross-validation details for 209:
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-17 10:46:25,175 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-17 10:46:25,175 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-17 10:46:25,175 - train_models - INFO - Building model for WorkType: 210
2025-05-17 10:46:25,180 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:43,003 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-17 10:46:43,003 - train_models - INFO - Top 10 most important features for 210:
2025-05-17 10:46:43,003 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-17 10:46:43,004 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-17 10:46:43,004 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-17 10:46:43,004 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-17 10:46:43,005 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-17 10:46:43,005 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-17 10:46:43,005 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-17 10:46:43,006 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-17 10:46:43,006 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:46:43,006 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-17 10:46:43,007 - train_models - INFO - Cross-validation details for 210:
2025-05-17 10:46:43,007 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-17 10:46:43,007 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-17 10:46:43,008 - train_models - INFO - Building model for WorkType: 211
2025-05-17 10:46:43,016 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:01,427 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-17 10:47:01,427 - train_models - INFO - Top 10 most important features for 211:
2025-05-17 10:47:01,427 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-17 10:47:01,429 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-17 10:47:01,429 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-17 10:47:01,429 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-17 10:47:01,429 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-17 10:47:01,430 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-17 10:47:01,430 - train_models - INFO - Cross-validation details for 211:
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-17 10:47:01,431 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-17 10:47:01,431 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-17 10:47:01,431 - train_models - INFO - Building model for WorkType: 213
2025-05-17 10:47:01,436 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:18,907 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-17 10:47:18,908 - train_models - INFO - Top 10 most important features for 213:
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-17 10:47:18,909 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-17 10:47:18,910 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-17 10:47:18,910 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-17 10:47:18,910 - train_models - INFO - Cross-validation details for 213:
2025-05-17 10:47:18,910 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-17 10:47:18,911 - train_models - INFO - Building model for WorkType: 214
2025-05-17 10:47:18,916 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:35,231 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-17 10:47:35,232 - train_models - INFO - Top 10 most important features for 214:
2025-05-17 10:47:35,232 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-17 10:47:35,232 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-17 10:47:35,233 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-17 10:47:35,233 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-17 10:47:35,233 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-17 10:47:35,235 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-17 10:47:35,235 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-17 10:47:35,235 - train_models - INFO - Cross-validation details for 214:
2025-05-17 10:47:35,235 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-17 10:47:35,237 - train_models - INFO - Building model for WorkType: 215
2025-05-17 10:47:35,242 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:53,947 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-17 10:47:53,947 - train_models - INFO - Top 10 most important features for 215:
2025-05-17 10:47:53,948 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-17 10:47:53,948 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-17 10:47:53,948 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-17 10:47:53,950 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-17 10:47:53,950 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-17 10:47:53,950 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:47:53,951 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-17 10:47:53,951 - train_models - INFO - Cross-validation details for 215:
2025-05-17 10:47:53,951 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-17 10:47:53,951 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-17 10:47:53,952 - train_models - INFO - Building model for WorkType: 217
2025-05-17 10:47:53,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:48:08,287 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-17 10:48:08,288 - train_models - INFO - Top 10 most important features for 217:
2025-05-17 10:48:08,288 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-17 10:48:08,288 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-17 10:48:08,290 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-17 10:48:08,291 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-17 10:48:08,291 - train_models - INFO - Cross-validation details for 217:
2025-05-17 10:48:08,291 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-17 10:48:08,291 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-17 10:48:08,293 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-17 10:48:08,962 - train_models - INFO - Model files saved successfully
2025-05-17 10:48:08,962 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-17 10:48:08,964 - train_models - INFO - Model training completed successfully
2025-05-19 09:18:53,967 - train_models - INFO - Starting the model training process
2025-05-19 09:18:53,970 - train_models - INFO - Training from SQL database (command line argument)
2025-05-19 09:18:53,973 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-19 09:18:54,087 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-19 09:18:54,657 - train_models - INFO - Read chunk of 10000 rows
2025-05-19 09:18:54,733 - train_models - INFO - Read chunk of 5415 rows
2025-05-19 09:18:54,751 - train_models - INFO - Data loaded successfully. Total rows: 15415
2025-05-19 09:18:54,753 - train_models - INFO - Converting Date column to datetime format
2025-05-19 09:18:54,767 - train_models - INFO - Engineering features...
2025-05-19 09:18:55,172 - utils.feature_engineering - INFO - Engineering features
2025-05-19 09:18:55,203 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-19 09:18:55,209 - train_models - INFO - Creating lag features...
2025-05-19 09:18:55,219 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-19 09:18:55,386 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-19 09:18:55,387 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-19 09:18:55,399 - train_models - INFO - Found 10 unique work types
2025-05-19 09:18:55,400 - train_models - INFO - Building models for 10 work types
2025-05-19 09:18:55,400 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-19 09:18:55,400 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-19 09:18:55,401 - train_models - INFO - Building model for WorkType: 202
2025-05-19 09:18:55,406 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:10,575 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-19 09:19:10,576 - train_models - INFO - Top 10 most important features for 202:
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-19 09:19:10,578 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-19 09:19:10,579 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-19 09:19:10,579 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-19 09:19:10,579 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-19 09:19:10,579 - train_models - INFO - Cross-validation details for 202:
2025-05-19 09:19:10,579 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-19 09:19:10,581 - train_models - INFO - Building model for WorkType: 203
2025-05-19 09:19:10,585 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:26,916 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-19 09:19:26,917 - train_models - INFO - Top 10 most important features for 203:
2025-05-19 09:19:26,917 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-19 09:19:26,917 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-19 09:19:26,920 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-19 09:19:26,920 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-19 09:19:26,920 - train_models - INFO - Cross-validation details for 203:
2025-05-19 09:19:26,920 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-19 09:19:26,922 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-19 09:19:26,922 - train_models - INFO - Building model for WorkType: 206
2025-05-19 09:19:26,926 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:48,486 - train_models - INFO - Model for 206 - MAE: 1.2976, RMSE: 2.1155, R²: 0.9328, MAPE: 10.12%
2025-05-19 09:19:48,486 - train_models - INFO - Top 10 most important features for 206:
2025-05-19 09:19:48,487 - train_models - INFO -   Relative_Quantity: 0.6753
2025-05-19 09:19:48,487 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1293
2025-05-19 09:19:48,487 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0416
2025-05-19 09:19:48,488 - train_models - INFO -   Hours_per_Quantity: 0.0360
2025-05-19 09:19:48,488 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0357
2025-05-19 09:19:48,488 - train_models - INFO -   Quantity_per_Worker: 0.0294
2025-05-19 09:19:48,488 - train_models - INFO -   NoOfMan_1day_trend: 0.0131
2025-05-19 09:19:48,489 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-19 09:19:48,489 - train_models - INFO -   NoOfMan_lag_1: 0.0057
2025-05-19 09:19:48,489 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-19 09:19:48,490 - train_models - INFO - Cross-validation details for 206:
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 1: MAE=1.7951, RMSE=2.3845, R²=0.9241, MAPE=9.13%
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 2: MAE=1.3520, RMSE=1.8653, R²=0.9477, MAPE=8.07%
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 3: MAE=1.0790, RMSE=2.2681, R²=0.9035, MAPE=5.87%
2025-05-19 09:19:48,491 - train_models - INFO -   Fold 4: MAE=0.9895, RMSE=1.8636, R²=0.9366, MAPE=14.03%
2025-05-19 09:19:48,491 - train_models - INFO -   Fold 5: MAE=1.2723, RMSE=2.1962, R²=0.9521, MAPE=13.51%
2025-05-19 09:19:48,491 - train_models - INFO - Building model for WorkType: 209
2025-05-19 09:19:48,496 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:05,530 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-19 09:20:05,530 - train_models - INFO - Top 10 most important features for 209:
2025-05-19 09:20:05,531 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-19 09:20:05,531 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-19 09:20:05,531 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-19 09:20:05,532 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-19 09:20:05,532 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-19 09:20:05,532 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-19 09:20:05,534 - train_models - INFO - Cross-validation details for 209:
2025-05-19 09:20:05,534 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-19 09:20:05,534 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-19 09:20:05,535 - train_models - INFO - Building model for WorkType: 210
2025-05-19 09:20:05,540 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:21,418 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-19 09:20:21,418 - train_models - INFO - Top 10 most important features for 210:
2025-05-19 09:20:21,419 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-19 09:20:21,419 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-19 09:20:21,419 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-19 09:20:21,420 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-19 09:20:21,420 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-19 09:20:21,420 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-19 09:20:21,421 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-19 09:20:21,422 - train_models - INFO - Cross-validation details for 210:
2025-05-19 09:20:21,422 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-19 09:20:21,422 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-19 09:20:21,423 - train_models - INFO - Building model for WorkType: 211
2025-05-19 09:20:21,428 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:39,185 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-19 09:20:39,186 - train_models - INFO - Top 10 most important features for 211:
2025-05-19 09:20:39,186 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-19 09:20:39,186 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-19 09:20:39,186 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-19 09:20:39,188 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-19 09:20:39,188 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-19 09:20:39,188 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-19 09:20:39,189 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-19 09:20:39,189 - train_models - INFO - Cross-validation details for 211:
2025-05-19 09:20:39,189 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-19 09:20:39,189 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-19 09:20:39,191 - train_models - INFO - Building model for WorkType: 213
2025-05-19 09:20:39,195 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:55,503 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-19 09:20:55,504 - train_models - INFO - Top 10 most important features for 213:
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-19 09:20:55,506 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-19 09:20:55,506 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-19 09:20:55,506 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-19 09:20:55,507 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-19 09:20:55,507 - train_models - INFO - Cross-validation details for 213:
2025-05-19 09:20:55,507 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-19 09:20:55,509 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-19 09:20:55,509 - train_models - INFO - Building model for WorkType: 214
2025-05-19 09:20:55,513 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:11,491 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-19 09:21:11,492 - train_models - INFO - Top 10 most important features for 214:
2025-05-19 09:21:11,492 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-19 09:21:11,492 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-19 09:21:11,492 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-19 09:21:11,495 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-19 09:21:11,495 - train_models - INFO - Cross-validation details for 214:
2025-05-19 09:21:11,495 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-19 09:21:11,495 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-19 09:21:11,496 - train_models - INFO - Building model for WorkType: 215
2025-05-19 09:21:11,501 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:30,982 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-19 09:21:30,982 - train_models - INFO - Top 10 most important features for 215:
2025-05-19 09:21:30,982 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-19 09:21:30,982 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-19 09:21:30,982 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-19 09:21:30,983 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-19 09:21:30,984 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-19 09:21:30,984 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-19 09:21:30,984 - train_models - INFO - Cross-validation details for 215:
2025-05-19 09:21:30,984 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-19 09:21:30,985 - train_models - INFO - Building model for WorkType: 217
2025-05-19 09:21:30,989 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:45,547 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-19 09:21:45,547 - train_models - INFO - Top 10 most important features for 217:
2025-05-19 09:21:45,547 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-19 09:21:45,549 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-19 09:21:45,550 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-19 09:21:45,550 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-19 09:21:45,550 - train_models - INFO - Cross-validation details for 217:
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-19 09:21:45,552 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-19 09:21:45,552 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-19 09:21:45,553 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-19 09:21:46,233 - train_models - INFO - Model files saved successfully
2025-05-19 09:21:46,233 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-19 09:21:46,237 - train_models - INFO - Model training completed successfully
2025-05-23 12:29:41,925 - train_models - INFO - Starting the model training process
2025-05-23 12:29:41,936 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 12:29:41,943 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 12:29:42,130 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 12:29:43,051 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 12:29:43,191 - train_models - INFO - Read chunk of 5446 rows
2025-05-23 12:29:43,214 - train_models - INFO - Data loaded successfully. Total rows: 15446
2025-05-23 12:29:43,216 - train_models - INFO - Converting Date column to datetime format
2025-05-23 12:29:43,241 - train_models - INFO - Engineering features...
2025-05-23 12:29:44,019 - utils.feature_engineering - INFO - Engineering features
2025-05-23 12:29:44,125 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 12:29:44,131 - train_models - INFO - Creating lag features...
2025-05-23 12:29:44,144 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 12:29:44,332 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 12:29:44,332 - utils.feature_engineering - INFO - Final shape: (11791, 72)
2025-05-23 12:29:44,342 - train_models - INFO - Found 10 unique work types
2025-05-23 12:29:44,342 - train_models - INFO - Building models for 10 work types
2025-05-23 12:29:44,342 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 12:29:44,343 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 12:29:44,343 - train_models - INFO - Building model for WorkType: 202
2025-05-23 12:29:44,349 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:02,088 - train_models - INFO - Model for 202 - MAE: 0.1982, RMSE: 0.2841, R²: 0.8704, MAPE: 9.37%
2025-05-23 12:30:02,088 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3689
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1832
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_1day_trend: 0.1209
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_lag_1: 0.0676
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_lag_7: 0.0612
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0605
2025-05-23 12:30:02,090 - train_models - INFO -   Relative_Quantity: 0.0505
2025-05-23 12:30:02,091 - train_models - INFO -   Hours_per_Quantity: 0.0201
2025-05-23 12:30:02,091 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0197
2025-05-23 12:30:02,091 - train_models - INFO -   Quantity_per_Worker: 0.0123
2025-05-23 12:30:02,092 - train_models - INFO - Cross-validation details for 202:
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 1: MAE=0.1877, RMSE=0.2598, R²=0.8540, MAPE=10.44%
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 2: MAE=0.2154, RMSE=0.3448, R²=0.8223, MAPE=10.97%
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 3: MAE=0.1877, RMSE=0.2542, R²=0.8849, MAPE=9.54%
2025-05-23 12:30:02,093 - train_models - INFO -   Fold 4: MAE=0.1842, RMSE=0.2584, R²=0.8932, MAPE=7.93%
2025-05-23 12:30:02,093 - train_models - INFO -   Fold 5: MAE=0.2162, RMSE=0.3031, R²=0.8975, MAPE=7.99%
2025-05-23 12:30:02,093 - train_models - INFO - Building model for WorkType: 203
2025-05-23 12:30:02,098 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:23,175 - train_models - INFO - Model for 203 - MAE: 0.2631, RMSE: 0.3986, R²: 0.8621, MAPE: 5.44%
2025-05-23 12:30:23,175 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 12:30:23,175 - train_models - INFO -   NoOfMan_7day_trend: 0.3411
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1339
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1309
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1009
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_1day_trend: 0.0922
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_lag_1: 0.0530
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0060
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 12:30:23,178 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 12:30:23,178 - train_models - INFO - Cross-validation details for 203:
2025-05-23 12:30:23,178 - train_models - INFO -   Fold 1: MAE=0.3957, RMSE=0.5379, R²=0.7656, MAPE=7.06%
2025-05-23 12:30:23,178 - train_models - INFO -   Fold 2: MAE=0.2774, RMSE=0.5411, R²=0.7861, MAPE=4.77%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 3: MAE=0.2723, RMSE=0.3878, R²=0.8961, MAPE=5.79%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 4: MAE=0.1941, RMSE=0.2934, R²=0.9293, MAPE=5.29%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 5: MAE=0.1762, RMSE=0.2328, R²=0.9333, MAPE=4.30%
2025-05-23 12:30:23,180 - train_models - INFO - Building model for WorkType: 206
2025-05-23 12:30:23,185 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:51,297 - train_models - INFO - Model for 206 - MAE: 1.3022, RMSE: 2.1162, R²: 0.9329, MAPE: 10.17%
2025-05-23 12:30:51,297 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 12:30:51,298 - train_models - INFO -   Relative_Quantity: 0.6663
2025-05-23 12:30:51,298 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1335
2025-05-23 12:30:51,298 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0441
2025-05-23 12:30:51,299 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0363
2025-05-23 12:30:51,299 - train_models - INFO -   Hours_per_Quantity: 0.0355
2025-05-23 12:30:51,299 - train_models - INFO -   Quantity_per_Worker: 0.0281
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_1day_trend: 0.0145
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_lag_1: 0.0060
2025-05-23 12:30:51,300 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 12:30:51,301 - train_models - INFO - Cross-validation details for 206:
2025-05-23 12:30:51,301 - train_models - INFO -   Fold 1: MAE=1.7909, RMSE=2.3718, R²=0.9246, MAPE=9.12%
2025-05-23 12:30:51,301 - train_models - INFO -   Fold 2: MAE=1.3475, RMSE=1.8615, R²=0.9483, MAPE=8.05%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 3: MAE=1.0780, RMSE=2.2686, R²=0.9030, MAPE=5.87%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 4: MAE=0.9898, RMSE=1.8517, R²=0.9374, MAPE=13.95%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 5: MAE=1.3048, RMSE=2.2275, R²=0.9512, MAPE=13.87%
2025-05-23 12:30:51,302 - train_models - INFO - Building model for WorkType: 209
2025-05-23 12:30:51,308 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:12,913 - train_models - INFO - Model for 209 - MAE: 0.5550, RMSE: 1.0543, R²: 0.9381, MAPE: 10.19%
2025-05-23 12:31:12,913 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 12:31:12,914 - train_models - INFO -   Relative_Quantity: 0.7430
2025-05-23 12:31:12,914 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1233
2025-05-23 12:31:12,914 - train_models - INFO -   Hours_per_Quantity: 0.0578
2025-05-23 12:31:12,914 - train_models - INFO -   Quantity_per_Worker: 0.0436
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 12:31:12,916 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 12:31:12,916 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0010
2025-05-23 12:31:12,916 - train_models - INFO - Cross-validation details for 209:
2025-05-23 12:31:12,916 - train_models - INFO -   Fold 1: MAE=0.9394, RMSE=1.9101, R²=0.8372, MAPE=15.03%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 2: MAE=0.4044, RMSE=0.6589, R²=0.9691, MAPE=4.65%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 3: MAE=0.5124, RMSE=1.1393, R²=0.9413, MAPE=6.06%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 4: MAE=0.4823, RMSE=0.7631, R²=0.9639, MAPE=19.75%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 5: MAE=0.4366, RMSE=0.8002, R²=0.9790, MAPE=5.47%
2025-05-23 12:31:12,917 - train_models - INFO - Building model for WorkType: 210
2025-05-23 12:31:12,922 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:33,500 - train_models - INFO - Model for 210 - MAE: 0.4227, RMSE: 0.8346, R²: 0.9404, MAPE: 7.74%
2025-05-23 12:31:33,501 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 12:31:33,501 - train_models - INFO -   Relative_Quantity: 0.8380
2025-05-23 12:31:33,501 - train_models - INFO -   Quantity_per_Worker: 0.0469
2025-05-23 12:31:33,502 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0448
2025-05-23 12:31:33,502 - train_models - INFO -   Hours_per_Quantity: 0.0434
2025-05-23 12:31:33,502 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0067
2025-05-23 12:31:33,503 - train_models - INFO -   SystemHours_per_Quantity: 0.0033
2025-05-23 12:31:33,503 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-23 12:31:33,503 - train_models - INFO -   NoOfMan_1day_trend: 0.0015
2025-05-23 12:31:33,503 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 12:31:33,504 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 12:31:33,504 - train_models - INFO - Cross-validation details for 210:
2025-05-23 12:31:33,504 - train_models - INFO -   Fold 1: MAE=0.5895, RMSE=1.2393, R²=0.8823, MAPE=9.23%
2025-05-23 12:31:33,504 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6391, R²=0.9606, MAPE=4.58%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 3: MAE=0.4156, RMSE=0.9213, R²=0.9206, MAPE=6.27%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 4: MAE=0.3493, RMSE=0.5873, R²=0.9695, MAPE=13.75%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 5: MAE=0.3702, RMSE=0.7863, R²=0.9692, MAPE=4.89%
2025-05-23 12:31:33,505 - train_models - INFO - Building model for WorkType: 211
2025-05-23 12:31:33,510 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:56,892 - train_models - INFO - Model for 211 - MAE: 0.7206, RMSE: 1.0515, R²: 0.8985, MAPE: 12.09%
2025-05-23 12:31:56,892 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 12:31:56,893 - train_models - INFO -   Relative_Quantity: 0.4505
2025-05-23 12:31:56,893 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1671
2025-05-23 12:31:56,893 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0961
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_1day_trend: 0.0950
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_7day_trend: 0.0725
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_lag_1: 0.0329
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_lag_7: 0.0180
2025-05-23 12:31:56,895 - train_models - INFO -   Quantity_per_Worker: 0.0146
2025-05-23 12:31:56,895 - train_models - INFO -   Hours_per_Quantity: 0.0093
2025-05-23 12:31:56,895 - train_models - INFO -   SystemHours_per_Quantity: 0.0050
2025-05-23 12:31:56,896 - train_models - INFO - Cross-validation details for 211:
2025-05-23 12:31:56,896 - train_models - INFO -   Fold 1: MAE=0.8823, RMSE=1.2823, R²=0.8451, MAPE=11.31%
2025-05-23 12:31:56,896 - train_models - INFO -   Fold 2: MAE=0.8418, RMSE=1.3105, R²=0.8740, MAPE=17.32%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 3: MAE=0.4964, RMSE=0.6778, R²=0.9441, MAPE=6.16%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 4: MAE=0.7916, RMSE=1.0344, R²=0.9156, MAPE=15.05%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 5: MAE=0.5909, RMSE=0.9524, R²=0.9140, MAPE=10.61%
2025-05-23 12:31:56,898 - train_models - INFO - Building model for WorkType: 213
2025-05-23 12:31:56,903 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:32:20,207 - train_models - INFO - Model for 213 - MAE: 0.3667, RMSE: 0.5306, R²: 0.8779, MAPE: 16.16%
2025-05-23 12:32:20,208 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3549
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_7day_trend: 0.2744
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_1day_trend: 0.1610
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_lag_1: 0.0465
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_lag_7: 0.0243
2025-05-23 12:32:20,210 - train_models - INFO -   Relative_Quantity: 0.0200
2025-05-23 12:32:20,210 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-23 12:32:20,210 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 12:32:20,210 - train_models - INFO - Cross-validation details for 213:
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 1: MAE=0.4232, RMSE=0.5263, R²=0.7912, MAPE=25.90%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.6524, R²=0.8610, MAPE=17.54%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 3: MAE=0.3714, RMSE=0.5341, R²=0.9084, MAPE=15.15%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 4: MAE=0.2958, RMSE=0.4931, R²=0.9080, MAPE=11.81%
2025-05-23 12:32:20,212 - train_models - INFO -   Fold 5: MAE=0.3167, RMSE=0.4472, R²=0.9211, MAPE=10.40%
2025-05-23 12:32:20,212 - train_models - INFO - Building model for WorkType: 214
2025-05-23 12:32:20,216 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:32:42,245 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7973, R²: 0.8785, MAPE: 11.87%
2025-05-23 12:32:42,246 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 12:32:42,246 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4966
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_7day_trend: 0.1473
2025-05-23 12:32:42,247 - train_models - INFO -   Relative_Quantity: 0.0988
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_1day_trend: 0.0545
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_lag_7: 0.0314
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0126
2025-05-23 12:32:42,249 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-23 12:32:42,249 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0099
2025-05-23 12:32:42,249 - train_models - INFO - Cross-validation details for 214:
2025-05-23 12:32:42,249 - train_models - INFO -   Fold 1: MAE=0.5033, RMSE=0.6543, R²=0.8646, MAPE=12.67%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 2: MAE=0.4473, RMSE=0.5739, R²=0.9153, MAPE=11.79%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 3: MAE=0.4149, RMSE=0.5814, R²=0.9150, MAPE=9.05%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 4: MAE=0.6079, RMSE=1.0773, R²=0.8393, MAPE=11.77%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 5: MAE=0.6960, RMSE=1.0996, R²=0.8584, MAPE=14.05%
2025-05-23 12:32:42,251 - train_models - INFO - Building model for WorkType: 215
2025-05-23 12:32:42,257 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:33:08,020 - train_models - INFO - Model for 215 - MAE: 0.3432, RMSE: 0.6241, R²: 0.9646, MAPE: 6.55%
2025-05-23 12:33:08,021 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 12:33:08,021 - train_models - INFO -   Relative_Quantity: 0.8923
2025-05-23 12:33:08,021 - train_models - INFO -   Quantity_per_Worker: 0.0384
2025-05-23 12:33:08,022 - train_models - INFO -   Hours_per_Quantity: 0.0358
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_7day_trend: 0.0080
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_1day_trend: 0.0050
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 12:33:08,023 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0023
2025-05-23 12:33:08,023 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 12:33:08,023 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 12:33:08,023 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 12:33:08,024 - train_models - INFO - Cross-validation details for 215:
2025-05-23 12:33:08,024 - train_models - INFO -   Fold 1: MAE=0.5066, RMSE=0.7027, R²=0.9608, MAPE=9.90%
2025-05-23 12:33:08,024 - train_models - INFO -   Fold 2: MAE=0.4893, RMSE=0.9036, R²=0.9408, MAPE=8.70%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 3: MAE=0.2384, RMSE=0.3577, R²=0.9796, MAPE=5.46%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 4: MAE=0.2216, RMSE=0.5019, R²=0.9777, MAPE=5.56%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 5: MAE=0.2600, RMSE=0.6548, R²=0.9639, MAPE=3.10%
2025-05-23 12:33:08,025 - train_models - INFO - Building model for WorkType: 217
2025-05-23 12:33:08,030 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:33:26,924 - train_models - INFO - Model for 217 - MAE: 0.4271, RMSE: 0.6031, R²: 0.9066, MAPE: 16.69%
2025-05-23 12:33:26,925 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4326
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_7day_trend: 0.1946
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1805
2025-05-23 12:33:26,926 - train_models - INFO -   NoOfMan_1day_trend: 0.0454
2025-05-23 12:33:26,926 - train_models - INFO -   NoOfMan_lag_7: 0.0393
2025-05-23 12:33:26,926 - train_models - INFO -   Relative_Quantity: 0.0240
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0215
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_lag_1: 0.0185
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0056
2025-05-23 12:33:26,928 - train_models - INFO -   Hours_per_Quantity: 0.0041
2025-05-23 12:33:26,928 - train_models - INFO - Cross-validation details for 217:
2025-05-23 12:33:26,928 - train_models - INFO -   Fold 1: MAE=0.4466, RMSE=0.5979, R²=0.8718, MAPE=21.71%
2025-05-23 12:33:26,928 - train_models - INFO -   Fold 2: MAE=0.4593, RMSE=0.7025, R²=0.9030, MAPE=16.03%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 3: MAE=0.3505, RMSE=0.4627, R²=0.9246, MAPE=14.26%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 4: MAE=0.4744, RMSE=0.6468, R²=0.9208, MAPE=17.33%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 5: MAE=0.4047, RMSE=0.6057, R²=0.9129, MAPE=14.13%
2025-05-23 12:33:26,930 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 12:33:28,195 - train_models - INFO - Model files saved successfully
2025-05-23 12:33:28,196 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 12:33:28,204 - train_models - INFO - Model training completed successfully
2025-05-23 13:14:48,953 - train_models - INFO - Starting the model training process
2025-05-23 13:14:48,953 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 13:14:48,957 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 13:14:49,140 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 13:14:49,401 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 13:14:49,424 - train_models - INFO - Read chunk of 5446 rows
2025-05-23 13:14:49,442 - train_models - INFO - Data loaded successfully. Total rows: 15446
2025-05-23 13:14:49,444 - train_models - INFO - Converting Date column to datetime format
2025-05-23 13:14:49,455 - train_models - INFO - Engineering features...
2025-05-23 13:14:49,989 - utils.feature_engineering - INFO - Engineering features
2025-05-23 13:14:50,023 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 13:14:50,027 - train_models - INFO - Creating lag features...
2025-05-23 13:14:50,040 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 13:14:50,221 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 13:14:50,221 - utils.feature_engineering - INFO - Final shape: (11791, 72)
2025-05-23 13:14:50,235 - train_models - INFO - Found 10 unique work types
2025-05-23 13:14:50,235 - train_models - INFO - Building models for 10 work types
2025-05-23 13:14:50,235 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 13:14:50,236 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 13:14:50,236 - train_models - INFO - Building model for WorkType: 202
2025-05-23 13:14:50,241 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:05,232 - train_models - INFO - Model for 202 - MAE: 0.1977, RMSE: 0.2839, R²: 0.8705, MAPE: 9.34%
2025-05-23 13:15:05,232 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3690
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_7day_trend: 0.1832
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_1day_trend: 0.1209
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_lag_1: 0.0677
2025-05-23 13:15:05,234 - train_models - INFO -   NoOfMan_lag_7: 0.0613
2025-05-23 13:15:05,234 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0604
2025-05-23 13:15:05,234 - train_models - INFO -   Relative_Quantity: 0.0506
2025-05-23 13:15:05,235 - train_models - INFO -   Hours_per_Quantity: 0.0206
2025-05-23 13:15:05,235 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0197
2025-05-23 13:15:05,235 - train_models - INFO -   Quantity_per_Worker: 0.0118
2025-05-23 13:15:05,235 - train_models - INFO - Cross-validation details for 202:
2025-05-23 13:15:05,235 - train_models - INFO -   Fold 1: MAE=0.1855, RMSE=0.2580, R²=0.8560, MAPE=10.35%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 2: MAE=0.2155, RMSE=0.3453, R²=0.8218, MAPE=10.96%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 3: MAE=0.1878, RMSE=0.2551, R²=0.8841, MAPE=9.54%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 4: MAE=0.1838, RMSE=0.2590, R²=0.8926, MAPE=7.91%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 5: MAE=0.2159, RMSE=0.3023, R²=0.8981, MAPE=7.96%
2025-05-23 13:15:05,236 - train_models - INFO - Building model for WorkType: 203
2025-05-23 13:15:05,241 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:21,323 - train_models - INFO - Model for 203 - MAE: 0.2630, RMSE: 0.3987, R²: 0.8621, MAPE: 5.44%
2025-05-23 13:15:21,323 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_7day_trend: 0.3409
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1338
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1317
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1011
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_lag_7: 0.1002
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_1day_trend: 0.0923
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_lag_1: 0.0528
2025-05-23 13:15:21,326 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0059
2025-05-23 13:15:21,326 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 13:15:21,326 - train_models - INFO -   Quantity_same_dow_lag: 0.0028
2025-05-23 13:15:21,327 - train_models - INFO - Cross-validation details for 203:
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 1: MAE=0.3946, RMSE=0.5365, R²=0.7668, MAPE=7.04%
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 2: MAE=0.2779, RMSE=0.5420, R²=0.7853, MAPE=4.77%
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 3: MAE=0.2729, RMSE=0.3885, R²=0.8957, MAPE=5.79%
2025-05-23 13:15:21,328 - train_models - INFO -   Fold 4: MAE=0.1929, RMSE=0.2924, R²=0.9298, MAPE=5.26%
2025-05-23 13:15:21,328 - train_models - INFO -   Fold 5: MAE=0.1770, RMSE=0.2339, R²=0.9327, MAPE=4.32%
2025-05-23 13:15:21,328 - train_models - INFO - Building model for WorkType: 206
2025-05-23 13:15:21,334 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:43,096 - train_models - INFO - Model for 206 - MAE: 1.2994, RMSE: 2.1096, R²: 0.9333, MAPE: 10.12%
2025-05-23 13:15:43,097 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 13:15:43,097 - train_models - INFO -   Relative_Quantity: 0.6664
2025-05-23 13:15:43,097 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1334
2025-05-23 13:15:43,097 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0439
2025-05-23 13:15:43,098 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0363
2025-05-23 13:15:43,098 - train_models - INFO -   Hours_per_Quantity: 0.0346
2025-05-23 13:15:43,098 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_1day_trend: 0.0145
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_7day_trend: 0.0076
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_lag_1: 0.0059
2025-05-23 13:15:43,099 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 13:15:43,100 - train_models - INFO - Cross-validation details for 206:
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 1: MAE=1.7889, RMSE=2.3775, R²=0.9243, MAPE=9.09%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 2: MAE=1.3473, RMSE=1.8652, R²=0.9481, MAPE=8.05%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 3: MAE=1.0777, RMSE=2.2633, R²=0.9034, MAPE=5.88%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 4: MAE=0.9802, RMSE=1.8305, R²=0.9388, MAPE=13.75%
2025-05-23 13:15:43,101 - train_models - INFO -   Fold 5: MAE=1.3032, RMSE=2.2114, R²=0.9519, MAPE=13.84%
2025-05-23 13:15:43,101 - train_models - INFO - Building model for WorkType: 209
2025-05-23 13:15:43,104 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:00,173 - train_models - INFO - Model for 209 - MAE: 0.5549, RMSE: 1.0554, R²: 0.9379, MAPE: 10.18%
2025-05-23 13:16:00,174 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 13:16:00,174 - train_models - INFO -   Relative_Quantity: 0.7431
2025-05-23 13:16:00,174 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1233
2025-05-23 13:16:00,175 - train_models - INFO -   Hours_per_Quantity: 0.0592
2025-05-23 13:16:00,175 - train_models - INFO -   Quantity_per_Worker: 0.0422
2025-05-23 13:16:00,175 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0084
2025-05-23 13:16:00,175 - train_models - INFO -   NoOfMan_7day_trend: 0.0056
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_1day_trend: 0.0016
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 13:16:00,177 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0009
2025-05-23 13:16:00,177 - train_models - INFO - Cross-validation details for 209:
2025-05-23 13:16:00,177 - train_models - INFO -   Fold 1: MAE=0.9383, RMSE=1.9115, R²=0.8369, MAPE=14.99%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 2: MAE=0.4063, RMSE=0.6587, R²=0.9691, MAPE=4.68%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 3: MAE=0.5110, RMSE=1.1485, R²=0.9404, MAPE=6.04%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 4: MAE=0.4859, RMSE=0.7645, R²=0.9638, MAPE=19.76%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 5: MAE=0.4331, RMSE=0.7938, R²=0.9794, MAPE=5.42%
2025-05-23 13:16:00,179 - train_models - INFO - Building model for WorkType: 210
2025-05-23 13:16:00,185 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:16,965 - train_models - INFO - Model for 210 - MAE: 0.4241, RMSE: 0.8331, R²: 0.9406, MAPE: 7.72%
2025-05-23 13:16:16,965 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 13:16:16,965 - train_models - INFO -   Relative_Quantity: 0.8384
2025-05-23 13:16:16,965 - train_models - INFO -   Quantity_per_Worker: 0.0469
2025-05-23 13:16:16,966 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0447
2025-05-23 13:16:16,966 - train_models - INFO -   Hours_per_Quantity: 0.0432
2025-05-23 13:16:16,966 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0066
2025-05-23 13:16:16,967 - train_models - INFO -   SystemHours_per_Quantity: 0.0035
2025-05-23 13:16:16,967 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-23 13:16:16,967 - train_models - INFO -   NoOfMan_1day_trend: 0.0016
2025-05-23 13:16:16,967 - train_models - INFO -   Quantity_1day_trend: 0.0012
2025-05-23 13:16:16,968 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 13:16:16,968 - train_models - INFO - Cross-validation details for 210:
2025-05-23 13:16:16,968 - train_models - INFO -   Fold 1: MAE=0.5938, RMSE=1.2443, R²=0.8813, MAPE=9.27%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 2: MAE=0.3854, RMSE=0.6378, R²=0.9607, MAPE=4.53%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 3: MAE=0.4180, RMSE=0.9146, R²=0.9217, MAPE=6.27%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 4: MAE=0.3538, RMSE=0.5873, R²=0.9695, MAPE=13.66%
2025-05-23 13:16:16,970 - train_models - INFO -   Fold 5: MAE=0.3693, RMSE=0.7816, R²=0.9696, MAPE=4.87%
2025-05-23 13:16:16,970 - train_models - INFO - Building model for WorkType: 211
2025-05-23 13:16:16,974 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:34,874 - train_models - INFO - Model for 211 - MAE: 0.7178, RMSE: 1.0464, R²: 0.8994, MAPE: 12.04%
2025-05-23 13:16:34,874 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 13:16:34,874 - train_models - INFO -   Relative_Quantity: 0.4506
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1672
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0960
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_1day_trend: 0.0950
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_7day_trend: 0.0725
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_lag_1: 0.0328
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_lag_7: 0.0181
2025-05-23 13:16:34,877 - train_models - INFO -   Quantity_per_Worker: 0.0145
2025-05-23 13:16:34,877 - train_models - INFO -   Hours_per_Quantity: 0.0095
2025-05-23 13:16:34,877 - train_models - INFO -   SystemHours_per_Quantity: 0.0048
2025-05-23 13:16:34,878 - train_models - INFO - Cross-validation details for 211:
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 1: MAE=0.8838, RMSE=1.2866, R²=0.8440, MAPE=11.43%
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 2: MAE=0.8405, RMSE=1.3029, R²=0.8755, MAPE=17.14%
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 3: MAE=0.4933, RMSE=0.6721, R²=0.9450, MAPE=6.11%
2025-05-23 13:16:34,879 - train_models - INFO -   Fold 4: MAE=0.7845, RMSE=1.0227, R²=0.9175, MAPE=14.93%
2025-05-23 13:16:34,879 - train_models - INFO -   Fold 5: MAE=0.5871, RMSE=0.9475, R²=0.9148, MAPE=10.61%
2025-05-23 13:16:34,879 - train_models - INFO - Building model for WorkType: 213
2025-05-23 13:16:34,883 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:51,388 - train_models - INFO - Model for 213 - MAE: 0.3675, RMSE: 0.5325, R²: 0.8769, MAPE: 16.21%
2025-05-23 13:16:51,389 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 13:16:51,389 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_7day_trend: 0.2750
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_1day_trend: 0.1607
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_lag_1: 0.0463
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0317
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_lag_7: 0.0242
2025-05-23 13:16:51,391 - train_models - INFO -   Relative_Quantity: 0.0200
2025-05-23 13:16:51,392 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0104
2025-05-23 13:16:51,392 - train_models - INFO -   NoOfMan_lag_3: 0.0038
2025-05-23 13:16:51,392 - train_models - INFO - Cross-validation details for 213:
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 1: MAE=0.4250, RMSE=0.5292, R²=0.7889, MAPE=26.05%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 2: MAE=0.4299, RMSE=0.6618, R²=0.8569, MAPE=17.64%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 3: MAE=0.3678, RMSE=0.5298, R²=0.9099, MAPE=15.02%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 4: MAE=0.2977, RMSE=0.4962, R²=0.9068, MAPE=11.90%
2025-05-23 13:16:51,394 - train_models - INFO -   Fold 5: MAE=0.3172, RMSE=0.4455, R²=0.9217, MAPE=10.44%
2025-05-23 13:16:51,394 - train_models - INFO - Building model for WorkType: 214
2025-05-23 13:16:51,399 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:07,505 - train_models - INFO - Model for 214 - MAE: 0.5344, RMSE: 0.7974, R²: 0.8784, MAPE: 11.89%
2025-05-23 13:17:07,505 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 13:17:07,506 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4964
2025-05-23 13:17:07,506 - train_models - INFO -   NoOfMan_7day_trend: 0.1472
2025-05-23 13:17:07,506 - train_models - INFO -   Relative_Quantity: 0.0990
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_1day_trend: 0.0543
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_lag_7: 0.0314
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0127
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0106
2025-05-23 13:17:07,509 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0099
2025-05-23 13:17:07,509 - train_models - INFO - Cross-validation details for 214:
2025-05-23 13:17:07,509 - train_models - INFO -   Fold 1: MAE=0.5054, RMSE=0.6559, R²=0.8640, MAPE=12.72%
2025-05-23 13:17:07,509 - train_models - INFO -   Fold 2: MAE=0.4475, RMSE=0.5747, R²=0.9151, MAPE=11.79%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 3: MAE=0.4140, RMSE=0.5817, R²=0.9149, MAPE=9.02%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 4: MAE=0.6097, RMSE=1.0811, R²=0.8381, MAPE=11.78%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 5: MAE=0.6953, RMSE=1.0937, R²=0.8599, MAPE=14.13%
2025-05-23 13:17:07,510 - train_models - INFO - Building model for WorkType: 215
2025-05-23 13:17:07,517 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:26,086 - train_models - INFO - Model for 215 - MAE: 0.3448, RMSE: 0.6265, R²: 0.9643, MAPE: 6.55%
2025-05-23 13:17:26,086 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 13:17:26,087 - train_models - INFO -   Relative_Quantity: 0.8929
2025-05-23 13:17:26,087 - train_models - INFO -   Hours_per_Quantity: 0.0379
2025-05-23 13:17:26,087 - train_models - INFO -   Quantity_per_Worker: 0.0363
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_7day_trend: 0.0083
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_1day_trend: 0.0047
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 13:17:26,089 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 13:17:26,089 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0020
2025-05-23 13:17:26,089 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:17:26,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 13:17:26,090 - train_models - INFO - Cross-validation details for 215:
2025-05-23 13:17:26,090 - train_models - INFO -   Fold 1: MAE=0.5154, RMSE=0.7192, R²=0.9589, MAPE=9.96%
2025-05-23 13:17:26,090 - train_models - INFO -   Fold 2: MAE=0.4888, RMSE=0.8972, R²=0.9417, MAPE=8.69%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 3: MAE=0.2384, RMSE=0.3591, R²=0.9794, MAPE=5.44%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 4: MAE=0.2224, RMSE=0.5013, R²=0.9777, MAPE=5.59%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 5: MAE=0.2589, RMSE=0.6557, R²=0.9638, MAPE=3.09%
2025-05-23 13:17:26,091 - train_models - INFO - Building model for WorkType: 217
2025-05-23 13:17:26,096 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:40,258 - train_models - INFO - Model for 217 - MAE: 0.4264, RMSE: 0.6024, R²: 0.9068, MAPE: 16.67%
2025-05-23 13:17:40,258 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4326
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_7day_trend: 0.1947
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1805
2025-05-23 13:17:40,260 - train_models - INFO -   NoOfMan_1day_trend: 0.0452
2025-05-23 13:17:40,260 - train_models - INFO -   NoOfMan_lag_7: 0.0394
2025-05-23 13:17:40,260 - train_models - INFO -   Relative_Quantity: 0.0238
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0214
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_lag_1: 0.0185
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0056
2025-05-23 13:17:40,261 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-23 13:17:40,262 - train_models - INFO - Cross-validation details for 217:
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 1: MAE=0.4444, RMSE=0.5968, R²=0.8722, MAPE=21.63%
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 2: MAE=0.4580, RMSE=0.7031, R²=0.9028, MAPE=15.97%
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 3: MAE=0.3531, RMSE=0.4637, R²=0.9242, MAPE=14.35%
2025-05-23 13:17:40,263 - train_models - INFO -   Fold 4: MAE=0.4731, RMSE=0.6472, R²=0.9207, MAPE=17.27%
2025-05-23 13:17:40,263 - train_models - INFO -   Fold 5: MAE=0.4034, RMSE=0.6013, R²=0.9142, MAPE=14.12%
2025-05-23 13:17:40,263 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 13:17:40,928 - train_models - INFO - Model files saved successfully
2025-05-23 13:17:40,928 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 13:17:40,931 - train_models - INFO - Model training completed successfully
2025-05-23 13:21:32,001 - train_models - INFO - Starting the model training process
2025-05-23 13:21:32,001 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 13:21:32,007 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 13:21:32,138 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 13:21:32,767 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 13:21:32,844 - train_models - INFO - Read chunk of 5415 rows
2025-05-23 13:21:32,863 - train_models - INFO - Data loaded successfully. Total rows: 15415
2025-05-23 13:21:32,866 - train_models - INFO - Converting Date column to datetime format
2025-05-23 13:21:32,880 - train_models - INFO - Engineering features...
2025-05-23 13:21:33,445 - utils.feature_engineering - INFO - Engineering features
2025-05-23 13:21:33,479 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 13:21:33,484 - train_models - INFO - Creating lag features...
2025-05-23 13:21:33,495 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 13:21:33,697 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 13:21:33,698 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-23 13:21:33,710 - train_models - INFO - Found 10 unique work types
2025-05-23 13:21:33,711 - train_models - INFO - Building models for 10 work types
2025-05-23 13:21:33,711 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 13:21:33,711 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 13:21:33,711 - train_models - INFO - Building model for WorkType: 202
2025-05-23 13:21:33,719 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:21:50,598 - train_models - INFO - Model for 202 - MAE: 0.1993, RMSE: 0.2857, R²: 0.8696, MAPE: 9.40%
2025-05-23 13:21:50,598 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3747
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_1day_trend: 0.1214
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_lag_1: 0.0665
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_lag_7: 0.0622
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0608
2025-05-23 13:21:50,600 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-23 13:21:50,601 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0200
2025-05-23 13:21:50,601 - train_models - INFO -   Hours_per_Quantity: 0.0169
2025-05-23 13:21:50,601 - train_models - INFO -   Quantity_per_Worker: 0.0108
2025-05-23 13:21:50,601 - train_models - INFO - Cross-validation details for 202:
2025-05-23 13:21:50,602 - train_models - INFO -   Fold 1: MAE=0.1869, RMSE=0.2576, R²=0.8571, MAPE=10.38%
2025-05-23 13:21:50,602 - train_models - INFO -   Fold 2: MAE=0.2177, RMSE=0.3482, R²=0.8197, MAPE=11.06%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 3: MAE=0.1883, RMSE=0.2557, R²=0.8838, MAPE=9.58%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 4: MAE=0.1829, RMSE=0.2580, R²=0.8935, MAPE=7.87%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 5: MAE=0.2205, RMSE=0.3090, R²=0.8940, MAPE=8.13%
2025-05-23 13:21:50,603 - train_models - INFO - Building model for WorkType: 203
2025-05-23 13:21:50,610 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:08,059 - train_models - INFO - Model for 203 - MAE: 0.2650, RMSE: 0.3940, R²: 0.8627, MAPE: 5.49%
2025-05-23 13:22:08,060 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1380
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1298
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_lag_7: 0.1010
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0977
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-23 13:22:08,062 - train_models - INFO -   NoOfMan_lag_1: 0.0533
2025-05-23 13:22:08,062 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0062
2025-05-23 13:22:08,062 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 13:22:08,063 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0029
2025-05-23 13:22:08,063 - train_models - INFO - Cross-validation details for 203:
2025-05-23 13:22:08,063 - train_models - INFO -   Fold 1: MAE=0.3900, RMSE=0.5075, R²=0.7476, MAPE=7.24%
2025-05-23 13:22:08,063 - train_models - INFO -   Fold 2: MAE=0.2891, RMSE=0.5457, R²=0.8106, MAPE=4.89%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 3: MAE=0.2755, RMSE=0.3950, R²=0.8922, MAPE=5.85%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2932, R²=0.9298, MAPE=5.29%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 5: MAE=0.1735, RMSE=0.2286, R²=0.9335, MAPE=4.19%
2025-05-23 13:22:08,064 - train_models - INFO - Building model for WorkType: 206
2025-05-23 13:22:08,073 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:33,219 - train_models - INFO - Model for 206 - MAE: 1.2967, RMSE: 2.1084, R²: 0.9333, MAPE: 10.10%
2025-05-23 13:22:33,219 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 13:22:33,220 - train_models - INFO -   Relative_Quantity: 0.6755
2025-05-23 13:22:33,220 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1293
2025-05-23 13:22:33,220 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0417
2025-05-23 13:22:33,221 - train_models - INFO -   Hours_per_Quantity: 0.0373
2025-05-23 13:22:33,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0357
2025-05-23 13:22:33,221 - train_models - INFO -   Quantity_per_Worker: 0.0278
2025-05-23 13:22:33,221 - train_models - INFO -   NoOfMan_1day_trend: 0.0132
2025-05-23 13:22:33,222 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-23 13:22:33,222 - train_models - INFO -   NoOfMan_lag_1: 0.0058
2025-05-23 13:22:33,222 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-23 13:22:33,222 - train_models - INFO - Cross-validation details for 206:
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 1: MAE=1.7984, RMSE=2.3954, R²=0.9234, MAPE=9.14%
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 2: MAE=1.3517, RMSE=1.8689, R²=0.9475, MAPE=8.06%
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 3: MAE=1.0769, RMSE=2.2594, R²=0.9043, MAPE=5.86%
2025-05-23 13:22:33,224 - train_models - INFO -   Fold 4: MAE=0.9777, RMSE=1.8351, R²=0.9385, MAPE=13.85%
2025-05-23 13:22:33,224 - train_models - INFO -   Fold 5: MAE=1.2791, RMSE=2.1831, R²=0.9527, MAPE=13.58%
2025-05-23 13:22:33,224 - train_models - INFO - Building model for WorkType: 209
2025-05-23 13:22:33,231 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:52,072 - train_models - INFO - Model for 209 - MAE: 0.5550, RMSE: 1.0555, R²: 0.9378, MAPE: 10.13%
2025-05-23 13:22:52,073 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 13:22:52,073 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-23 13:22:52,073 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1241
2025-05-23 13:22:52,073 - train_models - INFO -   Hours_per_Quantity: 0.0555
2025-05-23 13:22:52,074 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 13:22:52,074 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-23 13:22:52,074 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0021
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 13:22:52,076 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0009
2025-05-23 13:22:52,076 - train_models - INFO - Cross-validation details for 209:
2025-05-23 13:22:52,076 - train_models - INFO -   Fold 1: MAE=0.9492, RMSE=1.9176, R²=0.8366, MAPE=15.08%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 2: MAE=0.4109, RMSE=0.6708, R²=0.9681, MAPE=4.74%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 3: MAE=0.5127, RMSE=1.1513, R²=0.9404, MAPE=6.06%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 4: MAE=0.4839, RMSE=0.7640, R²=0.9636, MAPE=19.71%
2025-05-23 13:22:52,078 - train_models - INFO -   Fold 5: MAE=0.4182, RMSE=0.7740, R²=0.9803, MAPE=5.07%
2025-05-23 13:22:52,078 - train_models - INFO - Building model for WorkType: 210
2025-05-23 13:22:52,083 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:09,285 - train_models - INFO - Model for 210 - MAE: 0.4171, RMSE: 0.8260, R²: 0.9413, MAPE: 7.63%
2025-05-23 13:23:09,285 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 13:23:09,285 - train_models - INFO -   Relative_Quantity: 0.8393
2025-05-23 13:23:09,286 - train_models - INFO -   Quantity_per_Worker: 0.0453
2025-05-23 13:23:09,286 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-23 13:23:09,286 - train_models - INFO -   Hours_per_Quantity: 0.0437
2025-05-23 13:23:09,286 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0071
2025-05-23 13:23:09,287 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_7day_trend: 0.0022
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_1day_trend: 0.0019
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 13:23:09,288 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:23:09,288 - train_models - INFO - Cross-validation details for 210:
2025-05-23 13:23:09,288 - train_models - INFO -   Fold 1: MAE=0.5855, RMSE=1.2373, R²=0.8826, MAPE=9.19%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 2: MAE=0.3836, RMSE=0.6265, R²=0.9623, MAPE=4.51%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 3: MAE=0.4190, RMSE=0.9168, R²=0.9217, MAPE=6.29%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 4: MAE=0.3464, RMSE=0.5809, R²=0.9692, MAPE=13.54%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 5: MAE=0.3508, RMSE=0.7682, R²=0.9708, MAPE=4.58%
2025-05-23 13:23:09,290 - train_models - INFO - Building model for WorkType: 211
2025-05-23 13:23:09,294 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:28,425 - train_models - INFO - Model for 211 - MAE: 0.7176, RMSE: 1.0143, R²: 0.9031, MAPE: 11.35%
2025-05-23 13:23:28,425 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 13:23:28,426 - train_models - INFO -   Relative_Quantity: 0.4612
2025-05-23 13:23:28,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-23 13:23:28,426 - train_models - INFO -   NoOfMan_1day_trend: 0.0960
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_7day_trend: 0.0692
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_lag_1: 0.0335
2025-05-23 13:23:28,428 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-23 13:23:28,428 - train_models - INFO -   Quantity_per_Worker: 0.0118
2025-05-23 13:23:28,428 - train_models - INFO -   Hours_per_Quantity: 0.0086
2025-05-23 13:23:28,428 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-23 13:23:28,429 - train_models - INFO - Cross-validation details for 211:
2025-05-23 13:23:28,429 - train_models - INFO -   Fold 1: MAE=0.9249, RMSE=1.3235, R²=0.8351, MAPE=12.10%
2025-05-23 13:23:28,429 - train_models - INFO -   Fold 2: MAE=0.8533, RMSE=1.2989, R²=0.8758, MAPE=17.30%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 3: MAE=0.4937, RMSE=0.6742, R²=0.9420, MAPE=6.02%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 4: MAE=0.7644, RMSE=0.9941, R²=0.9240, MAPE=14.82%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 5: MAE=0.5516, RMSE=0.7807, R²=0.9383, MAPE=6.48%
2025-05-23 13:23:28,430 - train_models - INFO - Building model for WorkType: 213
2025-05-23 13:23:28,435 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:47,204 - train_models - INFO - Model for 213 - MAE: 0.3677, RMSE: 0.5374, R²: 0.8751, MAPE: 16.19%
2025-05-23 13:23:47,205 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 13:23:47,205 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3548
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_7day_trend: 0.2735
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_lag_1: 0.0465
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-23 13:23:47,207 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0315
2025-05-23 13:23:47,207 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 13:23:47,207 - train_models - INFO -   Relative_Quantity: 0.0213
2025-05-23 13:23:47,208 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0105
2025-05-23 13:23:47,208 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 13:23:47,208 - train_models - INFO - Cross-validation details for 213:
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 1: MAE=0.4347, RMSE=0.5431, R²=0.7894, MAPE=26.26%
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 2: MAE=0.4301, RMSE=0.6761, R²=0.8501, MAPE=17.57%
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 3: MAE=0.3695, RMSE=0.5361, R²=0.9078, MAPE=15.00%
2025-05-23 13:23:47,210 - train_models - INFO -   Fold 4: MAE=0.2914, RMSE=0.4899, R²=0.9031, MAPE=12.08%
2025-05-23 13:23:47,210 - train_models - INFO -   Fold 5: MAE=0.3126, RMSE=0.4417, R²=0.9248, MAPE=10.06%
2025-05-23 13:23:47,210 - train_models - INFO - Building model for WorkType: 214
2025-05-23 13:23:47,214 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:04,010 - train_models - INFO - Model for 214 - MAE: 0.5344, RMSE: 0.7970, R²: 0.8782, MAPE: 11.87%
2025-05-23 13:24:04,011 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 13:24:04,011 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-23 13:24:04,011 - train_models - INFO -   NoOfMan_7day_trend: 0.1460
2025-05-23 13:24:04,011 - train_models - INFO -   Relative_Quantity: 0.0987
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0625
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_1day_trend: 0.0540
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0119
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 13:24:04,013 - train_models - INFO - Cross-validation details for 214:
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 1: MAE=0.5190, RMSE=0.6742, R²=0.8606, MAPE=12.99%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 2: MAE=0.4409, RMSE=0.5715, R²=0.9130, MAPE=11.24%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 3: MAE=0.4107, RMSE=0.5799, R²=0.9136, MAPE=9.39%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 4: MAE=0.6140, RMSE=1.0686, R²=0.8436, MAPE=11.84%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 5: MAE=0.6876, RMSE=1.0905, R²=0.8601, MAPE=13.91%
2025-05-23 13:24:04,015 - train_models - INFO - Building model for WorkType: 215
2025-05-23 13:24:04,019 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:23,387 - train_models - INFO - Model for 215 - MAE: 0.3470, RMSE: 0.6295, R²: 0.9639, MAPE: 6.57%
2025-05-23 13:24:23,388 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 13:24:23,388 - train_models - INFO -   Relative_Quantity: 0.8927
2025-05-23 13:24:23,388 - train_models - INFO -   Quantity_per_Worker: 0.0375
2025-05-23 13:24:23,388 - train_models - INFO -   Hours_per_Quantity: 0.0364
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_7day_trend: 0.0080
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0040
2025-05-23 13:24:23,390 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0021
2025-05-23 13:24:23,390 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 13:24:23,390 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:24:23,391 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 13:24:23,391 - train_models - INFO - Cross-validation details for 215:
2025-05-23 13:24:23,391 - train_models - INFO -   Fold 1: MAE=0.5133, RMSE=0.7212, R²=0.9585, MAPE=9.80%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 2: MAE=0.4888, RMSE=0.9011, R²=0.9406, MAPE=8.54%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 3: MAE=0.2453, RMSE=0.3630, R²=0.9790, MAPE=5.70%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 4: MAE=0.2240, RMSE=0.5064, R²=0.9776, MAPE=5.66%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 5: MAE=0.2635, RMSE=0.6557, R²=0.9639, MAPE=3.17%
2025-05-23 13:24:23,392 - train_models - INFO - Building model for WorkType: 217
2025-05-23 13:24:23,396 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:38,135 - train_models - INFO - Model for 217 - MAE: 0.4289, RMSE: 0.6073, R²: 0.9037, MAPE: 16.80%
2025-05-23 13:24:38,135 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_7day_trend: 0.1907
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1826
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_lag_7: 0.0387
2025-05-23 13:24:38,137 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0218
2025-05-23 13:24:38,138 - train_models - INFO -   NoOfMan_lag_1: 0.0209
2025-05-23 13:24:38,138 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-23 13:24:38,138 - train_models - INFO -   Hours_per_Quantity: 0.0039
2025-05-23 13:24:38,138 - train_models - INFO - Cross-validation details for 217:
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 1: MAE=0.4579, RMSE=0.6158, R²=0.8581, MAPE=22.17%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 2: MAE=0.4597, RMSE=0.7088, R²=0.9015, MAPE=15.98%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 3: MAE=0.3524, RMSE=0.4637, R²=0.9240, MAPE=14.16%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 4: MAE=0.4689, RMSE=0.6377, R²=0.9234, MAPE=17.50%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 5: MAE=0.4057, RMSE=0.6107, R²=0.9114, MAPE=14.18%
2025-05-23 13:24:38,140 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 13:24:38,955 - train_models - INFO - Model files saved successfully
2025-05-23 13:24:38,955 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 13:24:38,960 - train_models - INFO - Model training completed successfully
2025-05-23 14:32:17,253 - train_models - INFO - Starting the model training process
2025-05-23 14:32:17,253 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:32:17,258 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:32:17,385 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:32:18,005 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:32:18,068 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:32:18,085 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:32:18,086 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:32:18,098 - train_models - INFO - Engineering features...
2025-05-23 14:32:18,597 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:32:18,627 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:32:18,632 - train_models - INFO - Creating lag features...
2025-05-23 14:32:18,642 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:32:18,820 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:32:18,820 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:32:18,831 - train_models - INFO - Found 10 unique work types
2025-05-23 14:32:18,832 - train_models - INFO - Building models for 10 work types
2025-05-23 14:32:18,832 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:32:18,832 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:32:18,833 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:32:18,836 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:32:34,769 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-23 14:32:34,769 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:32:34,769 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 14:32:34,771 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 14:32:34,772 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-23 14:32:34,772 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-23 14:32:34,772 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:32:34,772 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-23 14:32:34,774 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-23 14:32:34,774 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:32:34,777 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:32:51,937 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-23 14:32:51,938 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:32:51,938 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 14:32:51,938 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 14:32:51,941 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 14:32:51,941 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:32:51,941 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-23 14:32:51,942 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:32:51,947 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:14,741 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-23 14:33:14,742 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:33:14,742 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 14:33:14,742 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 14:33:14,742 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-23 14:33:14,743 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-23 14:33:14,743 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 14:33:14,743 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 14:33:14,743 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 14:33:14,744 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 14:33:14,744 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 14:33:14,744 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 14:33:14,744 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-23 14:33:14,746 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-23 14:33:14,746 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-23 14:33:14,746 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:33:14,750 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:32,430 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 14:33:32,430 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:33:32,430 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 14:33:32,431 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 14:33:32,431 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 14:33:32,431 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 14:33:32,433 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 14:33:32,433 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 14:33:32,433 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 14:33:32,433 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 14:33:32,435 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 14:33:32,435 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:33:32,445 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:49,842 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 14:33:49,842 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:33:49,842 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 14:33:49,843 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 14:33:49,843 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 14:33:49,843 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 14:33:49,844 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 14:33:49,844 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 14:33:49,844 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 14:33:49,845 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 14:33:49,845 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 14:33:49,845 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 14:33:49,845 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 14:33:49,847 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 14:33:49,847 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:33:49,854 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:08,708 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-23 14:34:08,709 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:34:08,709 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 14:34:08,709 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-23 14:34:08,711 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 14:34:08,711 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 14:34:08,711 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-23 14:34:08,711 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-23 14:34:08,712 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 14:34:08,712 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:34:08,712 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-23 14:34:08,712 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-23 14:34:08,714 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:34:08,719 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:26,245 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-23 14:34:26,245 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 14:34:26,248 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-23 14:34:26,248 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-23 14:34:26,248 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 14:34:26,249 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-23 14:34:26,250 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-23 14:34:26,250 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-23 14:34:26,250 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:34:26,256 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:42,957 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-23 14:34:42,957 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:34:42,957 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 14:34:42,958 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-23 14:34:42,960 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 14:34:42,960 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 14:34:42,960 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:34:42,960 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-23 14:34:42,961 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:34:42,965 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:35:02,904 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-23 14:35:02,904 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:35:02,904 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-23 14:35:02,905 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-23 14:35:02,905 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-23 14:35:02,905 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 14:35:02,905 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 14:35:02,906 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 14:35:02,906 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-23 14:35:02,906 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 14:35:02,907 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 14:35:02,907 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 14:35:02,907 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-23 14:35:02,909 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-23 14:35:02,909 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:35:02,915 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:35:17,687 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-23 14:35:17,688 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:35:17,688 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 14:35:17,688 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 14:35:17,689 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 14:35:17,691 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 14:35:17,691 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:35:17,691 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-23 14:35:17,691 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-23 14:35:17,693 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:35:18,366 - train_models - INFO - Model files saved successfully
2025-05-23 14:35:18,366 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:35:18,369 - train_models - INFO - Model training completed successfully
2025-05-23 14:43:26,700 - train_models - INFO - Starting the model training process
2025-05-23 14:43:26,700 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:43:26,703 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:43:26,822 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:43:27,460 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:43:27,536 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:43:27,554 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:43:27,557 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:43:27,580 - train_models - INFO - Engineering features...
2025-05-23 14:43:28,036 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:43:28,069 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:43:28,074 - train_models - INFO - Creating lag features...
2025-05-23 14:43:28,084 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:43:28,259 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:43:28,260 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:43:28,270 - train_models - INFO - Found 10 unique work types
2025-05-23 14:43:28,271 - train_models - INFO - Building models for 10 work types
2025-05-23 14:43:28,271 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:43:28,271 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:43:28,272 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:43:28,278 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:43:44,346 - train_models - INFO - Model for 202 - MAE: 0.1969, RMSE: 0.2838, R²: 0.8722, MAPE: 9.31%
2025-05-23 14:43:44,346 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:43:44,346 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_1day_trend: 0.1203
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_lag_7: 0.0695
2025-05-23 14:43:44,348 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 14:43:44,348 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 14:43:44,348 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 14:43:44,349 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0186
2025-05-23 14:43:44,349 - train_models - INFO -   Hours_per_Quantity: 0.0168
2025-05-23 14:43:44,349 - train_models - INFO -   Quantity_per_Worker: 0.0084
2025-05-23 14:43:44,350 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 1: MAE=0.1846, RMSE=0.2573, R²=0.8575, MAPE=10.27%
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 2: MAE=0.2148, RMSE=0.3455, R²=0.8238, MAPE=10.79%
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 3: MAE=0.1844, RMSE=0.2488, R²=0.8882, MAPE=9.41%
2025-05-23 14:43:44,351 - train_models - INFO -   Fold 4: MAE=0.1732, RMSE=0.2520, R²=0.8970, MAPE=7.24%
2025-05-23 14:43:44,351 - train_models - INFO -   Fold 5: MAE=0.2276, RMSE=0.3154, R²=0.8945, MAPE=8.84%
2025-05-23 14:43:44,351 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:43:44,358 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:01,274 - train_models - INFO - Model for 203 - MAE: 0.2661, RMSE: 0.4015, R²: 0.8608, MAPE: 5.50%
2025-05-23 14:44:01,274 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1330
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_lag_7: 0.1006
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_1day_trend: 0.0913
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-05-23 14:44:01,278 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 1: MAE=0.3983, RMSE=0.5321, R²=0.7557, MAPE=7.22%
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 2: MAE=0.2761, RMSE=0.5436, R²=0.7943, MAPE=4.72%
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 3: MAE=0.2725, RMSE=0.3877, R²=0.8972, MAPE=5.77%
2025-05-23 14:44:01,279 - train_models - INFO -   Fold 4: MAE=0.1955, RMSE=0.2962, R²=0.9258, MAPE=5.33%
2025-05-23 14:44:01,279 - train_models - INFO -   Fold 5: MAE=0.1880, RMSE=0.2477, R²=0.9312, MAPE=4.44%
2025-05-23 14:44:01,279 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:44:01,284 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:23,663 - train_models - INFO - Model for 206 - MAE: 1.2960, RMSE: 2.1104, R²: 0.9329, MAPE: 10.16%
2025-05-23 14:44:23,663 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:44:23,664 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 14:44:23,664 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1310
2025-05-23 14:44:23,664 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0405
2025-05-23 14:44:23,665 - train_models - INFO -   Hours_per_Quantity: 0.0366
2025-05-23 14:44:23,665 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 14:44:23,665 - train_models - INFO -   Quantity_per_Worker: 0.0300
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_1day_trend: 0.0121
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 14:44:23,667 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 14:44:23,667 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:44:23,667 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3615, R²=0.9255, MAPE=9.12%
2025-05-23 14:44:23,667 - train_models - INFO -   Fold 2: MAE=1.3791, RMSE=1.8956, R²=0.9456, MAPE=8.19%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 3: MAE=1.0668, RMSE=2.2623, R²=0.9045, MAPE=5.83%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 4: MAE=0.9879, RMSE=1.8814, R²=0.9349, MAPE=14.19%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 5: MAE=1.2643, RMSE=2.1510, R²=0.9539, MAPE=13.45%
2025-05-23 14:44:23,668 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:44:23,673 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:41,071 - train_models - INFO - Model for 209 - MAE: 0.5533, RMSE: 1.0455, R²: 0.9383, MAPE: 10.19%
2025-05-23 14:44:41,071 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:44:41,072 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 14:44:41,072 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 14:44:41,072 - train_models - INFO -   Hours_per_Quantity: 0.0539
2025-05-23 14:44:41,073 - train_models - INFO -   Quantity_per_Worker: 0.0467
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0075
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_7day_trend: 0.0058
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0021
2025-05-23 14:44:41,074 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 14:44:41,074 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 14:44:41,074 - train_models - INFO -   Quantity_same_dow_lag: 0.0009
2025-05-23 14:44:41,074 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 1: MAE=0.9734, RMSE=1.9430, R²=0.8316, MAPE=15.34%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 2: MAE=0.3886, RMSE=0.6162, R²=0.9729, MAPE=4.52%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 3: MAE=0.5222, RMSE=1.1530, R²=0.9403, MAPE=6.22%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 4: MAE=0.4632, RMSE=0.7323, R²=0.9668, MAPE=19.79%
2025-05-23 14:44:41,076 - train_models - INFO -   Fold 5: MAE=0.4193, RMSE=0.7831, R²=0.9797, MAPE=5.06%
2025-05-23 14:44:41,076 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:44:41,081 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:58,329 - train_models - INFO - Model for 210 - MAE: 0.4230, RMSE: 0.8372, R²: 0.9404, MAPE: 7.63%
2025-05-23 14:44:58,329 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:44:58,329 - train_models - INFO -   Relative_Quantity: 0.8401
2025-05-23 14:44:58,330 - train_models - INFO -   Quantity_per_Worker: 0.0460
2025-05-23 14:44:58,330 - train_models - INFO -   Hours_per_Quantity: 0.0440
2025-05-23 14:44:58,330 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0419
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 14:44:58,331 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_1day_trend: 0.0020
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_7day_trend: 0.0019
2025-05-23 14:44:58,332 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 14:44:58,332 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 14:44:58,332 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 1: MAE=0.5899, RMSE=1.2384, R²=0.8841, MAPE=9.04%
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 2: MAE=0.3918, RMSE=0.6339, R²=0.9605, MAPE=4.61%
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 3: MAE=0.4198, RMSE=0.9362, R²=0.9195, MAPE=6.40%
2025-05-23 14:44:58,334 - train_models - INFO -   Fold 4: MAE=0.3575, RMSE=0.5936, R²=0.9683, MAPE=13.50%
2025-05-23 14:44:58,334 - train_models - INFO -   Fold 5: MAE=0.3561, RMSE=0.7836, R²=0.9695, MAPE=4.61%
2025-05-23 14:44:58,334 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:44:58,339 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:17,200 - train_models - INFO - Model for 211 - MAE: 0.7154, RMSE: 1.0140, R²: 0.9028, MAPE: 11.28%
2025-05-23 14:45:17,200 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:45:17,200 - train_models - INFO -   Relative_Quantity: 0.4586
2025-05-23 14:45:17,200 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_1day_trend: 0.0959
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_7day_trend: 0.0707
2025-05-23 14:45:17,202 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 14:45:17,202 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 14:45:17,202 - train_models - INFO -   Quantity_per_Worker: 0.0121
2025-05-23 14:45:17,202 - train_models - INFO -   Hours_per_Quantity: 0.0081
2025-05-23 14:45:17,203 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 14:45:17,203 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:45:17,203 - train_models - INFO -   Fold 1: MAE=0.9326, RMSE=1.3190, R²=0.8354, MAPE=12.19%
2025-05-23 14:45:17,203 - train_models - INFO -   Fold 2: MAE=0.8391, RMSE=1.2942, R²=0.8765, MAPE=17.04%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 3: MAE=0.4928, RMSE=0.6710, R²=0.9451, MAPE=6.10%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 4: MAE=0.7963, RMSE=1.0367, R²=0.9145, MAPE=15.14%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 5: MAE=0.5163, RMSE=0.7492, R²=0.9423, MAPE=5.95%
2025-05-23 14:45:17,204 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:45:17,209 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:34,606 - train_models - INFO - Model for 213 - MAE: 0.3653, RMSE: 0.5316, R²: 0.8790, MAPE: 16.03%
2025-05-23 14:45:34,607 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:45:34,607 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3526
2025-05-23 14:45:34,607 - train_models - INFO -   NoOfMan_7day_trend: 0.2757
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0376
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-23 14:45:34,609 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 14:45:34,609 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0102
2025-05-23 14:45:34,609 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 14:45:34,609 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:45:34,609 - train_models - INFO -   Fold 1: MAE=0.4254, RMSE=0.5297, R²=0.8009, MAPE=25.75%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 2: MAE=0.4236, RMSE=0.6574, R²=0.8581, MAPE=17.39%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 3: MAE=0.3670, RMSE=0.5286, R²=0.9122, MAPE=14.95%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 4: MAE=0.2946, RMSE=0.4955, R²=0.9075, MAPE=11.85%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 5: MAE=0.3162, RMSE=0.4469, R²=0.9165, MAPE=10.21%
2025-05-23 14:45:34,610 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:45:34,614 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:51,995 - train_models - INFO - Model for 214 - MAE: 0.5305, RMSE: 0.7931, R²: 0.8796, MAPE: 11.77%
2025-05-23 14:45:51,996 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:45:51,996 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 14:45:51,996 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 14:45:51,997 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-23 14:45:51,997 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0616
2025-05-23 14:45:51,997 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_lag_7: 0.0322
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0121
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0105
2025-05-23 14:45:51,999 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 14:45:51,999 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:45:51,999 - train_models - INFO -   Fold 1: MAE=0.5114, RMSE=0.6670, R²=0.8616, MAPE=12.88%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 2: MAE=0.4457, RMSE=0.5749, R²=0.9146, MAPE=11.73%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 3: MAE=0.4147, RMSE=0.5815, R²=0.9156, MAPE=9.01%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 4: MAE=0.6179, RMSE=1.0840, R²=0.8396, MAPE=11.86%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 5: MAE=0.6627, RMSE=1.0583, R²=0.8665, MAPE=13.36%
2025-05-23 14:45:52,001 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:45:52,006 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:46:11,270 - train_models - INFO - Model for 215 - MAE: 0.3442, RMSE: 0.6280, R²: 0.9640, MAPE: 6.51%
2025-05-23 14:46:11,270 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:46:11,270 - train_models - INFO -   Relative_Quantity: 0.8933
2025-05-23 14:46:11,271 - train_models - INFO -   Quantity_per_Worker: 0.0387
2025-05-23 14:46:11,271 - train_models - INFO -   Hours_per_Quantity: 0.0354
2025-05-23 14:46:11,271 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 14:46:11,272 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 14:46:11,272 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 14:46:11,272 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 14:46:11,273 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0021
2025-05-23 14:46:11,273 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 14:46:11,273 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 14:46:11,274 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 1: MAE=0.5155, RMSE=0.7261, R²=0.9580, MAPE=9.88%
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 2: MAE=0.4871, RMSE=0.8993, R²=0.9412, MAPE=8.61%
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3584, R²=0.9795, MAPE=5.42%
2025-05-23 14:46:11,275 - train_models - INFO -   Fold 4: MAE=0.2232, RMSE=0.5097, R²=0.9768, MAPE=5.59%
2025-05-23 14:46:11,275 - train_models - INFO -   Fold 5: MAE=0.2571, RMSE=0.6463, R²=0.9645, MAPE=3.06%
2025-05-23 14:46:11,275 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:46:11,281 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:46:25,634 - train_models - INFO - Model for 217 - MAE: 0.4288, RMSE: 0.6067, R²: 0.9038, MAPE: 16.78%
2025-05-23 14:46:25,634 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:46:25,634 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2294
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_7day_trend: 0.1902
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 14:46:25,636 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 14:46:25,636 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 14:46:25,636 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 14:46:25,637 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 14:46:25,637 - train_models - INFO -   Hours_per_Quantity: 0.0055
2025-05-23 14:46:25,637 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-05-23 14:46:25,637 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 1: MAE=0.4525, RMSE=0.6100, R²=0.8598, MAPE=21.99%
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 2: MAE=0.4695, RMSE=0.7062, R²=0.9018, MAPE=16.38%
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 3: MAE=0.3425, RMSE=0.4583, R²=0.9254, MAPE=13.91%
2025-05-23 14:46:25,639 - train_models - INFO -   Fold 4: MAE=0.4752, RMSE=0.6516, R²=0.9212, MAPE=17.59%
2025-05-23 14:46:25,639 - train_models - INFO -   Fold 5: MAE=0.4044, RMSE=0.6073, R²=0.9107, MAPE=14.00%
2025-05-23 14:46:25,640 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:46:26,298 - train_models - INFO - Model files saved successfully
2025-05-23 14:46:26,298 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:46:26,301 - train_models - INFO - Model training completed successfully
2025-05-23 14:51:12,768 - train_models - INFO - Starting the model training process
2025-05-23 14:51:12,768 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:51:12,772 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:51:12,884 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:51:13,464 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:51:13,542 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:51:13,560 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:51:13,562 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:51:13,575 - train_models - INFO - Engineering features...
2025-05-23 14:51:14,038 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:51:14,074 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:51:14,084 - train_models - INFO - Creating lag features...
2025-05-23 14:51:14,095 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:51:14,322 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:51:14,322 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:51:14,340 - train_models - INFO - Found 10 unique work types
2025-05-23 14:51:14,340 - train_models - INFO - Building models for 10 work types
2025-05-23 14:51:14,340 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:51:14,341 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:51:14,341 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:51:14,348 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:51:14,354 - train_models - ERROR - Error building models: A given column is not a column of the dataframe
2025-05-23 14:51:14,512 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DayOfWeek_feat'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_indexing.py", line 364, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DayOfWeek_feat'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 199, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 654, in fit
    Xt = self._fit(X, y, routed_params, raw_params=params)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 588, in _fit
    X, fitted_transformer = fit_transform_one_cached(
                            ~~~~~~~~~~~~~~~~~~~~~~~~^
        cloned_transformer,
        ^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        params=step_params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 1551, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 993, in fit_transform
    self._validate_column_callables(X)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 552, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
                                         ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_indexing.py", line 372, in _get_column_indices
    raise ValueError("A given column is not a column of the dataframe") from e
ValueError: A given column is not a column of the dataframe

2025-05-23 14:51:14,514 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 14:51:14,547 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 14:51:14,656 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 416, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 14:51:14,659 - train_models - INFO - Model training completed successfully
2025-05-23 14:52:06,824 - train_models - INFO - Starting the model training process
2025-05-23 14:52:06,824 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:52:06,828 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:52:06,944 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:52:07,544 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:52:07,622 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:52:07,639 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:52:07,641 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:52:07,651 - train_models - INFO - Engineering features...
2025-05-23 14:52:08,035 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:52:08,066 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:52:08,074 - train_models - INFO - Creating lag features...
2025-05-23 14:52:08,084 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:52:08,285 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:52:08,286 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:52:08,297 - train_models - INFO - Found 10 unique work types
2025-05-23 14:52:08,298 - train_models - INFO - Building models for 10 work types
2025-05-23 14:52:08,298 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:52:08,298 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-23 14:52:08,299 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:52:08,307 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:21,138 - train_models - INFO - Model for 202 - MAE: 0.2538, RMSE: 0.3706, R²: 0.7767, MAPE: 11.85%
2025-05-23 14:52:21,138 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:52:21,138 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3991
2025-05-23 14:52:21,139 - train_models - INFO -   Relative_Quantity: 0.2655
2025-05-23 14:52:21,139 - train_models - INFO -   Hours_per_Quantity: 0.1518
2025-05-23 14:52:21,139 - train_models - INFO -   Quantity_per_Worker: 0.0998
2025-05-23 14:52:21,140 - train_models - INFO -   NoOfMan_lag_1: 0.0169
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_7day_trend: 0.0085
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_same_dow_lag: 0.0053
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_1day_trend: 0.0051
2025-05-23 14:52:21,141 - train_models - INFO -   SystemHours_per_Quantity: 0.0045
2025-05-23 14:52:21,141 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0044
2025-05-23 14:52:21,141 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 1: MAE=0.2468, RMSE=0.3434, R²=0.7462, MAPE=13.07%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 2: MAE=0.2997, RMSE=0.4709, R²=0.6726, MAPE=15.43%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 3: MAE=0.2647, RMSE=0.3721, R²=0.7499, MAPE=12.49%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 4: MAE=0.1910, RMSE=0.2792, R²=0.8736, MAPE=7.90%
2025-05-23 14:52:21,143 - train_models - INFO -   Fold 5: MAE=0.2668, RMSE=0.3872, R²=0.8410, MAPE=10.34%
2025-05-23 14:52:21,143 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:52:21,148 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:35,425 - train_models - INFO - Model for 203 - MAE: 0.5821, RMSE: 0.7744, R²: 0.5017, MAPE: 12.33%
2025-05-23 14:52:35,425 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:52:35,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3950
2025-05-23 14:52:35,426 - train_models - INFO -   Relative_Quantity: 0.1193
2025-05-23 14:52:35,426 - train_models - INFO -   NoOfMan_lag_1: 0.0825
2025-05-23 14:52:35,427 - train_models - INFO -   Quantity_per_Worker: 0.0630
2025-05-23 14:52:35,427 - train_models - INFO -   Hours_per_Quantity: 0.0623
2025-05-23 14:52:35,427 - train_models - INFO -   NoOfMan_lag_3: 0.0281
2025-05-23 14:52:35,428 - train_models - INFO -   Quantity_7day_trend: 0.0253
2025-05-23 14:52:35,428 - train_models - INFO -   Quantity_1day_trend: 0.0229
2025-05-23 14:52:35,428 - train_models - INFO -   NoOfMan_lag_7: 0.0214
2025-05-23 14:52:35,429 - train_models - INFO -   Quantity_same_dow_lag: 0.0206
2025-05-23 14:52:35,429 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:52:35,429 - train_models - INFO -   Fold 1: MAE=0.6472, RMSE=0.8935, R²=0.3110, MAPE=12.43%
2025-05-23 14:52:35,429 - train_models - INFO -   Fold 2: MAE=0.6427, RMSE=0.8343, R²=0.5155, MAPE=12.14%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 3: MAE=0.6197, RMSE=0.8095, R²=0.5518, MAPE=12.91%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 4: MAE=0.5247, RMSE=0.6892, R²=0.5981, MAPE=13.16%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 5: MAE=0.4762, RMSE=0.6458, R²=0.5319, MAPE=10.99%
2025-05-23 14:52:35,430 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:52:35,436 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:52,982 - train_models - INFO - Model for 206 - MAE: 1.1569, RMSE: 2.0885, R²: 0.9340, MAPE: 9.91%
2025-05-23 14:52:52,982 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:52:52,983 - train_models - INFO -   Relative_Quantity: 0.7617
2025-05-23 14:52:52,983 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1000
2025-05-23 14:52:52,983 - train_models - INFO -   Hours_per_Quantity: 0.0568
2025-05-23 14:52:52,984 - train_models - INFO -   Quantity_per_Worker: 0.0456
2025-05-23 14:52:52,984 - train_models - INFO -   Quantity_same_dow_lag: 0.0108
2025-05-23 14:52:52,984 - train_models - INFO -   DayOfWeek_feat_4: 0.0053
2025-05-23 14:52:52,984 - train_models - INFO -   NoOfMan_lag_1: 0.0031
2025-05-23 14:52:52,985 - train_models - INFO -   NoOfMan_lag_7: 0.0018
2025-05-23 14:52:52,985 - train_models - INFO -   NoOfMan_lag_3: 0.0014
2025-05-23 14:52:52,985 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0013
2025-05-23 14:52:52,986 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 1: MAE=1.8507, RMSE=2.6752, R²=0.9044, MAPE=10.01%
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 2: MAE=1.0664, RMSE=1.5392, R²=0.9641, MAPE=6.12%
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 3: MAE=0.8671, RMSE=2.1292, R²=0.9154, MAPE=4.84%
2025-05-23 14:52:52,987 - train_models - INFO -   Fold 4: MAE=0.8086, RMSE=1.8845, R²=0.9347, MAPE=14.25%
2025-05-23 14:52:52,987 - train_models - INFO -   Fold 5: MAE=1.1917, RMSE=2.2146, R²=0.9512, MAPE=14.31%
2025-05-23 14:52:52,987 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:52:52,992 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:06,456 - train_models - INFO - Model for 209 - MAE: 0.5236, RMSE: 1.0354, R²: 0.9374, MAPE: 10.31%
2025-05-23 14:53:06,456 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:53:06,457 - train_models - INFO -   Relative_Quantity: 0.7599
2025-05-23 14:53:06,457 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0915
2025-05-23 14:53:06,457 - train_models - INFO -   Hours_per_Quantity: 0.0672
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_per_Worker: 0.0642
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_rolling_mean_7: 0.0028
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_1day_trend: 0.0014
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_7day_trend: 0.0011
2025-05-23 14:53:06,459 - train_models - INFO -   NoOfMan_lag_3: 0.0011
2025-05-23 14:53:06,459 - train_models - INFO -   Quantity_same_dow_lag: 0.0010
2025-05-23 14:53:06,459 - train_models - INFO -   SystemHours_per_Quantity: 0.0010
2025-05-23 14:53:06,459 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 1: MAE=0.9920, RMSE=2.0008, R²=0.8215, MAPE=15.73%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 2: MAE=0.3992, RMSE=0.6202, R²=0.9726, MAPE=4.59%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 3: MAE=0.5060, RMSE=1.2144, R²=0.9338, MAPE=6.03%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 4: MAE=0.3656, RMSE=0.6137, R²=0.9767, MAPE=20.47%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 5: MAE=0.3550, RMSE=0.7279, R²=0.9825, MAPE=4.73%
2025-05-23 14:53:06,461 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:53:06,466 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:19,669 - train_models - INFO - Model for 210 - MAE: 0.4113, RMSE: 0.8576, R²: 0.9367, MAPE: 7.91%
2025-05-23 14:53:19,670 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:53:19,670 - train_models - INFO -   Relative_Quantity: 0.8527
2025-05-23 14:53:19,670 - train_models - INFO -   Hours_per_Quantity: 0.0542
2025-05-23 14:53:19,670 - train_models - INFO -   Quantity_per_Worker: 0.0542
2025-05-23 14:53:19,671 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0203
2025-05-23 14:53:19,671 - train_models - INFO -   SystemHours_per_Quantity: 0.0056
2025-05-23 14:53:19,671 - train_models - INFO -   Quantity_1day_trend: 0.0022
2025-05-23 14:53:19,672 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0013
2025-05-23 14:53:19,672 - train_models - INFO -   SystemKPI_lag_1: 0.0011
2025-05-23 14:53:19,672 - train_models - INFO -   Quantity_same_dow_lag: 0.0010
2025-05-23 14:53:19,672 - train_models - INFO -   Combined_KPI_lag_1: 0.0009
2025-05-23 14:53:19,673 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 1: MAE=0.5952, RMSE=1.3201, R²=0.8683, MAPE=8.84%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 2: MAE=0.3867, RMSE=0.6460, R²=0.9590, MAPE=4.48%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 3: MAE=0.4121, RMSE=0.9396, R²=0.9189, MAPE=6.11%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 4: MAE=0.3304, RMSE=0.5999, R²=0.9676, MAPE=15.58%
2025-05-23 14:53:19,674 - train_models - INFO -   Fold 5: MAE=0.3324, RMSE=0.7824, R²=0.9695, MAPE=4.54%
2025-05-23 14:53:19,674 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:53:19,679 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:34,716 - train_models - INFO - Model for 211 - MAE: 0.8164, RMSE: 1.1902, R²: 0.8583, MAPE: 12.68%
2025-05-23 14:53:34,716 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:53:34,716 - train_models - INFO -   Relative_Quantity: 0.5870
2025-05-23 14:53:34,717 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2219
2025-05-23 14:53:34,717 - train_models - INFO -   Quantity_per_Worker: 0.0565
2025-05-23 14:53:34,717 - train_models - INFO -   Hours_per_Quantity: 0.0483
2025-05-23 14:53:34,718 - train_models - INFO -   SystemHours_per_Quantity: 0.0255
2025-05-23 14:53:34,718 - train_models - INFO -   Quantity_1day_trend: 0.0078
2025-05-23 14:53:34,718 - train_models - INFO -   Quantity_same_dow_lag: 0.0071
2025-05-23 14:53:34,718 - train_models - INFO -   NoOfMan_lag_1: 0.0062
2025-05-23 14:53:34,719 - train_models - INFO -   Quantity_7day_trend: 0.0047
2025-05-23 14:53:34,719 - train_models - INFO -   NoOfMan_lag_2: 0.0040
2025-05-23 14:53:34,719 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 1: MAE=1.3222, RMSE=1.8035, R²=0.6923, MAPE=15.99%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 2: MAE=1.0345, RMSE=1.5429, R²=0.8245, MAPE=19.28%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 3: MAE=0.5333, RMSE=0.8052, R²=0.9210, MAPE=6.69%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 4: MAE=0.6527, RMSE=0.9433, R²=0.9292, MAPE=13.67%
2025-05-23 14:53:34,721 - train_models - INFO -   Fold 5: MAE=0.5395, RMSE=0.8563, R²=0.9246, MAPE=7.80%
2025-05-23 14:53:34,721 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:53:34,726 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:48,442 - train_models - INFO - Model for 213 - MAE: 0.6018, RMSE: 0.8479, R²: 0.6913, MAPE: 27.20%
2025-05-23 14:53:48,442 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:53:48,443 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4762
2025-05-23 14:53:48,443 - train_models - INFO -   Relative_Quantity: 0.1606
2025-05-23 14:53:48,443 - train_models - INFO -   Quantity_7day_trend: 0.0716
2025-05-23 14:53:48,444 - train_models - INFO -   Hours_per_Quantity: 0.0508
2025-05-23 14:53:48,444 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-23 14:53:48,444 - train_models - INFO -   Quantity_1day_trend: 0.0423
2025-05-23 14:53:48,445 - train_models - INFO -   NoOfMan_lag_1: 0.0121
2025-05-23 14:53:48,445 - train_models - INFO -   NoOfMan_lag_3: 0.0120
2025-05-23 14:53:48,445 - train_models - INFO -   SystemKPI_lag_1: 0.0110
2025-05-23 14:53:48,445 - train_models - INFO -   SystemHours_per_Quantity: 0.0109
2025-05-23 14:53:48,446 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 1: MAE=0.6523, RMSE=0.8489, R²=0.4886, MAPE=38.88%
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 2: MAE=0.7170, RMSE=1.0667, R²=0.6264, MAPE=34.02%
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 3: MAE=0.6500, RMSE=0.9589, R²=0.7110, MAPE=24.80%
2025-05-23 14:53:48,447 - train_models - INFO -   Fold 4: MAE=0.5068, RMSE=0.6980, R²=0.8164, MAPE=22.05%
2025-05-23 14:53:48,447 - train_models - INFO -   Fold 5: MAE=0.4829, RMSE=0.6669, R²=0.8139, MAPE=16.23%
2025-05-23 14:53:48,447 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:53:48,451 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:01,559 - train_models - INFO - Model for 214 - MAE: 0.6296, RMSE: 0.9212, R²: 0.8317, MAPE: 13.85%
2025-05-23 14:54:01,559 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:54:01,560 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5628
2025-05-23 14:54:01,560 - train_models - INFO -   Relative_Quantity: 0.2165
2025-05-23 14:54:01,560 - train_models - INFO -   Quantity_per_Worker: 0.0508
2025-05-23 14:54:01,560 - train_models - INFO -   Hours_per_Quantity: 0.0434
2025-05-23 14:54:01,560 - train_models - INFO -   SystemHours_per_Quantity: 0.0337
2025-05-23 14:54:01,561 - train_models - INFO -   Quantity_7day_trend: 0.0132
2025-05-23 14:54:01,561 - train_models - INFO -   Quantity_1day_trend: 0.0116
2025-05-23 14:54:01,561 - train_models - INFO -   DayOfWeek_feat_6: 0.0093
2025-05-23 14:54:01,562 - train_models - INFO -   Quantity_same_dow_lag: 0.0083
2025-05-23 14:54:01,562 - train_models - INFO -   NoOfMan_lag_1: 0.0060
2025-05-23 14:54:01,562 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:54:01,562 - train_models - INFO -   Fold 1: MAE=0.6551, RMSE=0.8530, R²=0.7736, MAPE=15.69%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 2: MAE=0.5878, RMSE=0.7720, R²=0.8460, MAPE=13.77%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 3: MAE=0.5510, RMSE=0.7778, R²=0.8489, MAPE=11.61%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 4: MAE=0.6654, RMSE=1.0945, R²=0.8365, MAPE=13.33%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 5: MAE=0.6889, RMSE=1.1085, R²=0.8536, MAPE=14.87%
2025-05-23 14:54:01,563 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:54:01,567 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:16,481 - train_models - INFO - Model for 215 - MAE: 0.3198, RMSE: 0.6181, R²: 0.9654, MAPE: 6.19%
2025-05-23 14:54:16,481 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:54:16,482 - train_models - INFO -   Relative_Quantity: 0.9023
2025-05-23 14:54:16,482 - train_models - INFO -   Hours_per_Quantity: 0.0410
2025-05-23 14:54:16,482 - train_models - INFO -   Quantity_per_Worker: 0.0374
2025-05-23 14:54:16,482 - train_models - INFO -   Quantity_1day_trend: 0.0040
2025-05-23 14:54:16,483 - train_models - INFO -   SystemHours_per_Quantity: 0.0034
2025-05-23 14:54:16,483 - train_models - INFO -   Quantity_7day_trend: 0.0021
2025-05-23 14:54:16,483 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0013
2025-05-23 14:54:16,483 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-23 14:54:16,484 - train_models - INFO -   NoOfMan_lag_2: 0.0010
2025-05-23 14:54:16,484 - train_models - INFO -   SystemKPI_lag_1: 0.0007
2025-05-23 14:54:16,484 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 1: MAE=0.5006, RMSE=0.7378, R²=0.9566, MAPE=9.50%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 2: MAE=0.4075, RMSE=0.8216, R²=0.9509, MAPE=7.56%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 3: MAE=0.2295, RMSE=0.3581, R²=0.9795, MAPE=5.41%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 4: MAE=0.2287, RMSE=0.5753, R²=0.9704, MAPE=5.65%
2025-05-23 14:54:16,486 - train_models - INFO -   Fold 5: MAE=0.2328, RMSE=0.5977, R²=0.9696, MAPE=2.84%
2025-05-23 14:54:16,486 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:54:16,491 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:28,104 - train_models - INFO - Model for 217 - MAE: 0.6579, RMSE: 0.9192, R²: 0.7678, MAPE: 26.66%
2025-05-23 14:54:28,105 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:54:28,105 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6170
2025-05-23 14:54:28,105 - train_models - INFO -   Relative_Quantity: 0.1636
2025-05-23 14:54:28,106 - train_models - INFO -   Hours_per_Quantity: 0.0580
2025-05-23 14:54:28,106 - train_models - INFO -   Quantity_per_Worker: 0.0542
2025-05-23 14:54:28,106 - train_models - INFO -   NoOfMan_lag_1: 0.0151
2025-05-23 14:54:28,107 - train_models - INFO -   Quantity_7day_trend: 0.0149
2025-05-23 14:54:28,107 - train_models - INFO -   SystemHours_per_Quantity: 0.0130
2025-05-23 14:54:28,107 - train_models - INFO -   Quantity_1day_trend: 0.0088
2025-05-23 14:54:28,108 - train_models - INFO -   NoOfMan_lag_7: 0.0063
2025-05-23 14:54:28,108 - train_models - INFO -   NoOfMan_lag_3: 0.0058
2025-05-23 14:54:28,108 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:54:28,108 - train_models - INFO -   Fold 1: MAE=0.7837, RMSE=1.0374, R²=0.5944, MAPE=35.87%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 2: MAE=0.7079, RMSE=1.0667, R²=0.7760, MAPE=25.56%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 3: MAE=0.5931, RMSE=0.7986, R²=0.7736, MAPE=24.31%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 4: MAE=0.6035, RMSE=0.8648, R²=0.8611, MAPE=25.59%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 5: MAE=0.6012, RMSE=0.8282, R²=0.8339, MAPE=21.95%
2025-05-23 14:54:28,110 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:54:28,717 - train_models - INFO - Model files saved successfully
2025-05-23 14:54:28,717 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:54:28,720 - train_models - INFO - Model training completed successfully
2025-05-23 15:03:43,552 - train_models - INFO - Starting the model training process
2025-05-23 15:03:43,552 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:03:43,557 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:03:43,677 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:03:44,287 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:03:44,373 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:03:44,394 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:03:44,398 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:03:44,418 - train_models - INFO - Engineering features...
2025-05-23 15:03:44,885 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:03:44,920 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:03:44,928 - train_models - INFO - Creating lag features...
2025-05-23 15:03:44,939 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:03:45,141 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:03:45,141 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:03:45,154 - train_models - INFO - Found 10 unique work types
2025-05-23 15:03:45,155 - train_models - INFO - Building models for 10 work types
2025-05-23 15:03:45,155 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:03:45,155 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:03:45,156 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:03:45,161 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:02,517 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2833, R²: 0.8728, MAPE: 9.29%
2025-05-23 15:04:02,517 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_lag_7: 0.0694
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:04:02,519 - train_models - INFO -   Relative_Quantity: 0.0382
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:04:02,520 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-23 15:04:02,520 - train_models - INFO -   Quantity_per_Worker: 0.0086
2025-05-23 15:04:02,520 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:04:02,520 - train_models - INFO -   Fold 1: MAE=0.1833, RMSE=0.2552, R²=0.8598, MAPE=10.17%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 2: MAE=0.2149, RMSE=0.3452, R²=0.8241, MAPE=10.80%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2482, R²=0.8887, MAPE=9.37%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 4: MAE=0.1730, RMSE=0.2502, R²=0.8984, MAPE=7.25%
2025-05-23 15:04:02,522 - train_models - INFO -   Fold 5: MAE=0.2287, RMSE=0.3177, R²=0.8930, MAPE=8.84%
2025-05-23 15:04:02,522 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:04:02,528 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:20,514 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4017, R²: 0.8607, MAPE: 5.51%
2025-05-23 15:04:20,514 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_lag_7: 0.1005
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0983
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_1day_trend: 0.0911
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_lag_2: 0.0030
2025-05-23 15:04:20,517 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:04:20,517 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:04:20,517 - train_models - INFO -   Fold 1: MAE=0.3987, RMSE=0.5317, R²=0.7560, MAPE=7.22%
2025-05-23 15:04:20,517 - train_models - INFO -   Fold 2: MAE=0.2769, RMSE=0.5439, R²=0.7941, MAPE=4.74%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 3: MAE=0.2728, RMSE=0.3879, R²=0.8971, MAPE=5.78%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 4: MAE=0.1956, RMSE=0.2961, R²=0.9258, MAPE=5.33%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 5: MAE=0.1892, RMSE=0.2491, R²=0.9303, MAPE=4.47%
2025-05-23 15:04:20,518 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:04:20,522 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:44,955 - train_models - INFO - Model for 206 - MAE: 1.2985, RMSE: 2.1094, R²: 0.9329, MAPE: 10.13%
2025-05-23 15:04:44,955 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:04:44,956 - train_models - INFO -   Relative_Quantity: 0.6750
2025-05-23 15:04:44,956 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:04:44,956 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0408
2025-05-23 15:04:44,956 - train_models - INFO -   Hours_per_Quantity: 0.0370
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:04:44,957 - train_models - INFO -   Quantity_per_Worker: 0.0291
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_lag_1: 0.0053
2025-05-23 15:04:44,958 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:04:44,958 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:04:44,958 - train_models - INFO -   Fold 1: MAE=1.7806, RMSE=2.3592, R²=0.9257, MAPE=9.13%
2025-05-23 15:04:44,958 - train_models - INFO -   Fold 2: MAE=1.3723, RMSE=1.8870, R²=0.9461, MAPE=8.15%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 3: MAE=1.0791, RMSE=2.2740, R²=0.9035, MAPE=5.87%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 4: MAE=0.9947, RMSE=1.8693, R²=0.9358, MAPE=14.09%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 5: MAE=1.2660, RMSE=2.1573, R²=0.9537, MAPE=13.42%
2025-05-23 15:04:44,959 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:04:44,963 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:03,500 - train_models - INFO - Model for 209 - MAE: 0.5529, RMSE: 1.0429, R²: 0.9384, MAPE: 10.23%
2025-05-23 15:05:03,500 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:05:03,500 - train_models - INFO -   Relative_Quantity: 0.7433
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1247
2025-05-23 15:05:03,501 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:05:03,501 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0075
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0019
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_lag_7: 0.0012
2025-05-23 15:05:03,502 - train_models - INFO -   Quantity_rolling_mean_7: 0.0009
2025-05-23 15:05:03,502 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 1: MAE=0.9712, RMSE=1.9404, R²=0.8321, MAPE=15.36%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 2: MAE=0.3919, RMSE=0.6217, R²=0.9724, MAPE=4.57%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 3: MAE=0.5155, RMSE=1.1498, R²=0.9406, MAPE=6.13%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.7413, R²=0.9660, MAPE=20.01%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 5: MAE=0.4112, RMSE=0.7614, R²=0.9808, MAPE=5.08%
2025-05-23 15:05:03,504 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:05:03,507 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:21,439 - train_models - INFO - Model for 210 - MAE: 0.4239, RMSE: 0.8392, R²: 0.9402, MAPE: 7.67%
2025-05-23 15:05:21,440 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:05:21,440 - train_models - INFO -   Relative_Quantity: 0.8401
2025-05-23 15:05:21,440 - train_models - INFO -   Quantity_per_Worker: 0.0458
2025-05-23 15:05:21,440 - train_models - INFO -   Hours_per_Quantity: 0.0444
2025-05-23 15:05:21,440 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:05:21,441 - train_models - INFO -   SystemHours_per_Quantity: 0.0037
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_7day_trend: 0.0020
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_1day_trend: 0.0019
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:05:21,442 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:05:21,442 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 1: MAE=0.5872, RMSE=1.2270, R²=0.8863, MAPE=9.02%
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 2: MAE=0.3931, RMSE=0.6374, R²=0.9601, MAPE=4.63%
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 3: MAE=0.4218, RMSE=0.9508, R²=0.9170, MAPE=6.45%
2025-05-23 15:05:21,443 - train_models - INFO -   Fold 4: MAE=0.3586, RMSE=0.5929, R²=0.9684, MAPE=13.62%
2025-05-23 15:05:21,443 - train_models - INFO -   Fold 5: MAE=0.3585, RMSE=0.7881, R²=0.9691, MAPE=4.64%
2025-05-23 15:05:21,443 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:05:21,449 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:42,794 - train_models - INFO - Model for 211 - MAE: 0.7165, RMSE: 1.0151, R²: 0.9028, MAPE: 11.26%
2025-05-23 15:05:42,795 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:05:42,795 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 15:05:42,795 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_7day_trend: 0.0706
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_lag_1: 0.0335
2025-05-23 15:05:42,797 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-05-23 15:05:42,797 - train_models - INFO -   Quantity_per_Worker: 0.0119
2025-05-23 15:05:42,797 - train_models - INFO -   Hours_per_Quantity: 0.0082
2025-05-23 15:05:42,797 - train_models - INFO -   SystemHours_per_Quantity: 0.0057
2025-05-23 15:05:42,797 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 1: MAE=0.9276, RMSE=1.3133, R²=0.8368, MAPE=11.94%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 2: MAE=0.8357, RMSE=1.2856, R²=0.8782, MAPE=17.02%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 3: MAE=0.4952, RMSE=0.6762, R²=0.9443, MAPE=6.16%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 4: MAE=0.8019, RMSE=1.0425, R²=0.9135, MAPE=15.23%
2025-05-23 15:05:42,799 - train_models - INFO -   Fold 5: MAE=0.5223, RMSE=0.7578, R²=0.9410, MAPE=5.95%
2025-05-23 15:05:42,799 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:05:42,804 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:01,203 - train_models - INFO - Model for 213 - MAE: 0.3657, RMSE: 0.5324, R²: 0.8788, MAPE: 16.02%
2025-05-23 15:06:01,204 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3527
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_7day_trend: 0.2753
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0376
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_lag_7: 0.0231
2025-05-23 15:06:01,205 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0105
2025-05-23 15:06:01,206 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 15:06:01,206 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:06:01,206 - train_models - INFO -   Fold 1: MAE=0.4254, RMSE=0.5286, R²=0.8017, MAPE=25.69%
2025-05-23 15:06:01,206 - train_models - INFO -   Fold 2: MAE=0.4243, RMSE=0.6590, R²=0.8574, MAPE=17.28%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 3: MAE=0.3687, RMSE=0.5323, R²=0.9110, MAPE=15.01%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 4: MAE=0.2935, RMSE=0.4950, R²=0.9077, MAPE=11.80%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 5: MAE=0.3163, RMSE=0.4471, R²=0.9164, MAPE=10.30%
2025-05-23 15:06:01,208 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:06:01,212 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:20,035 - train_models - INFO - Model for 214 - MAE: 0.5304, RMSE: 0.7931, R²: 0.8797, MAPE: 11.78%
2025-05-23 15:06:20,035 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:06:20,035 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 15:06:20,036 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0616
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_1day_trend: 0.0558
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0125
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-23 15:06:20,038 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6630, R²=0.8632, MAPE=12.83%
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 2: MAE=0.4463, RMSE=0.5754, R²=0.9144, MAPE=11.76%
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 3: MAE=0.4159, RMSE=0.5826, R²=0.9152, MAPE=9.06%
2025-05-23 15:06:20,039 - train_models - INFO -   Fold 4: MAE=0.6164, RMSE=1.0800, R²=0.8408, MAPE=11.87%
2025-05-23 15:06:20,039 - train_models - INFO -   Fold 5: MAE=0.6641, RMSE=1.0645, R²=0.8650, MAPE=13.37%
2025-05-23 15:06:20,039 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:06:20,043 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:41,104 - train_models - INFO - Model for 215 - MAE: 0.3427, RMSE: 0.6236, R²: 0.9644, MAPE: 6.50%
2025-05-23 15:06:41,105 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:06:41,105 - train_models - INFO -   Relative_Quantity: 0.8928
2025-05-23 15:06:41,105 - train_models - INFO -   Quantity_per_Worker: 0.0379
2025-05-23 15:06:41,106 - train_models - INFO -   Hours_per_Quantity: 0.0361
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_7day_trend: 0.0076
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_1day_trend: 0.0053
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0040
2025-05-23 15:06:41,107 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0024
2025-05-23 15:06:41,107 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:06:41,107 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 15:06:41,108 - train_models - INFO -   NoOfMan_lag_2: 0.0009
2025-05-23 15:06:41,108 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:06:41,108 - train_models - INFO -   Fold 1: MAE=0.5083, RMSE=0.7128, R²=0.9595, MAPE=9.80%
2025-05-23 15:06:41,108 - train_models - INFO -   Fold 2: MAE=0.4902, RMSE=0.9051, R²=0.9404, MAPE=8.68%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 3: MAE=0.2369, RMSE=0.3560, R²=0.9798, MAPE=5.40%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 4: MAE=0.2205, RMSE=0.4999, R²=0.9777, MAPE=5.55%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 5: MAE=0.2574, RMSE=0.6442, R²=0.9647, MAPE=3.07%
2025-05-23 15:06:41,109 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:06:41,114 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:56,972 - train_models - INFO - Model for 217 - MAE: 0.4295, RMSE: 0.6076, R²: 0.9033, MAPE: 16.79%
2025-05-23 15:06:56,972 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2295
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_lag_7: 0.0377
2025-05-23 15:06:56,974 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 15:06:56,975 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 15:06:56,975 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 15:06:56,975 - train_models - INFO -   Hours_per_Quantity: 0.0052
2025-05-23 15:06:56,976 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 1: MAE=0.4549, RMSE=0.6129, R²=0.8584, MAPE=22.10%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 2: MAE=0.4708, RMSE=0.7086, R²=0.9012, MAPE=16.36%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 3: MAE=0.3434, RMSE=0.4598, R²=0.9249, MAPE=13.88%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 4: MAE=0.4713, RMSE=0.6454, R²=0.9227, MAPE=17.59%
2025-05-23 15:06:56,977 - train_models - INFO -   Fold 5: MAE=0.4071, RMSE=0.6114, R²=0.9095, MAPE=14.03%
2025-05-23 15:06:56,977 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:06:57,731 - train_models - INFO - Model files saved successfully
2025-05-23 15:06:57,731 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:06:57,735 - train_models - INFO - Model training completed successfully
2025-05-23 15:08:39,646 - train_models - INFO - Starting the model training process
2025-05-23 15:08:39,647 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:08:39,651 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:08:39,767 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:08:40,381 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:08:40,466 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:08:40,486 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:08:40,489 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:08:40,514 - train_models - INFO - Engineering features...
2025-05-23 15:08:41,031 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:08:41,067 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:08:41,071 - train_models - INFO - Creating lag features...
2025-05-23 15:08:41,085 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:08:41,296 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:08:41,297 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:08:41,311 - train_models - INFO - Found 10 unique work types
2025-05-23 15:08:41,312 - train_models - INFO - Building models for 10 work types
2025-05-23 15:08:41,312 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:08:41,313 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:08:41,313 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:08:41,318 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:08:58,936 - train_models - INFO - Model for 202 - MAE: 0.1962, RMSE: 0.2829, R²: 0.8730, MAPE: 9.28%
2025-05-23 15:08:58,936 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_1day_trend: 0.1205
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_lag_7: 0.0694
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:08:58,938 - train_models - INFO -   Relative_Quantity: 0.0382
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:08:58,939 - train_models - INFO -   Hours_per_Quantity: 0.0163
2025-05-23 15:08:58,939 - train_models - INFO -   Quantity_per_Worker: 0.0090
2025-05-23 15:08:58,939 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:08:58,939 - train_models - INFO -   Fold 1: MAE=0.1844, RMSE=0.2569, R²=0.8579, MAPE=10.27%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 2: MAE=0.2148, RMSE=0.3451, R²=0.8242, MAPE=10.81%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 3: MAE=0.1830, RMSE=0.2482, R²=0.8887, MAPE=9.36%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 4: MAE=0.1717, RMSE=0.2484, R²=0.8999, MAPE=7.20%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 5: MAE=0.2270, RMSE=0.3157, R²=0.8943, MAPE=8.78%
2025-05-23 15:08:58,941 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:08:58,946 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:09:18,519 - train_models - INFO - Model for 203 - MAE: 0.2663, RMSE: 0.4018, R²: 0.8606, MAPE: 5.50%
2025-05-23 15:09:18,519 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_7day_trend: 0.3472
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1348
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1335
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_lag_7: 0.1005
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0983
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_1day_trend: 0.0909
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:09:18,523 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 1: MAE=0.3984, RMSE=0.5326, R²=0.7552, MAPE=7.22%
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 2: MAE=0.2760, RMSE=0.5428, R²=0.7949, MAPE=4.72%
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 3: MAE=0.2727, RMSE=0.3881, R²=0.8970, MAPE=5.78%
2025-05-23 15:09:18,524 - train_models - INFO -   Fold 4: MAE=0.1959, RMSE=0.2972, R²=0.9253, MAPE=5.34%
2025-05-23 15:09:18,524 - train_models - INFO -   Fold 5: MAE=0.1883, RMSE=0.2483, R²=0.9308, MAPE=4.45%
2025-05-23 15:09:18,524 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:09:18,528 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:09:42,395 - train_models - INFO - Model for 206 - MAE: 1.2929, RMSE: 2.1012, R²: 0.9333, MAPE: 10.14%
2025-05-23 15:09:42,395 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:09:42,396 - train_models - INFO -   Relative_Quantity: 0.6750
2025-05-23 15:09:42,396 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:09:42,396 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0406
2025-05-23 15:09:42,397 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:09:42,397 - train_models - INFO -   Quantity_per_Worker: 0.0290
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-23 15:09:42,398 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 15:09:42,398 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:09:42,398 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:09:42,398 - train_models - INFO -   Fold 1: MAE=1.7741, RMSE=2.3512, R²=0.9262, MAPE=9.10%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 2: MAE=1.3848, RMSE=1.8883, R²=0.9460, MAPE=8.20%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 3: MAE=1.0714, RMSE=2.2732, R²=0.9036, MAPE=5.84%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 4: MAE=0.9878, RMSE=1.8726, R²=0.9355, MAPE=14.11%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 5: MAE=1.2466, RMSE=2.1208, R²=0.9552, MAPE=13.45%
2025-05-23 15:09:42,400 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:09:42,403 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:01,621 - train_models - INFO - Model for 209 - MAE: 0.5522, RMSE: 1.0416, R²: 0.9383, MAPE: 10.19%
2025-05-23 15:10:01,622 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:10:01,622 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:10:01,622 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1249
2025-05-23 15:10:01,622 - train_models - INFO -   Hours_per_Quantity: 0.0540
2025-05-23 15:10:01,622 - train_models - INFO -   Quantity_per_Worker: 0.0466
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0074
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_7day_trend: 0.0058
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:10:01,624 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-23 15:10:01,624 - train_models - INFO -   NoOfMan_lag_7: 0.0012
2025-05-23 15:10:01,624 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:10:01,624 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:10:01,624 - train_models - INFO -   Fold 1: MAE=0.9806, RMSE=1.9546, R²=0.8296, MAPE=15.36%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 2: MAE=0.3897, RMSE=0.6178, R²=0.9728, MAPE=4.53%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 3: MAE=0.5139, RMSE=1.1365, R²=0.9420, MAPE=6.14%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 4: MAE=0.4648, RMSE=0.7345, R²=0.9666, MAPE=19.80%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 5: MAE=0.4124, RMSE=0.7649, R²=0.9806, MAPE=5.12%
2025-05-23 15:10:01,625 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:10:01,631 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:19,655 - train_models - INFO - Model for 210 - MAE: 0.4203, RMSE: 0.8322, R²: 0.9410, MAPE: 7.61%
2025-05-23 15:10:19,656 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:10:19,656 - train_models - INFO -   Relative_Quantity: 0.8400
2025-05-23 15:10:19,656 - train_models - INFO -   Quantity_per_Worker: 0.0466
2025-05-23 15:10:19,657 - train_models - INFO -   Hours_per_Quantity: 0.0433
2025-05-23 15:10:19,657 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:10:19,657 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:10:19,658 - train_models - INFO -   SystemHours_per_Quantity: 0.0042
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_7day_trend: 0.0020
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_1day_trend: 0.0018
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:10:19,658 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 15:10:19,659 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:10:19,659 - train_models - INFO -   Fold 1: MAE=0.5875, RMSE=1.2313, R²=0.8855, MAPE=9.02%
2025-05-23 15:10:19,659 - train_models - INFO -   Fold 2: MAE=0.3906, RMSE=0.6315, R²=0.9608, MAPE=4.59%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 3: MAE=0.4149, RMSE=0.9306, R²=0.9204, MAPE=6.34%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 4: MAE=0.3550, RMSE=0.5929, R²=0.9684, MAPE=13.48%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 5: MAE=0.3533, RMSE=0.7749, R²=0.9701, MAPE=4.59%
2025-05-23 15:10:19,661 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:10:19,665 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:39,413 - train_models - INFO - Model for 211 - MAE: 0.7154, RMSE: 1.0139, R²: 0.9029, MAPE: 11.29%
2025-05-23 15:10:39,414 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:10:39,414 - train_models - INFO -   Relative_Quantity: 0.4585
2025-05-23 15:10:39,414 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_1day_trend: 0.0959
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_7day_trend: 0.0707
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_lag_1: 0.0336
2025-05-23 15:10:39,416 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-05-23 15:10:39,416 - train_models - INFO -   Quantity_per_Worker: 0.0116
2025-05-23 15:10:39,417 - train_models - INFO -   Hours_per_Quantity: 0.0082
2025-05-23 15:10:39,417 - train_models - INFO -   SystemHours_per_Quantity: 0.0058
2025-05-23 15:10:39,417 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 1: MAE=0.9294, RMSE=1.3138, R²=0.8367, MAPE=12.16%
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 2: MAE=0.8391, RMSE=1.2903, R²=0.8773, MAPE=17.05%
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 3: MAE=0.4925, RMSE=0.6708, R²=0.9452, MAPE=6.10%
2025-05-23 15:10:39,419 - train_models - INFO -   Fold 4: MAE=0.7996, RMSE=1.0450, R²=0.9131, MAPE=15.20%
2025-05-23 15:10:39,419 - train_models - INFO -   Fold 5: MAE=0.5163, RMSE=0.7497, R²=0.9422, MAPE=5.93%
2025-05-23 15:10:39,419 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:10:39,427 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:57,856 - train_models - INFO - Model for 213 - MAE: 0.3646, RMSE: 0.5306, R²: 0.8798, MAPE: 15.98%
2025-05-23 15:10:57,856 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3526
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_7day_trend: 0.2754
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_1day_trend: 0.1609
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_lag_1: 0.0459
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0378
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_lag_7: 0.0231
2025-05-23 15:10:57,859 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 15:10:57,859 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0099
2025-05-23 15:10:57,859 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 15:10:57,860 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 1: MAE=0.4207, RMSE=0.5236, R²=0.8054, MAPE=25.50%
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 2: MAE=0.4251, RMSE=0.6582, R²=0.8577, MAPE=17.36%
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 3: MAE=0.3663, RMSE=0.5272, R²=0.9126, MAPE=14.95%
2025-05-23 15:10:57,861 - train_models - INFO -   Fold 4: MAE=0.2957, RMSE=0.4978, R²=0.9066, MAPE=11.84%
2025-05-23 15:10:57,861 - train_models - INFO -   Fold 5: MAE=0.3154, RMSE=0.4462, R²=0.9167, MAPE=10.22%
2025-05-23 15:10:57,861 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:10:57,865 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:15,746 - train_models - INFO - Model for 214 - MAE: 0.5294, RMSE: 0.7913, R²: 0.8801, MAPE: 11.75%
2025-05-23 15:11:15,746 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:11:15,747 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:11:15,747 - train_models - INFO -   NoOfMan_7day_trend: 0.1493
2025-05-23 15:11:15,747 - train_models - INFO -   Relative_Quantity: 0.0949
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0617
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_1day_trend: 0.0559
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0121
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0105
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 15:11:15,750 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 1: MAE=0.5106, RMSE=0.6659, R²=0.8620, MAPE=12.87%
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 2: MAE=0.4451, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 3: MAE=0.4135, RMSE=0.5806, R²=0.9158, MAPE=8.99%
2025-05-23 15:11:15,751 - train_models - INFO -   Fold 4: MAE=0.6170, RMSE=1.0803, R²=0.8407, MAPE=11.85%
2025-05-23 15:11:15,751 - train_models - INFO -   Fold 5: MAE=0.6609, RMSE=1.0564, R²=0.8670, MAPE=13.33%
2025-05-23 15:11:15,751 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:11:15,758 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:36,175 - train_models - INFO - Model for 215 - MAE: 0.3427, RMSE: 0.6239, R²: 0.9644, MAPE: 6.50%
2025-05-23 15:11:36,175 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:11:36,176 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-23 15:11:36,176 - train_models - INFO -   Quantity_per_Worker: 0.0386
2025-05-23 15:11:36,176 - train_models - INFO -   Hours_per_Quantity: 0.0355
2025-05-23 15:11:36,176 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 15:11:36,177 - train_models - INFO -   NoOfMan_1day_trend: 0.0048
2025-05-23 15:11:36,177 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 15:11:36,178 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:11:36,178 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0020
2025-05-23 15:11:36,178 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 15:11:36,178 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 15:11:36,179 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 1: MAE=0.5102, RMSE=0.7135, R²=0.9594, MAPE=9.84%
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 2: MAE=0.4868, RMSE=0.9034, R²=0.9407, MAPE=8.61%
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 3: MAE=0.2380, RMSE=0.3585, R²=0.9795, MAPE=5.42%
2025-05-23 15:11:36,180 - train_models - INFO -   Fold 4: MAE=0.2203, RMSE=0.5000, R²=0.9776, MAPE=5.55%
2025-05-23 15:11:36,180 - train_models - INFO -   Fold 5: MAE=0.2581, RMSE=0.6441, R²=0.9647, MAPE=3.08%
2025-05-23 15:11:36,180 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:11:36,190 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:51,397 - train_models - INFO - Model for 217 - MAE: 0.4279, RMSE: 0.6068, R²: 0.9036, MAPE: 16.75%
2025-05-23 15:11:51,398 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:11:51,398 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:11:51,398 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_7day_trend: 0.1903
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_lag_7: 0.0377
2025-05-23 15:11:51,399 - train_models - INFO -   Relative_Quantity: 0.0269
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-05-23 15:11:51,400 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 15:11:51,401 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:11:51,401 - train_models - INFO -   Fold 1: MAE=0.4529, RMSE=0.6113, R²=0.8591, MAPE=22.00%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 2: MAE=0.4674, RMSE=0.7055, R²=0.9020, MAPE=16.27%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 3: MAE=0.3435, RMSE=0.4602, R²=0.9248, MAPE=13.93%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 4: MAE=0.4718, RMSE=0.6481, R²=0.9220, MAPE=17.55%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 5: MAE=0.4037, RMSE=0.6088, R²=0.9102, MAPE=14.00%
2025-05-23 15:11:51,403 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:11:52,135 - train_models - INFO - Model files saved successfully
2025-05-23 15:11:52,135 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:11:52,138 - train_models - INFO - Model training completed successfully
2025-05-23 15:19:02,679 - train_models - INFO - Starting the model training process
2025-05-23 15:19:02,680 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:19:02,684 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:19:02,822 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:19:03,467 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:19:03,539 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:19:03,557 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:19:03,559 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:19:03,578 - train_models - INFO - Engineering features...
2025-05-23 15:19:04,147 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:19:04,176 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:19:04,182 - train_models - INFO - Creating lag features...
2025-05-23 15:19:04,193 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:19:04,392 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:19:04,392 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:19:04,407 - train_models - INFO - Found 10 unique work types
2025-05-23 15:19:04,407 - train_models - INFO - Building models for 10 work types
2025-05-23 15:19:04,407 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:19:04,408 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:19:04,408 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:19:04,417 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:19:21,193 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-23 15:19:21,194 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:19:21,194 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-23 15:19:21,196 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:19:21,196 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:19:21,196 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 15:19:21,197 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:19:21,197 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-23 15:19:21,197 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-23 15:19:21,198 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:19:21,198 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-23 15:19:21,198 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-23 15:19:21,199 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:19:21,204 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:19:39,875 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-23 15:19:39,875 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:19:39,878 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-23 15:19:39,880 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-23 15:19:39,880 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:19:39,885 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:05,922 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-23 15:20:05,922 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:20:05,923 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 15:20:05,923 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:20:05,923 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-23 15:20:05,924 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:20:05,924 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 15:20:05,925 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 15:20:05,925 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:20:05,925 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:20:05,925 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-23 15:20:05,927 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-23 15:20:05,927 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:20:05,932 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:24,450 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:20:24,450 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:20:24,451 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:20:24,451 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:20:24,451 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:20:24,452 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:20:24,452 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:20:24,452 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:20:24,453 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:20:24,454 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:20:24,454 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:20:24,456 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:20:24,456 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:20:24,461 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:42,320 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:20:42,320 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:20:42,321 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:20:42,321 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:20:42,321 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:20:42,322 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:20:42,322 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:20:42,323 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:20:42,323 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:20:42,324 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:20:42,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:20:42,324 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:20:42,325 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:20:42,326 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:20:42,326 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:20:42,326 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:20:42,330 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:02,608 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-23 15:21:02,609 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:21:02,609 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 15:21:02,609 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-23 15:21:02,611 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 15:21:02,611 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 15:21:02,611 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-23 15:21:02,611 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-23 15:21:02,612 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 15:21:02,612 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:21:02,612 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-23 15:21:02,614 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:21:02,620 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:21,337 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-23 15:21:21,338 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:21:21,338 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 15:21:21,341 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-23 15:21:21,341 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-23 15:21:21,341 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 15:21:21,342 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:21:21,342 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-23 15:21:21,342 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-23 15:21:21,343 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:21:21,350 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:39,209 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-23 15:21:39,210 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:21:39,210 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:21:39,210 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 15:21:39,211 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-23 15:21:39,211 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-23 15:21:39,211 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 15:21:39,213 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 15:21:39,213 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:21:39,213 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-23 15:21:39,213 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-23 15:21:39,214 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:21:39,222 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:59,873 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-23 15:21:59,874 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:21:59,874 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-23 15:21:59,874 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-23 15:21:59,875 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 15:21:59,876 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-23 15:21:59,876 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:21:59,876 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 15:21:59,876 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 15:21:59,877 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:21:59,877 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-23 15:21:59,877 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-23 15:21:59,878 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:21:59,884 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:22:16,425 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-23 15:22:16,426 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:22:16,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:22:16,426 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 15:22:16,428 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 15:22:16,428 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-23 15:22:16,428 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 15:22:16,429 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 15:22:16,429 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 15:22:16,429 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-23 15:22:16,431 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-23 15:22:16,431 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-23 15:22:16,431 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:22:17,131 - train_models - INFO - Model files saved successfully
2025-05-23 15:22:17,132 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:22:17,134 - train_models - INFO - Model training completed successfully
2025-05-23 15:26:42,577 - train_models - INFO - Starting the model training process
2025-05-23 15:26:42,577 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:26:42,581 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:26:42,700 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:26:43,142 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:26:43,159 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:26:43,160 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:26:43,170 - train_models - INFO - Engineering features...
2025-05-23 15:26:43,566 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:26:43,580 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:26:43,582 - train_models - INFO - Creating lag features...
2025-05-23 15:26:43,588 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:26:43,669 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:26:43,669 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:26:43,673 - train_models - INFO - Found 2 unique work types
2025-05-23 15:26:43,673 - train_models - INFO - Building models for 2 work types
2025-05-23 15:26:43,674 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:26:43,674 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:26:43,674 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:26:43,678 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:27:01,247 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:27:01,248 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:27:01,248 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:27:01,248 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:27:01,249 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:27:01,249 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:27:01,249 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:27:01,251 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:27:01,251 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:27:01,251 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:27:01,253 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:27:01,253 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:27:01,258 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:27:18,108 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:27:18,109 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:27:18,109 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:27:18,109 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:27:18,110 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:27:18,110 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:27:18,110 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:27:18,110 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:27:18,111 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:27:18,112 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:27:18,112 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:27:18,112 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:27:18,114 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:27:18,480 - train_models - INFO - Model files saved successfully
2025-05-23 15:27:18,480 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:27:18,481 - train_models - INFO - Model training completed successfully
2025-05-23 15:32:53,958 - train_models - INFO - Starting the model training process
2025-05-23 15:32:53,959 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:32:53,963 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:32:54,099 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:32:54,529 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:32:54,545 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:32:54,546 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:32:54,554 - train_models - INFO - Engineering features...
2025-05-23 15:32:55,046 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:32:55,058 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:32:55,061 - train_models - INFO - Creating lag features...
2025-05-23 15:32:55,067 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:32:55,140 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:32:55,140 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:32:55,143 - train_models - INFO - Found 2 unique work types
2025-05-23 15:32:55,143 - train_models - INFO - Building models for 2 work types
2025-05-23 15:32:55,143 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:32:55,144 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:32:55,144 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:32:55,216 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:33:13,702 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:33:13,702 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:33:13,702 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:33:13,703 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:33:13,703 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:33:13,703 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:33:13,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:33:13,705 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:33:13,705 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:33:13,706 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:33:13,706 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:33:13,706 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:33:13,764 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:33:32,425 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:33:32,426 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:33:32,426 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:33:32,426 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:33:32,427 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:33:32,427 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:33:32,427 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:33:32,427 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:33:32,428 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:33:32,429 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:33:32,430 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:33:32,803 - train_models - INFO - Model files saved successfully
2025-05-23 15:33:32,804 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:33:32,804 - train_models - INFO - Model training completed successfully
2025-05-23 15:36:22,455 - train_models - INFO - Starting the model training process
2025-05-23 15:36:22,456 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:36:22,461 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:36:22,581 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:36:23,019 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:36:23,036 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:36:23,038 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:36:23,051 - train_models - INFO - Engineering features...
2025-05-23 15:36:23,560 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:36:23,576 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:36:23,578 - train_models - INFO - Creating lag features...
2025-05-23 15:36:23,584 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:36:23,664 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:36:23,664 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:36:23,666 - train_models - INFO - Found 2 unique work types
2025-05-23 15:36:23,667 - train_models - INFO - Building models for 2 work types
2025-05-23 15:36:23,667 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:36:23,667 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:36:23,667 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:36:25,401 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:36:45,384 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:36:45,385 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:36:45,385 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:36:45,385 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:36:45,385 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:36:45,385 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:36:45,386 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:36:45,386 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:36:45,388 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:36:46,818 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:37:10,065 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:37:10,066 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:37:10,066 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:37:10,066 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:37:10,066 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:37:10,066 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:37:10,067 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:37:10,068 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:37:10,068 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:37:10,069 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:37:10,069 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:37:10,069 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:37:10,178 - train_models - INFO - Model files saved successfully
2025-05-23 15:37:10,178 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:37:10,179 - train_models - INFO - Model training completed successfully
2025-05-23 15:38:47,816 - train_models - INFO - Starting the model training process
2025-05-23 15:38:47,816 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:38:47,821 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:38:47,934 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:38:48,440 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:38:48,458 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:38:48,460 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:38:48,467 - train_models - INFO - Engineering features...
2025-05-23 15:38:48,960 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:38:48,975 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:38:48,977 - train_models - INFO - Creating lag features...
2025-05-23 15:38:48,983 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:38:49,065 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:38:49,066 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:38:49,068 - train_models - INFO - Found 1 unique work types
2025-05-23 15:38:49,068 - train_models - INFO - Building models for 1 work types
2025-05-23 15:38:49,069 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:38:49,069 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:38:49,069 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:38:49,427 - train_models - ERROR - Error building models: [Errno 13] Permission denied: 'work_type_data_All.xlsx'
2025-05-23 15:38:49,722 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 157, in build_models
    work_type_data.to_excel('work_type_data_All.xlsx', index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'work_type_data_All.xlsx'

2025-05-23 15:38:49,727 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:38:49,738 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:38:49,802 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 420, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:38:49,803 - train_models - INFO - Model training completed successfully
2025-05-23 15:38:57,733 - train_models - INFO - Starting the model training process
2025-05-23 15:38:57,734 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:38:57,738 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:38:57,849 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:38:58,229 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:38:58,245 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:38:58,246 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:38:58,252 - train_models - INFO - Engineering features...
2025-05-23 15:38:58,670 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:38:58,681 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:38:58,683 - train_models - INFO - Creating lag features...
2025-05-23 15:38:58,689 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:38:58,750 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:38:58,751 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:38:58,754 - train_models - INFO - Found 1 unique work types
2025-05-23 15:38:58,754 - train_models - INFO - Building models for 1 work types
2025-05-23 15:38:58,755 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:38:58,755 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:38:58,755 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:39:00,223 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:39:21,017 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:39:21,018 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:39:21,018 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:39:21,018 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:39:21,018 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:39:21,018 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:39:21,020 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:39:21,020 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:39:21,020 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:39:21,020 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:39:21,020 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:39:21,022 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-23 15:39:21,099 - train_models - INFO - Model files saved successfully
2025-05-23 15:39:21,100 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:39:21,101 - train_models - INFO - Model training completed successfully
2025-05-23 15:46:50,296 - train_models - INFO - Starting the model training process
2025-05-23 15:46:50,297 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:46:50,301 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:46:50,426 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:46:50,822 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:46:50,837 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:46:50,838 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:46:50,847 - train_models - INFO - Engineering features...
2025-05-23 15:46:51,322 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:46:51,340 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:46:51,343 - train_models - INFO - Creating lag features...
2025-05-23 15:46:51,349 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:46:51,418 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:46:51,420 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:46:51,427 - train_models - INFO - Found 1 unique work types
2025-05-23 15:46:51,428 - train_models - INFO - Building models for 1 work types
2025-05-23 15:46:51,428 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:46:51,429 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:46:51,429 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:46:53,199 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:46:53,201 - train_models - ERROR - Error building models: [Errno 13] Permission denied: 'work_type_data.xlsx'
2025-05-23 15:46:53,206 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 169, in build_models
    work_type_data.to_excel('work_type_data.xlsx', index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'work_type_data.xlsx'

2025-05-23 15:46:53,207 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:46:53,214 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:46:53,219 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 421, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:46:53,219 - train_models - INFO - Model training completed successfully
2025-05-23 15:47:03,800 - train_models - INFO - Starting the model training process
2025-05-23 15:47:03,801 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:47:03,804 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:47:03,917 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:47:04,299 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:47:04,316 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:47:04,317 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:47:04,329 - train_models - INFO - Engineering features...
2025-05-23 15:47:04,734 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:47:04,747 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:47:04,749 - train_models - INFO - Creating lag features...
2025-05-23 15:47:04,754 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:47:04,817 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:47:04,817 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:47:04,819 - train_models - INFO - Found 1 unique work types
2025-05-23 15:47:04,819 - train_models - INFO - Building models for 1 work types
2025-05-23 15:47:04,819 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:47:04,819 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:47:04,820 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:47:06,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:47:07,606 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:47:07,692 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 204, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:47:07,693 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:47:07,694 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:47:07,699 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 421, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:47:07,699 - train_models - INFO - Model training completed successfully
2025-05-23 15:48:35,458 - train_models - INFO - Starting the model training process
2025-05-23 15:48:35,458 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:48:35,461 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:48:35,582 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:48:35,966 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:48:35,989 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:48:35,991 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:48:35,999 - train_models - INFO - Engineering features...
2025-05-23 15:48:36,404 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:48:36,415 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:48:36,417 - train_models - INFO - Creating lag features...
2025-05-23 15:48:36,424 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:48:36,485 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:48:36,486 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:48:36,487 - train_models - INFO - Found 1 unique work types
2025-05-23 15:48:36,488 - train_models - INFO - Building models for 1 work types
2025-05-23 15:48:36,488 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:48:36,488 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:48:36,488 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:48:38,019 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:48:39,347 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:48:39,359 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:48:39,360 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:48:39,363 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:48:39,369 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 422, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:48:39,370 - train_models - INFO - Model training completed successfully
2025-05-23 15:49:04,529 - train_models - INFO - Starting the model training process
2025-05-23 15:49:04,529 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:49:04,536 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:49:04,667 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:49:05,043 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:49:05,059 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:49:05,061 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:49:05,071 - train_models - INFO - Engineering features...
2025-05-23 15:49:05,500 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:49:05,514 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:49:05,517 - train_models - INFO - Creating lag features...
2025-05-23 15:49:05,523 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:49:05,591 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:49:05,592 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:49:05,595 - train_models - INFO - Found 1 unique work types
2025-05-23 15:49:05,595 - train_models - INFO - Building models for 1 work types
2025-05-23 15:49:05,595 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:49:05,596 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:49:05,596 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:49:07,159 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:49:08,548 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:49:08,549 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:49:08,550 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:49:08,552 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:49:08,639 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 422, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:49:08,640 - train_models - INFO - Model training completed successfully
2025-05-23 15:54:45,561 - train_models - INFO - Starting the model training process
2025-05-23 15:54:45,561 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:54:45,566 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:54:45,684 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:54:45,995 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:54:46,011 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:54:46,013 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:54:46,022 - train_models - INFO - Engineering features...
2025-05-23 15:54:46,512 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:54:46,525 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:54:46,526 - train_models - INFO - Creating lag features...
2025-05-23 15:54:46,535 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:54:46,595 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:54:46,595 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:54:46,597 - train_models - INFO - Found 1 unique work types
2025-05-23 15:54:46,597 - train_models - INFO - Building models for 1 work types
2025-05-23 15:54:46,598 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:54:46,598 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:54:46,599 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:54:48,179 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:54:49,463 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:54:49,465 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:54:49,466 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:54:49,468 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:54:49,473 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:54:49,474 - train_models - INFO - Model training completed successfully
2025-05-23 15:55:54,805 - train_models - INFO - Starting the model training process
2025-05-23 15:55:54,805 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:55:54,809 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:55:54,927 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:55:55,298 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:55:55,315 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:55:55,317 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:55:55,327 - train_models - INFO - Engineering features...
2025-05-23 15:55:55,758 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:55:55,771 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:55:55,773 - train_models - INFO - Creating lag features...
2025-05-23 15:55:55,780 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:55:55,848 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:55:55,849 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:55:55,851 - train_models - INFO - Found 1 unique work types
2025-05-23 15:55:55,851 - train_models - INFO - Building models for 1 work types
2025-05-23 15:55:55,851 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:55:55,852 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:55:55,852 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:55:57,413 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:55:58,911 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:55:58,913 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:55:58,913 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:55:58,914 - train_models - ERROR - Error saving models: DataFrame constructor not properly called!
2025-05-23 15:55:58,917 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 420, in save_models
    performance_df = pd.DataFrame('COLXX', performance_summary)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 886, in __init__
    raise ValueError("DataFrame constructor not properly called!")
ValueError: DataFrame constructor not properly called!

2025-05-23 15:55:58,918 - train_models - INFO - Model training completed successfully
2025-05-23 15:56:35,718 - train_models - INFO - Starting the model training process
2025-05-23 15:56:35,718 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:56:35,724 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:56:35,837 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:56:36,213 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:56:36,229 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:56:36,230 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:56:36,238 - train_models - INFO - Engineering features...
2025-05-23 15:56:36,648 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:56:36,661 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:56:36,663 - train_models - INFO - Creating lag features...
2025-05-23 15:56:36,672 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:56:36,732 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:56:36,732 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:56:36,735 - train_models - INFO - Found 1 unique work types
2025-05-23 15:56:36,735 - train_models - INFO - Building models for 1 work types
2025-05-23 15:56:36,736 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:56:36,736 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:56:36,736 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:56:38,193 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:56:39,624 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:56:39,627 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:56:39,628 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:56:39,632 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:56:39,639 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:56:39,640 - train_models - INFO - Model training completed successfully
2025-05-23 15:58:07,011 - train_models - INFO - Starting the model training process
2025-05-23 15:58:07,011 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:58:07,015 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:58:07,130 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:58:07,501 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:58:07,517 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:58:07,518 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:58:07,529 - train_models - INFO - Engineering features...
2025-05-23 15:58:07,922 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:58:07,933 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:58:07,935 - train_models - INFO - Creating lag features...
2025-05-23 15:58:07,944 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:58:08,002 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:58:08,003 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:58:08,005 - train_models - INFO - Found 1 unique work types
2025-05-23 15:58:08,005 - train_models - INFO - Building models for 1 work types
2025-05-23 15:58:08,005 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:58:08,006 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:58:08,006 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:58:09,486 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:58:10,913 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:58:10,915 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:58:10,915 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:58:10,918 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:58:10,923 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:58:10,924 - train_models - INFO - Model training completed successfully
2025-05-23 15:58:58,171 - train_models - INFO - Starting the model training process
2025-05-23 15:58:58,171 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:58:58,174 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:58:58,291 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:58:58,669 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:58:58,685 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:58:58,686 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:58:58,693 - train_models - INFO - Engineering features...
2025-05-23 15:58:59,085 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:58:59,098 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:58:59,100 - train_models - INFO - Creating lag features...
2025-05-23 15:58:59,108 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:58:59,177 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:58:59,177 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:58:59,180 - train_models - INFO - Found 1 unique work types
2025-05-23 15:58:59,180 - train_models - INFO - Building models for 1 work types
2025-05-23 15:58:59,180 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:58:59,180 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:58:59,181 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:00,699 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:02,106 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:59:02,108 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:59:02,109 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:02,130 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:02,131 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:02,131 - train_models - INFO - Model training completed successfully
2025-05-23 15:59:40,349 - train_models - INFO - Starting the model training process
2025-05-23 15:59:40,350 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:59:40,353 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:59:40,472 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:59:40,691 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:59:40,706 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:59:40,708 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:59:40,718 - train_models - INFO - Engineering features...
2025-05-23 15:59:41,124 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:59:41,138 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:59:41,141 - train_models - INFO - Creating lag features...
2025-05-23 15:59:41,148 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:59:41,212 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:59:41,213 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:59:41,215 - train_models - INFO - Found 1 unique work types
2025-05-23 15:59:41,215 - train_models - INFO - Building models for 1 work types
2025-05-23 15:59:41,216 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:59:41,216 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:59:41,216 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:42,760 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:44,153 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:59:44,220 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:59:44,222 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:44,233 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:44,234 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:44,234 - train_models - INFO - Model training completed successfully
2025-05-23 15:59:52,712 - train_models - INFO - Starting the model training process
2025-05-23 15:59:52,712 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:59:52,717 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:59:52,836 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:59:53,241 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:59:53,258 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:59:53,259 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:59:53,268 - train_models - INFO - Engineering features...
2025-05-23 15:59:53,687 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:59:53,700 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:59:53,702 - train_models - INFO - Creating lag features...
2025-05-23 15:59:53,707 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:59:53,775 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:59:53,775 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:59:53,778 - train_models - INFO - Found 1 unique work types
2025-05-23 15:59:53,778 - train_models - INFO - Building models for 1 work types
2025-05-23 15:59:53,779 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:59:53,779 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:59:53,779 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:55,236 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:56,650 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:59:56,655 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:59:56,656 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:56,670 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:56,671 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:56,672 - train_models - INFO - Model training completed successfully
2025-05-23 16:02:19,139 - train_models - INFO - Starting the model training process
2025-05-23 16:02:19,139 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:02:19,143 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:02:19,262 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:02:19,653 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:02:19,669 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:02:19,670 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:02:19,682 - train_models - INFO - Engineering features...
2025-05-23 16:02:20,083 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:02:20,097 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:02:20,099 - train_models - INFO - Creating lag features...
2025-05-23 16:02:20,108 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:02:20,179 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:02:20,179 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:02:20,181 - train_models - INFO - Found 1 unique work types
2025-05-23 16:02:20,181 - train_models - INFO - Building models for 1 work types
2025-05-23 16:02:20,182 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:02:20,182 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:02:20,182 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:02:21,883 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:02:23,211 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 16:02:23,217 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 16:02:23,218 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 16:02:23,230 - train_models - INFO - Model files saved successfully
2025-05-23 16:02:23,230 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:02:23,231 - train_models - INFO - Model training completed successfully
2025-05-23 16:05:32,389 - train_models - INFO - Starting the model training process
2025-05-23 16:05:32,390 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:05:32,393 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:05:32,511 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:05:32,935 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:05:32,950 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:05:32,951 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:05:32,956 - train_models - INFO - Engineering features...
2025-05-23 16:05:33,525 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:05:33,539 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:05:33,542 - train_models - INFO - Creating lag features...
2025-05-23 16:05:33,551 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:05:33,627 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:05:33,627 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:05:33,630 - train_models - INFO - Found 1 unique work types
2025-05-23 16:05:33,630 - train_models - INFO - Building models for 1 work types
2025-05-23 16:05:33,630 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:05:33,631 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:05:33,631 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:05:35,371 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:05:45,770 - train_models - INFO - Starting the model training process
2025-05-23 16:05:45,770 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:05:45,773 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:05:45,885 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:05:46,254 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:05:46,271 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:05:46,273 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:05:46,284 - train_models - INFO - Engineering features...
2025-05-23 16:05:46,674 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:05:46,686 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:05:46,689 - train_models - INFO - Creating lag features...
2025-05-23 16:05:46,695 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:05:46,754 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:05:46,754 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:05:46,756 - train_models - INFO - Found 1 unique work types
2025-05-23 16:05:46,757 - train_models - INFO - Building models for 1 work types
2025-05-23 16:05:46,757 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:05:46,757 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:05:46,758 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:05:48,331 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:06:16,403 - train_models - INFO - Starting the model training process
2025-05-23 16:06:16,404 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:06:16,407 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:06:16,527 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:06:16,891 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:06:16,908 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:06:16,910 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:06:16,921 - train_models - INFO - Engineering features...
2025-05-23 16:06:17,329 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:06:17,340 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:06:17,342 - train_models - INFO - Creating lag features...
2025-05-23 16:06:17,350 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:06:17,414 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:06:17,415 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:06:17,417 - train_models - INFO - Found 1 unique work types
2025-05-23 16:06:17,417 - train_models - INFO - Building models for 1 work types
2025-05-23 16:06:17,417 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:06:17,418 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:06:17,418 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:06:18,837 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:06:37,375 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 16:06:37,376 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 16:06:37,376 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 16:06:37,376 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 16:06:37,377 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 16:06:37,377 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 16:06:37,377 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 16:06:37,379 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 16:06:37,379 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 16:06:37,379 - train_models - INFO - Cross-validation details for 209:
2025-05-23 16:06:37,379 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 16:06:37,381 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-23 16:06:37,437 - train_models - INFO - Model files saved successfully
2025-05-23 16:06:37,437 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:06:37,437 - train_models - INFO - Model training completed successfully
2025-05-23 16:07:32,751 - train_models - INFO - Starting the model training process
2025-05-23 16:07:32,752 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:07:32,756 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:07:32,870 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-23 16:07:33,307 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 16:07:33,323 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 16:07:33,324 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:07:33,334 - train_models - INFO - Engineering features...
2025-05-23 16:07:33,733 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:07:33,745 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:07:33,748 - train_models - INFO - Creating lag features...
2025-05-23 16:07:33,757 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:07:33,829 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 16:07:33,829 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 16:07:33,831 - train_models - INFO - Found 2 unique work types
2025-05-23 16:07:33,832 - train_models - INFO - Building models for 2 work types
2025-05-23 16:07:33,832 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:07:33,832 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:07:33,833 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:07:35,271 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:07:53,929 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 16:07:53,929 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 16:07:53,929 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 16:07:53,930 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 16:07:53,930 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 16:07:53,931 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 16:07:53,932 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 16:07:53,932 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 16:07:53,932 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 16:07:53,933 - train_models - INFO - Cross-validation details for 209:
2025-05-23 16:07:53,933 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 16:07:53,933 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 16:07:53,934 - train_models - INFO - Building model for WorkType: 210
2025-05-23 16:07:55,218 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:08:13,398 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 16:08:13,398 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 16:08:13,399 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 16:08:13,399 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 16:08:13,399 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 16:08:13,399 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 16:08:13,400 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 16:08:13,400 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 16:08:13,400 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 16:08:13,401 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 16:08:13,401 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 16:08:13,401 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 16:08:13,402 - train_models - INFO - Cross-validation details for 210:
2025-05-23 16:08:13,402 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 16:08:13,402 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 16:08:13,404 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 16:08:13,540 - train_models - INFO - Model files saved successfully
2025-05-23 16:08:13,540 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:08:13,541 - train_models - INFO - Model training completed successfully
2025-05-25 10:24:24,286 - train_models - INFO - Starting the model training process
2025-05-25 10:24:24,288 - train_models - INFO - Training from SQL database (command line argument)
2025-05-25 10:24:24,295 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-25 10:24:24,617 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-25 10:24:25,424 - train_models - INFO - Read chunk of 10000 rows
2025-05-25 10:24:25,524 - train_models - INFO - Read chunk of 5476 rows
2025-05-25 10:24:25,587 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-25 10:24:25,591 - train_models - INFO - Converting Date column to datetime format
2025-05-25 10:24:25,613 - train_models - INFO - Engineering features...
2025-05-25 10:24:26,548 - utils.feature_engineering - INFO - Engineering features
2025-05-25 10:24:26,619 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-25 10:24:26,627 - train_models - INFO - Creating lag features...
2025-05-25 10:24:26,647 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-25 10:24:27,056 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-25 10:24:27,056 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-25 10:24:27,075 - train_models - INFO - Found 10 unique work types
2025-05-25 10:24:27,076 - train_models - INFO - Building models for 10 work types
2025-05-25 10:24:27,076 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-25 10:24:27,077 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-25 10:24:27,077 - train_models - INFO - Building model for WorkType: 202
2025-05-25 10:24:30,643 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:25:10,714 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-25 10:25:10,715 - train_models - INFO - Top 10 most important features for 202:
2025-05-25 10:25:10,715 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-25 10:25:10,715 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-25 10:25:10,716 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-25 10:25:10,716 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-25 10:25:10,717 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-25 10:25:10,717 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-25 10:25:10,717 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-25 10:25:10,718 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-25 10:25:10,718 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-25 10:25:10,719 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-25 10:25:10,719 - train_models - INFO - Cross-validation details for 202:
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-25 10:25:10,721 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-25 10:25:10,722 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-25 10:25:10,722 - train_models - INFO - Building model for WorkType: 203
2025-05-25 10:25:13,742 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:26:01,202 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-25 10:26:01,203 - train_models - INFO - Top 10 most important features for 203:
2025-05-25 10:26:01,203 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-25 10:26:01,204 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-25 10:26:01,204 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-25 10:26:01,206 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-25 10:26:01,206 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-25 10:26:01,207 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-25 10:26:01,208 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-25 10:26:01,208 - train_models - INFO - Cross-validation details for 203:
2025-05-25 10:26:01,208 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-25 10:26:01,209 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-25 10:26:01,210 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-25 10:26:01,210 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-25 10:26:01,211 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-25 10:26:01,212 - train_models - INFO - Building model for WorkType: 206
2025-05-25 10:26:05,050 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:27:06,531 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-25 10:27:06,532 - train_models - INFO - Top 10 most important features for 206:
2025-05-25 10:27:06,532 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-25 10:27:06,533 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-25 10:27:06,533 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-25 10:27:06,534 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-25 10:27:06,534 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-25 10:27:06,535 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-25 10:27:06,535 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-25 10:27:06,536 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-25 10:27:06,536 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-25 10:27:06,537 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-25 10:27:06,537 - train_models - INFO - Cross-validation details for 206:
2025-05-25 10:27:06,538 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-25 10:27:06,538 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-25 10:27:06,539 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-25 10:27:06,539 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-25 10:27:06,540 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-25 10:27:06,540 - train_models - INFO - Building model for WorkType: 209
2025-05-25 10:27:09,530 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:27:55,158 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-25 10:27:55,159 - train_models - INFO - Top 10 most important features for 209:
2025-05-25 10:27:55,160 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-25 10:27:55,160 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-25 10:27:55,160 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-25 10:27:55,161 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-25 10:27:55,161 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-25 10:27:55,162 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-25 10:27:55,162 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-25 10:27:55,163 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-25 10:27:55,164 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-25 10:27:55,164 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-25 10:27:55,166 - train_models - INFO - Cross-validation details for 209:
2025-05-25 10:27:55,166 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-25 10:27:55,167 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-25 10:27:55,168 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-25 10:27:55,168 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-25 10:27:55,169 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-25 10:27:55,169 - train_models - INFO - Building model for WorkType: 210
2025-05-25 10:27:58,213 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:28:41,387 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-25 10:28:41,388 - train_models - INFO - Top 10 most important features for 210:
2025-05-25 10:28:41,388 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-25 10:28:41,388 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-25 10:28:41,389 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-25 10:28:41,389 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-25 10:28:41,390 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-25 10:28:41,390 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-25 10:28:41,391 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-25 10:28:41,391 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-25 10:28:41,392 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-25 10:28:41,392 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-25 10:28:41,392 - train_models - INFO - Cross-validation details for 210:
2025-05-25 10:28:41,393 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-25 10:28:41,393 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-25 10:28:41,394 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-25 10:28:41,394 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-25 10:28:41,395 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-25 10:28:41,395 - train_models - INFO - Building model for WorkType: 211
2025-05-25 10:28:44,399 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:29:31,855 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-25 10:29:31,856 - train_models - INFO - Top 10 most important features for 211:
2025-05-25 10:29:31,857 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-25 10:29:31,857 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-25 10:29:31,857 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-25 10:29:31,858 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-25 10:29:31,858 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-25 10:29:31,859 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-25 10:29:31,859 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-25 10:29:31,860 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-25 10:29:31,860 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-25 10:29:31,861 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-25 10:29:31,861 - train_models - INFO - Cross-validation details for 211:
2025-05-25 10:29:31,861 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-25 10:29:31,862 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-25 10:29:31,862 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-25 10:29:31,863 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-25 10:29:31,863 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-25 10:29:31,864 - train_models - INFO - Building model for WorkType: 213
2025-05-25 10:29:34,581 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:30:18,617 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-25 10:30:18,617 - train_models - INFO - Top 10 most important features for 213:
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-25 10:30:18,620 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-25 10:30:18,620 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-25 10:30:18,621 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-25 10:30:18,621 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-25 10:30:18,622 - train_models - INFO - Cross-validation details for 213:
2025-05-25 10:30:18,622 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-25 10:30:18,623 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-25 10:30:18,623 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-25 10:30:18,624 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-25 10:30:18,624 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-25 10:30:18,625 - train_models - INFO - Building model for WorkType: 214
2025-05-25 10:30:21,330 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:31:03,279 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-25 10:31:03,280 - train_models - INFO - Top 10 most important features for 214:
2025-05-25 10:31:03,280 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-25 10:31:03,281 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-25 10:31:03,281 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-25 10:31:03,282 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-25 10:31:03,282 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-25 10:31:03,283 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-25 10:31:03,283 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-25 10:31:03,284 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-25 10:31:03,284 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-25 10:31:03,285 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-25 10:31:03,285 - train_models - INFO - Cross-validation details for 214:
2025-05-25 10:31:03,285 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-25 10:31:03,286 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-25 10:31:03,286 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-25 10:31:03,287 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-25 10:31:03,287 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-25 10:31:03,288 - train_models - INFO - Building model for WorkType: 215
2025-05-25 10:31:07,075 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:31:57,833 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-25 10:31:57,834 - train_models - INFO - Top 10 most important features for 215:
2025-05-25 10:31:57,835 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-25 10:31:57,835 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-25 10:31:57,835 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-25 10:31:57,836 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-25 10:31:57,836 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-25 10:31:57,837 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-25 10:31:57,837 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-25 10:31:57,838 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-25 10:31:57,838 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-25 10:31:57,839 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-25 10:31:57,839 - train_models - INFO - Cross-validation details for 215:
2025-05-25 10:31:57,840 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-25 10:31:57,840 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-25 10:31:57,841 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-25 10:31:57,841 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-25 10:31:57,842 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-25 10:31:57,842 - train_models - INFO - Building model for WorkType: 217
2025-05-25 10:32:00,383 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:32:37,697 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-25 10:32:37,697 - train_models - INFO - Top 10 most important features for 217:
2025-05-25 10:32:37,698 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-25 10:32:37,698 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-25 10:32:37,699 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-25 10:32:37,699 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-25 10:32:37,700 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-25 10:32:37,700 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-25 10:32:37,700 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-25 10:32:37,701 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-25 10:32:37,701 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-25 10:32:37,702 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-25 10:32:37,702 - train_models - INFO - Cross-validation details for 217:
2025-05-25 10:32:37,703 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-25 10:32:37,703 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-25 10:32:37,704 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-25 10:32:37,704 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-25 10:32:37,705 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-25 10:32:37,706 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-25 10:32:38,461 - train_models - INFO - Model files saved successfully
2025-05-25 10:32:38,461 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-25 10:32:38,468 - train_models - INFO - Model training completed successfully
2025-05-25 12:13:02,083 - train_models - INFO - Starting the model training process
2025-05-25 12:13:02,084 - train_models - INFO - Training from SQL database (command line argument)
2025-05-25 12:13:02,091 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-25 12:13:02,385 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-25 12:13:03,246 - train_models - INFO - Read chunk of 10000 rows
2025-05-25 12:13:03,358 - train_models - INFO - Read chunk of 5476 rows
2025-05-25 12:13:03,404 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-25 12:13:03,406 - train_models - INFO - Converting Date column to datetime format
2025-05-25 12:13:03,431 - train_models - INFO - Engineering features...
2025-05-25 12:13:04,389 - utils.feature_engineering - INFO - Engineering features
2025-05-25 12:13:04,456 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-25 12:13:04,465 - train_models - INFO - Creating lag features...
2025-05-25 12:13:04,484 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-25 12:13:04,921 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-25 12:13:04,922 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-25 12:13:04,951 - train_models - INFO - Found 10 unique work types
2025-05-25 12:13:04,952 - train_models - INFO - Building models for 10 work types
2025-05-25 12:13:04,952 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-25 12:13:04,953 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-25 12:13:04,953 - train_models - INFO - Building model for WorkType: 202
2025-05-25 12:13:08,333 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:13:48,103 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-25 12:13:48,104 - train_models - INFO - Top 10 most important features for 202:
2025-05-25 12:13:48,104 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-25 12:13:48,105 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-25 12:13:48,105 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-25 12:13:48,107 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-25 12:13:48,107 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-25 12:13:48,108 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-25 12:13:48,108 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-25 12:13:48,109 - train_models - INFO - Cross-validation details for 202:
2025-05-25 12:13:48,109 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-25 12:13:48,110 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-25 12:13:48,110 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-25 12:13:48,111 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-25 12:13:48,111 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-25 12:13:48,111 - train_models - INFO - Building model for WorkType: 203
2025-05-25 12:13:51,090 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:14:33,027 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-25 12:14:33,028 - train_models - INFO - Top 10 most important features for 203:
2025-05-25 12:14:33,028 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-25 12:14:33,028 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-25 12:14:33,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-25 12:14:33,031 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-25 12:14:33,031 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-25 12:14:33,032 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-25 12:14:33,032 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-25 12:14:33,033 - train_models - INFO - Cross-validation details for 203:
2025-05-25 12:14:33,033 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-25 12:14:33,033 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-25 12:14:33,034 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-25 12:14:33,034 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-25 12:14:33,035 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-25 12:14:33,035 - train_models - INFO - Building model for WorkType: 206
2025-05-25 12:14:36,681 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:15:33,452 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-25 12:15:33,453 - train_models - INFO - Top 10 most important features for 206:
2025-05-25 12:15:33,453 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-25 12:15:33,454 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-25 12:15:33,454 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-25 12:15:33,455 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-25 12:15:33,455 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-25 12:15:33,456 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-25 12:15:33,456 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-25 12:15:33,457 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-25 12:15:33,457 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-25 12:15:33,457 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-25 12:15:33,458 - train_models - INFO - Cross-validation details for 206:
2025-05-25 12:15:33,458 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-25 12:15:33,459 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-25 12:15:33,459 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-25 12:15:33,460 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-25 12:15:33,460 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-25 12:15:33,461 - train_models - INFO - Building model for WorkType: 209
2025-05-25 12:15:36,242 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:16:20,311 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-25 12:16:20,312 - train_models - INFO - Top 10 most important features for 209:
2025-05-25 12:16:20,312 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-25 12:16:20,312 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-25 12:16:20,313 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-25 12:16:20,313 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-25 12:16:20,314 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-25 12:16:20,314 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-25 12:16:20,316 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-25 12:16:20,316 - train_models - INFO - Cross-validation details for 209:
2025-05-25 12:16:20,317 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-25 12:16:20,317 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-25 12:16:20,318 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-25 12:16:20,318 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-25 12:16:20,319 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-25 12:16:20,319 - train_models - INFO - Building model for WorkType: 210
2025-05-25 12:16:23,230 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:17:05,585 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-25 12:17:05,585 - train_models - INFO - Top 10 most important features for 210:
2025-05-25 12:17:05,586 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-25 12:17:05,586 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-25 12:17:05,586 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-25 12:17:05,587 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-25 12:17:05,587 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-25 12:17:05,587 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-25 12:17:05,589 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-25 12:17:05,589 - train_models - INFO - Cross-validation details for 210:
2025-05-25 12:17:05,589 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-25 12:17:05,591 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-25 12:17:05,591 - train_models - INFO - Building model for WorkType: 211
2025-05-25 12:17:08,634 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:17:56,476 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-25 12:17:56,477 - train_models - INFO - Top 10 most important features for 211:
2025-05-25 12:17:56,477 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-25 12:17:56,477 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-25 12:17:56,478 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-25 12:17:56,478 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-25 12:17:56,479 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-25 12:17:56,479 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-25 12:17:56,480 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-25 12:17:56,480 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-25 12:17:56,481 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-25 12:17:56,481 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-25 12:17:56,481 - train_models - INFO - Cross-validation details for 211:
2025-05-25 12:17:56,482 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-25 12:17:56,482 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-25 12:17:56,483 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-25 12:17:56,483 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-25 12:17:56,484 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-25 12:17:56,484 - train_models - INFO - Building model for WorkType: 213
2025-05-25 12:17:59,199 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:18:43,065 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-25 12:18:43,066 - train_models - INFO - Top 10 most important features for 213:
2025-05-25 12:18:43,066 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-25 12:18:43,067 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-25 12:18:43,067 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-25 12:18:43,068 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-25 12:18:43,068 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-25 12:18:43,069 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-25 12:18:43,069 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-25 12:18:43,070 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-25 12:18:43,070 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-25 12:18:43,071 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-25 12:18:43,071 - train_models - INFO - Cross-validation details for 213:
2025-05-25 12:18:43,071 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-25 12:18:43,072 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-25 12:18:43,072 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-25 12:18:43,073 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-25 12:18:43,073 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-25 12:18:43,074 - train_models - INFO - Building model for WorkType: 214
2025-05-25 12:18:45,902 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:19:28,185 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-25 12:19:28,185 - train_models - INFO - Top 10 most important features for 214:
2025-05-25 12:19:28,186 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-25 12:19:28,186 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-25 12:19:28,187 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-25 12:19:28,187 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-25 12:19:28,187 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-25 12:19:28,189 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-25 12:19:28,189 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-25 12:19:28,189 - train_models - INFO - Cross-validation details for 214:
2025-05-25 12:19:28,190 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-25 12:19:28,190 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-25 12:19:28,192 - train_models - INFO - Building model for WorkType: 215
2025-05-25 12:19:31,487 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:20:20,097 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-25 12:20:20,097 - train_models - INFO - Top 10 most important features for 215:
2025-05-25 12:20:20,098 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-25 12:20:20,098 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-25 12:20:20,099 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-25 12:20:20,099 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-25 12:20:20,100 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-25 12:20:20,100 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-25 12:20:20,101 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-25 12:20:20,101 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-25 12:20:20,102 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-25 12:20:20,102 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-25 12:20:20,102 - train_models - INFO - Cross-validation details for 215:
2025-05-25 12:20:20,103 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-25 12:20:20,103 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-25 12:20:20,104 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-25 12:20:20,104 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-25 12:20:20,105 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-25 12:20:20,105 - train_models - INFO - Building model for WorkType: 217
2025-05-25 12:20:22,603 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:20:58,721 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-25 12:20:58,722 - train_models - INFO - Top 10 most important features for 217:
2025-05-25 12:20:58,722 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-25 12:20:58,723 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-25 12:20:58,723 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-25 12:20:58,724 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-25 12:20:58,724 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-25 12:20:58,725 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-25 12:20:58,725 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-25 12:20:58,725 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-25 12:20:58,726 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-25 12:20:58,726 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-25 12:20:58,727 - train_models - INFO - Cross-validation details for 217:
2025-05-25 12:20:58,727 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-25 12:20:58,727 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-25 12:20:58,728 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-25 12:20:58,728 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-25 12:20:58,729 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-25 12:20:58,730 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-25 12:20:59,446 - train_models - INFO - Model files saved successfully
2025-05-25 12:20:59,447 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-25 12:20:59,452 - train_models - INFO - Model training completed successfully
2025-05-26 10:16:37,296 - train_models - INFO - Starting the model training process
2025-05-26 10:16:37,298 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-26 10:16:49,829 - train_models - INFO - Loading data from 
2025-05-26 10:16:49,830 - train_models - ERROR - Error loading data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)
2025-05-26 10:16:49,835 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 65, in load_data
    raise ValueError("Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)")
ValueError: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

2025-05-26 10:16:49,835 - train_models - ERROR - Error in main training process: Failed to load data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)
2025-05-26 10:16:49,837 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 65, in load_data
    raise ValueError("Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)")
ValueError: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 462, in main
    df = load_data(file_path)
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 97, in load_data
    raise Exception(f"Failed to load data: {str(e)}")
Exception: Failed to load data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

2025-05-26 10:17:05,777 - train_models - INFO - Starting the model training process
2025-05-26 10:17:05,777 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:17:05,781 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:17:05,906 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:17:06,260 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:17:06,276 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:17:06,277 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:17:06,282 - train_models - INFO - Engineering features...
2025-05-26 10:17:06,763 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:17:06,775 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:17:06,777 - train_models - INFO - Creating lag features...
2025-05-26 10:17:06,783 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:17:06,846 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:17:06,847 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:17:06,849 - train_models - INFO - Found 1 unique work types
2025-05-26 10:17:06,849 - train_models - INFO - Building models for 1 work types
2025-05-26 10:17:06,849 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:17:06,849 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:17:06,850 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:17:08,352 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:17:27,198 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:17:27,200 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:17:27,200 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:17:27,200 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:17:27,201 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:17:27,201 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:17:27,202 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:17:27,202 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:17:27,202 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:17:27,202 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:17:27,202 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:17:27,204 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:17:27,270 - train_models - INFO - Model files saved successfully
2025-05-26 10:17:27,270 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:17:27,271 - train_models - INFO - Model training completed successfully
2025-05-26 10:19:47,384 - train_models - INFO - Starting the model training process
2025-05-26 10:19:47,384 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:19:47,388 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:19:47,498 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:19:47,860 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:19:47,877 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:19:47,879 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:19:47,889 - train_models - INFO - Engineering features...
2025-05-26 10:19:48,237 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:19:48,252 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:19:48,254 - train_models - INFO - Creating lag features...
2025-05-26 10:19:48,261 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:19:48,319 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:19:48,319 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:19:48,321 - train_models - INFO - Found 1 unique work types
2025-05-26 10:19:48,325 - train_models - ERROR - Error building models: No engine for filetype: 'xlxs'
2025-05-26 10:19:48,439 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1136, in __new__
    engine = config.get_option(f"io.excel.{ext}.writer", silent=True)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 274, in __call__
    return self.__func__(*args, **kwds)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 146, in _get_option
    key = _get_single_key(pat, silent)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 132, in _get_single_key
    raise OptionError(f"No such keys(s): {repr(pat)}")
pandas._config.config.OptionError: No such keys(s): 'io.excel.xlxs.writer'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 121, in build_models
    processed_data.to_excel('209.xlxs')
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1140, in __new__
    raise ValueError(f"No engine for filetype: '{ext}'") from err
ValueError: No engine for filetype: 'xlxs'

2025-05-26 10:19:48,440 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-26 10:19:48,701 - train_models - INFO - Model files saved successfully
2025-05-26 10:19:48,701 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:19:48,702 - train_models - INFO - Model training completed successfully
2025-05-26 10:21:23,314 - train_models - INFO - Starting the model training process
2025-05-26 10:21:23,315 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:21:23,318 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:21:23,428 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:21:23,813 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:21:23,828 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:21:23,829 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:21:23,834 - train_models - INFO - Engineering features...
2025-05-26 10:21:24,203 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:21:24,213 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:21:24,215 - train_models - INFO - Creating lag features...
2025-05-26 10:21:24,226 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:21:24,287 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:21:24,288 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:21:24,290 - train_models - INFO - Found 1 unique work types
2025-05-26 10:21:24,291 - train_models - INFO - Building models for 1 work types
2025-05-26 10:21:24,291 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:21:24,291 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:21:24,291 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:21:25,708 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:21:46,576 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:21:46,577 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:21:46,577 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:21:46,577 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:21:46,578 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:21:46,578 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:21:46,578 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:21:46,580 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:21:46,580 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:21:46,580 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:21:46,580 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:21:46,582 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:21:46,633 - train_models - INFO - Model files saved successfully
2025-05-26 10:21:46,633 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:21:46,634 - train_models - INFO - Model training completed successfully
2025-05-26 10:21:51,231 - train_models - INFO - Starting the model training process
2025-05-26 10:21:51,232 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:21:51,235 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:21:51,338 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:21:51,705 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:21:51,721 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:21:51,723 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:21:51,734 - train_models - INFO - Engineering features...
2025-05-26 10:21:52,088 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:21:52,101 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:21:52,103 - train_models - INFO - Creating lag features...
2025-05-26 10:21:52,109 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:21:52,170 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:21:52,171 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:21:52,173 - train_models - INFO - Found 1 unique work types
2025-05-26 10:21:52,174 - train_models - INFO - Building models for 1 work types
2025-05-26 10:21:52,174 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:21:52,174 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:21:52,175 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:21:53,932 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:22:13,209 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:22:13,209 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:22:13,209 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:22:13,209 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:22:13,210 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:22:13,210 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:22:13,210 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:22:13,211 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:22:13,212 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:22:13,212 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:22:13,213 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:22:13,267 - train_models - INFO - Model files saved successfully
2025-05-26 10:22:13,267 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:22:13,268 - train_models - INFO - Model training completed successfully
2025-05-26 10:22:51,140 - train_models - INFO - Starting the model training process
2025-05-26 10:22:51,141 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:22:51,144 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:22:51,261 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:22:51,617 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:22:51,634 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:22:51,635 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:22:51,647 - train_models - INFO - Engineering features...
2025-05-26 10:22:51,994 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:22:52,007 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:22:52,009 - train_models - INFO - Creating lag features...
2025-05-26 10:22:52,016 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:22:52,073 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:22:52,074 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:22:52,077 - train_models - INFO - Found 1 unique work types
2025-05-26 10:22:52,077 - train_models - INFO - Building models for 1 work types
2025-05-26 10:22:53,540 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:22:53,541 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:22:53,541 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:22:54,754 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:23:15,065 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:23:15,066 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:23:15,066 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:23:15,066 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:23:15,066 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:23:15,066 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:23:15,068 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:23:15,068 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:23:15,069 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:23:15,069 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:23:15,069 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:23:15,117 - train_models - INFO - Model files saved successfully
2025-05-26 10:23:15,118 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:23:15,118 - train_models - INFO - Model training completed successfully
2025-05-26 10:29:20,092 - train_models - INFO - Starting the model training process
2025-05-26 10:29:20,093 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:29:20,096 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:29:20,263 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:29:20,632 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:29:20,649 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:29:20,651 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:29:21,140 - train_models - INFO - Engineering features...
2025-05-26 10:29:21,625 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:29:21,640 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:29:21,642 - train_models - INFO - Creating lag features...
2025-05-26 10:29:21,648 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:29:21,722 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:29:21,723 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:29:21,725 - train_models - INFO - Found 1 unique work types
2025-05-26 10:29:21,726 - train_models - INFO - Building models for 1 work types
2025-05-26 10:29:21,726 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:29:21,727 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:29:21,727 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:29:23,225 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:29:44,523 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:29:44,523 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:29:44,523 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:29:44,524 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:29:44,524 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:29:44,524 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:29:44,526 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:29:44,526 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:29:44,526 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:29:44,526 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:29:44,528 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:29:44,588 - train_models - INFO - Model files saved successfully
2025-05-26 10:29:44,588 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:29:44,589 - train_models - INFO - Model training completed successfully
2025-05-26 10:47:57,443 - train_models - INFO - Starting the model training process
2025-05-26 10:47:57,443 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:47:57,447 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:47:57,554 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 10:47:58,137 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 10:47:58,191 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 10:47:58,208 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 10:47:58,209 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:47:58,220 - train_models - INFO - Engineering features...
2025-05-26 10:47:58,636 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:47:58,665 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:47:58,671 - train_models - INFO - Creating lag features...
2025-05-26 10:47:58,681 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:47:58,851 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 10:47:58,852 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 10:47:58,860 - train_models - INFO - Found 9 unique work types
2025-05-26 10:47:58,860 - train_models - INFO - Building models for 9 work types
2025-05-26 10:47:58,860 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:47:58,861 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:47:58,861 - train_models - INFO - Building model for WorkType: 202
2025-05-26 10:48:00,220 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:48:17,377 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 10:48:17,377 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 10:48:17,379 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 10:48:17,380 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 10:48:17,380 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 10:48:17,380 - train_models - INFO - Cross-validation details for 202:
2025-05-26 10:48:17,380 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 10:48:17,380 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 10:48:17,381 - train_models - INFO - Building model for WorkType: 203
2025-05-26 10:48:18,632 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:48:36,351 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 10:48:36,351 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 10:48:36,354 - train_models - INFO - Cross-validation details for 203:
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 10:48:36,355 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 10:48:36,355 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 10:48:36,355 - train_models - INFO - Building model for WorkType: 206
2025-05-26 10:48:37,961 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:02,487 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 10:49:02,488 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 10:49:02,488 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 10:49:02,488 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 10:49:02,488 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 10:49:02,488 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 10:49:02,489 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 10:49:02,490 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 10:49:02,490 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 10:49:02,490 - train_models - INFO - Cross-validation details for 206:
2025-05-26 10:49:02,490 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 10:49:02,492 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:49:03,661 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:21,973 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:49:21,973 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:49:21,973 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:49:21,973 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:49:21,974 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:49:21,974 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:49:21,975 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:49:21,975 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:49:21,975 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:49:21,975 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:49:21,977 - train_models - INFO - Building model for WorkType: 210
2025-05-26 10:49:23,208 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:42,074 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 10:49:42,075 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 10:49:42,075 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 10:49:42,075 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 10:49:42,075 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 10:49:42,075 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 10:49:42,076 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 10:49:42,077 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 10:49:42,077 - train_models - INFO - Cross-validation details for 210:
2025-05-26 10:49:42,077 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 10:49:42,078 - train_models - INFO - Building model for WorkType: 211
2025-05-26 10:49:43,747 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:05,945 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 10:50:05,945 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 10:50:05,946 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 10:50:05,946 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 10:50:05,946 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 10:50:05,948 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 10:50:05,948 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 10:50:05,948 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 10:50:05,948 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 10:50:05,949 - train_models - INFO - Cross-validation details for 211:
2025-05-26 10:50:05,949 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 10:50:05,949 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 10:50:05,950 - train_models - INFO - Building model for WorkType: 213
2025-05-26 10:50:07,069 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:26,017 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 10:50:26,018 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 10:50:26,019 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 10:50:26,020 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 10:50:26,020 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 10:50:26,020 - train_models - INFO - Cross-validation details for 213:
2025-05-26 10:50:26,020 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 10:50:26,020 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 10:50:26,021 - train_models - INFO - Building model for WorkType: 214
2025-05-26 10:50:27,258 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:46,275 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 10:50:46,276 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 10:50:46,276 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 10:50:46,276 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 10:50:46,277 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 10:50:46,277 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 10:50:46,277 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 10:50:46,279 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 10:50:46,279 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 10:50:46,279 - train_models - INFO - Cross-validation details for 214:
2025-05-26 10:50:46,279 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 10:50:46,281 - train_models - INFO - Building model for WorkType: 217
2025-05-26 10:50:47,383 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:51:03,960 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 10:51:03,961 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 10:51:03,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 10:51:03,961 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 10:51:03,962 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 10:51:03,964 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 10:51:03,964 - train_models - INFO - Cross-validation details for 217:
2025-05-26 10:51:03,964 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 10:51:03,966 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 10:51:04,412 - train_models - INFO - Model files saved successfully
2025-05-26 10:51:04,413 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:51:04,415 - train_models - INFO - Model training completed successfully
2025-05-26 11:37:21,869 - train_models - INFO - Starting the model training process
2025-05-26 11:37:21,870 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:37:21,873 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:37:21,983 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 11:37:22,548 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 11:37:22,607 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 11:37:22,625 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 11:37:22,626 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:37:22,638 - train_models - INFO - Engineering features...
2025-05-26 11:37:23,033 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:37:23,065 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:37:23,069 - train_models - INFO - Creating lag features...
2025-05-26 11:37:23,079 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:37:23,247 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 11:37:23,248 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 11:37:23,259 - train_models - INFO - Found 9 unique work types
2025-05-26 11:37:23,260 - train_models - INFO - Building models for 9 work types
2025-05-26 11:37:23,260 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:37:23,260 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:37:23,261 - train_models - INFO - Building model for WorkType: 202
2025-05-26 11:37:24,627 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:37:41,217 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 11:37:41,217 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 11:37:41,219 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 11:37:41,220 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 11:37:41,220 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 11:37:41,220 - train_models - INFO - Cross-validation details for 202:
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 11:37:41,222 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 11:37:41,222 - train_models - INFO - Building model for WorkType: 203
2025-05-26 11:37:42,469 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:37:59,842 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 11:37:59,842 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 11:37:59,846 - train_models - INFO - Cross-validation details for 203:
2025-05-26 11:37:59,846 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 11:37:59,846 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 11:37:59,847 - train_models - INFO - Building model for WorkType: 206
2025-05-26 11:38:01,478 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:38:25,219 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 11:38:25,219 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 11:38:25,219 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 11:38:25,220 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 11:38:25,220 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 11:38:25,220 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 11:38:25,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 11:38:25,221 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 11:38:25,221 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 11:38:25,222 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 11:38:25,222 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 11:38:25,222 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 11:38:25,222 - train_models - INFO - Cross-validation details for 206:
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 11:38:25,224 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 11:38:25,224 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 11:38:25,224 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:38:26,353 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:38:44,564 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:38:44,564 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:38:44,564 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:38:44,564 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:38:44,565 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:38:44,565 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:38:44,565 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:38:44,567 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:38:44,567 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:38:44,567 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:38:44,569 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:38:45,928 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:03,641 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:39:03,641 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:39:03,641 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:39:03,642 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:39:03,642 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:39:03,642 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:39:03,642 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:39:03,643 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:39:03,644 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:39:03,644 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:39:03,644 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:39:03,644 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:39:03,645 - train_models - INFO - Building model for WorkType: 211
2025-05-26 11:39:04,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:24,750 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 11:39:24,751 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 11:39:24,751 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 11:39:24,751 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 11:39:24,753 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 11:39:24,753 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 11:39:24,753 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 11:39:24,754 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 11:39:24,754 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 11:39:24,754 - train_models - INFO - Cross-validation details for 211:
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 11:39:24,756 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 11:39:24,756 - train_models - INFO - Building model for WorkType: 213
2025-05-26 11:39:25,854 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:43,858 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 11:39:43,859 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 11:39:43,861 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 11:39:43,862 - train_models - INFO - Cross-validation details for 213:
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 11:39:43,863 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 11:39:43,863 - train_models - INFO - Building model for WorkType: 214
2025-05-26 11:39:44,972 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:40:02,270 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 11:40:02,270 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 11:40:02,271 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 11:40:02,273 - train_models - INFO - Cross-validation details for 214:
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 11:40:02,275 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 11:40:02,275 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 11:40:02,275 - train_models - INFO - Building model for WorkType: 217
2025-05-26 11:40:03,370 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:40:18,360 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 11:40:18,361 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 11:40:18,361 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 11:40:18,363 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 11:40:18,363 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 11:40:18,363 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 11:40:18,364 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 11:40:18,364 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 11:40:18,364 - train_models - INFO - Cross-validation details for 217:
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 11:40:18,366 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 11:40:18,367 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 11:40:18,684 - train_models - INFO - Model files saved successfully
2025-05-26 11:40:18,684 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:40:18,687 - train_models - INFO - Model training completed successfully
2025-05-26 11:45:15,740 - train_models - INFO - Starting the model training process
2025-05-26 11:45:15,740 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:45:15,743 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:45:15,857 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 11:45:16,441 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 11:45:16,497 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 11:45:16,513 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 11:45:16,515 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:45:16,527 - train_models - INFO - Engineering features...
2025-05-26 11:45:16,915 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:45:16,945 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:45:16,948 - train_models - INFO - Creating lag features...
2025-05-26 11:45:16,958 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:45:17,117 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 11:45:17,117 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 11:45:17,127 - train_models - INFO - Found 9 unique work types
2025-05-26 11:45:17,127 - train_models - INFO - Building models for 9 work types
2025-05-26 11:45:17,127 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:45:17,128 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:45:17,128 - train_models - INFO - Building model for WorkType: 202
2025-05-26 11:45:18,458 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:45:34,980 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 11:45:34,981 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 11:45:34,981 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 11:45:34,981 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 11:45:34,983 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 11:45:34,983 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 11:45:34,983 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 11:45:34,983 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 11:45:34,983 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 11:45:34,984 - train_models - INFO - Cross-validation details for 202:
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 11:45:34,985 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 11:45:34,985 - train_models - INFO - Building model for WorkType: 203
2025-05-26 11:45:36,194 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:45:53,768 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 11:45:53,768 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 11:45:53,768 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 11:45:53,771 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 11:45:53,771 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 11:45:53,771 - train_models - INFO - Cross-validation details for 203:
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 11:45:53,773 - train_models - INFO - Building model for WorkType: 206
2025-05-26 11:45:55,343 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:18,891 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 11:46:18,891 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 11:46:18,891 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 11:46:18,892 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 11:46:18,892 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 11:46:18,892 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 11:46:18,893 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 11:46:18,893 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 11:46:18,893 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 11:46:18,894 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 11:46:18,894 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 11:46:18,894 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 11:46:18,894 - train_models - INFO - Cross-validation details for 206:
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 11:46:18,896 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 11:46:18,896 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 11:46:18,896 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:46:20,025 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:38,288 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:46:38,288 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:46:38,288 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:46:38,289 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:46:38,289 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:46:38,289 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:46:38,289 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:46:38,291 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:46:38,291 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:46:38,291 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:46:38,291 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:46:38,292 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:46:39,580 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:57,224 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:46:57,224 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:46:57,225 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:46:57,225 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:46:57,225 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:46:57,225 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:46:57,225 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:46:57,226 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:46:57,227 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:46:57,227 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:46:57,227 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:46:57,227 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:46:57,228 - train_models - INFO - Building model for WorkType: 211
2025-05-26 11:46:58,576 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:18,933 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 11:47:18,933 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 11:47:18,933 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 11:47:18,935 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 11:47:18,936 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 11:47:18,936 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 11:47:18,936 - train_models - INFO - Cross-validation details for 211:
2025-05-26 11:47:18,936 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 11:47:18,938 - train_models - INFO - Building model for WorkType: 213
2025-05-26 11:47:20,283 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:39,703 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 11:47:39,703 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 11:47:39,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 11:47:39,705 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 11:47:39,706 - train_models - INFO - Cross-validation details for 213:
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 11:47:39,707 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 11:47:39,707 - train_models - INFO - Building model for WorkType: 214
2025-05-26 11:47:40,899 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:58,381 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 11:47:58,381 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 11:47:58,381 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 11:47:58,382 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 11:47:58,382 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 11:47:58,382 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 11:47:58,384 - train_models - INFO - Cross-validation details for 214:
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 11:47:58,386 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 11:47:58,386 - train_models - INFO - Building model for WorkType: 217
2025-05-26 11:47:59,510 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:48:16,088 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 11:48:16,088 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 11:48:16,090 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 11:48:16,091 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 11:48:16,091 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 11:48:16,091 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 11:48:16,092 - train_models - INFO - Cross-validation details for 217:
2025-05-26 11:48:16,092 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 11:48:16,092 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 11:48:16,094 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 11:48:16,388 - train_models - INFO - Model files saved successfully
2025-05-26 11:48:16,388 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:48:16,392 - train_models - INFO - Model training completed successfully
2025-05-26 11:50:12,550 - train_models - INFO - Starting the model training process
2025-05-26 11:50:12,550 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:50:12,554 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:50:12,672 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-26 11:50:12,909 - train_models - INFO - Read chunk of 3052 rows
2025-05-26 11:50:12,924 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-26 11:50:12,925 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:50:12,934 - train_models - INFO - Engineering features...
2025-05-26 11:50:13,312 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:50:13,328 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:50:13,331 - train_models - INFO - Creating lag features...
2025-05-26 11:50:13,339 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:50:13,426 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-26 11:50:13,426 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-26 11:50:13,428 - train_models - INFO - Found 2 unique work types
2025-05-26 11:50:13,428 - train_models - INFO - Building models for 2 work types
2025-05-26 11:50:13,429 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:50:13,429 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:50:13,429 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:50:14,943 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:50:37,224 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:50:37,224 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:50:37,225 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:50:37,225 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:50:37,225 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:50:37,226 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:50:37,227 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:50:37,227 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:50:37,227 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:50:37,227 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:50:37,229 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:50:37,229 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:50:37,229 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:50:38,576 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:50:58,186 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:50:58,187 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:50:58,187 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:50:58,187 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:50:58,187 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:50:58,188 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:50:58,189 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:50:58,189 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:50:58,189 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:50:58,190 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:50:58,191 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:50:58,191 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:50:58,192 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-26 11:50:58,302 - train_models - INFO - Model files saved successfully
2025-05-26 11:50:58,302 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:50:58,303 - train_models - INFO - Model training completed successfully
2025-05-26 11:55:24,092 - train_models - INFO - Starting the model training process
2025-05-26 11:55:24,092 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:55:24,095 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:55:24,201 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-26 11:55:24,632 - train_models - INFO - Read chunk of 3052 rows
2025-05-26 11:55:24,648 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-26 11:55:24,649 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:55:24,658 - train_models - INFO - Engineering features...
2025-05-26 11:55:24,988 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:55:25,001 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:55:25,003 - train_models - INFO - Creating lag features...
2025-05-26 11:55:25,011 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:55:25,079 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-26 11:55:25,080 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-26 11:55:25,083 - train_models - INFO - Found 2 unique work types
2025-05-26 11:55:25,083 - train_models - INFO - Building models for 2 work types
2025-05-26 11:55:25,083 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:55:25,084 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:55:25,084 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:55:26,439 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:55:44,794 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:55:44,795 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:55:44,795 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:55:44,795 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:55:44,796 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:55:44,796 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:55:44,796 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:55:44,796 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:55:44,798 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:55:44,798 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:55:44,798 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:55:44,798 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:55:44,799 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:55:46,156 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:56:03,959 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:56:03,960 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:56:03,960 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:56:03,960 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:56:03,960 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:56:03,961 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:56:03,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:56:03,961 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:56:03,962 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:56:03,963 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:56:03,964 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:56:03,964 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:56:03,964 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-26 11:56:04,044 - train_models - INFO - Model files saved successfully
2025-05-26 11:56:04,044 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:56:04,045 - train_models - INFO - Model training completed successfully
2025-05-26 13:07:11,866 - train_models - INFO - Starting the model training process
2025-05-26 13:07:11,867 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 13:07:11,870 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 13:07:11,985 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 13:07:12,233 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 13:07:12,250 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 13:07:12,267 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 13:07:12,269 - train_models - INFO - Converting Date column to datetime format
2025-05-26 13:07:12,278 - train_models - INFO - Engineering features...
2025-05-26 13:07:12,664 - utils.feature_engineering - INFO - Engineering features
2025-05-26 13:07:12,694 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 13:07:12,699 - train_models - INFO - Creating lag features...
2025-05-26 13:07:12,709 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 13:07:12,865 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 13:07:12,866 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 13:07:12,876 - train_models - INFO - Found 9 unique work types
2025-05-26 13:07:12,876 - train_models - INFO - Building models for 9 work types
2025-05-26 13:07:12,876 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 13:07:12,877 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 13:07:12,877 - train_models - INFO - Building model for WorkType: 202
2025-05-26 13:07:14,277 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:07:30,660 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 13:07:30,660 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 13:07:30,660 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 13:07:30,662 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 13:07:30,663 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 13:07:30,663 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 13:07:30,663 - train_models - INFO - Cross-validation details for 202:
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 13:07:30,665 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 13:07:30,665 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 13:07:30,665 - train_models - INFO - Building model for WorkType: 203
2025-05-26 13:07:31,853 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:07:48,957 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 13:07:48,957 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 13:07:48,961 - train_models - INFO - Cross-validation details for 203:
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 13:07:48,962 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 13:07:48,962 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 13:07:48,962 - train_models - INFO - Building model for WorkType: 206
2025-05-26 13:07:50,470 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:14,214 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 13:08:14,214 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 13:08:14,214 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 13:08:14,215 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 13:08:14,215 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 13:08:14,215 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 13:08:14,216 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 13:08:14,216 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 13:08:14,216 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 13:08:14,217 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 13:08:14,217 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 13:08:14,217 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 13:08:14,217 - train_models - INFO - Cross-validation details for 206:
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 13:08:14,219 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 13:08:14,219 - train_models - INFO - Building model for WorkType: 209
2025-05-26 13:08:15,311 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:33,077 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 13:08:33,077 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 13:08:33,077 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 13:08:33,078 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 13:08:33,078 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 13:08:33,078 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 13:08:33,080 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 13:08:33,080 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 13:08:33,080 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 13:08:33,080 - train_models - INFO - Cross-validation details for 209:
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 13:08:33,082 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 13:08:33,082 - train_models - INFO - Building model for WorkType: 210
2025-05-26 13:08:34,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:51,397 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 13:08:51,398 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 13:08:51,398 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 13:08:51,398 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 13:08:51,398 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 13:08:51,399 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 13:08:51,399 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 13:08:51,399 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 13:08:51,401 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 13:08:51,401 - train_models - INFO - Cross-validation details for 210:
2025-05-26 13:08:51,401 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 13:08:51,401 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 13:08:51,402 - train_models - INFO - Building model for WorkType: 211
2025-05-26 13:08:52,676 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:12,003 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 13:09:12,004 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 13:09:12,004 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 13:09:12,004 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 13:09:12,006 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 13:09:12,006 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 13:09:12,006 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 13:09:12,006 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 13:09:12,007 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 13:09:12,007 - train_models - INFO - Cross-validation details for 211:
2025-05-26 13:09:12,007 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 13:09:12,007 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 13:09:12,008 - train_models - INFO - Building model for WorkType: 213
2025-05-26 13:09:13,088 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:31,027 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 13:09:31,027 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 13:09:31,027 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 13:09:31,030 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 13:09:31,030 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 13:09:31,030 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 13:09:31,030 - train_models - INFO - Cross-validation details for 213:
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 13:09:31,032 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 13:09:31,032 - train_models - INFO - Building model for WorkType: 214
2025-05-26 13:09:32,119 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:49,164 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 13:09:49,164 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 13:09:49,165 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 13:09:49,165 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 13:09:49,165 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 13:09:49,168 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 13:09:49,168 - train_models - INFO - Cross-validation details for 214:
2025-05-26 13:09:49,168 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 13:09:49,169 - train_models - INFO - Building model for WorkType: 217
2025-05-26 13:09:50,232 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:10:04,961 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 13:10:04,961 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 13:10:04,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 13:10:04,963 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 13:10:04,964 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 13:10:04,964 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 13:10:04,964 - train_models - INFO - Cross-validation details for 217:
2025-05-26 13:10:04,964 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 13:10:04,966 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 13:10:05,254 - train_models - INFO - Model files saved successfully
2025-05-26 13:10:05,254 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 13:10:05,257 - train_models - INFO - Model training completed successfully
2025-05-30 12:53:33,161 - train_models - INFO - Starting the model training process
2025-05-30 12:53:33,162 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 12:57:20,329 - train_models - INFO - Starting the model training process
2025-05-30 12:57:20,330 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 12:57:20,335 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 12:57:20,506 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            
2025-05-30 12:57:21,060 - train_models - ERROR - Error in train_from_sql: Execution failed on sql '
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")
2025-05-30 12:57:21,116 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2674, in execute
    cur.execute(sql, *args)
    ~~~~~~~~~~~^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 313, in train_from_sql
    for chunk in pd.read_sql(sql_query, conn, chunksize=CHUNK_SIZE):
                 ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 706, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2738, in read_query
    cursor = self.execute(sql, params)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2686, in execute
    raise ex from exc
pandas.errors.DatabaseError: Execution failed on sql '
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")

2025-05-30 12:57:21,117 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 12:57:49,077 - train_models - INFO - Starting the model training process
2025-05-30 12:57:49,078 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 12:57:49,087 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 12:57:49,289 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) and Date = '2024-05-01'
            
2025-05-30 12:57:49,742 - train_models - INFO - Read chunk of 4 rows
2025-05-30 12:57:49,760 - train_models - INFO - Data loaded successfully. Total rows: 4
2025-05-30 12:57:49,762 - train_models - INFO - Converting Date column to datetime format
2025-05-30 12:57:49,770 - train_models - INFO - Engineering features...
2025-05-30 12:57:50,422 - utils.feature_engineering - INFO - Engineering features
2025-05-30 12:57:50,443 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 12:57:50,445 - train_models - INFO - Creating lag features...
2025-05-30 12:57:50,456 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 12:57:50,595 - utils.feature_engineering - INFO - Lag features created. Dropped 4 rows with NaN values.
2025-05-30 12:57:50,595 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 12:57:50,611 - train_models - INFO - Found 0 unique work types
2025-05-30 12:57:50,611 - train_models - INFO - Building models for 0 work types
2025-05-30 12:57:50,611 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 12:57:50,612 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 12:57:50,612 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 12:57:51,129 - train_models - INFO - Model files saved successfully
2025-05-30 12:57:51,130 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 12:57:51,130 - train_models - INFO - Model training completed successfully
2025-05-30 13:00:08,522 - train_models - INFO - Starting the model training process
2025-05-30 13:00:08,522 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:00:08,525 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:00:08,661 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) and Date >= '2024-05-01'
            
2025-05-30 13:00:09,299 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:00:09,320 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:00:09,323 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:00:09,355 - train_models - INFO - Engineering features...
2025-05-30 13:00:09,818 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:00:09,833 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:00:09,835 - train_models - INFO - Creating lag features...
2025-05-30 13:00:09,841 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:00:09,989 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:00:09,990 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:00:09,991 - train_models - INFO - Found 0 unique work types
2025-05-30 13:00:09,991 - train_models - INFO - Building models for 0 work types
2025-05-30 13:00:09,992 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:00:09,992 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:00:09,992 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:00:10,494 - train_models - INFO - Model files saved successfully
2025-05-30 13:00:10,494 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:00:10,496 - train_models - INFO - Model training completed successfully
2025-05-30 13:02:10,785 - train_models - INFO - Starting the model training process
2025-05-30 13:02:10,786 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:02:10,789 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:02:10,932 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01'
            
2025-05-30 13:02:11,706 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:02:11,725 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:02:11,726 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:02:11,754 - train_models - INFO - Engineering features...
2025-05-30 13:02:12,299 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:02:12,311 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:02:12,313 - train_models - INFO - Creating lag features...
2025-05-30 13:02:12,321 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:02:12,436 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:02:12,437 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:02:12,438 - train_models - INFO - Found 0 unique work types
2025-05-30 13:02:12,438 - train_models - INFO - Building models for 0 work types
2025-05-30 13:02:12,439 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:02:12,439 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:02:12,439 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:02:12,917 - train_models - INFO - Model files saved successfully
2025-05-30 13:02:12,918 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:02:12,918 - train_models - INFO - Model training completed successfully
2025-05-30 13:04:26,330 - train_models - INFO - Starting the model training process
2025-05-30 13:04:26,331 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:04:26,335 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:04:26,491 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01'
            
2025-05-30 13:04:27,225 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:04:27,254 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:04:27,270 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:04:27,375 - train_models - INFO - Engineering features...
2025-05-30 13:04:27,867 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:04:27,886 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:04:27,888 - train_models - INFO - Creating lag features...
2025-05-30 13:04:27,896 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:04:28,030 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:04:28,031 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:04:28,032 - train_models - INFO - Found 0 unique work types
2025-05-30 13:04:28,033 - train_models - INFO - Building models for 0 work types
2025-05-30 13:04:28,033 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:04:28,033 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:04:28,034 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:04:28,409 - train_models - INFO - Model files saved successfully
2025-05-30 13:04:28,409 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:04:28,410 - train_models - INFO - Model training completed successfully
2025-05-30 13:05:06,115 - train_models - INFO - Starting the model training process
2025-05-30 13:05:06,116 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:05:06,124 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:05:06,318 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:05:06,752 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:05:06,774 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:05:06,775 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:05:06,812 - train_models - INFO - Engineering features...
2025-05-30 13:05:07,710 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:05:07,726 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:05:07,732 - train_models - INFO - Creating lag features...
2025-05-30 13:05:07,756 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:05:07,956 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:05:07,957 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:05:07,958 - train_models - INFO - Found 0 unique work types
2025-05-30 13:05:07,959 - train_models - INFO - Building models for 0 work types
2025-05-30 13:05:07,959 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:05:07,959 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:05:07,960 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:05:08,551 - train_models - INFO - Model files saved successfully
2025-05-30 13:05:08,552 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:05:08,553 - train_models - INFO - Model training completed successfully
2025-05-30 13:06:15,991 - train_models - INFO - Starting the model training process
2025-05-30 13:06:15,993 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:06:16,006 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:06:16,166 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:06:16,802 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:06:16,825 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:06:16,827 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:06:16,843 - train_models - INFO - Engineering features...
2025-05-30 13:06:17,281 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:06:17,302 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:06:17,333 - train_models - INFO - Creating lag features...
2025-05-30 13:06:17,343 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:06:17,514 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:06:17,514 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:06:17,516 - train_models - INFO - Found 0 unique work types
2025-05-30 13:06:17,516 - train_models - INFO - Building models for 0 work types
2025-05-30 13:06:17,517 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:06:17,517 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:06:17,517 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:06:17,805 - train_models - INFO - Model files saved successfully
2025-05-30 13:06:17,806 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:06:17,806 - train_models - INFO - Model training completed successfully
2025-05-30 13:07:25,548 - train_models - INFO - Starting the model training process
2025-05-30 13:07:25,548 - train_models - WARNING - File not found: c:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 13:07:44,172 - train_models - INFO - Starting the model training process
2025-05-30 13:07:44,173 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:07:44,176 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:07:44,305 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:07:44,830 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:07:44,854 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:07:44,855 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:07:44,867 - train_models - INFO - Engineering features...
2025-05-30 13:07:45,319 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:07:45,335 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:07:46,961 - train_models - INFO - Creating lag features...
2025-05-30 13:07:46,973 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:07:47,170 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:07:47,171 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:07:47,173 - train_models - INFO - Found 0 unique work types
2025-05-30 13:07:47,173 - train_models - INFO - Building models for 0 work types
2025-05-30 13:07:47,174 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:07:47,174 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:07:47,174 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:07:47,187 - train_models - INFO - Model files saved successfully
2025-05-30 13:07:47,187 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:07:47,189 - train_models - INFO - Model training completed successfully
2025-05-30 13:13:08,964 - train_models - INFO - Starting the model training process
2025-05-30 13:13:08,964 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:13:08,971 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:13:09,121 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:13:09,970 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:13:09,992 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:13:09,995 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:13:10,027 - train_models - INFO - Engineering features...
2025-05-30 13:13:10,770 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:13:10,803 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:13:10,806 - train_models - INFO - Creating lag features...
2025-05-30 13:13:10,820 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:13:11,033 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:13:11,033 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:13:11,035 - train_models - INFO - Found 0 unique work types
2025-05-30 13:13:11,035 - train_models - INFO - Building models for 0 work types
2025-05-30 13:13:11,036 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:13:11,036 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:13:11,036 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:13:11,491 - train_models - INFO - Model files saved successfully
2025-05-30 13:13:11,492 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:13:11,492 - train_models - INFO - Model training completed successfully
2025-05-30 13:14:38,933 - train_models - INFO - Starting the model training process
2025-05-30 13:14:38,933 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:14:38,938 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:14:39,078 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:14:39,850 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:14:39,870 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:14:39,872 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:14:39,883 - train_models - INFO - Engineering features...
2025-05-30 13:14:40,682 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:14:40,698 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:14:40,699 - train_models - INFO - Creating lag features...
2025-05-30 13:14:40,707 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:14:40,832 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:14:40,833 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:14:40,835 - train_models - INFO - Found 9 unique work types
2025-05-30 13:14:40,835 - train_models - INFO - Building models for 9 work types
2025-05-30 13:14:40,835 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:14:40,836 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:14:40,836 - train_models - INFO - Building model for WorkType: 206
2025-05-30 13:14:40,837 - train_models - WARNING - Skipping 206: Not enough data (0 records)
2025-05-30 13:14:40,837 - train_models - INFO - Building model for WorkType: 209
2025-05-30 13:14:40,839 - train_models - WARNING - Skipping 209: Not enough data (0 records)
2025-05-30 13:14:40,839 - train_models - INFO - Building model for WorkType: 211
2025-05-30 13:14:40,840 - train_models - WARNING - Skipping 211: Not enough data (0 records)
2025-05-30 13:14:40,840 - train_models - INFO - Building model for WorkType: 210
2025-05-30 13:14:40,841 - train_models - WARNING - Skipping 210: Not enough data (0 records)
2025-05-30 13:14:40,842 - train_models - INFO - Building model for WorkType: 214
2025-05-30 13:14:40,843 - train_models - WARNING - Skipping 214: Not enough data (0 records)
2025-05-30 13:14:40,843 - train_models - INFO - Building model for WorkType: 217
2025-05-30 13:14:40,844 - train_models - WARNING - Skipping 217: Not enough data (0 records)
2025-05-30 13:14:40,844 - train_models - INFO - Building model for WorkType: 202
2025-05-30 13:14:40,846 - train_models - WARNING - Skipping 202: Not enough data (0 records)
2025-05-30 13:14:40,846 - train_models - INFO - Building model for WorkType: 203
2025-05-30 13:14:40,847 - train_models - WARNING - Skipping 203: Not enough data (0 records)
2025-05-30 13:14:40,848 - train_models - INFO - Building model for WorkType: 213
2025-05-30 13:14:40,850 - train_models - WARNING - Skipping 213: Not enough data (0 records)
2025-05-30 13:14:40,850 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:14:41,322 - train_models - INFO - Model files saved successfully
2025-05-30 13:14:41,323 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:14:41,323 - train_models - INFO - Model training completed successfully
2025-05-30 13:16:27,092 - train_models - INFO - Starting the model training process
2025-05-30 13:16:27,092 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:16:27,097 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:16:27,231 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:16:27,920 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:16:27,941 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:16:27,942 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:16:27,959 - train_models - INFO - Engineering features...
2025-05-30 13:16:28,405 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:16:28,419 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:16:28,421 - train_models - INFO - Creating lag features...
2025-05-30 13:16:28,429 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:16:28,567 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:16:28,567 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:16:28,569 - train_models - ERROR - Error in train_from_sql: 'DataFrame' object has no attribute 'Head'
2025-05-30 13:16:28,658 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 362, in train_from_sql
    print('XXX-X ', lag_features_df.Head())
                    ^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'Head'. Did you mean: 'head'?

2025-05-30 13:16:28,660 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 13:16:55,904 - train_models - INFO - Starting the model training process
2025-05-30 13:16:55,904 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:16:55,908 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:16:56,177 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:16:57,097 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:16:57,116 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:16:57,118 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:16:57,133 - train_models - INFO - Engineering features...
2025-05-30 13:16:57,555 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:16:57,570 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:16:57,572 - train_models - INFO - Creating lag features...
2025-05-30 13:16:57,580 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:16:57,725 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:16:57,726 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:16:57,734 - train_models - INFO - Found 0 unique work types
2025-05-30 13:16:57,735 - train_models - INFO - Building models for 0 work types
2025-05-30 13:16:57,736 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:16:57,737 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:16:57,739 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:16:58,148 - train_models - INFO - Model files saved successfully
2025-05-30 13:16:58,148 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:16:58,149 - train_models - INFO - Model training completed successfully
2025-05-30 13:44:28,247 - train_models - INFO - Starting the model training process
2025-05-30 13:44:28,247 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:44:28,251 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:44:28,549 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:44:28,949 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:44:28,966 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:44:28,968 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:44:28,976 - train_models - INFO - Engineering features...
2025-05-30 13:44:29,428 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:44:29,440 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:44:29,442 - train_models - INFO - Creating lag features...
2025-05-30 13:44:29,449 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:44:29,565 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:44:29,565 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:44:29,569 - train_models - INFO - Found 0 unique work types
2025-05-30 13:44:29,569 - train_models - INFO - Building models for 0 work types
2025-05-30 13:44:29,569 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:44:29,570 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:44:29,570 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:44:29,824 - train_models - INFO - Model files saved successfully
2025-05-30 13:44:29,824 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:44:29,825 - train_models - INFO - Model training completed successfully
2025-05-30 13:45:08,431 - train_models - INFO - Starting the model training process
2025-05-30 13:45:08,432 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:45:08,434 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:45:08,548 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:45:08,944 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:45:08,960 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:45:08,961 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:45:08,968 - train_models - INFO - Engineering features...
2025-05-30 13:45:09,325 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:45:09,339 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:45:09,342 - train_models - INFO - Creating lag features...
2025-05-30 13:45:09,350 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:45:09,470 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:45:09,470 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:45:09,473 - train_models - INFO - Found 0 unique work types
2025-05-30 13:45:09,474 - train_models - INFO - Building models for 0 work types
2025-05-30 13:45:09,474 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:45:09,474 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:45:09,475 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:45:09,713 - train_models - INFO - Model files saved successfully
2025-05-30 13:45:09,714 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:45:09,714 - train_models - INFO - Model training completed successfully
2025-05-30 13:45:34,889 - train_models - INFO - Starting the model training process
2025-05-30 13:45:34,890 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:45:34,893 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:45:35,007 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:45:35,396 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:45:35,411 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:45:35,412 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:45:35,422 - train_models - INFO - Engineering features...
2025-05-30 13:45:35,750 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:45:35,762 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:45:35,764 - train_models - INFO - Creating lag features...
2025-05-30 13:45:35,771 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:45:35,885 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:45:35,885 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:45:35,888 - train_models - INFO - Found 0 unique work types
2025-05-30 13:45:35,888 - train_models - INFO - Building models for 0 work types
2025-05-30 13:45:35,888 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:45:35,889 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:45:35,889 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:45:36,113 - train_models - INFO - Model files saved successfully
2025-05-30 13:45:36,114 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:45:36,114 - train_models - INFO - Model training completed successfully
2025-05-30 13:46:21,908 - train_models - INFO - Starting the model training process
2025-05-30 13:46:21,908 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:46:21,911 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:46:22,023 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:46:22,422 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:46:22,441 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:46:22,442 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:46:22,455 - train_models - INFO - Engineering features...
2025-05-30 13:46:22,789 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:46:22,801 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:46:22,804 - train_models - INFO - Creating lag features...
2025-05-30 13:46:22,811 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:46:22,929 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:46:22,929 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:46:22,932 - train_models - INFO - Found 0 unique work types
2025-05-30 13:46:22,932 - train_models - INFO - Building models for 0 work types
2025-05-30 13:46:22,933 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:46:22,933 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:46:22,934 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:46:23,204 - train_models - INFO - Model files saved successfully
2025-05-30 13:46:23,204 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:46:23,205 - train_models - INFO - Model training completed successfully
2025-05-30 13:48:04,297 - train_models - INFO - Starting the model training process
2025-05-30 13:48:04,297 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:48:04,300 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:48:04,420 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:48:04,634 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:48:04,650 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:48:04,651 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:48:04,656 - train_models - INFO - Engineering features...
2025-05-30 13:48:05,035 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:48:05,063 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:48:05,066 - train_models - INFO - Creating lag features...
2025-05-30 13:48:05,077 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:48:05,190 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:48:05,190 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:48:05,194 - train_models - INFO - Found 0 unique work types
2025-05-30 13:48:05,194 - train_models - INFO - Building models for 0 work types
2025-05-30 13:48:05,194 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:48:05,195 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:48:05,195 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:48:05,438 - train_models - INFO - Model files saved successfully
2025-05-30 13:48:05,439 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:48:05,439 - train_models - INFO - Model training completed successfully
2025-05-30 13:50:19,738 - train_models - INFO - Starting the model training process
2025-05-30 13:50:19,738 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:50:19,741 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:50:19,860 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:50:20,322 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:50:20,338 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:50:20,340 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:50:20,354 - train_models - INFO - Engineering features...
2025-05-30 13:50:20,749 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:50:20,765 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:50:20,768 - train_models - INFO - Creating lag features...
2025-05-30 13:50:20,775 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:50:20,896 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:50:20,896 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:50:20,899 - train_models - INFO - Found 0 unique work types
2025-05-30 13:50:20,899 - train_models - INFO - Building models for 0 work types
2025-05-30 13:50:20,899 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:50:20,900 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:50:20,900 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:50:21,135 - train_models - INFO - Model files saved successfully
2025-05-30 13:50:21,136 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:50:21,137 - train_models - INFO - Model training completed successfully
2025-05-30 13:54:59,828 - train_models - INFO - Starting the model training process
2025-05-30 13:54:59,828 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:54:59,831 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:54:59,947 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:55:00,345 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:55:00,360 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:55:00,361 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:55:00,366 - train_models - INFO - Engineering features...
2025-05-30 13:55:00,785 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:55:00,798 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:55:00,801 - train_models - INFO - Creating lag features...
2025-05-30 13:55:00,806 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:55:00,832 - utils.feature_engineering - ERROR - Error creating lag features: 'DataFrame' object has no attribute 'HEAD'
2025-05-30 13:55:00,877 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 213, in create_lag_features
    print('XXX-X ',daily_data.HEAD())
                   ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'HEAD'

2025-05-30 13:55:00,878 - train_models - ERROR - Error in train_from_sql: Failed to create lag features: 'DataFrame' object has no attribute 'HEAD'
2025-05-30 13:55:00,881 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 213, in create_lag_features
    print('XXX-X ',daily_data.HEAD())
                   ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'HEAD'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 359, in train_from_sql
    lag_features_df = create_lag_features(feature_df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 277, in create_lag_features
    raise Exception(f"Failed to create lag features: {str(e)}")
Exception: Failed to create lag features: 'DataFrame' object has no attribute 'HEAD'

2025-05-30 13:55:00,882 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 13:55:20,926 - train_models - INFO - Starting the model training process
2025-05-30 13:55:20,926 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:55:20,930 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:55:21,053 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:55:21,452 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:55:21,469 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:55:21,470 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:55:21,481 - train_models - INFO - Engineering features...
2025-05-30 13:55:21,980 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:55:21,991 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:55:21,993 - train_models - INFO - Creating lag features...
2025-05-30 13:55:22,001 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:55:22,179 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:55:22,180 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:55:22,182 - train_models - INFO - Found 0 unique work types
2025-05-30 13:55:22,183 - train_models - INFO - Building models for 0 work types
2025-05-30 13:55:22,183 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:55:22,183 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:55:22,184 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:55:22,433 - train_models - INFO - Model files saved successfully
2025-05-30 13:55:22,433 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:55:22,434 - train_models - INFO - Model training completed successfully
2025-05-30 13:57:28,092 - train_models - INFO - Starting the model training process
2025-05-30 13:57:28,093 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:57:28,096 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:57:28,206 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:57:28,608 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:57:28,623 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:57:28,624 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:57:28,634 - train_models - INFO - Engineering features...
2025-05-30 13:57:29,192 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:57:29,210 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:57:29,213 - train_models - INFO - Creating lag features...
2025-05-30 13:57:29,220 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:57:29,368 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:57:29,369 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:57:29,372 - train_models - INFO - Found 0 unique work types
2025-05-30 13:57:29,372 - train_models - INFO - Building models for 0 work types
2025-05-30 13:57:29,372 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:57:29,373 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:57:29,373 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:57:29,624 - train_models - INFO - Model files saved successfully
2025-05-30 13:57:29,625 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:57:29,625 - train_models - INFO - Model training completed successfully
2025-05-30 13:57:59,357 - train_models - INFO - Starting the model training process
2025-05-30 13:57:59,357 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:57:59,360 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:57:59,480 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:57:59,698 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:57:59,714 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:57:59,715 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:57:59,721 - train_models - INFO - Engineering features...
2025-05-30 13:58:00,106 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:58:00,131 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:58:00,134 - train_models - INFO - Creating lag features...
2025-05-30 13:58:00,142 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:58:00,272 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:58:00,273 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:58:00,275 - train_models - INFO - Found 0 unique work types
2025-05-30 13:58:00,276 - train_models - INFO - Building models for 0 work types
2025-05-30 13:58:00,276 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:58:00,276 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:58:00,277 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:58:00,507 - train_models - INFO - Model files saved successfully
2025-05-30 13:58:00,507 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:58:00,507 - train_models - INFO - Model training completed successfully
2025-05-30 13:58:40,891 - train_models - INFO - Starting the model training process
2025-05-30 13:58:40,892 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:58:40,896 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:58:41,005 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:58:41,410 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:58:41,427 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:58:41,429 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:58:41,436 - train_models - INFO - Engineering features...
2025-05-30 13:58:41,761 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:58:41,772 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:58:41,775 - train_models - INFO - Creating lag features...
2025-05-30 13:58:41,783 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:58:41,917 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:58:41,917 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:58:41,920 - train_models - INFO - Found 0 unique work types
2025-05-30 13:58:41,920 - train_models - INFO - Building models for 0 work types
2025-05-30 13:58:41,921 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:58:41,921 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:58:41,922 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:58:42,162 - train_models - INFO - Model files saved successfully
2025-05-30 13:58:42,162 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:58:42,163 - train_models - INFO - Model training completed successfully
2025-05-30 13:59:25,045 - train_models - INFO - Starting the model training process
2025-05-30 13:59:25,046 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:59:25,049 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:59:25,158 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:59:25,542 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:59:25,559 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:59:25,560 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:59:25,570 - train_models - INFO - Engineering features...
2025-05-30 13:59:25,971 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:59:25,985 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:59:25,986 - train_models - INFO - Creating lag features...
2025-05-30 13:59:25,994 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:59:26,140 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:59:26,141 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:59:26,144 - train_models - INFO - Found 0 unique work types
2025-05-30 13:59:26,144 - train_models - INFO - Building models for 0 work types
2025-05-30 13:59:26,144 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:59:26,145 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:59:26,145 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:59:26,379 - train_models - INFO - Model files saved successfully
2025-05-30 13:59:26,379 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:59:26,380 - train_models - INFO - Model training completed successfully
2025-05-30 14:00:06,876 - train_models - INFO - Starting the model training process
2025-05-30 14:00:06,876 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:00:06,879 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:00:06,986 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:00:07,376 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:00:07,391 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:00:07,392 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:00:07,397 - train_models - INFO - Engineering features...
2025-05-30 14:00:07,800 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:00:07,813 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:00:07,815 - train_models - INFO - Creating lag features...
2025-05-30 14:00:07,822 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:00:07,963 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:00:07,964 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:00:07,967 - train_models - INFO - Found 0 unique work types
2025-05-30 14:00:07,967 - train_models - INFO - Building models for 0 work types
2025-05-30 14:00:07,968 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:00:07,968 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:00:07,968 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:00:08,203 - train_models - INFO - Model files saved successfully
2025-05-30 14:00:08,203 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:00:08,204 - train_models - INFO - Model training completed successfully
2025-05-30 14:00:28,063 - train_models - INFO - Starting the model training process
2025-05-30 14:00:28,063 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:00:28,066 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:00:28,180 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:00:28,575 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:00:28,591 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:00:28,593 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:00:28,605 - train_models - INFO - Engineering features...
2025-05-30 14:00:28,948 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:00:28,962 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:00:28,964 - train_models - INFO - Creating lag features...
2025-05-30 14:00:28,971 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:00:29,118 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:00:29,118 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:00:29,121 - train_models - INFO - Found 0 unique work types
2025-05-30 14:00:29,122 - train_models - INFO - Building models for 0 work types
2025-05-30 14:00:29,122 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:00:29,122 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:00:29,123 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:00:29,364 - train_models - INFO - Model files saved successfully
2025-05-30 14:00:29,364 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:00:29,365 - train_models - INFO - Model training completed successfully
2025-05-30 14:01:13,855 - train_models - INFO - Starting the model training process
2025-05-30 14:01:13,855 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:01:13,858 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:01:13,983 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:01:14,391 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:01:14,408 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:01:14,409 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:01:14,422 - train_models - INFO - Engineering features...
2025-05-30 14:01:14,764 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:01:14,786 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:01:14,789 - train_models - INFO - Creating lag features...
2025-05-30 14:01:14,800 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:01:14,979 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:01:14,979 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:01:14,981 - train_models - INFO - Found 0 unique work types
2025-05-30 14:01:14,981 - train_models - INFO - Building models for 0 work types
2025-05-30 14:01:14,981 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:01:14,982 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:01:14,982 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:01:15,205 - train_models - INFO - Model files saved successfully
2025-05-30 14:01:15,205 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:01:15,206 - train_models - INFO - Model training completed successfully
2025-05-30 14:02:41,569 - train_models - INFO - Starting the model training process
2025-05-30 14:02:41,569 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:02:41,572 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:02:41,684 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:02:42,075 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:02:42,090 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:02:42,091 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:02:42,097 - train_models - INFO - Engineering features...
2025-05-30 14:02:42,436 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:02:42,449 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:02:42,450 - train_models - INFO - Creating lag features...
2025-05-30 14:02:42,457 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:02:42,578 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:02:42,579 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:02:42,582 - train_models - INFO - Found 0 unique work types
2025-05-30 14:02:42,582 - train_models - INFO - Building models for 0 work types
2025-05-30 14:02:42,583 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:02:42,583 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:02:42,584 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:02:42,823 - train_models - INFO - Model files saved successfully
2025-05-30 14:02:42,823 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:02:42,824 - train_models - INFO - Model training completed successfully
2025-05-30 14:03:51,753 - train_models - INFO - Starting the model training process
2025-05-30 14:03:51,754 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:03:51,757 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:03:51,874 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:03:52,289 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:03:52,306 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:03:52,307 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:03:52,316 - train_models - INFO - Engineering features...
2025-05-30 14:03:52,728 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:03:52,740 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:03:52,742 - train_models - INFO - Creating lag features...
2025-05-30 14:03:52,750 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:03:52,873 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:03:52,873 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:03:52,878 - train_models - INFO - Found 0 unique work types
2025-05-30 14:03:52,878 - train_models - INFO - Building models for 0 work types
2025-05-30 14:03:52,878 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:03:52,879 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:03:52,879 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:03:53,139 - train_models - INFO - Model files saved successfully
2025-05-30 14:03:53,140 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:03:53,141 - train_models - INFO - Model training completed successfully
2025-05-30 14:05:03,605 - train_models - INFO - Starting the model training process
2025-05-30 14:05:03,605 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:05:03,608 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:05:03,729 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:05:04,126 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:05:04,143 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:05:04,145 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:05:04,154 - train_models - INFO - Engineering features...
2025-05-30 14:05:04,564 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:05:04,576 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:05:04,579 - train_models - INFO - Creating lag features...
2025-05-30 14:05:04,587 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:05:04,744 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:05:04,744 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:05:04,748 - train_models - INFO - Found 0 unique work types
2025-05-30 14:05:04,748 - train_models - INFO - Building models for 0 work types
2025-05-30 14:05:04,748 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:05:04,749 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:05:04,749 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:05:04,993 - train_models - INFO - Model files saved successfully
2025-05-30 14:05:04,993 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:05:04,994 - train_models - INFO - Model training completed successfully
2025-05-30 14:07:34,995 - train_models - INFO - Starting the model training process
2025-05-30 14:07:34,995 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:07:34,998 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:07:35,149 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:07:35,543 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:07:35,559 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:07:35,561 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:07:35,570 - train_models - INFO - Engineering features...
2025-05-30 14:07:35,980 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:07:35,991 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:07:35,994 - train_models - INFO - Creating lag features...
2025-05-30 14:07:36,000 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:07:36,153 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:07:36,154 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:07:36,157 - train_models - INFO - Found 0 unique work types
2025-05-30 14:07:36,158 - train_models - INFO - Building models for 0 work types
2025-05-30 14:07:36,158 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:07:36,159 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:07:36,159 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:07:36,406 - train_models - INFO - Model files saved successfully
2025-05-30 14:07:36,406 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:07:36,407 - train_models - INFO - Model training completed successfully
2025-05-30 14:13:31,309 - train_models - INFO - Starting the model training process
2025-05-30 14:13:31,310 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:13:31,313 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:13:31,442 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:13:31,875 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:13:31,891 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:13:31,892 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:13:31,900 - train_models - INFO - Engineering features...
2025-05-30 14:13:32,357 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:13:32,390 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:13:32,392 - train_models - INFO - Creating lag features...
2025-05-30 14:13:32,404 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:13:35,792 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:13:35,793 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:13:35,796 - train_models - INFO - Found 0 unique work types
2025-05-30 14:13:35,796 - train_models - INFO - Building models for 0 work types
2025-05-30 14:13:35,797 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:13:35,797 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:13:35,798 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:13:35,822 - train_models - INFO - Model files saved successfully
2025-05-30 14:13:35,823 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:13:35,824 - train_models - INFO - Model training completed successfully
2025-05-30 14:18:26,991 - train_models - INFO - Starting the model training process
2025-05-30 14:18:26,991 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:18:26,994 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:18:27,110 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:18:27,515 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:18:27,531 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:18:27,533 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:18:27,544 - train_models - INFO - Engineering features...
2025-05-30 14:18:28,014 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:18:28,027 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:18:28,029 - train_models - INFO - Creating lag features...
2025-05-30 14:18:28,035 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:18:28,195 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:18:28,195 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:18:28,198 - train_models - INFO - Found 0 unique work types
2025-05-30 14:18:28,199 - train_models - INFO - Building models for 0 work types
2025-05-30 14:18:28,199 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:18:28,199 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:18:28,200 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:18:28,469 - train_models - INFO - Model files saved successfully
2025-05-30 14:18:28,469 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:18:28,470 - train_models - INFO - Model training completed successfully
2025-05-30 14:21:08,900 - train_models - INFO - Starting the model training process
2025-05-30 14:21:08,900 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:21:08,904 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:21:09,011 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:21:09,426 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:21:09,443 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:21:09,444 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:21:09,453 - train_models - INFO - Engineering features...
2025-05-30 14:21:09,860 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:21:09,874 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:21:09,877 - train_models - INFO - Creating lag features...
2025-05-30 14:21:09,883 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:21:10,032 - utils.feature_engineering - INFO - Lag features created. Dropped 273 2508 rows with NaN values.
2025-05-30 14:21:10,032 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:21:10,037 - train_models - INFO - Found 0 unique work types
2025-05-30 14:21:10,037 - train_models - INFO - Building models for 0 work types
2025-05-30 14:21:10,037 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:21:10,038 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:21:10,038 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:21:10,288 - train_models - INFO - Model files saved successfully
2025-05-30 14:21:10,288 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:21:10,289 - train_models - INFO - Model training completed successfully
2025-05-30 14:26:06,135 - train_models - INFO - Starting the model training process
2025-05-30 14:26:06,136 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:26:06,140 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:26:06,267 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:26:06,676 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:26:06,694 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:26:06,695 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:26:06,703 - train_models - INFO - Engineering features...
2025-05-30 14:26:07,148 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:26:07,164 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:26:07,166 - train_models - INFO - Creating lag features...
2025-05-30 14:26:07,172 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:26:07,466 - utils.feature_engineering - INFO - Lag features created. Dropped 273 320 rows with NaN values.
2025-05-30 14:26:07,466 - utils.feature_engineering - INFO - Final shape: (2188, 71)
2025-05-30 14:26:07,526 - train_models - INFO - Found 9 unique work types
2025-05-30 14:26:07,527 - train_models - INFO - Building models for 9 work types
2025-05-30 14:26:07,527 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:26:07,527 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:26:07,527 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:26:08,062 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:11,764 - train_models - INFO - Model for 202 - MAE: 0.4370, RMSE: 0.5447, R²: 0.3888, MAPE: 21.40%
2025-05-30 14:26:11,764 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:26:11,764 - train_models - INFO -   NoOfMan_7day_trend: 0.2539
2025-05-30 14:26:11,764 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2422
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1521
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_1day_trend: 0.0798
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0743
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_lag_7: 0.0359
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_lag_1: 0.0248
2025-05-30 14:26:11,766 - train_models - INFO -   Relative_Quantity: 0.0247
2025-05-30 14:26:11,766 - train_models - INFO -   Hours_per_Quantity: 0.0125
2025-05-30 14:26:11,766 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0123
2025-05-30 14:26:11,766 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 1: MAE=0.6832, RMSE=0.8306, R²=0.0214, MAPE=44.63%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 2: MAE=0.5031, RMSE=0.6078, R²=-0.2087, MAPE=13.78%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 3: MAE=0.3501, RMSE=0.4301, R²=0.7068, MAPE=12.64%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 4: MAE=0.3514, RMSE=0.4675, R²=0.6735, MAPE=18.46%
2025-05-30 14:26:11,768 - train_models - INFO -   Fold 5: MAE=0.2970, RMSE=0.3876, R²=0.7508, MAPE=17.48%
2025-05-30 14:26:11,768 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:26:12,028 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:15,779 - train_models - INFO - Model for 203 - MAE: 0.4061, RMSE: 0.5467, R²: 0.6239, MAPE: 8.79%
2025-05-30 14:26:15,779 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_7day_trend: 0.3821
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_lag_7: 0.1570
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_1day_trend: 0.0941
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0866
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0801
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_lag_1: 0.0516
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0434
2025-05-30 14:26:15,782 - train_models - INFO -   Relative_Quantity: 0.0096
2025-05-30 14:26:15,782 - train_models - INFO -   Quantity_7day_trend: 0.0080
2025-05-30 14:26:15,782 - train_models - INFO -   Quantity_1day_trend: 0.0077
2025-05-30 14:26:15,783 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 1: MAE=0.5195, RMSE=0.6445, R²=0.4529, MAPE=10.74%
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 2: MAE=0.4008, RMSE=0.4868, R²=0.5832, MAPE=8.19%
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 3: MAE=0.4977, RMSE=0.6484, R²=0.6028, MAPE=10.99%
2025-05-30 14:26:15,784 - train_models - INFO -   Fold 4: MAE=0.3272, RMSE=0.4170, R²=0.7747, MAPE=8.82%
2025-05-30 14:26:15,784 - train_models - INFO -   Fold 5: MAE=0.2854, RMSE=0.5368, R²=0.7061, MAPE=5.21%
2025-05-30 14:26:15,784 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:26:16,101 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:21,066 - train_models - INFO - Model for 206 - MAE: 2.3149, RMSE: 3.0920, R²: 0.8877, MAPE: 20.42%
2025-05-30 14:26:21,067 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:26:21,067 - train_models - INFO -   Relative_Quantity: 0.6697
2025-05-30 14:26:21,067 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1990
2025-05-30 14:26:21,067 - train_models - INFO -   Hours_per_Quantity: 0.0173
2025-05-30 14:26:21,067 - train_models - INFO -   Quantity_per_Worker: 0.0156
2025-05-30 14:26:21,068 - train_models - INFO -   NoOfMan_lag_7: 0.0141
2025-05-30 14:26:21,068 - train_models - INFO -   Quantity_same_dow_lag: 0.0125
2025-05-30 14:26:21,068 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0115
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_1day_trend: 0.0089
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_lag_1: 0.0058
2025-05-30 14:26:21,069 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 1: MAE=1.9725, RMSE=2.6428, R²=0.9040, MAPE=41.39%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 2: MAE=4.1789, RMSE=5.4720, R²=0.7532, MAPE=18.18%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 3: MAE=3.0870, RMSE=4.0498, R²=0.8985, MAPE=27.87%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 4: MAE=1.2587, RMSE=1.7882, R²=0.9371, MAPE=7.93%
2025-05-30 14:26:21,071 - train_models - INFO -   Fold 5: MAE=1.0774, RMSE=1.5070, R²=0.9456, MAPE=6.71%
2025-05-30 14:26:21,071 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:26:21,351 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:26,499 - train_models - INFO - Model for 209 - MAE: 1.0513, RMSE: 1.5231, R²: 0.8668, MAPE: 13.62%
2025-05-30 14:26:26,499 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:26:26,500 - train_models - INFO -   Relative_Quantity: 0.7998
2025-05-30 14:26:26,500 - train_models - INFO -   Hours_per_Quantity: 0.0436
2025-05-30 14:26:26,500 - train_models - INFO -   Quantity_rolling_mean_7: 0.0336
2025-05-30 14:26:26,501 - train_models - INFO -   Quantity_per_Worker: 0.0327
2025-05-30 14:26:26,501 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0233
2025-05-30 14:26:26,501 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0217
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_lag_3: 0.0076
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0056
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0025
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0025
2025-05-30 14:26:26,503 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:26:26,503 - train_models - INFO -   Fold 1: MAE=1.0165, RMSE=1.4209, R²=0.8762, MAPE=15.13%
2025-05-30 14:26:26,503 - train_models - INFO -   Fold 2: MAE=1.2161, RMSE=1.9983, R²=0.8897, MAPE=13.27%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 3: MAE=1.7240, RMSE=2.5080, R²=0.8868, MAPE=20.18%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 4: MAE=0.6147, RMSE=0.7672, R²=0.8898, MAPE=9.16%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 5: MAE=0.6853, RMSE=0.9214, R²=0.7917, MAPE=10.34%
2025-05-30 14:26:26,504 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:26:26,800 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:30,900 - train_models - INFO - Model for 210 - MAE: 1.0684, RMSE: 1.5436, R²: 0.8374, MAPE: 14.93%
2025-05-30 14:26:30,900 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:26:30,901 - train_models - INFO -   Relative_Quantity: 0.8227
2025-05-30 14:26:30,901 - train_models - INFO -   Hours_per_Quantity: 0.0274
2025-05-30 14:26:30,901 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0256
2025-05-30 14:26:30,901 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0247
2025-05-30 14:26:30,901 - train_models - INFO -   Quantity_per_Worker: 0.0203
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0141
2025-05-30 14:26:30,902 - train_models - INFO -   SystemHours_per_Quantity: 0.0091
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_1day_trend: 0.0090
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_7day_trend: 0.0045
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0041
2025-05-30 14:26:30,903 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 1: MAE=0.8580, RMSE=1.1201, R²=0.8885, MAPE=16.99%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 2: MAE=1.4346, RMSE=2.0930, R²=0.7613, MAPE=17.99%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 3: MAE=2.0236, RMSE=3.1549, R²=0.7538, MAPE=20.85%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 4: MAE=0.5838, RMSE=0.7421, R²=0.8731, MAPE=11.23%
2025-05-30 14:26:30,904 - train_models - INFO -   Fold 5: MAE=0.4423, RMSE=0.6077, R²=0.9103, MAPE=7.58%
2025-05-30 14:26:30,904 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:26:31,181 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:35,240 - train_models - INFO - Model for 211 - MAE: 1.2977, RMSE: 1.6444, R²: 0.6187, MAPE: 24.26%
2025-05-30 14:26:35,240 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:26:35,241 - train_models - INFO -   Relative_Quantity: 0.4600
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1435
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_7day_trend: 0.1119
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0799
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_1day_trend: 0.0554
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_lag_7: 0.0211
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0184
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_lag_1: 0.0170
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0094
2025-05-30 14:26:35,243 - train_models - INFO -   Quantity_rolling_mean_7: 0.0092
2025-05-30 14:26:35,243 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 1: MAE=2.1205, RMSE=2.5756, R²=-0.0038, MAPE=28.27%
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 2: MAE=1.7778, RMSE=2.1498, R²=0.6232, MAPE=36.58%
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 3: MAE=1.1830, RMSE=1.6672, R²=0.7294, MAPE=28.81%
2025-05-30 14:26:35,244 - train_models - INFO -   Fold 4: MAE=0.6881, RMSE=0.8603, R²=0.8317, MAPE=8.48%
2025-05-30 14:26:35,244 - train_models - INFO -   Fold 5: MAE=0.7192, RMSE=0.9692, R²=0.9133, MAPE=19.17%
2025-05-30 14:26:35,244 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:26:35,623 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:39,436 - train_models - INFO - Model for 213 - MAE: 0.5635, RMSE: 0.7353, R²: 0.5260, MAPE: 19.23%
2025-05-30 14:26:39,436 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:26:39,437 - train_models - INFO -   Relative_Quantity: 0.7322
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0395
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_7day_trend: 0.0356
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0305
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_1day_trend: 0.0268
2025-05-30 14:26:39,438 - train_models - INFO -   Hours_per_Quantity: 0.0164
2025-05-30 14:26:39,438 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0139
2025-05-30 14:26:39,438 - train_models - INFO -   Quantity_per_Worker: 0.0127
2025-05-30 14:26:39,438 - train_models - INFO -   Quantity_same_dow_lag: 0.0078
2025-05-30 14:26:39,439 - train_models - INFO -   NoOfMan_lag_3: 0.0072
2025-05-30 14:26:39,439 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 1: MAE=0.9961, RMSE=1.2010, R²=0.3235, MAPE=24.52%
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 2: MAE=0.4934, RMSE=0.6980, R²=0.8192, MAPE=18.10%
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 3: MAE=0.5072, RMSE=0.7223, R²=0.7400, MAPE=13.08%
2025-05-30 14:26:39,440 - train_models - INFO -   Fold 4: MAE=0.4489, RMSE=0.5864, R²=0.1588, MAPE=21.32%
2025-05-30 14:26:39,440 - train_models - INFO -   Fold 5: MAE=0.3718, RMSE=0.4688, R²=0.5886, MAPE=19.10%
2025-05-30 14:26:39,440 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:26:39,701 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:43,699 - train_models - INFO - Model for 214 - MAE: 0.9986, RMSE: 1.2457, R²: 0.5877, MAPE: 21.43%
2025-05-30 14:26:43,699 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:26:43,699 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3043
2025-05-30 14:26:43,699 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2584
2025-05-30 14:26:43,700 - train_models - INFO -   Relative_Quantity: 0.1744
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_7day_trend: 0.0587
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_1day_trend: 0.0487
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0236
2025-05-30 14:26:43,700 - train_models - INFO -   Hours_per_Quantity: 0.0131
2025-05-30 14:26:43,701 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0127
2025-05-30 14:26:43,701 - train_models - INFO -   Quantity_per_Worker: 0.0125
2025-05-30 14:26:43,701 - train_models - INFO -   NoOfMan_lag_1: 0.0116
2025-05-30 14:26:43,701 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:26:43,701 - train_models - INFO -   Fold 1: MAE=1.0479, RMSE=1.2443, R²=0.5623, MAPE=15.32%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 2: MAE=1.7898, RMSE=2.2686, R²=0.3783, MAPE=41.57%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 3: MAE=0.8518, RMSE=1.1146, R²=0.8680, MAPE=15.35%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 4: MAE=0.8274, RMSE=0.9411, R²=0.3133, MAPE=26.23%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 5: MAE=0.4761, RMSE=0.6598, R²=0.8166, MAPE=8.69%
2025-05-30 14:26:43,703 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:26:44,074 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:47,573 - train_models - INFO - Model for 217 - MAE: 0.7324, RMSE: 1.0014, R²: 0.6865, MAPE: 25.05%
2025-05-30 14:26:47,574 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:26:47,574 - train_models - INFO -   Relative_Quantity: 0.5540
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_7day_trend: 0.0762
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0586
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_1day_trend: 0.0537
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0503
2025-05-30 14:26:47,575 - train_models - INFO -   Hours_per_Quantity: 0.0426
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0402
2025-05-30 14:26:47,575 - train_models - INFO -   Quantity_per_Worker: 0.0322
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_lag_1: 0.0111
2025-05-30 14:26:47,575 - train_models - INFO -   Quantity_rolling_mean_7: 0.0093
2025-05-30 14:26:47,576 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 1: MAE=0.6824, RMSE=0.9047, R²=0.7039, MAPE=27.62%
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 2: MAE=0.6725, RMSE=0.7898, R²=0.5255, MAPE=19.90%
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 3: MAE=1.0583, RMSE=1.5943, R²=0.5939, MAPE=35.66%
2025-05-30 14:26:47,577 - train_models - INFO -   Fold 4: MAE=0.7917, RMSE=0.9984, R²=0.7799, MAPE=21.89%
2025-05-30 14:26:47,577 - train_models - INFO -   Fold 5: MAE=0.4571, RMSE=0.7199, R²=0.8293, MAPE=20.19%
2025-05-30 14:26:47,577 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:26:47,697 - train_models - INFO - Model files saved successfully
2025-05-30 14:26:47,697 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:26:47,698 - train_models - INFO - Model training completed successfully
2025-05-30 14:32:04,416 - train_models - INFO - Starting the model training process
2025-05-30 14:32:04,417 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:32:04,420 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:32:04,528 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:32:04,929 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:32:04,945 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:32:04,946 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:32:04,952 - train_models - INFO - Engineering features...
2025-05-30 14:32:05,456 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:32:05,469 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:32:05,471 - train_models - INFO - Creating lag features...
2025-05-30 14:32:05,477 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:32:05,682 - utils.feature_engineering - INFO - Lag features created. Dropped AMILA 0 rows with NaN values.
2025-05-30 14:32:05,682 - utils.feature_engineering - INFO - Final shape: (2508, 71)
2025-05-30 14:32:05,685 - train_models - INFO - Found 9 unique work types
2025-05-30 14:32:05,685 - train_models - INFO - Building models for 9 work types
2025-05-30 14:32:05,686 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:32:05,686 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:32:05,686 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:32:06,236 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:10,535 - train_models - INFO - Model for 202 - MAE: 0.3825, RMSE: 0.4959, R²: 0.6849, MAPE: 17.38%
2025-05-30 14:32:10,535 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:32:10,535 - train_models - INFO -   NoOfMan_7day_trend: 0.2930
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2193
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1087
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1004
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_1day_trend: 0.0888
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_lag_7: 0.0421
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_lag_1: 0.0279
2025-05-30 14:32:10,537 - train_models - INFO -   Relative_Quantity: 0.0168
2025-05-30 14:32:10,538 - train_models - INFO -   Hours_per_Quantity: 0.0142
2025-05-30 14:32:10,538 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0127
2025-05-30 14:32:10,538 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 1: MAE=0.4484, RMSE=0.5973, R²=0.5319, MAPE=15.61%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 2: MAE=0.4518, RMSE=0.5734, R²=0.7260, MAPE=24.04%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 3: MAE=0.3600, RMSE=0.4430, R²=0.6620, MAPE=12.58%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 4: MAE=0.3601, RMSE=0.4903, R²=0.7416, MAPE=19.39%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 5: MAE=0.2920, RMSE=0.3754, R²=0.7631, MAPE=15.25%
2025-05-30 14:32:10,540 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:32:10,840 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:15,268 - train_models - INFO - Model for 203 - MAE: 0.4452, RMSE: 0.6032, R²: 0.4934, MAPE: 11.46%
2025-05-30 14:32:15,268 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:32:15,268 - train_models - INFO -   NoOfMan_7day_trend: 0.4025
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_lag_7: 0.1357
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_1day_trend: 0.1054
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0762
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0716
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_lag_1: 0.0472
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0445
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0174
2025-05-30 14:32:15,271 - train_models - INFO -   Relative_Quantity: 0.0083
2025-05-30 14:32:15,271 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0073
2025-05-30 14:32:15,271 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:32:15,272 - train_models - INFO -   Fold 1: MAE=0.7082, RMSE=0.8444, R²=-0.2331, MAPE=20.26%
2025-05-30 14:32:15,272 - train_models - INFO -   Fold 2: MAE=0.4275, RMSE=0.5369, R²=0.5640, MAPE=8.31%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 3: MAE=0.4579, RMSE=0.6113, R²=0.6318, MAPE=9.59%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 4: MAE=0.3290, RMSE=0.5403, R²=0.7073, MAPE=12.77%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 5: MAE=0.3034, RMSE=0.4833, R²=0.7969, MAPE=6.39%
2025-05-30 14:32:15,273 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:32:15,803 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:21,862 - train_models - INFO - Model for 206 - MAE: 2.2802, RMSE: 3.0490, R²: 0.8866, MAPE: 19.17%
2025-05-30 14:32:21,863 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:32:21,863 - train_models - INFO -   Relative_Quantity: 0.6868
2025-05-30 14:32:21,863 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1845
2025-05-30 14:32:21,864 - train_models - INFO -   Hours_per_Quantity: 0.0224
2025-05-30 14:32:21,864 - train_models - INFO -   Quantity_per_Worker: 0.0170
2025-05-30 14:32:21,864 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0129
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_lag_7: 0.0129
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_1day_trend: 0.0086
2025-05-30 14:32:21,865 - train_models - INFO -   Quantity_same_dow_lag: 0.0077
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_7day_trend: 0.0060
2025-05-30 14:32:21,866 - train_models - INFO -   NoOfMan_lag_1: 0.0045
2025-05-30 14:32:21,866 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:32:21,866 - train_models - INFO -   Fold 1: MAE=2.3688, RMSE=3.2272, R²=0.8343, MAPE=36.55%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 2: MAE=2.4216, RMSE=3.2458, R²=0.8815, MAPE=17.49%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 3: MAE=4.3996, RMSE=5.5529, R²=0.8232, MAPE=24.41%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 4: MAE=1.2238, RMSE=1.8185, R²=0.9421, MAPE=11.69%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 5: MAE=0.9873, RMSE=1.4006, R²=0.9517, MAPE=5.71%
2025-05-30 14:32:21,868 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:32:22,240 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:27,103 - train_models - INFO - Model for 209 - MAE: 1.0983, RMSE: 1.5601, R²: 0.8740, MAPE: 11.96%
2025-05-30 14:32:27,103 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:32:27,104 - train_models - INFO -   Relative_Quantity: 0.8145
2025-05-30 14:32:27,104 - train_models - INFO -   Hours_per_Quantity: 0.0398
2025-05-30 14:32:27,104 - train_models - INFO -   Quantity_rolling_mean_7: 0.0384
2025-05-30 14:32:27,104 - train_models - INFO -   Quantity_per_Worker: 0.0274
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0269
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0129
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0072
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_lag_3: 0.0033
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_lag_1: 0.0027
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_1day_trend: 0.0025
2025-05-30 14:32:27,106 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 1: MAE=0.9555, RMSE=1.2186, R²=0.8971, MAPE=12.63%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 2: MAE=1.0616, RMSE=1.5300, R²=0.9019, MAPE=10.30%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 3: MAE=2.2919, RMSE=3.4727, R²=0.7996, MAPE=18.80%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 4: MAE=0.5942, RMSE=0.7872, R²=0.9357, MAPE=9.15%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 5: MAE=0.5885, RMSE=0.7922, R²=0.8358, MAPE=8.92%
2025-05-30 14:32:27,108 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:32:27,487 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:32,803 - train_models - INFO - Model for 210 - MAE: 1.0165, RMSE: 1.4622, R²: 0.8475, MAPE: 13.20%
2025-05-30 14:32:32,804 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:32:32,804 - train_models - INFO -   Relative_Quantity: 0.8298
2025-05-30 14:32:32,804 - train_models - INFO -   Hours_per_Quantity: 0.0283
2025-05-30 14:32:32,804 - train_models - INFO -   Quantity_per_Worker: 0.0249
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0244
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0238
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0146
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_1day_trend: 0.0076
2025-05-30 14:32:32,806 - train_models - INFO -   SystemHours_per_Quantity: 0.0051
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0045
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_7day_trend: 0.0041
2025-05-30 14:32:32,807 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 1: MAE=1.0706, RMSE=1.3207, R²=0.8155, MAPE=18.32%
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 2: MAE=0.9194, RMSE=1.2934, R²=0.8884, MAPE=11.38%
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 3: MAE=2.0492, RMSE=3.3407, R²=0.7159, MAPE=16.49%
2025-05-30 14:32:32,808 - train_models - INFO -   Fold 4: MAE=0.6765, RMSE=0.8581, R²=0.8826, MAPE=13.73%
2025-05-30 14:32:32,808 - train_models - INFO -   Fold 5: MAE=0.3668, RMSE=0.4982, R²=0.9350, MAPE=6.08%
2025-05-30 14:32:32,808 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:32:33,113 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:38,271 - train_models - INFO - Model for 211 - MAE: 1.1369, RMSE: 1.3713, R²: 0.7088, MAPE: 17.33%
2025-05-30 14:32:38,272 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:32:38,272 - train_models - INFO -   Relative_Quantity: 0.4646
2025-05-30 14:32:38,272 - train_models - INFO -   NoOfMan_7day_trend: 0.1351
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1329
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0567
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_lag_7: 0.0263
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0254
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_lag_1: 0.0230
2025-05-30 14:32:38,275 - train_models - INFO -   NoOfMan_lag_3: 0.0111
2025-05-30 14:32:38,275 - train_models - INFO -   Quantity_rolling_mean_7: 0.0076
2025-05-30 14:32:38,275 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:32:38,275 - train_models - INFO -   Fold 1: MAE=1.0811, RMSE=1.3093, R²=0.6595, MAPE=20.73%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 2: MAE=2.0033, RMSE=2.2920, R²=0.3072, MAPE=21.96%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 3: MAE=1.4614, RMSE=1.7637, R²=0.7388, MAPE=23.51%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 4: MAE=0.5180, RMSE=0.6750, R²=0.9031, MAPE=7.02%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 5: MAE=0.6206, RMSE=0.8166, R²=0.9356, MAPE=13.42%
2025-05-30 14:32:38,277 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:32:38,561 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:43,172 - train_models - INFO - Model for 213 - MAE: 0.5732, RMSE: 0.7454, R²: 0.6744, MAPE: 21.59%
2025-05-30 14:32:43,173 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:32:43,173 - train_models - INFO -   Relative_Quantity: 0.6992
2025-05-30 14:32:43,173 - train_models - INFO -   NoOfMan_7day_trend: 0.0464
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0403
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0366
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_1day_trend: 0.0269
2025-05-30 14:32:43,175 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0216
2025-05-30 14:32:43,175 - train_models - INFO -   Hours_per_Quantity: 0.0207
2025-05-30 14:32:43,175 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-30 14:32:43,175 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-05-30 14:32:43,176 - train_models - INFO -   NoOfMan_lag_1: 0.0084
2025-05-30 14:32:43,176 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:32:43,176 - train_models - INFO -   Fold 1: MAE=0.9422, RMSE=1.1651, R²=0.7060, MAPE=40.11%
2025-05-30 14:32:43,176 - train_models - INFO -   Fold 2: MAE=0.7012, RMSE=0.8772, R²=0.5840, MAPE=19.36%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 3: MAE=0.4585, RMSE=0.6662, R²=0.8210, MAPE=14.06%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 4: MAE=0.4869, RMSE=0.6621, R²=0.5031, MAPE=20.18%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 5: MAE=0.2774, RMSE=0.3566, R²=0.7580, MAPE=14.23%
2025-05-30 14:32:43,177 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:32:43,482 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:48,390 - train_models - INFO - Model for 214 - MAE: 0.9799, RMSE: 1.2754, R²: 0.6008, MAPE: 22.06%
2025-05-30 14:32:48,391 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:32:48,391 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3510
2025-05-30 14:32:48,391 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1854
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_7day_trend: 0.1140
2025-05-30 14:32:48,392 - train_models - INFO -   Relative_Quantity: 0.1033
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_1day_trend: 0.0589
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0388
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0206
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_lag_1: 0.0140
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_lag_7: 0.0125
2025-05-30 14:32:48,393 - train_models - INFO -   Quantity_per_Worker: 0.0096
2025-05-30 14:32:48,394 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 1: MAE=1.1608, RMSE=1.4729, R²=0.5437, MAPE=23.07%
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 2: MAE=1.0203, RMSE=1.2615, R²=0.6403, MAPE=13.09%
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 3: MAE=1.6900, RMSE=2.3276, R²=0.5194, MAPE=44.64%
2025-05-30 14:32:48,395 - train_models - INFO -   Fold 4: MAE=0.5953, RMSE=0.7479, R²=0.4548, MAPE=21.20%
2025-05-30 14:32:48,395 - train_models - INFO -   Fold 5: MAE=0.4332, RMSE=0.5670, R²=0.8458, MAPE=8.27%
2025-05-30 14:32:48,395 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:32:48,675 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:52,769 - train_models - INFO - Model for 217 - MAE: 0.6622, RMSE: 0.8977, R²: 0.3626, MAPE: 28.94%
2025-05-30 14:32:52,769 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:32:52,770 - train_models - INFO -   Relative_Quantity: 0.6237
2025-05-30 14:32:52,770 - train_models - INFO -   NoOfMan_7day_trend: 0.0548
2025-05-30 14:32:52,770 - train_models - INFO -   Hours_per_Quantity: 0.0543
2025-05-30 14:32:52,770 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0482
2025-05-30 14:32:52,771 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-30 14:32:52,771 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0393
2025-05-30 14:32:52,771 - train_models - INFO -   NoOfMan_1day_trend: 0.0305
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_lag_1: 0.0115
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_lag_7: 0.0096
2025-05-30 14:32:52,773 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:32:52,773 - train_models - INFO -   Fold 1: MAE=0.9056, RMSE=1.0682, R²=-1.2680, MAPE=75.15%
2025-05-30 14:32:52,773 - train_models - INFO -   Fold 2: MAE=0.4783, RMSE=0.5909, R²=0.8154, MAPE=13.05%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 3: MAE=0.6515, RMSE=0.8181, R²=0.7364, MAPE=24.27%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 4: MAE=0.8869, RMSE=1.4481, R²=0.6397, MAPE=16.48%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 5: MAE=0.3885, RMSE=0.5631, R²=0.8897, MAPE=15.77%
2025-05-30 14:32:52,775 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:32:53,053 - train_models - INFO - Model files saved successfully
2025-05-30 14:32:53,054 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:32:53,055 - train_models - INFO - Model training completed successfully
2025-05-30 14:34:30,160 - train_models - INFO - Starting the model training process
2025-05-30 14:34:30,160 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:34:30,163 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:34:30,274 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2022-01-01' order by Date
            
2025-05-30 14:34:30,825 - train_models - INFO - Read chunk of 7967 rows
2025-05-30 14:34:30,841 - train_models - INFO - Data loaded successfully. Total rows: 7967
2025-05-30 14:34:30,843 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:34:30,851 - train_models - INFO - Engineering features...
2025-05-30 14:34:31,274 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:34:31,296 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:34:31,299 - train_models - INFO - Creating lag features...
2025-05-30 14:34:31,308 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:34:31,480 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 14:34:31,480 - utils.feature_engineering - INFO - Final shape: (7967, 71)
2025-05-30 14:34:31,489 - train_models - INFO - Found 9 unique work types
2025-05-30 14:34:31,490 - train_models - INFO - Building models for 9 work types
2025-05-30 14:34:31,490 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:34:31,490 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:34:31,490 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:34:32,548 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:34:45,639 - train_models - INFO - Model for 202 - MAE: 0.2496, RMSE: 0.3415, R²: 0.8206, MAPE: 11.28%
2025-05-30 14:34:45,639 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3089
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_7day_trend: 0.2154
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_1day_trend: 0.1250
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_lag_7: 0.0747
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_lag_1: 0.0713
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0576
2025-05-30 14:34:45,642 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0494
2025-05-30 14:34:45,642 - train_models - INFO -   Relative_Quantity: 0.0291
2025-05-30 14:34:45,642 - train_models - INFO -   Hours_per_Quantity: 0.0165
2025-05-30 14:34:45,643 - train_models - INFO -   Quantity_per_Worker: 0.0073
2025-05-30 14:34:45,643 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 1: MAE=0.3352, RMSE=0.4897, R²=0.6781, MAPE=14.72%
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 2: MAE=0.2478, RMSE=0.3265, R²=0.8086, MAPE=13.91%
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 3: MAE=0.2309, RMSE=0.2907, R²=0.8272, MAPE=10.64%
2025-05-30 14:34:45,644 - train_models - INFO -   Fold 4: MAE=0.1864, RMSE=0.2669, R²=0.9008, MAPE=6.94%
2025-05-30 14:34:45,644 - train_models - INFO -   Fold 5: MAE=0.2478, RMSE=0.3338, R²=0.8881, MAPE=10.18%
2025-05-30 14:34:45,644 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:34:46,495 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:00,769 - train_models - INFO - Model for 203 - MAE: 0.2772, RMSE: 0.3891, R²: 0.8578, MAPE: 6.51%
2025-05-30 14:35:00,769 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:35:00,769 - train_models - INFO -   NoOfMan_7day_trend: 0.3247
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1661
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1131
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_lag_7: 0.1014
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_1day_trend: 0.0978
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0823
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_lag_1: 0.0571
2025-05-30 14:35:00,772 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0074
2025-05-30 14:35:00,772 - train_models - INFO -   Quantity_same_dow_lag: 0.0039
2025-05-30 14:35:00,772 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-30 14:35:00,772 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 1: MAE=0.3501, RMSE=0.4624, R²=0.7661, MAPE=6.80%
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 2: MAE=0.3825, RMSE=0.5184, R²=0.8099, MAPE=8.54%
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 3: MAE=0.2122, RMSE=0.3255, R²=0.9096, MAPE=5.01%
2025-05-30 14:35:00,774 - train_models - INFO -   Fold 4: MAE=0.2164, RMSE=0.3015, R²=0.9094, MAPE=5.71%
2025-05-30 14:35:00,774 - train_models - INFO -   Fold 5: MAE=0.2250, RMSE=0.3379, R²=0.8940, MAPE=6.47%
2025-05-30 14:35:00,774 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:35:01,803 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:19,036 - train_models - INFO - Model for 206 - MAE: 1.3970, RMSE: 2.4092, R²: 0.9110, MAPE: 12.81%
2025-05-30 14:35:19,037 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:35:19,037 - train_models - INFO -   Relative_Quantity: 0.7677
2025-05-30 14:35:19,037 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0476
2025-05-30 14:35:19,038 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0461
2025-05-30 14:35:19,038 - train_models - INFO -   Hours_per_Quantity: 0.0383
2025-05-30 14:35:19,038 - train_models - INFO -   Quantity_per_Worker: 0.0233
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0196
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_1day_trend: 0.0118
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_7day_trend: 0.0067
2025-05-30 14:35:19,040 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-30 14:35:19,040 - train_models - INFO -   DayOfWeek_feat_4: 0.0051
2025-05-30 14:35:19,040 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:35:19,040 - train_models - INFO -   Fold 1: MAE=2.1163, RMSE=3.3036, R²=0.8452, MAPE=11.19%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 2: MAE=1.3937, RMSE=2.6779, R²=0.8767, MAPE=7.96%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 3: MAE=1.0402, RMSE=1.6323, R²=0.9500, MAPE=7.23%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 4: MAE=1.0814, RMSE=2.1132, R²=0.9346, MAPE=28.85%
2025-05-30 14:35:19,042 - train_models - INFO -   Fold 5: MAE=1.3535, RMSE=2.3193, R²=0.9485, MAPE=8.82%
2025-05-30 14:35:19,042 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:35:19,906 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:34,411 - train_models - INFO - Model for 209 - MAE: 0.7136, RMSE: 1.2608, R²: 0.9103, MAPE: 10.30%
2025-05-30 14:35:34,411 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:35:34,411 - train_models - INFO -   Relative_Quantity: 0.7319
2025-05-30 14:35:34,412 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1132
2025-05-30 14:35:34,412 - train_models - INFO -   Hours_per_Quantity: 0.0639
2025-05-30 14:35:34,413 - train_models - INFO -   Quantity_per_Worker: 0.0470
2025-05-30 14:35:34,413 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0124
2025-05-30 14:35:34,413 - train_models - INFO -   NoOfMan_7day_trend: 0.0046
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0028
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_1day_trend: 0.0024
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0023
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-05-30 14:35:34,414 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 1: MAE=1.1079, RMSE=1.7367, R²=0.8167, MAPE=11.20%
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 2: MAE=0.5055, RMSE=0.7861, R²=0.9260, MAPE=8.26%
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 3: MAE=0.9945, RMSE=1.9997, R²=0.8685, MAPE=21.20%
2025-05-30 14:35:34,416 - train_models - INFO -   Fold 4: MAE=0.3945, RMSE=0.6977, R²=0.9760, MAPE=5.12%
2025-05-30 14:35:34,416 - train_models - INFO -   Fold 5: MAE=0.5658, RMSE=1.0838, R²=0.9645, MAPE=5.71%
2025-05-30 14:35:34,416 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:35:35,277 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:49,597 - train_models - INFO - Model for 210 - MAE: 0.5240, RMSE: 0.9807, R²: 0.9206, MAPE: 9.23%
2025-05-30 14:35:49,598 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:35:49,598 - train_models - INFO -   Relative_Quantity: 0.8523
2025-05-30 14:35:49,598 - train_models - INFO -   Quantity_per_Worker: 0.0468
2025-05-30 14:35:49,598 - train_models - INFO -   Hours_per_Quantity: 0.0420
2025-05-30 14:35:49,599 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0231
2025-05-30 14:35:49,599 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0066
2025-05-30 14:35:49,599 - train_models - INFO -   SystemHours_per_Quantity: 0.0040
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_7day_trend: 0.0031
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_1day_trend: 0.0027
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0025
2025-05-30 14:35:49,601 - train_models - INFO -   Quantity_7day_trend: 0.0018
2025-05-30 14:35:49,601 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:35:49,601 - train_models - INFO -   Fold 1: MAE=0.8094, RMSE=1.3325, R²=0.8464, MAPE=8.77%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 2: MAE=0.4162, RMSE=0.6521, R²=0.9473, MAPE=5.08%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 3: MAE=0.6326, RMSE=1.3085, R²=0.8807, MAPE=21.81%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 4: MAE=0.3180, RMSE=0.5945, R²=0.9757, MAPE=5.44%
2025-05-30 14:35:49,603 - train_models - INFO -   Fold 5: MAE=0.4440, RMSE=1.0158, R²=0.9528, MAPE=5.03%
2025-05-30 14:35:49,603 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:35:50,494 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:06,074 - train_models - INFO - Model for 211 - MAE: 0.8124, RMSE: 1.1197, R²: 0.8764, MAPE: 14.08%
2025-05-30 14:36:06,075 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:36:06,075 - train_models - INFO -   Relative_Quantity: 0.4639
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1331
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0986
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_7day_trend: 0.0934
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_1day_trend: 0.0847
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_lag_1: 0.0267
2025-05-30 14:36:06,077 - train_models - INFO -   NoOfMan_lag_7: 0.0212
2025-05-30 14:36:06,077 - train_models - INFO -   Quantity_per_Worker: 0.0128
2025-05-30 14:36:06,077 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0090
2025-05-30 14:36:06,078 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0080
2025-05-30 14:36:06,078 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:36:06,078 - train_models - INFO -   Fold 1: MAE=1.3129, RMSE=1.8907, R²=0.7656, MAPE=24.14%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 2: MAE=0.7531, RMSE=1.0065, R²=0.8572, MAPE=11.56%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 3: MAE=0.7056, RMSE=1.0342, R²=0.9300, MAPE=11.51%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 4: MAE=0.7767, RMSE=0.9616, R²=0.8785, MAPE=17.09%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 5: MAE=0.5139, RMSE=0.7054, R²=0.9507, MAPE=6.08%
2025-05-30 14:36:06,080 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:36:06,945 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:21,701 - train_models - INFO - Model for 213 - MAE: 0.3923, RMSE: 0.5645, R²: 0.8798, MAPE: 15.07%
2025-05-30 14:36:21,702 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:36:21,702 - train_models - INFO -   Relative_Quantity: 0.3760
2025-05-30 14:36:21,702 - train_models - INFO -   NoOfMan_7day_trend: 0.2000
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0859
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0835
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_1day_trend: 0.0699
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_lag_1: 0.0265
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_lag_7: 0.0189
2025-05-30 14:36:21,705 - train_models - INFO -   Hours_per_Quantity: 0.0114
2025-05-30 14:36:21,705 - train_models - INFO -   Quantity_per_Worker: 0.0071
2025-05-30 14:36:21,705 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 1: MAE=0.5768, RMSE=0.8524, R²=0.7553, MAPE=21.16%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 2: MAE=0.4330, RMSE=0.6221, R²=0.8873, MAPE=18.32%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 3: MAE=0.2834, RMSE=0.3922, R²=0.9126, MAPE=11.04%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 4: MAE=0.4056, RMSE=0.5968, R²=0.9012, MAPE=15.14%
2025-05-30 14:36:21,707 - train_models - INFO -   Fold 5: MAE=0.2625, RMSE=0.3587, R²=0.9426, MAPE=9.68%
2025-05-30 14:36:21,707 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:36:22,550 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:36,028 - train_models - INFO - Model for 214 - MAE: 0.6276, RMSE: 0.9079, R²: 0.8500, MAPE: 13.98%
2025-05-30 14:36:36,028 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:36:36,028 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5149
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_7day_trend: 0.1277
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0844
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_1day_trend: 0.0738
2025-05-30 14:36:36,029 - train_models - INFO -   Relative_Quantity: 0.0551
2025-05-30 14:36:36,030 - train_models - INFO -   NoOfMan_lag_1: 0.0281
2025-05-30 14:36:36,030 - train_models - INFO -   NoOfMan_lag_7: 0.0215
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0181
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0131
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0095
2025-05-30 14:36:36,031 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 1: MAE=0.6495, RMSE=0.7933, R²=0.8061, MAPE=18.17%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 2: MAE=0.4184, RMSE=0.5633, R²=0.9050, MAPE=11.16%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 3: MAE=0.6352, RMSE=0.9389, R²=0.8309, MAPE=11.55%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 4: MAE=0.7031, RMSE=1.0753, R²=0.8515, MAPE=13.13%
2025-05-30 14:36:36,033 - train_models - INFO -   Fold 5: MAE=0.7318, RMSE=1.1686, R²=0.8563, MAPE=15.92%
2025-05-30 14:36:36,033 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:36:36,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:49,111 - train_models - INFO - Model for 217 - MAE: 0.5163, RMSE: 0.7177, R²: 0.8723, MAPE: 19.67%
2025-05-30 14:36:49,112 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:36:49,112 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4253
2025-05-30 14:36:49,112 - train_models - INFO -   NoOfMan_7day_trend: 0.1829
2025-05-30 14:36:49,113 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1548
2025-05-30 14:36:49,113 - train_models - INFO -   Relative_Quantity: 0.0616
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_1day_trend: 0.0408
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_lag_7: 0.0375
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0236
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_lag_1: 0.0196
2025-05-30 14:36:49,115 - train_models - INFO -   Hours_per_Quantity: 0.0066
2025-05-30 14:36:49,115 - train_models - INFO -   Quantity_per_Worker: 0.0058
2025-05-30 14:36:49,115 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 1: MAE=0.6605, RMSE=0.8868, R²=0.8177, MAPE=27.42%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 2: MAE=0.5520, RMSE=0.7961, R²=0.8466, MAPE=22.20%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 3: MAE=0.5175, RMSE=0.7297, R²=0.8855, MAPE=14.35%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 4: MAE=0.3610, RMSE=0.4835, R²=0.9205, MAPE=17.29%
2025-05-30 14:36:49,117 - train_models - INFO -   Fold 5: MAE=0.4905, RMSE=0.6925, R²=0.8913, MAPE=17.09%
2025-05-30 14:36:49,118 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:36:49,430 - train_models - INFO - Model files saved successfully
2025-05-30 14:36:49,430 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:36:49,432 - train_models - INFO - Model training completed successfully
2025-05-30 14:38:42,364 - train_models - INFO - Starting the model training process
2025-05-30 14:38:42,364 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 15:07:09,350 - train_models - INFO - Starting the model training process
2025-05-30 15:07:09,350 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:07:09,354 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:07:09,476 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:07:10,077 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:07:10,125 - train_models - INFO - Read chunk of 3803 rows
2025-05-30 15:07:10,143 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-30 15:07:10,146 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:07:10,155 - train_models - INFO - Engineering features...
2025-05-30 15:07:10,598 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:07:10,626 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:07:10,631 - train_models - INFO - Creating lag features...
2025-05-30 15:07:10,640 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:07:10,836 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:07:10,836 - utils.feature_engineering - INFO - Final shape: (13803, 71)
2025-05-30 15:07:10,848 - train_models - INFO - Found 9 unique work types
2025-05-30 15:07:10,849 - train_models - INFO - Building models for 9 work types
2025-05-30 15:07:10,849 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:07:10,849 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:07:10,850 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:07:12,667 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:07:36,308 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:07:36,308 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:07:36,308 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:07:36,308 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:07:36,310 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:07:36,310 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:07:36,310 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:07:36,311 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:07:36,311 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:07:36,311 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:07:36,313 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:07:36,313 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:07:37,974 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:08:03,046 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:08:03,046 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:08:03,046 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:08:03,049 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:08:03,049 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:08:03,049 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:08:03,049 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:08:03,051 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:08:05,217 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:08:36,584 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:08:36,585 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:08:36,585 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:08:36,586 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:08:36,586 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:08:36,586 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:08:36,586 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:08:36,587 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:08:36,587 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:08:36,587 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:08:36,587 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:08:36,587 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:08:36,588 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:08:38,290 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:09:05,111 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:09:05,112 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:09:05,112 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:09:05,112 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:09:05,112 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:09:05,112 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:09:05,113 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:09:05,113 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:09:05,114 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:09:05,115 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:09:05,115 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:09:06,654 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:09:32,428 - train_models - INFO - Model for 210 - MAE: 0.3483, RMSE: 0.8012, R²: 0.9361, MAPE: 5.28%
2025-05-30 15:09:32,428 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 15:09:32,428 - train_models - INFO -   Relative_Quantity: 0.8308
2025-05-30 15:09:32,428 - train_models - INFO -   Hours_per_Quantity: 0.0464
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0463
2025-05-30 15:09:32,429 - train_models - INFO -   Quantity_per_Worker: 0.0462
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 15:09:32,429 - train_models - INFO -   Quantity_1day_trend: 0.0048
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0039
2025-05-30 15:09:32,430 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-30 15:09:32,430 - train_models - INFO -   NoOfMan_lag_3: 0.0013
2025-05-30 15:09:32,430 - train_models - INFO -   Quantity_7day_trend: 0.0012
2025-05-30 15:09:32,430 - train_models - INFO - Cross-validation details for 210:
2025-05-30 15:09:32,430 - train_models - INFO -   Fold 1: MAE=0.4781, RMSE=0.7752, R²=0.9460, MAPE=6.91%
2025-05-30 15:09:32,430 - train_models - INFO -   Fold 2: MAE=0.4624, RMSE=1.4247, R²=0.8165, MAPE=7.10%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 3: MAE=0.2539, RMSE=0.4706, R²=0.9787, MAPE=2.89%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 4: MAE=0.2712, RMSE=0.7288, R²=0.9598, MAPE=6.19%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 5: MAE=0.2760, RMSE=0.6065, R²=0.9796, MAPE=3.32%
2025-05-30 15:09:32,431 - train_models - INFO - Building model for WorkType: 211
2025-05-30 15:09:34,095 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:01,316 - train_models - INFO - Model for 211 - MAE: 0.5923, RMSE: 0.9048, R²: 0.9279, MAPE: 8.83%
2025-05-30 15:10:01,317 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 15:10:01,317 - train_models - INFO -   Relative_Quantity: 0.4814
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1691
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_7day_trend: 0.1091
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0757
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_1day_trend: 0.0392
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_lag_1: 0.0218
2025-05-30 15:10:01,318 - train_models - INFO -   Quantity_per_Worker: 0.0172
2025-05-30 15:10:01,318 - train_models - INFO -   Hours_per_Quantity: 0.0126
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0046
2025-05-30 15:10:01,318 - train_models - INFO - Cross-validation details for 211:
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 1: MAE=0.9589, RMSE=1.5256, R²=0.8421, MAPE=12.05%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 2: MAE=0.5348, RMSE=0.8193, R²=0.9391, MAPE=6.32%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 3: MAE=0.5233, RMSE=0.8709, R²=0.9371, MAPE=11.53%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 4: MAE=0.4535, RMSE=0.6321, R²=0.9672, MAPE=6.84%
2025-05-30 15:10:01,320 - train_models - INFO -   Fold 5: MAE=0.4913, RMSE=0.6762, R²=0.9542, MAPE=7.39%
2025-05-30 15:10:01,320 - train_models - INFO - Building model for WorkType: 213
2025-05-30 15:10:02,945 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:28,406 - train_models - INFO - Model for 213 - MAE: 0.4047, RMSE: 0.6085, R²: 0.8818, MAPE: 16.08%
2025-05-30 15:10:28,406 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4472
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_7day_trend: 0.2020
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_1day_trend: 0.1429
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_lag_1: 0.0461
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0431
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0361
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_lag_7: 0.0255
2025-05-30 15:10:28,408 - train_models - INFO -   Relative_Quantity: 0.0087
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0075
2025-05-30 15:10:28,409 - train_models - INFO - Cross-validation details for 213:
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 1: MAE=0.5493, RMSE=0.8495, R²=0.8377, MAPE=15.08%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 2: MAE=0.4847, RMSE=0.6703, R²=0.8512, MAPE=25.75%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 3: MAE=0.3230, RMSE=0.5194, R²=0.8994, MAPE=15.13%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 4: MAE=0.3184, RMSE=0.4778, R²=0.9134, MAPE=12.25%
2025-05-30 15:10:28,410 - train_models - INFO -   Fold 5: MAE=0.3481, RMSE=0.5255, R²=0.9072, MAPE=12.16%
2025-05-30 15:10:28,410 - train_models - INFO - Building model for WorkType: 214
2025-05-30 15:10:30,073 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:56,399 - train_models - INFO - Model for 214 - MAE: 0.4681, RMSE: 0.6879, R²: 0.8940, MAPE: 10.16%
2025-05-30 15:10:56,399 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 15:10:56,399 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4745
2025-05-30 15:10:56,400 - train_models - INFO -   NoOfMan_7day_trend: 0.1603
2025-05-30 15:10:56,400 - train_models - INFO -   Relative_Quantity: 0.0938
2025-05-30 15:10:56,400 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0711
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_1day_trend: 0.0577
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_lag_7: 0.0461
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_lag_1: 0.0247
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0101
2025-05-30 15:10:56,402 - train_models - INFO -   SystemHours_per_Quantity: 0.0076
2025-05-30 15:10:56,402 - train_models - INFO -   Hours_per_Quantity: 0.0074
2025-05-30 15:10:56,402 - train_models - INFO - Cross-validation details for 214:
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 1: MAE=0.4797, RMSE=0.6487, R²=0.8570, MAPE=11.90%
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.5307, R²=0.9212, MAPE=9.84%
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 3: MAE=0.3354, RMSE=0.4474, R²=0.9468, MAPE=9.28%
2025-05-30 15:10:56,404 - train_models - INFO -   Fold 4: MAE=0.3278, RMSE=0.5535, R²=0.9284, MAPE=6.41%
2025-05-30 15:10:56,404 - train_models - INFO -   Fold 5: MAE=0.7710, RMSE=1.2593, R²=0.8167, MAPE=13.38%
2025-05-30 15:10:56,404 - train_models - INFO - Building model for WorkType: 217
2025-05-30 15:10:57,929 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:11:24,384 - train_models - INFO - Starting the model training process
2025-05-30 15:11:24,384 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:11:24,387 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:11:24,497 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:11:25,092 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:11:25,168 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:11:25,185 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:11:25,186 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:11:25,199 - train_models - INFO - Engineering features...
2025-05-30 15:11:25,541 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:11:25,569 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:11:25,575 - train_models - INFO - Creating lag features...
2025-05-30 15:11:25,585 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:11:25,816 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:11:25,817 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:11:25,835 - train_models - INFO - Found 10 unique work types
2025-05-30 15:11:25,835 - train_models - INFO - Building models for 10 work types
2025-05-30 15:11:25,835 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:11:25,836 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:11:25,836 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:11:27,714 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:11:50,563 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:11:50,563 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:11:50,563 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:11:50,565 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:11:50,565 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:11:50,565 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:11:50,566 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:11:50,566 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:11:50,566 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:11:50,566 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:11:50,567 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:11:52,224 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:12:16,365 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:12:16,366 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:12:16,366 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:12:16,366 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:12:16,369 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:12:16,369 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:12:16,369 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:12:16,369 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:12:16,371 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:12:16,371 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:12:18,500 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:12:50,818 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:12:50,819 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:12:50,819 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:12:50,819 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:12:50,819 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:12:50,820 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:12:50,820 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:12:50,821 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:12:50,821 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:12:50,821 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:12:50,821 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:12:50,821 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:12:50,822 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:12:52,476 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:13:18,754 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:13:18,754 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:13:18,754 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:13:18,754 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:13:18,755 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:13:18,755 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:13:18,755 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:13:18,756 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:13:18,756 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:13:18,756 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:13:18,756 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:13:18,756 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:13:18,757 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:13:20,314 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:13:46,113 - train_models - INFO - Model for 210 - MAE: 0.3483, RMSE: 0.8012, R²: 0.9361, MAPE: 5.28%
2025-05-30 15:13:46,114 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 15:13:46,114 - train_models - INFO -   Relative_Quantity: 0.8308
2025-05-30 15:13:46,114 - train_models - INFO -   Hours_per_Quantity: 0.0464
2025-05-30 15:13:46,114 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0463
2025-05-30 15:13:46,114 - train_models - INFO -   Quantity_per_Worker: 0.0462
2025-05-30 15:13:46,114 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 15:13:46,115 - train_models - INFO -   Quantity_1day_trend: 0.0048
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0039
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_lag_3: 0.0013
2025-05-30 15:13:46,115 - train_models - INFO -   Quantity_7day_trend: 0.0012
2025-05-30 15:13:46,115 - train_models - INFO - Cross-validation details for 210:
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 1: MAE=0.4781, RMSE=0.7752, R²=0.9460, MAPE=6.91%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 2: MAE=0.4624, RMSE=1.4247, R²=0.8165, MAPE=7.10%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 3: MAE=0.2539, RMSE=0.4706, R²=0.9787, MAPE=2.89%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 4: MAE=0.2712, RMSE=0.7288, R²=0.9598, MAPE=6.19%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 5: MAE=0.2760, RMSE=0.6065, R²=0.9796, MAPE=3.32%
2025-05-30 15:13:46,117 - train_models - INFO - Building model for WorkType: 211
2025-05-30 15:13:47,798 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:14:14,986 - train_models - INFO - Model for 211 - MAE: 0.5923, RMSE: 0.9048, R²: 0.9279, MAPE: 8.83%
2025-05-30 15:14:14,986 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 15:14:14,986 - train_models - INFO -   Relative_Quantity: 0.4814
2025-05-30 15:14:14,986 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1691
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_7day_trend: 0.1091
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0757
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_1day_trend: 0.0392
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_lag_1: 0.0218
2025-05-30 15:14:14,988 - train_models - INFO -   Quantity_per_Worker: 0.0172
2025-05-30 15:14:14,988 - train_models - INFO -   Hours_per_Quantity: 0.0126
2025-05-30 15:14:14,988 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0046
2025-05-30 15:14:14,988 - train_models - INFO - Cross-validation details for 211:
2025-05-30 15:14:14,988 - train_models - INFO -   Fold 1: MAE=0.9589, RMSE=1.5256, R²=0.8421, MAPE=12.05%
2025-05-30 15:14:14,988 - train_models - INFO -   Fold 2: MAE=0.5348, RMSE=0.8193, R²=0.9391, MAPE=6.32%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 3: MAE=0.5233, RMSE=0.8709, R²=0.9371, MAPE=11.53%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 4: MAE=0.4535, RMSE=0.6321, R²=0.9672, MAPE=6.84%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 5: MAE=0.4913, RMSE=0.6762, R²=0.9542, MAPE=7.39%
2025-05-30 15:14:14,989 - train_models - INFO - Building model for WorkType: 213
2025-05-30 15:14:16,613 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:14:42,430 - train_models - INFO - Model for 213 - MAE: 0.4047, RMSE: 0.6085, R²: 0.8818, MAPE: 16.08%
2025-05-30 15:14:42,431 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4472
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_7day_trend: 0.2020
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_1day_trend: 0.1429
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_lag_1: 0.0461
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0431
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0361
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_lag_7: 0.0255
2025-05-30 15:14:42,433 - train_models - INFO -   Relative_Quantity: 0.0087
2025-05-30 15:14:42,433 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-05-30 15:14:42,433 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0075
2025-05-30 15:14:42,433 - train_models - INFO - Cross-validation details for 213:
2025-05-30 15:14:42,433 - train_models - INFO -   Fold 1: MAE=0.5493, RMSE=0.8495, R²=0.8377, MAPE=15.08%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 2: MAE=0.4847, RMSE=0.6703, R²=0.8512, MAPE=25.75%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 3: MAE=0.3230, RMSE=0.5194, R²=0.8994, MAPE=15.13%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 4: MAE=0.3184, RMSE=0.4778, R²=0.9134, MAPE=12.25%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 5: MAE=0.3481, RMSE=0.5255, R²=0.9072, MAPE=12.16%
2025-05-30 15:14:42,435 - train_models - INFO - Building model for WorkType: 214
2025-05-30 15:14:44,541 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:15:09,322 - train_models - INFO - Model for 214 - MAE: 0.4681, RMSE: 0.6879, R²: 0.8940, MAPE: 10.16%
2025-05-30 15:15:09,323 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4745
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_7day_trend: 0.1603
2025-05-30 15:15:09,323 - train_models - INFO -   Relative_Quantity: 0.0938
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0711
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_1day_trend: 0.0577
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_lag_7: 0.0461
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_lag_1: 0.0247
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0101
2025-05-30 15:15:09,324 - train_models - INFO -   SystemHours_per_Quantity: 0.0076
2025-05-30 15:15:09,325 - train_models - INFO -   Hours_per_Quantity: 0.0074
2025-05-30 15:15:09,325 - train_models - INFO - Cross-validation details for 214:
2025-05-30 15:15:09,325 - train_models - INFO -   Fold 1: MAE=0.4797, RMSE=0.6487, R²=0.8570, MAPE=11.90%
2025-05-30 15:15:09,325 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.5307, R²=0.9212, MAPE=9.84%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 3: MAE=0.3354, RMSE=0.4474, R²=0.9468, MAPE=9.28%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 4: MAE=0.3278, RMSE=0.5535, R²=0.9284, MAPE=6.41%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 5: MAE=0.7710, RMSE=1.2593, R²=0.8167, MAPE=13.38%
2025-05-30 15:15:09,326 - train_models - INFO - Building model for WorkType: 215
2025-05-30 15:15:11,134 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:15:39,521 - train_models - INFO - Model for 215 - MAE: 0.2851, RMSE: 0.6385, R²: 0.9597, MAPE: 6.08%
2025-05-30 15:15:39,521 - train_models - INFO - Top 10 most important features for 215:
2025-05-30 15:15:39,522 - train_models - INFO -   Relative_Quantity: 0.8671
2025-05-30 15:15:39,522 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-30 15:15:39,522 - train_models - INFO -   Quantity_per_Worker: 0.0409
2025-05-30 15:15:39,522 - train_models - INFO -   NoOfMan_7day_trend: 0.0077
2025-05-30 15:15:39,522 - train_models - INFO -   NoOfMan_1day_trend: 0.0073
2025-05-30 15:15:39,523 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0063
2025-05-30 15:15:39,523 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0016
2025-05-30 15:15:39,523 - train_models - INFO -   SystemHours_per_Quantity: 0.0016
2025-05-30 15:15:39,523 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-30 15:15:39,524 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0010
2025-05-30 15:15:39,524 - train_models - INFO - Cross-validation details for 215:
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 1: MAE=0.5364, RMSE=1.1687, R²=0.8904, MAPE=10.93%
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 2: MAE=0.2631, RMSE=0.4396, R²=0.9835, MAPE=7.83%
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 3: MAE=0.2331, RMSE=0.6094, R²=0.9691, MAPE=4.26%
2025-05-30 15:15:39,525 - train_models - INFO -   Fold 4: MAE=0.1929, RMSE=0.4279, R²=0.9808, MAPE=4.46%
2025-05-30 15:15:39,525 - train_models - INFO -   Fold 5: MAE=0.1999, RMSE=0.5469, R²=0.9746, MAPE=2.95%
2025-05-30 15:15:39,525 - train_models - INFO - Building model for WorkType: 217
2025-05-30 15:15:41,111 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:16:02,725 - train_models - INFO - Model for 217 - MAE: 0.3809, RMSE: 0.5177, R²: 0.9245, MAPE: 17.43%
2025-05-30 15:16:02,726 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5645
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_7day_trend: 0.1173
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0868
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_lag_1: 0.0743
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_1day_trend: 0.0695
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0279
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-30 15:16:02,727 - train_models - INFO -   Relative_Quantity: 0.0061
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-05-30 15:16:02,727 - train_models - INFO -   Hours_per_Quantity: 0.0026
2025-05-30 15:16:02,728 - train_models - INFO - Cross-validation details for 217:
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 1: MAE=0.4965, RMSE=0.6494, R²=0.8629, MAPE=27.24%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 2: MAE=0.4093, RMSE=0.5284, R²=0.9172, MAPE=20.39%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 3: MAE=0.3325, RMSE=0.4335, R²=0.9564, MAPE=13.13%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 4: MAE=0.3093, RMSE=0.3951, R²=0.9663, MAPE=13.06%
2025-05-30 15:16:02,729 - train_models - INFO -   Fold 5: MAE=0.3569, RMSE=0.5820, R²=0.9194, MAPE=13.30%
2025-05-30 15:16:02,729 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-30 15:16:03,358 - train_models - INFO - Model files saved successfully
2025-05-30 15:16:03,359 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 15:16:03,361 - train_models - INFO - Model training completed successfully
2025-05-30 15:39:16,574 - train_models - INFO - Starting the model training process
2025-05-30 15:39:16,575 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:39:16,578 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:39:16,704 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:39:17,316 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:39:17,377 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:39:17,396 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:39:17,398 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:39:17,421 - train_models - INFO - Engineering features...
2025-05-30 15:39:17,803 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:39:17,831 - utils.feature_engineering - ERROR - Error engineering features: ('Date', 'Relative_Quantity')
2025-05-30 15:39:17,910 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

2025-05-30 15:39:17,912 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: ('Date', 'Relative_Quantity')
2025-05-30 15:39:17,913 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 356, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 128, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: ('Date', 'Relative_Quantity')

2025-05-30 15:39:17,915 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 15:40:12,450 - train_models - INFO - Starting the model training process
2025-05-30 15:40:12,450 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:40:12,453 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:40:12,568 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:40:13,170 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:40:13,247 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:40:13,264 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:40:13,265 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:40:13,277 - train_models - INFO - Engineering features...
2025-05-30 15:40:13,613 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:40:13,641 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:40:13,645 - train_models - INFO - Creating lag features...
2025-05-30 15:40:13,657 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:40:13,865 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:40:13,865 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:40:13,878 - train_models - INFO - Found 10 unique work types
2025-05-30 15:40:13,879 - train_models - INFO - Building models for 10 work types
2025-05-30 15:40:13,879 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:40:13,879 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:40:13,879 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:40:15,667 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:40:39,895 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:40:39,896 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:40:39,897 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:40:39,898 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:40:39,898 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:40:39,898 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:40:39,899 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:40:39,900 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:40:39,900 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:40:39,900 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:40:41,658 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:41:07,403 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:41:07,403 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:41:07,406 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:41:07,408 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:41:07,408 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:41:07,408 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:41:09,296 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:41:41,606 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:41:41,606 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:41:41,607 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:41:41,607 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:41:41,607 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:41:41,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:41:41,608 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:41:41,608 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:41:41,610 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:41:41,610 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:41:41,611 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:41:41,611 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:41:41,611 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:41:43,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:09,758 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:42:09,758 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:42:09,759 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:42:09,759 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:42:09,759 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:42:09,760 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:42:09,761 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:42:09,761 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:42:09,761 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:42:09,762 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:42:09,763 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:42:09,763 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:42:09,763 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:42:11,425 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:31,806 - train_models - INFO - Starting the model training process
2025-05-30 15:42:31,806 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:42:31,810 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:42:31,929 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:42:32,518 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:42:32,593 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:42:32,610 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:42:32,611 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:42:32,624 - train_models - INFO - Engineering features...
2025-05-30 15:42:33,050 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:42:33,077 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:42:33,083 - train_models - INFO - Creating lag features...
2025-05-30 15:42:33,094 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:42:33,303 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:42:33,303 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:42:33,318 - train_models - INFO - Found 10 unique work types
2025-05-30 15:42:33,318 - train_models - INFO - Building models for 10 work types
2025-05-30 15:42:33,318 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:42:33,319 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:42:33,319 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:42:35,052 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:58,153 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:42:58,154 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:42:58,154 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:42:58,154 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:42:58,156 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:42:58,156 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:42:58,156 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:42:58,157 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:42:58,157 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:42:58,157 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:42:58,157 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:42:58,159 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:42:59,893 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:45:51,665 - train_models - INFO - Starting the model training process
2025-05-30 15:45:51,665 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:45:51,668 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:45:51,778 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:45:52,371 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:45:52,452 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:45:52,470 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:45:52,472 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:45:52,484 - train_models - INFO - Engineering features...
2025-05-30 15:45:52,813 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:45:52,845 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:45:52,850 - train_models - INFO - Creating lag features...
2025-05-30 15:45:52,859 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:45:53,079 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:45:53,082 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:45:53,099 - train_models - INFO - Found 10 unique work types
2025-05-30 15:45:53,101 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:45:53,102 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:48:25,105 - train_models - INFO - Starting the model training process
2025-05-30 15:48:25,106 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:48:25,109 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:48:25,219 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:48:25,594 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:48:25,622 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:48:25,623 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:48:25,630 - train_models - INFO - Engineering features...
2025-05-30 15:48:25,963 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:48:25,974 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:48:25,976 - train_models - INFO - Creating lag features...
2025-05-30 15:48:25,983 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:48:26,102 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:48:26,102 - utils.feature_engineering - INFO - Final shape: (1526, 71)
2025-05-30 15:48:26,105 - train_models - INFO - Found 1 unique work types
2025-05-30 15:48:26,105 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:48:26,106 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:50:46,098 - train_models - INFO - Starting the model training process
2025-05-30 15:50:46,098 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:50:46,101 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:50:46,217 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:50:46,586 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:50:46,601 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:50:46,603 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:50:46,612 - train_models - INFO - Engineering features...
2025-05-30 15:50:47,075 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:50:47,087 - utils.feature_engineering - ERROR - Error engineering features: ('Date', 'Relative_Quantity')
2025-05-30 15:50:47,160 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

2025-05-30 15:50:47,161 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: ('Date', 'Relative_Quantity')
2025-05-30 15:50:47,163 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 356, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 128, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: ('Date', 'Relative_Quantity')

2025-05-30 15:50:47,164 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 15:51:47,025 - train_models - INFO - Starting the model training process
2025-05-30 15:51:47,025 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:51:47,029 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:51:47,136 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:51:47,484 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:51:47,500 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:51:47,502 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:51:47,507 - train_models - INFO - Engineering features...
2025-05-30 15:51:47,868 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:51:47,888 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:51:47,891 - train_models - INFO - Creating lag features...
2025-05-30 15:51:47,898 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:51:48,004 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:51:48,004 - utils.feature_engineering - INFO - Final shape: (1526, 71)
2025-05-30 15:51:48,007 - train_models - INFO - Found 1 unique work types
2025-05-30 15:51:48,007 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:51:48,008 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:59:28,740 - train_models - INFO - Starting the model training process
2025-05-30 15:59:28,741 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:59:28,745 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:59:28,872 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:59:29,247 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:59:29,264 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:59:29,265 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:59:29,274 - train_models - INFO - Engineering features...
2025-05-30 15:59:29,875 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:59:29,889 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-05-30 15:59:29,891 - train_models - INFO - Creating lag features...
2025-05-30 15:59:29,898 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:59:30,009 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:59:30,009 - utils.feature_engineering - INFO - Final shape: (1526, 70)
2025-05-30 15:59:30,011 - train_models - INFO - Found 1 unique work types
2025-05-30 15:59:30,012 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:59:30,013 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:59:52,441 - train_models - INFO - Starting the model training process
2025-05-30 15:59:52,441 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:59:52,444 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:59:52,554 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:59:52,909 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:59:52,925 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:59:52,927 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:59:52,937 - train_models - INFO - Engineering features...
2025-05-30 15:59:53,283 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:59:53,292 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-05-30 15:59:53,294 - train_models - INFO - Creating lag features...
2025-05-30 15:59:53,301 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:59:53,407 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:59:53,407 - utils.feature_engineering - INFO - Final shape: (1526, 70)
2025-05-30 15:59:53,409 - train_models - INFO - Found 1 unique work types
2025-05-30 15:59:53,409 - train_models - INFO - Building models for 1 work types
2025-05-30 15:59:53,410 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:59:53,410 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:59:53,410 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:59:55,251 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-05-30 16:00:22,483 - train_models - INFO - Model for 209 - MAE: 0.9495, RMSE: 1.4467, R²: 0.8901, MAPE: 16.59%
2025-05-30 16:00:22,483 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 16:00:22,483 - train_models - INFO -   NoOfMan_7day_trend: 0.3955
2025-05-30 16:00:22,484 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1317
2025-05-30 16:00:22,484 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1159
2025-05-30 16:00:22,484 - train_models - INFO -   Hours_per_Quantity: 0.0661
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_lag_7: 0.0639
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_1day_trend: 0.0595
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_lag_1: 0.0383
2025-05-30 16:00:22,485 - train_models - INFO -   Quantity_rolling_mean_7: 0.0216
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0197
2025-05-30 16:00:22,486 - train_models - INFO -   Quantity_per_Worker: 0.0104
2025-05-30 16:00:22,486 - train_models - INFO - Cross-validation details for 209:
2025-05-30 16:00:22,486 - train_models - INFO -   Fold 1: MAE=1.0186, RMSE=1.4758, R²=0.8524, MAPE=14.25%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 2: MAE=0.9940, RMSE=1.5382, R²=0.8764, MAPE=16.08%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 3: MAE=0.6812, RMSE=0.8998, R²=0.9376, MAPE=10.49%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 4: MAE=1.0389, RMSE=1.6207, R²=0.8909, MAPE=24.36%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 5: MAE=1.0150, RMSE=1.6990, R²=0.8929, MAPE=17.76%
2025-05-30 16:00:22,488 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-30 16:00:22,576 - train_models - INFO - Model files saved successfully
2025-05-30 16:00:22,576 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 16:00:22,577 - train_models - INFO - Model training completed successfully
2025-06-01 21:04:24,076 - train_models - INFO - Starting the model training process
2025-06-01 21:04:24,077 - train_models - INFO - Training from SQL database (command line argument)
2025-06-01 21:04:24,085 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-01 21:04:24,447 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND and Hours <> 0
                ORDER BY Date
            
2025-06-01 21:04:24,984 - train_models - ERROR - Error in train_from_sql: Execution failed on sql '
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND and Hours <> 0
                ORDER BY Date
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'and'. (156) (SQLExecDirectW)")
2025-06-01 21:04:25,019 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2674, in execute
    cur.execute(sql, *args)
    ~~~~~~~~~~~^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'and'. (156) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 314, in train_from_sql
    for chunk in pd.read_sql(sql_query, conn, chunksize=CHUNK_SIZE):
                 ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 706, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2738, in read_query
    cursor = self.execute(sql, params)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2686, in execute
    raise ex from exc
pandas.errors.DatabaseError: Execution failed on sql '
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND and Hours <> 0
                ORDER BY Date
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'and'. (156) (SQLExecDirectW)")

2025-06-01 21:04:25,020 - train_models - ERROR - SQL training failed. Check logs for details.
2025-06-01 21:05:41,655 - train_models - INFO - Starting the model training process
2025-06-01 21:05:41,655 - train_models - INFO - Training from SQL database (command line argument)
2025-06-01 21:05:41,658 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-01 21:05:41,970 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND Hours <> 0
                ORDER BY Date
            
2025-06-01 21:05:43,256 - train_models - INFO - Read chunk of 10000 rows
2025-06-01 21:05:43,434 - train_models - INFO - Read chunk of 5359 rows
2025-06-01 21:05:43,510 - train_models - INFO - Data loaded successfully. Total rows: 15359
2025-06-01 21:05:43,511 - train_models - INFO - Converting Date column to datetime format
2025-06-01 21:05:43,569 - train_models - INFO - Engineering features...
2025-06-01 21:05:44,314 - utils.feature_engineering - INFO - Engineering features
2025-06-01 21:05:44,368 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-01 21:05:44,385 - train_models - INFO - Creating lag features...
2025-06-01 21:05:44,440 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-01 21:05:44,752 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-01 21:05:44,753 - utils.feature_engineering - INFO - Final shape: (15359, 70)
2025-06-01 21:05:44,765 - train_models - INFO - Found 10 unique work types
2025-06-01 21:05:44,766 - train_models - INFO - Building models for 10 work types
2025-06-01 21:05:44,766 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-01 21:05:44,766 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-01 21:05:44,767 - train_models - INFO - Building model for WorkType: 202
2025-06-01 21:05:47,406 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:06:17,777 - train_models - INFO - Model for 202 - MAE: 0.2121, RMSE: 0.3305, R²: 0.7462, MAPE: 10.12%
2025-06-01 21:06:17,778 - train_models - INFO - Top 10 most important features for 202:
2025-06-01 21:06:17,778 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3965
2025-06-01 21:06:17,779 - train_models - INFO -   NoOfMan_7day_trend: 0.1981
2025-06-01 21:06:17,779 - train_models - INFO -   NoOfMan_1day_trend: 0.1273
2025-06-01 21:06:17,779 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-01 21:06:17,779 - train_models - INFO -   NoOfMan_lag_1: 0.0674
2025-06-01 21:06:17,779 - train_models - INFO -   NoOfMan_lag_7: 0.0659
2025-06-01 21:06:17,780 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0386
2025-06-01 21:06:17,780 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-01 21:06:17,780 - train_models - INFO -   Quantity_rolling_mean_7: 0.0021
2025-06-01 21:06:17,780 - train_models - INFO -   Quantity_lag_7: 0.0021
2025-06-01 21:06:17,781 - train_models - INFO - Cross-validation details for 202:
2025-06-01 21:06:17,781 - train_models - INFO -   Fold 1: MAE=0.2222, RMSE=0.4181, R²=0.3874, MAPE=11.30%
2025-06-01 21:06:17,781 - train_models - INFO -   Fold 2: MAE=0.2016, RMSE=0.3019, R²=0.7901, MAPE=11.19%
2025-06-01 21:06:17,781 - train_models - INFO -   Fold 3: MAE=0.2276, RMSE=0.3600, R²=0.7983, MAPE=11.70%
2025-06-01 21:06:17,781 - train_models - INFO -   Fold 4: MAE=0.1745, RMSE=0.2277, R²=0.8945, MAPE=8.04%
2025-06-01 21:06:17,782 - train_models - INFO -   Fold 5: MAE=0.2347, RMSE=0.3450, R²=0.8606, MAPE=8.38%
2025-06-01 21:06:17,782 - train_models - INFO - Building model for WorkType: 203
2025-06-01 21:06:20,014 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:06:53,091 - train_models - INFO - Model for 203 - MAE: 0.2242, RMSE: 0.3229, R²: 0.9147, MAPE: 4.69%
2025-06-01 21:06:53,092 - train_models - INFO - Top 10 most important features for 203:
2025-06-01 21:06:53,092 - train_models - INFO -   NoOfMan_7day_trend: 0.3049
2025-06-01 21:06:53,092 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-01 21:06:53,092 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1217
2025-06-01 21:06:53,093 - train_models - INFO -   NoOfMan_1day_trend: 0.0916
2025-06-01 21:06:53,093 - train_models - INFO -   NoOfMan_lag_7: 0.0841
2025-06-01 21:06:53,093 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0720
2025-06-01 21:06:53,093 - train_models - INFO -   NoOfMan_lag_1: 0.0531
2025-06-01 21:06:53,093 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-06-01 21:06:53,094 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-06-01 21:06:53,094 - train_models - INFO -   NoOfMan_lag_2: 0.0026
2025-06-01 21:06:53,094 - train_models - INFO - Cross-validation details for 203:
2025-06-01 21:06:53,094 - train_models - INFO -   Fold 1: MAE=0.2863, RMSE=0.3951, R²=0.8770, MAPE=5.74%
2025-06-01 21:06:53,095 - train_models - INFO -   Fold 2: MAE=0.2562, RMSE=0.3466, R²=0.9125, MAPE=5.04%
2025-06-01 21:06:53,095 - train_models - INFO -   Fold 3: MAE=0.2273, RMSE=0.3641, R²=0.9001, MAPE=4.25%
2025-06-01 21:06:53,095 - train_models - INFO -   Fold 4: MAE=0.1799, RMSE=0.2720, R²=0.9400, MAPE=4.25%
2025-06-01 21:06:53,095 - train_models - INFO -   Fold 5: MAE=0.1711, RMSE=0.2369, R²=0.9440, MAPE=4.19%
2025-06-01 21:06:53,096 - train_models - INFO - Building model for WorkType: 206
2025-06-01 21:06:56,066 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:07:41,369 - train_models - INFO - Model for 206 - MAE: 1.4349, RMSE: 2.1913, R²: 0.9293, MAPE: 8.21%
2025-06-01 21:07:41,370 - train_models - INFO - Top 10 most important features for 206:
2025-06-01 21:07:41,370 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5326
2025-06-01 21:07:41,370 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1477
2025-06-01 21:07:41,371 - train_models - INFO -   NoOfMan_1day_trend: 0.0716
2025-06-01 21:07:41,371 - train_models - INFO -   DayOfWeek_feat_6: 0.0637
2025-06-01 21:07:41,371 - train_models - INFO -   NoOfMan_7day_trend: 0.0528
2025-06-01 21:07:41,371 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0385
2025-06-01 21:07:41,372 - train_models - INFO -   NoOfMan_lag_1: 0.0268
2025-06-01 21:07:41,372 - train_models - INFO -   NoOfMan_lag_7: 0.0072
2025-06-01 21:07:41,372 - train_models - INFO -   Quantity_rolling_mean_7: 0.0068
2025-06-01 21:07:41,372 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0058
2025-06-01 21:07:41,373 - train_models - INFO - Cross-validation details for 206:
2025-06-01 21:07:41,373 - train_models - INFO -   Fold 1: MAE=1.7344, RMSE=2.3918, R²=0.9231, MAPE=9.87%
2025-06-01 21:07:41,373 - train_models - INFO -   Fold 2: MAE=1.6224, RMSE=2.3514, R²=0.9219, MAPE=8.85%
2025-06-01 21:07:41,374 - train_models - INFO -   Fold 3: MAE=1.5351, RMSE=2.6268, R²=0.8964, MAPE=8.99%
2025-06-01 21:07:41,374 - train_models - INFO -   Fold 4: MAE=0.9605, RMSE=1.4548, R²=0.9596, MAPE=6.28%
2025-06-01 21:07:41,374 - train_models - INFO -   Fold 5: MAE=1.3219, RMSE=2.1318, R²=0.9454, MAPE=7.05%
2025-06-01 21:07:41,374 - train_models - INFO - Building model for WorkType: 209
2025-06-01 21:07:43,757 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:08:21,493 - train_models - INFO - Model for 209 - MAE: 0.8926, RMSE: 1.4008, R²: 0.8867, MAPE: 12.46%
2025-06-01 21:08:21,493 - train_models - INFO - Top 10 most important features for 209:
2025-06-01 21:08:21,493 - train_models - INFO -   NoOfMan_7day_trend: 0.4019
2025-06-01 21:08:21,494 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2246
2025-06-01 21:08:21,494 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0965
2025-06-01 21:08:21,494 - train_models - INFO -   NoOfMan_1day_trend: 0.0671
2025-06-01 21:08:21,494 - train_models - INFO -   NoOfMan_lag_7: 0.0518
2025-06-01 21:08:21,495 - train_models - INFO -   Quantity_rolling_mean_7: 0.0395
2025-06-01 21:08:21,495 - train_models - INFO -   NoOfMan_lag_1: 0.0275
2025-06-01 21:08:21,495 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0192
2025-06-01 21:08:21,495 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-06-01 21:08:21,496 - train_models - INFO -   Quantity_7day_trend: 0.0084
2025-06-01 21:08:21,496 - train_models - INFO - Cross-validation details for 209:
2025-06-01 21:08:21,496 - train_models - INFO -   Fold 1: MAE=1.0019, RMSE=1.4685, R²=0.8559, MAPE=13.83%
2025-06-01 21:08:21,496 - train_models - INFO -   Fold 2: MAE=1.0352, RMSE=1.7638, R²=0.8396, MAPE=15.12%
2025-06-01 21:08:21,497 - train_models - INFO -   Fold 3: MAE=0.6516, RMSE=0.8736, R²=0.9401, MAPE=10.39%
2025-06-01 21:08:21,497 - train_models - INFO -   Fold 4: MAE=0.8488, RMSE=1.3921, R²=0.9013, MAPE=11.09%
2025-06-01 21:08:21,497 - train_models - INFO -   Fold 5: MAE=0.9253, RMSE=1.5062, R²=0.8968, MAPE=11.87%
2025-06-01 21:08:21,497 - train_models - INFO - Building model for WorkType: 210
2025-06-01 21:08:23,942 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:09:03,088 - train_models - INFO - Model for 210 - MAE: 0.8170, RMSE: 1.1899, R²: 0.8878, MAPE: 17.63%
2025-06-01 21:09:03,089 - train_models - INFO - Top 10 most important features for 210:
2025-06-01 21:09:03,089 - train_models - INFO -   NoOfMan_7day_trend: 0.2622
2025-06-01 21:09:03,090 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2054
2025-06-01 21:09:03,090 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1685
2025-06-01 21:09:03,090 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0665
2025-06-01 21:09:03,091 - train_models - INFO -   NoOfMan_1day_trend: 0.0610
2025-06-01 21:09:03,091 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-06-01 21:09:03,091 - train_models - INFO -   Quantity_1day_trend: 0.0293
2025-06-01 21:09:03,092 - train_models - INFO -   NoOfMan_lag_1: 0.0284
2025-06-01 21:09:03,092 - train_models - INFO -   DayOfWeek_feat_6: 0.0256
2025-06-01 21:09:03,092 - train_models - INFO -   Quantity_7day_trend: 0.0183
2025-06-01 21:09:03,092 - train_models - INFO - Cross-validation details for 210:
2025-06-01 21:09:03,093 - train_models - INFO -   Fold 1: MAE=0.8290, RMSE=1.1500, R²=0.8814, MAPE=13.56%
2025-06-01 21:09:03,093 - train_models - INFO -   Fold 2: MAE=0.7285, RMSE=1.0597, R²=0.8971, MAPE=12.38%
2025-06-01 21:09:03,093 - train_models - INFO -   Fold 3: MAE=0.6101, RMSE=0.8538, R²=0.9301, MAPE=8.56%
2025-06-01 21:09:03,094 - train_models - INFO -   Fold 4: MAE=0.9058, RMSE=1.2655, R²=0.8774, MAPE=27.19%
2025-06-01 21:09:03,094 - train_models - INFO -   Fold 5: MAE=1.0113, RMSE=1.6202, R²=0.8531, MAPE=26.46%
2025-06-01 21:09:03,094 - train_models - INFO - Building model for WorkType: 211
2025-06-01 21:09:05,906 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:09:48,222 - train_models - INFO - Model for 211 - MAE: 0.6484, RMSE: 1.0003, R²: 0.9107, MAPE: 11.48%
2025-06-01 21:09:48,222 - train_models - INFO - Top 10 most important features for 211:
2025-06-01 21:09:48,222 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3468
2025-06-01 21:09:48,223 - train_models - INFO -   NoOfMan_7day_trend: 0.1766
2025-06-01 21:09:48,223 - train_models - INFO -   NoOfMan_1day_trend: 0.1700
2025-06-01 21:09:48,223 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-01 21:09:48,223 - train_models - INFO -   DayOfWeek_feat_6: 0.0530
2025-06-01 21:09:48,224 - train_models - INFO -   NoOfMan_lag_1: 0.0456
2025-06-01 21:09:48,224 - train_models - INFO -   NoOfMan_lag_7: 0.0393
2025-06-01 21:09:48,224 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0387
2025-06-01 21:09:48,224 - train_models - INFO -   Quantity_same_dow_lag: 0.0130
2025-06-01 21:09:48,225 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-06-01 21:09:48,225 - train_models - INFO - Cross-validation details for 211:
2025-06-01 21:09:48,225 - train_models - INFO -   Fold 1: MAE=1.1122, RMSE=1.7373, R²=0.7950, MAPE=17.23%
2025-06-01 21:09:48,225 - train_models - INFO -   Fold 2: MAE=0.5746, RMSE=0.9278, R²=0.9220, MAPE=9.41%
2025-06-01 21:09:48,226 - train_models - INFO -   Fold 3: MAE=0.4636, RMSE=0.7220, R²=0.9569, MAPE=8.99%
2025-06-01 21:09:48,226 - train_models - INFO -   Fold 4: MAE=0.5934, RMSE=0.9030, R²=0.9316, MAPE=11.82%
2025-06-01 21:09:48,226 - train_models - INFO -   Fold 5: MAE=0.4981, RMSE=0.7113, R²=0.9481, MAPE=9.93%
2025-06-01 21:09:48,227 - train_models - INFO - Building model for WorkType: 213
2025-06-01 21:09:50,580 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:10:28,534 - train_models - INFO - Model for 213 - MAE: 0.3932, RMSE: 0.5862, R²: 0.8881, MAPE: 15.61%
2025-06-01 21:10:28,534 - train_models - INFO - Top 10 most important features for 213:
2025-06-01 21:10:28,534 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4403
2025-06-01 21:10:28,535 - train_models - INFO -   NoOfMan_7day_trend: 0.2114
2025-06-01 21:10:28,535 - train_models - INFO -   NoOfMan_1day_trend: 0.1424
2025-06-01 21:10:28,535 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0531
2025-06-01 21:10:28,535 - train_models - INFO -   NoOfMan_lag_1: 0.0451
2025-06-01 21:10:28,536 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0330
2025-06-01 21:10:28,536 - train_models - INFO -   NoOfMan_lag_7: 0.0278
2025-06-01 21:10:28,536 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0068
2025-06-01 21:10:28,537 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-01 21:10:28,537 - train_models - INFO -   NoOfMan_lag_3: 0.0031
2025-06-01 21:10:28,537 - train_models - INFO - Cross-validation details for 213:
2025-06-01 21:10:28,537 - train_models - INFO -   Fold 1: MAE=0.5252, RMSE=0.7744, R²=0.8596, MAPE=15.25%
2025-06-01 21:10:28,538 - train_models - INFO -   Fold 2: MAE=0.4515, RMSE=0.6321, R²=0.8629, MAPE=23.61%
2025-06-01 21:10:28,538 - train_models - INFO -   Fold 3: MAE=0.3211, RMSE=0.5237, R²=0.8983, MAPE=15.00%
2025-06-01 21:10:28,538 - train_models - INFO -   Fold 4: MAE=0.3378, RMSE=0.4972, R²=0.9061, MAPE=13.28%
2025-06-01 21:10:28,539 - train_models - INFO -   Fold 5: MAE=0.3306, RMSE=0.5037, R²=0.9137, MAPE=10.93%
2025-06-01 21:10:28,539 - train_models - INFO - Building model for WorkType: 214
2025-06-01 21:10:31,138 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:11:07,959 - train_models - INFO - Model for 214 - MAE: 0.4606, RMSE: 0.6960, R²: 0.8892, MAPE: 10.30%
2025-06-01 21:11:07,959 - train_models - INFO - Top 10 most important features for 214:
2025-06-01 21:11:07,960 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5059
2025-06-01 21:11:07,960 - train_models - INFO -   NoOfMan_7day_trend: 0.1861
2025-06-01 21:11:07,960 - train_models - INFO -   NoOfMan_1day_trend: 0.0837
2025-06-01 21:11:07,961 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0655
2025-06-01 21:11:07,961 - train_models - INFO -   NoOfMan_lag_7: 0.0540
2025-06-01 21:11:07,961 - train_models - INFO -   NoOfMan_lag_1: 0.0418
2025-06-01 21:11:07,961 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-01 21:11:07,962 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0071
2025-06-01 21:11:07,962 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-01 21:11:07,962 - train_models - INFO -   NoOfMan_lag_2: 0.0035
2025-06-01 21:11:07,963 - train_models - INFO - Cross-validation details for 214:
2025-06-01 21:11:07,963 - train_models - INFO -   Fold 1: MAE=0.5008, RMSE=0.6928, R²=0.8328, MAPE=13.58%
2025-06-01 21:11:07,963 - train_models - INFO -   Fold 2: MAE=0.4204, RMSE=0.5340, R²=0.9206, MAPE=10.02%
2025-06-01 21:11:07,963 - train_models - INFO -   Fold 3: MAE=0.3151, RMSE=0.4373, R²=0.9479, MAPE=9.00%
2025-06-01 21:11:07,964 - train_models - INFO -   Fold 4: MAE=0.3053, RMSE=0.5442, R²=0.9311, MAPE=5.49%
2025-06-01 21:11:07,964 - train_models - INFO -   Fold 5: MAE=0.7616, RMSE=1.2717, R²=0.8138, MAPE=13.41%
2025-06-01 21:11:07,964 - train_models - INFO - Building model for WorkType: 215
2025-06-01 21:11:10,711 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:11:54,263 - train_models - INFO - Model for 215 - MAE: 0.6809, RMSE: 1.0595, R²: 0.8966, MAPE: 15.72%
2025-06-01 21:11:54,263 - train_models - INFO - Top 10 most important features for 215:
2025-06-01 21:11:54,263 - train_models - INFO -   NoOfMan_7day_trend: 0.1741
2025-06-01 21:11:54,263 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1717
2025-06-01 21:11:54,264 - train_models - INFO -   DayOfWeek_feat_6: 0.1659
2025-06-01 21:11:54,264 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1419
2025-06-01 21:11:54,264 - train_models - INFO -   NoOfMan_1day_trend: 0.1236
2025-06-01 21:11:54,265 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0666
2025-06-01 21:11:54,265 - train_models - INFO -   NoOfMan_lag_1: 0.0333
2025-06-01 21:11:54,265 - train_models - INFO -   NoOfMan_lag_7: 0.0301
2025-06-01 21:11:54,265 - train_models - INFO -   Quantity_7day_trend: 0.0113
2025-06-01 21:11:54,266 - train_models - INFO -   Quantity_1day_trend: 0.0098
2025-06-01 21:11:54,266 - train_models - INFO - Cross-validation details for 215:
2025-06-01 21:11:54,266 - train_models - INFO -   Fold 1: MAE=0.9833, RMSE=1.5269, R²=0.8062, MAPE=26.21%
2025-06-01 21:11:54,266 - train_models - INFO -   Fold 2: MAE=0.6939, RMSE=1.0014, R²=0.9137, MAPE=16.78%
2025-06-01 21:11:54,267 - train_models - INFO -   Fold 3: MAE=0.6709, RMSE=1.0383, R²=0.9043, MAPE=11.72%
2025-06-01 21:11:54,267 - train_models - INFO -   Fold 4: MAE=0.5287, RMSE=0.8017, R²=0.9335, MAPE=13.18%
2025-06-01 21:11:54,267 - train_models - INFO -   Fold 5: MAE=0.5277, RMSE=0.9295, R²=0.9255, MAPE=10.70%
2025-06-01 21:11:54,267 - train_models - INFO - Building model for WorkType: 217
2025-06-01 21:11:56,562 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-01 21:12:30,263 - train_models - INFO - Model for 217 - MAE: 0.3985, RMSE: 0.5414, R²: 0.9139, MAPE: 17.42%
2025-06-01 21:12:30,264 - train_models - INFO - Top 10 most important features for 217:
2025-06-01 21:12:30,264 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5684
2025-06-01 21:12:30,264 - train_models - INFO -   NoOfMan_7day_trend: 0.1240
2025-06-01 21:12:30,264 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0837
2025-06-01 21:12:30,265 - train_models - INFO -   NoOfMan_lag_1: 0.0683
2025-06-01 21:12:30,265 - train_models - INFO -   NoOfMan_1day_trend: 0.0641
2025-06-01 21:12:30,265 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0342
2025-06-01 21:12:30,266 - train_models - INFO -   NoOfMan_lag_7: 0.0282
2025-06-01 21:12:30,266 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0046
2025-06-01 21:12:30,266 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-06-01 21:12:30,266 - train_models - INFO -   NoOfMan_lag_2: 0.0018
2025-06-01 21:12:30,267 - train_models - INFO - Cross-validation details for 217:
2025-06-01 21:12:30,267 - train_models - INFO -   Fold 1: MAE=0.5485, RMSE=0.6803, R²=0.8390, MAPE=25.82%
2025-06-01 21:12:30,267 - train_models - INFO -   Fold 2: MAE=0.4285, RMSE=0.5650, R²=0.9025, MAPE=21.38%
2025-06-01 21:12:30,267 - train_models - INFO -   Fold 3: MAE=0.3421, RMSE=0.4593, R²=0.9501, MAPE=12.62%
2025-06-01 21:12:30,268 - train_models - INFO -   Fold 4: MAE=0.3079, RMSE=0.3934, R²=0.9674, MAPE=13.48%
2025-06-01 21:12:30,268 - train_models - INFO -   Fold 5: MAE=0.3653, RMSE=0.6092, R²=0.9103, MAPE=13.80%
2025-06-01 21:12:30,268 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-01 21:12:31,008 - train_models - INFO - Model files saved successfully
2025-06-01 21:12:31,008 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-01 21:12:31,013 - train_models - INFO - Model training completed successfully
2025-06-02 10:01:54,565 - train_models - INFO - Starting the model training process
2025-06-02 10:01:54,565 - train_models - INFO - Training from SQL database (command line argument)
2025-06-02 10:01:54,569 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-02 10:01:54,685 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND Hours <> 0
                ORDER BY Date
            
2025-06-02 10:01:54,943 - train_models - INFO - Read chunk of 10000 rows
2025-06-02 10:01:54,965 - train_models - INFO - Read chunk of 5359 rows
2025-06-02 10:01:54,982 - train_models - INFO - Data loaded successfully. Total rows: 15359
2025-06-02 10:01:54,982 - train_models - INFO - Converting Date column to datetime format
2025-06-02 10:01:54,992 - train_models - INFO - Engineering features...
2025-06-02 10:01:55,436 - utils.feature_engineering - INFO - Engineering features
2025-06-02 10:01:55,463 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-02 10:01:55,468 - train_models - INFO - Creating lag features...
2025-06-02 10:01:55,477 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-02 10:01:55,634 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-02 10:01:55,634 - utils.feature_engineering - INFO - Final shape: (15359, 70)
2025-06-02 10:01:55,648 - train_models - INFO - Found 10 unique work types
2025-06-02 10:01:55,649 - train_models - INFO - Building models for 10 work types
2025-06-02 10:01:55,649 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-02 10:01:55,649 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-02 10:01:55,650 - train_models - INFO - Building model for WorkType: 202
2025-06-02 10:01:57,395 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:02:20,328 - train_models - INFO - Model for 202 - MAE: 0.2121, RMSE: 0.3305, R²: 0.7462, MAPE: 10.12%
2025-06-02 10:02:20,328 - train_models - INFO - Top 10 most important features for 202:
2025-06-02 10:02:20,328 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3965
2025-06-02 10:02:20,328 - train_models - INFO -   NoOfMan_7day_trend: 0.1981
2025-06-02 10:02:20,329 - train_models - INFO -   NoOfMan_1day_trend: 0.1273
2025-06-02 10:02:20,329 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-02 10:02:20,329 - train_models - INFO -   NoOfMan_lag_1: 0.0674
2025-06-02 10:02:20,329 - train_models - INFO -   NoOfMan_lag_7: 0.0659
2025-06-02 10:02:20,329 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0386
2025-06-02 10:02:20,330 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-02 10:02:20,330 - train_models - INFO -   Quantity_rolling_mean_7: 0.0021
2025-06-02 10:02:20,330 - train_models - INFO -   Quantity_lag_7: 0.0021
2025-06-02 10:02:20,330 - train_models - INFO - Cross-validation details for 202:
2025-06-02 10:02:20,331 - train_models - INFO -   Fold 1: MAE=0.2222, RMSE=0.4181, R²=0.3874, MAPE=11.30%
2025-06-02 10:02:20,331 - train_models - INFO -   Fold 2: MAE=0.2016, RMSE=0.3019, R²=0.7901, MAPE=11.19%
2025-06-02 10:02:20,331 - train_models - INFO -   Fold 3: MAE=0.2276, RMSE=0.3600, R²=0.7983, MAPE=11.70%
2025-06-02 10:02:20,331 - train_models - INFO -   Fold 4: MAE=0.1745, RMSE=0.2277, R²=0.8945, MAPE=8.04%
2025-06-02 10:02:20,332 - train_models - INFO -   Fold 5: MAE=0.2347, RMSE=0.3450, R²=0.8606, MAPE=8.38%
2025-06-02 10:02:20,332 - train_models - INFO - Building model for WorkType: 203
2025-06-02 10:02:21,930 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:02:47,939 - train_models - INFO - Model for 203 - MAE: 0.2242, RMSE: 0.3229, R²: 0.9147, MAPE: 4.69%
2025-06-02 10:02:47,939 - train_models - INFO - Top 10 most important features for 203:
2025-06-02 10:02:47,939 - train_models - INFO -   NoOfMan_7day_trend: 0.3049
2025-06-02 10:02:47,939 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-02 10:02:47,939 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1217
2025-06-02 10:02:47,940 - train_models - INFO -   NoOfMan_1day_trend: 0.0916
2025-06-02 10:02:47,940 - train_models - INFO -   NoOfMan_lag_7: 0.0841
2025-06-02 10:02:47,940 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0720
2025-06-02 10:02:47,940 - train_models - INFO -   NoOfMan_lag_1: 0.0531
2025-06-02 10:02:47,941 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-06-02 10:02:47,941 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-06-02 10:02:47,941 - train_models - INFO -   NoOfMan_lag_2: 0.0026
2025-06-02 10:02:47,941 - train_models - INFO - Cross-validation details for 203:
2025-06-02 10:02:47,942 - train_models - INFO -   Fold 1: MAE=0.2863, RMSE=0.3951, R²=0.8770, MAPE=5.74%
2025-06-02 10:02:47,942 - train_models - INFO -   Fold 2: MAE=0.2562, RMSE=0.3466, R²=0.9125, MAPE=5.04%
2025-06-02 10:02:47,942 - train_models - INFO -   Fold 3: MAE=0.2273, RMSE=0.3641, R²=0.9001, MAPE=4.25%
2025-06-02 10:02:47,942 - train_models - INFO -   Fold 4: MAE=0.1799, RMSE=0.2720, R²=0.9400, MAPE=4.25%
2025-06-02 10:02:47,942 - train_models - INFO -   Fold 5: MAE=0.1711, RMSE=0.2369, R²=0.9440, MAPE=4.19%
2025-06-02 10:02:47,943 - train_models - INFO - Building model for WorkType: 206
2025-06-02 10:02:49,759 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:03:28,220 - train_models - INFO - Model for 206 - MAE: 1.4349, RMSE: 2.1913, R²: 0.9293, MAPE: 8.21%
2025-06-02 10:03:28,220 - train_models - INFO - Top 10 most important features for 206:
2025-06-02 10:03:28,221 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5326
2025-06-02 10:03:28,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1477
2025-06-02 10:03:28,221 - train_models - INFO -   NoOfMan_1day_trend: 0.0716
2025-06-02 10:03:28,221 - train_models - INFO -   DayOfWeek_feat_6: 0.0637
2025-06-02 10:03:28,221 - train_models - INFO -   NoOfMan_7day_trend: 0.0528
2025-06-02 10:03:28,222 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0385
2025-06-02 10:03:28,222 - train_models - INFO -   NoOfMan_lag_1: 0.0268
2025-06-02 10:03:28,222 - train_models - INFO -   NoOfMan_lag_7: 0.0072
2025-06-02 10:03:28,222 - train_models - INFO -   Quantity_rolling_mean_7: 0.0068
2025-06-02 10:03:28,223 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0058
2025-06-02 10:03:28,223 - train_models - INFO - Cross-validation details for 206:
2025-06-02 10:03:28,223 - train_models - INFO -   Fold 1: MAE=1.7344, RMSE=2.3918, R²=0.9231, MAPE=9.87%
2025-06-02 10:03:28,223 - train_models - INFO -   Fold 2: MAE=1.6224, RMSE=2.3514, R²=0.9219, MAPE=8.85%
2025-06-02 10:03:28,223 - train_models - INFO -   Fold 3: MAE=1.5351, RMSE=2.6268, R²=0.8964, MAPE=8.99%
2025-06-02 10:03:28,224 - train_models - INFO -   Fold 4: MAE=0.9605, RMSE=1.4548, R²=0.9596, MAPE=6.28%
2025-06-02 10:03:28,224 - train_models - INFO -   Fold 5: MAE=1.3219, RMSE=2.1318, R²=0.9454, MAPE=7.05%
2025-06-02 10:03:28,224 - train_models - INFO - Building model for WorkType: 209
2025-06-02 10:03:30,062 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:03:57,818 - train_models - INFO - Model for 209 - MAE: 0.8926, RMSE: 1.4008, R²: 0.8867, MAPE: 12.46%
2025-06-02 10:03:57,819 - train_models - INFO - Top 10 most important features for 209:
2025-06-02 10:03:57,819 - train_models - INFO -   NoOfMan_7day_trend: 0.4019
2025-06-02 10:03:57,819 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2246
2025-06-02 10:03:57,820 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0965
2025-06-02 10:03:57,820 - train_models - INFO -   NoOfMan_1day_trend: 0.0671
2025-06-02 10:03:57,820 - train_models - INFO -   NoOfMan_lag_7: 0.0518
2025-06-02 10:03:57,821 - train_models - INFO -   Quantity_rolling_mean_7: 0.0395
2025-06-02 10:03:57,821 - train_models - INFO -   NoOfMan_lag_1: 0.0275
2025-06-02 10:03:57,821 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0192
2025-06-02 10:03:57,821 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-06-02 10:03:57,822 - train_models - INFO -   Quantity_7day_trend: 0.0084
2025-06-02 10:03:57,822 - train_models - INFO - Cross-validation details for 209:
2025-06-02 10:03:57,822 - train_models - INFO -   Fold 1: MAE=1.0019, RMSE=1.4685, R²=0.8559, MAPE=13.83%
2025-06-02 10:03:57,822 - train_models - INFO -   Fold 2: MAE=1.0352, RMSE=1.7638, R²=0.8396, MAPE=15.12%
2025-06-02 10:03:57,823 - train_models - INFO -   Fold 3: MAE=0.6516, RMSE=0.8736, R²=0.9401, MAPE=10.39%
2025-06-02 10:03:57,823 - train_models - INFO -   Fold 4: MAE=0.8488, RMSE=1.3921, R²=0.9013, MAPE=11.09%
2025-06-02 10:03:57,823 - train_models - INFO -   Fold 5: MAE=0.9253, RMSE=1.5062, R²=0.8968, MAPE=11.87%
2025-06-02 10:03:57,823 - train_models - INFO - Building model for WorkType: 210
2025-06-02 10:03:59,376 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:04:26,912 - train_models - INFO - Model for 210 - MAE: 0.8170, RMSE: 1.1899, R²: 0.8878, MAPE: 17.63%
2025-06-02 10:04:26,912 - train_models - INFO - Top 10 most important features for 210:
2025-06-02 10:04:26,912 - train_models - INFO -   NoOfMan_7day_trend: 0.2622
2025-06-02 10:04:26,913 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2054
2025-06-02 10:04:26,913 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1685
2025-06-02 10:04:26,913 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0665
2025-06-02 10:04:26,913 - train_models - INFO -   NoOfMan_1day_trend: 0.0610
2025-06-02 10:04:26,914 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-06-02 10:04:26,914 - train_models - INFO -   Quantity_1day_trend: 0.0293
2025-06-02 10:04:26,914 - train_models - INFO -   NoOfMan_lag_1: 0.0284
2025-06-02 10:04:26,915 - train_models - INFO -   DayOfWeek_feat_6: 0.0256
2025-06-02 10:04:26,915 - train_models - INFO -   Quantity_7day_trend: 0.0183
2025-06-02 10:04:26,915 - train_models - INFO - Cross-validation details for 210:
2025-06-02 10:04:26,916 - train_models - INFO -   Fold 1: MAE=0.8290, RMSE=1.1500, R²=0.8814, MAPE=13.56%
2025-06-02 10:04:26,916 - train_models - INFO -   Fold 2: MAE=0.7285, RMSE=1.0597, R²=0.8971, MAPE=12.38%
2025-06-02 10:04:26,916 - train_models - INFO -   Fold 3: MAE=0.6101, RMSE=0.8538, R²=0.9301, MAPE=8.56%
2025-06-02 10:04:26,916 - train_models - INFO -   Fold 4: MAE=0.9058, RMSE=1.2655, R²=0.8774, MAPE=27.19%
2025-06-02 10:04:26,917 - train_models - INFO -   Fold 5: MAE=1.0113, RMSE=1.6202, R²=0.8531, MAPE=26.46%
2025-06-02 10:04:26,917 - train_models - INFO - Building model for WorkType: 211
2025-06-02 10:04:28,557 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:05:07,731 - train_models - INFO - Model for 211 - MAE: 0.6484, RMSE: 1.0003, R²: 0.9107, MAPE: 11.48%
2025-06-02 10:05:07,732 - train_models - INFO - Top 10 most important features for 211:
2025-06-02 10:05:07,732 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3468
2025-06-02 10:05:07,732 - train_models - INFO -   NoOfMan_7day_trend: 0.1766
2025-06-02 10:05:07,732 - train_models - INFO -   NoOfMan_1day_trend: 0.1700
2025-06-02 10:05:07,733 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-02 10:05:07,733 - train_models - INFO -   DayOfWeek_feat_6: 0.0530
2025-06-02 10:05:07,734 - train_models - INFO -   NoOfMan_lag_1: 0.0456
2025-06-02 10:05:07,734 - train_models - INFO -   NoOfMan_lag_7: 0.0393
2025-06-02 10:05:07,734 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0387
2025-06-02 10:05:07,734 - train_models - INFO -   Quantity_same_dow_lag: 0.0130
2025-06-02 10:05:07,735 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-06-02 10:05:07,735 - train_models - INFO - Cross-validation details for 211:
2025-06-02 10:05:07,735 - train_models - INFO -   Fold 1: MAE=1.1122, RMSE=1.7373, R²=0.7950, MAPE=17.23%
2025-06-02 10:05:07,736 - train_models - INFO -   Fold 2: MAE=0.5746, RMSE=0.9278, R²=0.9220, MAPE=9.41%
2025-06-02 10:05:07,736 - train_models - INFO -   Fold 3: MAE=0.4636, RMSE=0.7220, R²=0.9569, MAPE=8.99%
2025-06-02 10:05:07,736 - train_models - INFO -   Fold 4: MAE=0.5934, RMSE=0.9030, R²=0.9316, MAPE=11.82%
2025-06-02 10:05:07,737 - train_models - INFO -   Fold 5: MAE=0.4981, RMSE=0.7113, R²=0.9481, MAPE=9.93%
2025-06-02 10:05:07,738 - train_models - INFO - Building model for WorkType: 213
2025-06-02 10:05:09,925 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:05:40,325 - train_models - INFO - Model for 213 - MAE: 0.3932, RMSE: 0.5862, R²: 0.8881, MAPE: 15.61%
2025-06-02 10:05:40,325 - train_models - INFO - Top 10 most important features for 213:
2025-06-02 10:05:40,326 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4403
2025-06-02 10:05:40,326 - train_models - INFO -   NoOfMan_7day_trend: 0.2114
2025-06-02 10:05:40,326 - train_models - INFO -   NoOfMan_1day_trend: 0.1424
2025-06-02 10:05:40,326 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0531
2025-06-02 10:05:40,327 - train_models - INFO -   NoOfMan_lag_1: 0.0451
2025-06-02 10:05:40,327 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0330
2025-06-02 10:05:40,327 - train_models - INFO -   NoOfMan_lag_7: 0.0278
2025-06-02 10:05:40,327 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0068
2025-06-02 10:05:40,327 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-02 10:05:40,328 - train_models - INFO -   NoOfMan_lag_3: 0.0031
2025-06-02 10:05:40,328 - train_models - INFO - Cross-validation details for 213:
2025-06-02 10:05:40,328 - train_models - INFO -   Fold 1: MAE=0.5252, RMSE=0.7744, R²=0.8596, MAPE=15.25%
2025-06-02 10:05:40,329 - train_models - INFO -   Fold 2: MAE=0.4515, RMSE=0.6321, R²=0.8629, MAPE=23.61%
2025-06-02 10:05:40,329 - train_models - INFO -   Fold 3: MAE=0.3211, RMSE=0.5237, R²=0.8983, MAPE=15.00%
2025-06-02 10:05:40,329 - train_models - INFO -   Fold 4: MAE=0.3378, RMSE=0.4972, R²=0.9061, MAPE=13.28%
2025-06-02 10:05:40,329 - train_models - INFO -   Fold 5: MAE=0.3306, RMSE=0.5037, R²=0.9137, MAPE=10.93%
2025-06-02 10:05:40,330 - train_models - INFO - Building model for WorkType: 214
2025-06-02 10:05:42,168 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:06:13,788 - train_models - INFO - Model for 214 - MAE: 0.4606, RMSE: 0.6960, R²: 0.8892, MAPE: 10.30%
2025-06-02 10:06:13,788 - train_models - INFO - Top 10 most important features for 214:
2025-06-02 10:06:13,788 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5059
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_7day_trend: 0.1861
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_1day_trend: 0.0837
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0655
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_lag_7: 0.0540
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_lag_1: 0.0418
2025-06-02 10:06:13,789 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-02 10:06:13,790 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0071
2025-06-02 10:06:13,790 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-02 10:06:13,790 - train_models - INFO -   NoOfMan_lag_2: 0.0035
2025-06-02 10:06:13,790 - train_models - INFO - Cross-validation details for 214:
2025-06-02 10:06:13,790 - train_models - INFO -   Fold 1: MAE=0.5008, RMSE=0.6928, R²=0.8328, MAPE=13.58%
2025-06-02 10:06:13,790 - train_models - INFO -   Fold 2: MAE=0.4204, RMSE=0.5340, R²=0.9206, MAPE=10.02%
2025-06-02 10:06:13,791 - train_models - INFO -   Fold 3: MAE=0.3151, RMSE=0.4373, R²=0.9479, MAPE=9.00%
2025-06-02 10:06:13,791 - train_models - INFO -   Fold 4: MAE=0.3053, RMSE=0.5442, R²=0.9311, MAPE=5.49%
2025-06-02 10:06:13,791 - train_models - INFO -   Fold 5: MAE=0.7616, RMSE=1.2717, R²=0.8138, MAPE=13.41%
2025-06-02 10:06:13,791 - train_models - INFO - Building model for WorkType: 215
2025-06-02 10:06:15,989 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:06:51,674 - train_models - INFO - Model for 215 - MAE: 0.6809, RMSE: 1.0595, R²: 0.8966, MAPE: 15.72%
2025-06-02 10:06:51,674 - train_models - INFO - Top 10 most important features for 215:
2025-06-02 10:06:51,675 - train_models - INFO -   NoOfMan_7day_trend: 0.1741
2025-06-02 10:06:51,675 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1717
2025-06-02 10:06:51,675 - train_models - INFO -   DayOfWeek_feat_6: 0.1659
2025-06-02 10:06:51,675 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1419
2025-06-02 10:06:51,675 - train_models - INFO -   NoOfMan_1day_trend: 0.1236
2025-06-02 10:06:51,676 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0666
2025-06-02 10:06:51,676 - train_models - INFO -   NoOfMan_lag_1: 0.0333
2025-06-02 10:06:51,676 - train_models - INFO -   NoOfMan_lag_7: 0.0301
2025-06-02 10:06:51,676 - train_models - INFO -   Quantity_7day_trend: 0.0113
2025-06-02 10:06:51,676 - train_models - INFO -   Quantity_1day_trend: 0.0098
2025-06-02 10:06:51,676 - train_models - INFO - Cross-validation details for 215:
2025-06-02 10:06:51,677 - train_models - INFO -   Fold 1: MAE=0.9833, RMSE=1.5269, R²=0.8062, MAPE=26.21%
2025-06-02 10:06:51,677 - train_models - INFO -   Fold 2: MAE=0.6939, RMSE=1.0014, R²=0.9137, MAPE=16.78%
2025-06-02 10:06:51,677 - train_models - INFO -   Fold 3: MAE=0.6709, RMSE=1.0383, R²=0.9043, MAPE=11.72%
2025-06-02 10:06:51,677 - train_models - INFO -   Fold 4: MAE=0.5287, RMSE=0.8017, R²=0.9335, MAPE=13.18%
2025-06-02 10:06:51,677 - train_models - INFO -   Fold 5: MAE=0.5277, RMSE=0.9295, R²=0.9255, MAPE=10.70%
2025-06-02 10:06:51,678 - train_models - INFO - Building model for WorkType: 217
2025-06-02 10:06:53,284 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-02 10:07:20,112 - train_models - INFO - Model for 217 - MAE: 0.3985, RMSE: 0.5414, R²: 0.9139, MAPE: 17.42%
2025-06-02 10:07:20,113 - train_models - INFO - Top 10 most important features for 217:
2025-06-02 10:07:20,113 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5684
2025-06-02 10:07:20,113 - train_models - INFO -   NoOfMan_7day_trend: 0.1240
2025-06-02 10:07:20,113 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0837
2025-06-02 10:07:20,114 - train_models - INFO -   NoOfMan_lag_1: 0.0683
2025-06-02 10:07:20,114 - train_models - INFO -   NoOfMan_1day_trend: 0.0641
2025-06-02 10:07:20,114 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0342
2025-06-02 10:07:20,114 - train_models - INFO -   NoOfMan_lag_7: 0.0282
2025-06-02 10:07:20,114 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0046
2025-06-02 10:07:20,115 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-06-02 10:07:20,115 - train_models - INFO -   NoOfMan_lag_2: 0.0018
2025-06-02 10:07:20,115 - train_models - INFO - Cross-validation details for 217:
2025-06-02 10:07:20,115 - train_models - INFO -   Fold 1: MAE=0.5485, RMSE=0.6803, R²=0.8390, MAPE=25.82%
2025-06-02 10:07:20,115 - train_models - INFO -   Fold 2: MAE=0.4285, RMSE=0.5650, R²=0.9025, MAPE=21.38%
2025-06-02 10:07:20,116 - train_models - INFO -   Fold 3: MAE=0.3421, RMSE=0.4593, R²=0.9501, MAPE=12.62%
2025-06-02 10:07:20,116 - train_models - INFO -   Fold 4: MAE=0.3079, RMSE=0.3934, R²=0.9674, MAPE=13.48%
2025-06-02 10:07:20,116 - train_models - INFO -   Fold 5: MAE=0.3653, RMSE=0.6092, R²=0.9103, MAPE=13.80%
2025-06-02 10:07:20,117 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-02 10:07:20,593 - train_models - INFO - Model files saved successfully
2025-06-02 10:07:20,593 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-02 10:07:20,596 - train_models - INFO - Model training completed successfully
2025-06-02 10:18:30,043 - train_models - INFO - Starting the model training process
2025-06-02 10:18:30,043 - train_models - INFO - Training from SQL database (command line argument)
2025-06-02 10:18:30,047 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-02 10:18:30,156 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) AND Hours <> 0
                ORDER BY Date
            
2025-06-02 10:18:30,735 - train_models - INFO - Read chunk of 10000 rows
2025-06-02 10:18:30,812 - train_models - INFO - Read chunk of 5359 rows
2025-06-02 10:18:30,829 - train_models - INFO - Data loaded successfully. Total rows: 15359
2025-06-02 10:18:30,829 - train_models - INFO - Converting Date column to datetime format
2025-06-02 10:18:30,841 - train_models - INFO - Engineering features...
2025-06-04 10:37:11,313 - train_models - INFO - Starting the model training process
2025-06-04 10:37:11,314 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 10:37:11,321 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 10:37:11,618 - train_models - INFO - Executing SQL query: 
               SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) AND SystemHours <> 0
                AND Hours <> 0 and Quantity > 0
                AND Date > '2023-01-01'
                ORDER BY Date
            
2025-06-04 10:37:12,465 - train_models - INFO - Read chunk of 6241 rows
2025-06-04 10:37:12,487 - train_models - INFO - Data loaded successfully. Total rows: 6241
2025-06-04 10:37:12,488 - train_models - INFO - Converting Date column to datetime format
2025-06-04 10:37:12,508 - train_models - INFO - Engineering features...
2025-06-04 10:37:13,317 - utils.feature_engineering - INFO - Engineering features
2025-06-04 10:37:13,370 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 10:37:13,375 - train_models - INFO - Creating lag features...
2025-06-04 10:37:13,385 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 10:37:13,565 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 10:37:13,566 - utils.feature_engineering - INFO - Final shape: (6241, 70)
2025-06-04 10:37:13,571 - train_models - INFO - Found 10 unique work types
2025-06-04 10:37:13,572 - train_models - INFO - Building models for 10 work types
2025-06-04 10:37:13,572 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 10:37:13,573 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 10:37:13,573 - train_models - INFO - Building model for WorkType: 202
2025-06-04 10:37:15,207 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:37:26,991 - train_models - INFO - Model for 202 - MAE: 0.2757, RMSE: 0.3676, R²: 0.7743, MAPE: 11.62%
2025-06-04 10:37:26,992 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 10:37:26,993 - train_models - INFO -   NoOfMan_7day_trend: 0.2557
2025-06-04 10:37:26,993 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2535
2025-06-04 10:37:26,994 - train_models - INFO -   NoOfMan_1day_trend: 0.1123
2025-06-04 10:37:26,994 - train_models - INFO -   NoOfMan_lag_7: 0.0924
2025-06-04 10:37:26,995 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0841
2025-06-04 10:37:26,996 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0836
2025-06-04 10:37:26,996 - train_models - INFO -   NoOfMan_lag_1: 0.0514
2025-06-04 10:37:26,997 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0062
2025-06-04 10:37:26,998 - train_models - INFO -   Quantity_rolling_mean_7: 0.0046
2025-06-04 10:37:26,998 - train_models - INFO -   Quantity_lag_7: 0.0046
2025-06-04 10:37:26,999 - train_models - INFO - Cross-validation details for 202:
2025-06-04 10:37:27,000 - train_models - INFO -   Fold 1: MAE=0.3798, RMSE=0.4780, R²=0.5438, MAPE=16.20%
2025-06-04 10:37:27,001 - train_models - INFO -   Fold 2: MAE=0.2575, RMSE=0.3283, R²=0.7820, MAPE=12.67%
2025-06-04 10:37:27,002 - train_models - INFO -   Fold 3: MAE=0.2294, RMSE=0.3413, R²=0.8266, MAPE=8.77%
2025-06-04 10:37:27,002 - train_models - INFO -   Fold 4: MAE=0.2812, RMSE=0.3915, R²=0.8411, MAPE=9.29%
2025-06-04 10:37:27,003 - train_models - INFO -   Fold 5: MAE=0.2307, RMSE=0.2987, R²=0.8779, MAPE=11.18%
2025-06-04 10:37:27,004 - train_models - INFO - Building model for WorkType: 203
2025-06-04 10:37:27,967 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:37:41,924 - train_models - INFO - Model for 203 - MAE: 0.3644, RMSE: 0.4748, R²: 0.7949, MAPE: 8.41%
2025-06-04 10:37:41,924 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 10:37:41,925 - train_models - INFO -   NoOfMan_7day_trend: 0.3260
2025-06-04 10:37:41,925 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1480
2025-06-04 10:37:41,925 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1398
2025-06-04 10:37:41,926 - train_models - INFO -   NoOfMan_1day_trend: 0.0973
2025-06-04 10:37:41,926 - train_models - INFO -   NoOfMan_lag_7: 0.0964
2025-06-04 10:37:41,926 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0836
2025-06-04 10:37:41,927 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 10:37:41,927 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-06-04 10:37:41,927 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0050
2025-06-04 10:37:41,928 - train_models - INFO -   NoOfMan_lag_2: 0.0041
2025-06-04 10:37:41,928 - train_models - INFO - Cross-validation details for 203:
2025-06-04 10:37:41,928 - train_models - INFO -   Fold 1: MAE=0.6025, RMSE=0.7625, R²=0.6362, MAPE=12.55%
2025-06-04 10:37:41,928 - train_models - INFO -   Fold 2: MAE=0.3886, RMSE=0.5346, R²=0.7524, MAPE=9.43%
2025-06-04 10:37:41,929 - train_models - INFO -   Fold 3: MAE=0.3397, RMSE=0.4408, R²=0.8248, MAPE=8.63%
2025-06-04 10:37:41,929 - train_models - INFO -   Fold 4: MAE=0.2391, RMSE=0.2788, R²=0.9065, MAPE=5.06%
2025-06-04 10:37:41,929 - train_models - INFO -   Fold 5: MAE=0.2519, RMSE=0.3572, R²=0.8547, MAPE=6.36%
2025-06-04 10:37:41,930 - train_models - INFO - Building model for WorkType: 206
2025-06-04 10:37:43,135 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:38:06,299 - train_models - INFO - Model for 206 - MAE: 1.7758, RMSE: 2.6924, R²: 0.8807, MAPE: 9.78%
2025-06-04 10:38:06,300 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 10:38:06,301 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3662
2025-06-04 10:38:06,301 - train_models - INFO -   NoOfMan_1day_trend: 0.1584
2025-06-04 10:38:06,302 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0925
2025-06-04 10:38:06,302 - train_models - INFO -   DayOfWeek_feat_6: 0.0819
2025-06-04 10:38:06,303 - train_models - INFO -   NoOfMan_lag_1: 0.0626
2025-06-04 10:38:06,304 - train_models - INFO -   NoOfMan_7day_trend: 0.0569
2025-06-04 10:38:06,304 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0495
2025-06-04 10:38:06,304 - train_models - INFO -   Quantity_same_dow_lag: 0.0343
2025-06-04 10:38:06,305 - train_models - INFO -   Quantity_rolling_mean_7: 0.0272
2025-06-04 10:38:06,305 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0144
2025-06-04 10:38:06,306 - train_models - INFO - Cross-validation details for 206:
2025-06-04 10:38:06,306 - train_models - INFO -   Fold 1: MAE=1.7013, RMSE=2.3113, R²=0.8947, MAPE=9.61%
2025-06-04 10:38:06,307 - train_models - INFO -   Fold 2: MAE=1.9251, RMSE=3.0593, R²=0.8406, MAPE=12.25%
2025-06-04 10:38:06,307 - train_models - INFO -   Fold 3: MAE=1.3181, RMSE=1.9351, R²=0.9200, MAPE=9.58%
2025-06-04 10:38:06,308 - train_models - INFO -   Fold 4: MAE=2.7519, RMSE=4.2940, R²=0.8247, MAPE=10.90%
2025-06-04 10:38:06,309 - train_models - INFO -   Fold 5: MAE=1.1826, RMSE=1.8622, R²=0.9237, MAPE=6.56%
2025-06-04 10:38:06,309 - train_models - INFO - Building model for WorkType: 209
2025-06-04 10:38:07,952 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:38:28,368 - train_models - INFO - Model for 209 - MAE: 1.4695, RMSE: 2.2203, R²: 0.7049, MAPE: 17.71%
2025-06-04 10:38:28,369 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 10:38:28,369 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3174
2025-06-04 10:38:28,370 - train_models - INFO -   NoOfMan_7day_trend: 0.2158
2025-06-04 10:38:28,370 - train_models - INFO -   Quantity_rolling_mean_7: 0.1038
2025-06-04 10:38:28,370 - train_models - INFO -   NoOfMan_1day_trend: 0.0951
2025-06-04 10:38:28,371 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0672
2025-06-04 10:38:28,371 - train_models - INFO -   NoOfMan_lag_7: 0.0258
2025-06-04 10:38:28,372 - train_models - INFO -   Quantity_7day_trend: 0.0234
2025-06-04 10:38:28,372 - train_models - INFO -   NoOfMan_lag_1: 0.0233
2025-06-04 10:38:28,372 - train_models - INFO -   Quantity_1day_trend: 0.0173
2025-06-04 10:38:28,373 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0156
2025-06-04 10:38:28,373 - train_models - INFO - Cross-validation details for 209:
2025-06-04 10:38:28,373 - train_models - INFO -   Fold 1: MAE=1.4325, RMSE=1.9239, R²=0.6122, MAPE=16.94%
2025-06-04 10:38:28,374 - train_models - INFO -   Fold 2: MAE=2.4427, RMSE=4.1656, R²=0.5025, MAPE=22.14%
2025-06-04 10:38:28,374 - train_models - INFO -   Fold 3: MAE=0.9461, RMSE=1.2846, R²=0.8128, MAPE=13.49%
2025-06-04 10:38:28,375 - train_models - INFO -   Fold 4: MAE=1.7000, RMSE=2.4283, R²=0.7867, MAPE=23.99%
2025-06-04 10:38:28,375 - train_models - INFO -   Fold 5: MAE=0.8265, RMSE=1.2993, R²=0.8103, MAPE=11.99%
2025-06-04 10:38:28,375 - train_models - INFO - Building model for WorkType: 210
2025-06-04 10:38:29,436 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:38:48,525 - train_models - INFO - Model for 210 - MAE: 1.2969, RMSE: 1.9467, R²: 0.7110, MAPE: 28.99%
2025-06-04 10:38:48,525 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 10:38:48,526 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2731
2025-06-04 10:38:48,526 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-06-04 10:38:48,526 - train_models - INFO -   NoOfMan_7day_trend: 0.1069
2025-06-04 10:38:48,527 - train_models - INFO -   DayOfWeek_feat_6: 0.0752
2025-06-04 10:38:48,527 - train_models - INFO -   NoOfMan_1day_trend: 0.0752
2025-06-04 10:38:48,528 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0561
2025-06-04 10:38:48,529 - train_models - INFO -   Quantity_1day_trend: 0.0395
2025-06-04 10:38:48,529 - train_models - INFO -   Quantity_7day_trend: 0.0327
2025-06-04 10:38:48,530 - train_models - INFO -   NoOfMan_lag_7: 0.0318
2025-06-04 10:38:48,530 - train_models - INFO -   NoOfMan_lag_1: 0.0282
2025-06-04 10:38:48,531 - train_models - INFO - Cross-validation details for 210:
2025-06-04 10:38:48,531 - train_models - INFO -   Fold 1: MAE=1.2040, RMSE=1.7355, R²=0.5859, MAPE=12.93%
2025-06-04 10:38:48,532 - train_models - INFO -   Fold 2: MAE=1.5773, RMSE=2.2524, R²=0.7005, MAPE=37.02%
2025-06-04 10:38:48,532 - train_models - INFO -   Fold 3: MAE=1.1404, RMSE=1.6451, R²=0.7904, MAPE=43.98%
2025-06-04 10:38:48,533 - train_models - INFO -   Fold 4: MAE=1.6124, RMSE=2.4648, R²=0.7649, MAPE=27.20%
2025-06-04 10:38:48,533 - train_models - INFO -   Fold 5: MAE=0.9504, RMSE=1.6359, R²=0.7132, MAPE=23.84%
2025-06-04 10:38:48,534 - train_models - INFO - Building model for WorkType: 211
2025-06-04 10:38:50,262 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:39:12,804 - train_models - INFO - Model for 211 - MAE: 1.0129, RMSE: 1.4077, R²: 0.7352, MAPE: 17.51%
2025-06-04 10:39:12,804 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 10:39:12,805 - train_models - INFO -   NoOfMan_1day_trend: 0.2081
2025-06-04 10:39:12,805 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1950
2025-06-04 10:39:12,805 - train_models - INFO -   NoOfMan_7day_trend: 0.1789
2025-06-04 10:39:12,806 - train_models - INFO -   DayOfWeek_feat_6: 0.1364
2025-06-04 10:39:12,806 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1227
2025-06-04 10:39:12,806 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 10:39:12,807 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-06-04 10:39:12,807 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0134
2025-06-04 10:39:12,807 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0120
2025-06-04 10:39:12,808 - train_models - INFO -   Quantity_lag_7: 0.0060
2025-06-04 10:39:12,808 - train_models - INFO - Cross-validation details for 211:
2025-06-04 10:39:12,808 - train_models - INFO -   Fold 1: MAE=1.1981, RMSE=1.5578, R²=0.6444, MAPE=12.97%
2025-06-04 10:39:12,809 - train_models - INFO -   Fold 2: MAE=1.3921, RMSE=2.2514, R²=0.7053, MAPE=19.83%
2025-06-04 10:39:12,809 - train_models - INFO -   Fold 3: MAE=1.1313, RMSE=1.3678, R²=0.5256, MAPE=27.76%
2025-06-04 10:39:12,810 - train_models - INFO -   Fold 4: MAE=0.7740, RMSE=0.9776, R²=0.9070, MAPE=9.87%
2025-06-04 10:39:12,810 - train_models - INFO -   Fold 5: MAE=0.5689, RMSE=0.8838, R²=0.8934, MAPE=17.13%
2025-06-04 10:39:12,810 - train_models - INFO - Building model for WorkType: 213
2025-06-04 10:39:13,905 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:39:29,944 - train_models - INFO - Model for 213 - MAE: 0.6391, RMSE: 0.8542, R²: 0.6608, MAPE: 20.43%
2025-06-04 10:39:29,945 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 10:39:29,945 - train_models - INFO -   NoOfMan_7day_trend: 0.3111
2025-06-04 10:39:29,945 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3107
2025-06-04 10:39:29,945 - train_models - INFO -   NoOfMan_1day_trend: 0.1147
2025-06-04 10:39:29,946 - train_models - INFO -   NoOfMan_lag_1: 0.0396
2025-06-04 10:39:29,946 - train_models - INFO -   Quantity_1day_trend: 0.0363
2025-06-04 10:39:29,946 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0329
2025-06-04 10:39:29,947 - train_models - INFO -   NoOfMan_lag_7: 0.0299
2025-06-04 10:39:29,947 - train_models - INFO -   Quantity_7day_trend: 0.0234
2025-06-04 10:39:29,947 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0192
2025-06-04 10:39:29,947 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-06-04 10:39:29,948 - train_models - INFO - Cross-validation details for 213:
2025-06-04 10:39:29,948 - train_models - INFO -   Fold 1: MAE=1.4552, RMSE=1.9452, R²=-0.0658, MAPE=36.72%
2025-06-04 10:39:29,948 - train_models - INFO -   Fold 2: MAE=0.4801, RMSE=0.6083, R²=0.8196, MAPE=19.74%
2025-06-04 10:39:29,949 - train_models - INFO -   Fold 3: MAE=0.4600, RMSE=0.6938, R²=0.8362, MAPE=20.58%
2025-06-04 10:39:29,949 - train_models - INFO -   Fold 4: MAE=0.5397, RMSE=0.6756, R²=0.8221, MAPE=14.47%
2025-06-04 10:39:29,949 - train_models - INFO -   Fold 5: MAE=0.2605, RMSE=0.3480, R²=0.8919, MAPE=10.66%
2025-06-04 10:39:29,950 - train_models - INFO - Building model for WorkType: 214
2025-06-04 10:39:31,088 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:39:46,404 - train_models - INFO - Model for 214 - MAE: 0.9350, RMSE: 1.3071, R²: 0.5655, MAPE: 17.96%
2025-06-04 10:39:46,405 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 10:39:46,405 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5358
2025-06-04 10:39:46,405 - train_models - INFO -   NoOfMan_7day_trend: 0.1303
2025-06-04 10:39:46,406 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0936
2025-06-04 10:39:46,406 - train_models - INFO -   NoOfMan_1day_trend: 0.0754
2025-06-04 10:39:46,406 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0279
2025-06-04 10:39:46,407 - train_models - INFO -   NoOfMan_lag_7: 0.0261
2025-06-04 10:39:46,407 - train_models - INFO -   NoOfMan_lag_1: 0.0251
2025-06-04 10:39:46,407 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0123
2025-06-04 10:39:46,408 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0114
2025-06-04 10:39:46,408 - train_models - INFO -   DayOfWeek_feat_6: 0.0092
2025-06-04 10:39:46,408 - train_models - INFO - Cross-validation details for 214:
2025-06-04 10:39:46,409 - train_models - INFO -   Fold 1: MAE=1.4748, RMSE=1.7929, R²=-0.2129, MAPE=23.19%
2025-06-04 10:39:46,409 - train_models - INFO -   Fold 2: MAE=0.8719, RMSE=1.2268, R²=0.7327, MAPE=15.81%
2025-06-04 10:39:46,409 - train_models - INFO -   Fold 3: MAE=0.8148, RMSE=1.3558, R²=0.7903, MAPE=18.04%
2025-06-04 10:39:46,409 - train_models - INFO -   Fold 4: MAE=1.0794, RMSE=1.5727, R²=0.6599, MAPE=22.63%
2025-06-04 10:39:46,410 - train_models - INFO -   Fold 5: MAE=0.4340, RMSE=0.5875, R²=0.8574, MAPE=10.13%
2025-06-04 10:39:46,410 - train_models - INFO - Building model for WorkType: 215
2025-06-04 10:39:47,512 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:40:05,093 - train_models - INFO - Model for 215 - MAE: 0.8960, RMSE: 1.3572, R²: 0.7939, MAPE: 19.40%
2025-06-04 10:40:05,094 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 10:40:05,094 - train_models - INFO -   DayOfWeek_feat_6: 0.2222
2025-06-04 10:40:05,094 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1930
2025-06-04 10:40:05,095 - train_models - INFO -   NoOfMan_7day_trend: 0.1337
2025-06-04 10:40:05,095 - train_models - INFO -   NoOfMan_1day_trend: 0.0940
2025-06-04 10:40:05,095 - train_models - INFO -   Quantity_rolling_mean_7: 0.0669
2025-06-04 10:40:05,096 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0539
2025-06-04 10:40:05,096 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0537
2025-06-04 10:40:05,096 - train_models - INFO -   NoOfMan_lag_1: 0.0239
2025-06-04 10:40:05,097 - train_models - INFO -   NoOfMan_lag_7: 0.0213
2025-06-04 10:40:05,097 - train_models - INFO -   Quantity_same_dow_lag: 0.0186
2025-06-04 10:40:05,097 - train_models - INFO - Cross-validation details for 215:
2025-06-04 10:40:05,098 - train_models - INFO -   Fold 1: MAE=0.7512, RMSE=0.9457, R²=0.8081, MAPE=15.88%
2025-06-04 10:40:05,098 - train_models - INFO -   Fold 2: MAE=1.1751, RMSE=1.9845, R²=0.7437, MAPE=22.29%
2025-06-04 10:40:05,098 - train_models - INFO -   Fold 3: MAE=0.6940, RMSE=0.9430, R²=0.8029, MAPE=25.43%
2025-06-04 10:40:05,098 - train_models - INFO -   Fold 4: MAE=1.0490, RMSE=1.7207, R²=0.7856, MAPE=11.05%
2025-06-04 10:40:05,099 - train_models - INFO -   Fold 5: MAE=0.8106, RMSE=1.1924, R²=0.8292, MAPE=22.35%
2025-06-04 10:40:05,099 - train_models - INFO - Building model for WorkType: 217
2025-06-04 10:40:06,087 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:40:19,723 - train_models - INFO - Model for 217 - MAE: 0.5961, RMSE: 0.7765, R²: 0.8410, MAPE: 26.48%
2025-06-04 10:40:19,724 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 10:40:19,724 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4840
2025-06-04 10:40:19,724 - train_models - INFO -   NoOfMan_7day_trend: 0.2246
2025-06-04 10:40:19,725 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0860
2025-06-04 10:40:19,725 - train_models - INFO -   NoOfMan_1day_trend: 0.0468
2025-06-04 10:40:19,725 - train_models - INFO -   NoOfMan_lag_7: 0.0442
2025-06-04 10:40:19,726 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0291
2025-06-04 10:40:19,726 - train_models - INFO -   NoOfMan_lag_1: 0.0219
2025-06-04 10:40:19,726 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-06-04 10:40:19,727 - train_models - INFO -   Quantity_rolling_mean_7: 0.0045
2025-06-04 10:40:19,727 - train_models - INFO -   Quantity_lag_7: 0.0045
2025-06-04 10:40:19,727 - train_models - INFO - Cross-validation details for 217:
2025-06-04 10:40:19,727 - train_models - INFO -   Fold 1: MAE=0.8285, RMSE=0.9752, R²=0.7121, MAPE=52.21%
2025-06-04 10:40:19,728 - train_models - INFO -   Fold 2: MAE=0.6699, RMSE=0.8763, R²=0.8463, MAPE=20.13%
2025-06-04 10:40:19,728 - train_models - INFO -   Fold 3: MAE=0.5029, RMSE=0.6957, R²=0.8652, MAPE=23.55%
2025-06-04 10:40:19,728 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.4605, R²=0.9214, MAPE=13.17%
2025-06-04 10:40:19,729 - train_models - INFO -   Fold 5: MAE=0.6291, RMSE=0.8747, R²=0.8599, MAPE=23.34%
2025-06-04 10:40:19,730 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 10:40:20,116 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-04 10:40:20,439 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 425, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-04 10:40:20,443 - train_models - INFO - Model training completed successfully
2025-06-04 10:40:52,626 - train_models - INFO - Starting the model training process
2025-06-04 10:40:52,626 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 10:40:52,634 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 10:40:52,820 - train_models - INFO - Executing SQL query: 
               SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) AND SystemHours <> 0
                AND Hours <> 0 and Quantity > 0
                AND Date > '2023-01-01'
                ORDER BY Date
            
2025-06-04 10:40:53,440 - train_models - INFO - Read chunk of 6241 rows
2025-06-04 10:40:53,480 - train_models - INFO - Data loaded successfully. Total rows: 6241
2025-06-04 10:40:53,480 - train_models - INFO - Converting Date column to datetime format
2025-06-04 10:40:53,499 - train_models - INFO - Engineering features...
2025-06-04 10:40:54,310 - utils.feature_engineering - INFO - Engineering features
2025-06-04 10:40:54,373 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 10:40:54,379 - train_models - INFO - Creating lag features...
2025-06-04 10:40:54,397 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 10:40:54,563 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 10:40:54,563 - utils.feature_engineering - INFO - Final shape: (6241, 70)
2025-06-04 10:40:54,570 - train_models - INFO - Found 10 unique work types
2025-06-04 10:40:54,571 - train_models - INFO - Building models for 10 work types
2025-06-04 10:40:54,571 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 10:40:54,571 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 10:40:54,571 - train_models - INFO - Building model for WorkType: 202
2025-06-04 10:40:56,130 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:41:09,187 - train_models - INFO - Model for 202 - MAE: 0.2757, RMSE: 0.3676, R²: 0.7743, MAPE: 11.62%
2025-06-04 10:41:09,188 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 10:41:09,188 - train_models - INFO -   NoOfMan_7day_trend: 0.2557
2025-06-04 10:41:09,188 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2535
2025-06-04 10:41:09,188 - train_models - INFO -   NoOfMan_1day_trend: 0.1123
2025-06-04 10:41:09,189 - train_models - INFO -   NoOfMan_lag_7: 0.0924
2025-06-04 10:41:09,189 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0841
2025-06-04 10:41:09,189 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0836
2025-06-04 10:41:09,190 - train_models - INFO -   NoOfMan_lag_1: 0.0514
2025-06-04 10:41:09,190 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0062
2025-06-04 10:41:09,190 - train_models - INFO -   Quantity_rolling_mean_7: 0.0046
2025-06-04 10:41:09,190 - train_models - INFO -   Quantity_lag_7: 0.0046
2025-06-04 10:41:09,191 - train_models - INFO - Cross-validation details for 202:
2025-06-04 10:41:09,191 - train_models - INFO -   Fold 1: MAE=0.3798, RMSE=0.4780, R²=0.5438, MAPE=16.20%
2025-06-04 10:41:09,191 - train_models - INFO -   Fold 2: MAE=0.2575, RMSE=0.3283, R²=0.7820, MAPE=12.67%
2025-06-04 10:41:09,191 - train_models - INFO -   Fold 3: MAE=0.2294, RMSE=0.3413, R²=0.8266, MAPE=8.77%
2025-06-04 10:41:09,192 - train_models - INFO -   Fold 4: MAE=0.2812, RMSE=0.3915, R²=0.8411, MAPE=9.29%
2025-06-04 10:41:09,192 - train_models - INFO -   Fold 5: MAE=0.2307, RMSE=0.2987, R²=0.8779, MAPE=11.18%
2025-06-04 10:41:09,192 - train_models - INFO - Building model for WorkType: 203
2025-06-04 10:41:10,227 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:41:24,845 - train_models - INFO - Model for 203 - MAE: 0.3644, RMSE: 0.4748, R²: 0.7949, MAPE: 8.41%
2025-06-04 10:41:24,845 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 10:41:24,845 - train_models - INFO -   NoOfMan_7day_trend: 0.3260
2025-06-04 10:41:24,846 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1480
2025-06-04 10:41:24,846 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1398
2025-06-04 10:41:24,846 - train_models - INFO -   NoOfMan_1day_trend: 0.0973
2025-06-04 10:41:24,847 - train_models - INFO -   NoOfMan_lag_7: 0.0964
2025-06-04 10:41:24,847 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0836
2025-06-04 10:41:24,847 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 10:41:24,848 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-06-04 10:41:24,848 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0050
2025-06-04 10:41:24,848 - train_models - INFO -   NoOfMan_lag_2: 0.0041
2025-06-04 10:41:24,849 - train_models - INFO - Cross-validation details for 203:
2025-06-04 10:41:24,849 - train_models - INFO -   Fold 1: MAE=0.6025, RMSE=0.7625, R²=0.6362, MAPE=12.55%
2025-06-04 10:41:24,849 - train_models - INFO -   Fold 2: MAE=0.3886, RMSE=0.5346, R²=0.7524, MAPE=9.43%
2025-06-04 10:41:24,850 - train_models - INFO -   Fold 3: MAE=0.3397, RMSE=0.4408, R²=0.8248, MAPE=8.63%
2025-06-04 10:41:24,850 - train_models - INFO -   Fold 4: MAE=0.2391, RMSE=0.2788, R²=0.9065, MAPE=5.06%
2025-06-04 10:41:24,850 - train_models - INFO -   Fold 5: MAE=0.2519, RMSE=0.3572, R²=0.8547, MAPE=6.36%
2025-06-04 10:41:24,850 - train_models - INFO - Building model for WorkType: 206
2025-06-04 10:41:25,991 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:41:45,770 - train_models - INFO - Model for 206 - MAE: 1.7758, RMSE: 2.6924, R²: 0.8807, MAPE: 9.78%
2025-06-04 10:41:45,770 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 10:41:45,770 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3662
2025-06-04 10:41:45,771 - train_models - INFO -   NoOfMan_1day_trend: 0.1584
2025-06-04 10:41:45,771 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0925
2025-06-04 10:41:45,771 - train_models - INFO -   DayOfWeek_feat_6: 0.0819
2025-06-04 10:41:45,772 - train_models - INFO -   NoOfMan_lag_1: 0.0626
2025-06-04 10:41:45,772 - train_models - INFO -   NoOfMan_7day_trend: 0.0569
2025-06-04 10:41:45,772 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0495
2025-06-04 10:41:45,773 - train_models - INFO -   Quantity_same_dow_lag: 0.0343
2025-06-04 10:41:45,773 - train_models - INFO -   Quantity_rolling_mean_7: 0.0272
2025-06-04 10:41:45,773 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0144
2025-06-04 10:41:45,774 - train_models - INFO - Cross-validation details for 206:
2025-06-04 10:41:45,774 - train_models - INFO -   Fold 1: MAE=1.7013, RMSE=2.3113, R²=0.8947, MAPE=9.61%
2025-06-04 10:41:45,774 - train_models - INFO -   Fold 2: MAE=1.9251, RMSE=3.0593, R²=0.8406, MAPE=12.25%
2025-06-04 10:41:45,775 - train_models - INFO -   Fold 3: MAE=1.3181, RMSE=1.9351, R²=0.9200, MAPE=9.58%
2025-06-04 10:41:45,775 - train_models - INFO -   Fold 4: MAE=2.7519, RMSE=4.2940, R²=0.8247, MAPE=10.90%
2025-06-04 10:41:45,775 - train_models - INFO -   Fold 5: MAE=1.1826, RMSE=1.8622, R²=0.9237, MAPE=6.56%
2025-06-04 10:41:45,776 - train_models - INFO - Building model for WorkType: 209
2025-06-04 10:41:46,830 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:42:02,225 - train_models - INFO - Model for 209 - MAE: 1.4695, RMSE: 2.2203, R²: 0.7049, MAPE: 17.71%
2025-06-04 10:42:02,225 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 10:42:02,226 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3174
2025-06-04 10:42:02,226 - train_models - INFO -   NoOfMan_7day_trend: 0.2158
2025-06-04 10:42:02,226 - train_models - INFO -   Quantity_rolling_mean_7: 0.1038
2025-06-04 10:42:02,226 - train_models - INFO -   NoOfMan_1day_trend: 0.0951
2025-06-04 10:42:02,227 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0672
2025-06-04 10:42:02,227 - train_models - INFO -   NoOfMan_lag_7: 0.0258
2025-06-04 10:42:02,227 - train_models - INFO -   Quantity_7day_trend: 0.0234
2025-06-04 10:42:02,228 - train_models - INFO -   NoOfMan_lag_1: 0.0233
2025-06-04 10:42:02,228 - train_models - INFO -   Quantity_1day_trend: 0.0173
2025-06-04 10:42:02,228 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0156
2025-06-04 10:42:02,229 - train_models - INFO - Cross-validation details for 209:
2025-06-04 10:42:02,229 - train_models - INFO -   Fold 1: MAE=1.4325, RMSE=1.9239, R²=0.6122, MAPE=16.94%
2025-06-04 10:42:02,229 - train_models - INFO -   Fold 2: MAE=2.4427, RMSE=4.1656, R²=0.5025, MAPE=22.14%
2025-06-04 10:42:02,230 - train_models - INFO -   Fold 3: MAE=0.9461, RMSE=1.2846, R²=0.8128, MAPE=13.49%
2025-06-04 10:42:02,230 - train_models - INFO -   Fold 4: MAE=1.7000, RMSE=2.4283, R²=0.7867, MAPE=23.99%
2025-06-04 10:42:02,230 - train_models - INFO -   Fold 5: MAE=0.8265, RMSE=1.2993, R²=0.8103, MAPE=11.99%
2025-06-04 10:42:02,231 - train_models - INFO - Building model for WorkType: 210
2025-06-04 10:42:03,419 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:42:20,189 - train_models - INFO - Model for 210 - MAE: 1.2969, RMSE: 1.9467, R²: 0.7110, MAPE: 28.99%
2025-06-04 10:42:20,190 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 10:42:20,190 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2731
2025-06-04 10:42:20,190 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-06-04 10:42:20,191 - train_models - INFO -   NoOfMan_7day_trend: 0.1069
2025-06-04 10:42:20,191 - train_models - INFO -   DayOfWeek_feat_6: 0.0752
2025-06-04 10:42:20,191 - train_models - INFO -   NoOfMan_1day_trend: 0.0752
2025-06-04 10:42:20,192 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0561
2025-06-04 10:42:20,192 - train_models - INFO -   Quantity_1day_trend: 0.0395
2025-06-04 10:42:20,192 - train_models - INFO -   Quantity_7day_trend: 0.0327
2025-06-04 10:42:20,193 - train_models - INFO -   NoOfMan_lag_7: 0.0318
2025-06-04 10:42:20,193 - train_models - INFO -   NoOfMan_lag_1: 0.0282
2025-06-04 10:42:20,193 - train_models - INFO - Cross-validation details for 210:
2025-06-04 10:42:20,193 - train_models - INFO -   Fold 1: MAE=1.2040, RMSE=1.7355, R²=0.5859, MAPE=12.93%
2025-06-04 10:42:20,194 - train_models - INFO -   Fold 2: MAE=1.5773, RMSE=2.2524, R²=0.7005, MAPE=37.02%
2025-06-04 10:42:20,194 - train_models - INFO -   Fold 3: MAE=1.1404, RMSE=1.6451, R²=0.7904, MAPE=43.98%
2025-06-04 10:42:20,194 - train_models - INFO -   Fold 4: MAE=1.6124, RMSE=2.4648, R²=0.7649, MAPE=27.20%
2025-06-04 10:42:20,195 - train_models - INFO -   Fold 5: MAE=0.9504, RMSE=1.6359, R²=0.7132, MAPE=23.84%
2025-06-04 10:42:20,195 - train_models - INFO - Building model for WorkType: 211
2025-06-04 10:42:21,244 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:42:38,198 - train_models - INFO - Model for 211 - MAE: 1.0129, RMSE: 1.4077, R²: 0.7352, MAPE: 17.51%
2025-06-04 10:42:38,198 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 10:42:38,199 - train_models - INFO -   NoOfMan_1day_trend: 0.2081
2025-06-04 10:42:38,199 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1950
2025-06-04 10:42:38,199 - train_models - INFO -   NoOfMan_7day_trend: 0.1789
2025-06-04 10:42:38,199 - train_models - INFO -   DayOfWeek_feat_6: 0.1364
2025-06-04 10:42:38,200 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1227
2025-06-04 10:42:38,200 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 10:42:38,200 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-06-04 10:42:38,201 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0134
2025-06-04 10:42:38,201 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0120
2025-06-04 10:42:38,201 - train_models - INFO -   Quantity_lag_7: 0.0060
2025-06-04 10:42:38,202 - train_models - INFO - Cross-validation details for 211:
2025-06-04 10:42:38,202 - train_models - INFO -   Fold 1: MAE=1.1981, RMSE=1.5578, R²=0.6444, MAPE=12.97%
2025-06-04 10:42:38,202 - train_models - INFO -   Fold 2: MAE=1.3921, RMSE=2.2514, R²=0.7053, MAPE=19.83%
2025-06-04 10:42:38,202 - train_models - INFO -   Fold 3: MAE=1.1313, RMSE=1.3678, R²=0.5256, MAPE=27.76%
2025-06-04 10:42:38,203 - train_models - INFO -   Fold 4: MAE=0.7740, RMSE=0.9776, R²=0.9070, MAPE=9.87%
2025-06-04 10:42:38,203 - train_models - INFO -   Fold 5: MAE=0.5689, RMSE=0.8838, R²=0.8934, MAPE=17.13%
2025-06-04 10:42:38,203 - train_models - INFO - Building model for WorkType: 213
2025-06-04 10:42:39,204 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:42:54,989 - train_models - INFO - Model for 213 - MAE: 0.6391, RMSE: 0.8542, R²: 0.6608, MAPE: 20.43%
2025-06-04 10:42:54,990 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 10:42:54,991 - train_models - INFO -   NoOfMan_7day_trend: 0.3111
2025-06-04 10:42:54,991 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3107
2025-06-04 10:42:54,991 - train_models - INFO -   NoOfMan_1day_trend: 0.1147
2025-06-04 10:42:54,992 - train_models - INFO -   NoOfMan_lag_1: 0.0396
2025-06-04 10:42:54,992 - train_models - INFO -   Quantity_1day_trend: 0.0363
2025-06-04 10:42:54,993 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0329
2025-06-04 10:42:54,993 - train_models - INFO -   NoOfMan_lag_7: 0.0299
2025-06-04 10:42:54,993 - train_models - INFO -   Quantity_7day_trend: 0.0234
2025-06-04 10:42:54,994 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0192
2025-06-04 10:42:54,994 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-06-04 10:42:54,995 - train_models - INFO - Cross-validation details for 213:
2025-06-04 10:42:54,995 - train_models - INFO -   Fold 1: MAE=1.4552, RMSE=1.9452, R²=-0.0658, MAPE=36.72%
2025-06-04 10:42:54,995 - train_models - INFO -   Fold 2: MAE=0.4801, RMSE=0.6083, R²=0.8196, MAPE=19.74%
2025-06-04 10:42:54,996 - train_models - INFO -   Fold 3: MAE=0.4600, RMSE=0.6938, R²=0.8362, MAPE=20.58%
2025-06-04 10:42:54,997 - train_models - INFO -   Fold 4: MAE=0.5397, RMSE=0.6756, R²=0.8221, MAPE=14.47%
2025-06-04 10:42:54,997 - train_models - INFO -   Fold 5: MAE=0.2605, RMSE=0.3480, R²=0.8919, MAPE=10.66%
2025-06-04 10:42:54,998 - train_models - INFO - Building model for WorkType: 214
2025-06-04 10:42:56,102 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:43:11,018 - train_models - INFO - Model for 214 - MAE: 0.9350, RMSE: 1.3071, R²: 0.5655, MAPE: 17.96%
2025-06-04 10:43:11,019 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 10:43:11,019 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5358
2025-06-04 10:43:11,020 - train_models - INFO -   NoOfMan_7day_trend: 0.1303
2025-06-04 10:43:11,020 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0936
2025-06-04 10:43:11,020 - train_models - INFO -   NoOfMan_1day_trend: 0.0754
2025-06-04 10:43:11,020 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0279
2025-06-04 10:43:11,021 - train_models - INFO -   NoOfMan_lag_7: 0.0261
2025-06-04 10:43:11,021 - train_models - INFO -   NoOfMan_lag_1: 0.0251
2025-06-04 10:43:11,021 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0123
2025-06-04 10:43:11,022 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0114
2025-06-04 10:43:11,022 - train_models - INFO -   DayOfWeek_feat_6: 0.0092
2025-06-04 10:43:11,022 - train_models - INFO - Cross-validation details for 214:
2025-06-04 10:43:11,022 - train_models - INFO -   Fold 1: MAE=1.4748, RMSE=1.7929, R²=-0.2129, MAPE=23.19%
2025-06-04 10:43:11,023 - train_models - INFO -   Fold 2: MAE=0.8719, RMSE=1.2268, R²=0.7327, MAPE=15.81%
2025-06-04 10:43:11,023 - train_models - INFO -   Fold 3: MAE=0.8148, RMSE=1.3558, R²=0.7903, MAPE=18.04%
2025-06-04 10:43:11,023 - train_models - INFO -   Fold 4: MAE=1.0794, RMSE=1.5727, R²=0.6599, MAPE=22.63%
2025-06-04 10:43:11,023 - train_models - INFO -   Fold 5: MAE=0.4340, RMSE=0.5875, R²=0.8574, MAPE=10.13%
2025-06-04 10:43:11,024 - train_models - INFO - Building model for WorkType: 215
2025-06-04 10:43:12,142 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:43:30,100 - train_models - INFO - Model for 215 - MAE: 0.8960, RMSE: 1.3572, R²: 0.7939, MAPE: 19.40%
2025-06-04 10:43:30,100 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 10:43:30,101 - train_models - INFO -   DayOfWeek_feat_6: 0.2222
2025-06-04 10:43:30,101 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1930
2025-06-04 10:43:30,101 - train_models - INFO -   NoOfMan_7day_trend: 0.1337
2025-06-04 10:43:30,102 - train_models - INFO -   NoOfMan_1day_trend: 0.0940
2025-06-04 10:43:30,102 - train_models - INFO -   Quantity_rolling_mean_7: 0.0669
2025-06-04 10:43:30,102 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0539
2025-06-04 10:43:30,103 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0537
2025-06-04 10:43:30,103 - train_models - INFO -   NoOfMan_lag_1: 0.0239
2025-06-04 10:43:30,103 - train_models - INFO -   NoOfMan_lag_7: 0.0213
2025-06-04 10:43:30,104 - train_models - INFO -   Quantity_same_dow_lag: 0.0186
2025-06-04 10:43:30,104 - train_models - INFO - Cross-validation details for 215:
2025-06-04 10:43:30,104 - train_models - INFO -   Fold 1: MAE=0.7512, RMSE=0.9457, R²=0.8081, MAPE=15.88%
2025-06-04 10:43:30,105 - train_models - INFO -   Fold 2: MAE=1.1751, RMSE=1.9845, R²=0.7437, MAPE=22.29%
2025-06-04 10:43:30,105 - train_models - INFO -   Fold 3: MAE=0.6940, RMSE=0.9430, R²=0.8029, MAPE=25.43%
2025-06-04 10:43:30,105 - train_models - INFO -   Fold 4: MAE=1.0490, RMSE=1.7207, R²=0.7856, MAPE=11.05%
2025-06-04 10:43:30,106 - train_models - INFO -   Fold 5: MAE=0.8106, RMSE=1.1924, R²=0.8292, MAPE=22.35%
2025-06-04 10:43:30,106 - train_models - INFO - Building model for WorkType: 217
2025-06-04 10:43:31,067 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:43:45,000 - train_models - INFO - Model for 217 - MAE: 0.5961, RMSE: 0.7765, R²: 0.8410, MAPE: 26.48%
2025-06-04 10:43:45,001 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 10:43:45,001 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4840
2025-06-04 10:43:45,002 - train_models - INFO -   NoOfMan_7day_trend: 0.2246
2025-06-04 10:43:45,002 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0860
2025-06-04 10:43:45,003 - train_models - INFO -   NoOfMan_1day_trend: 0.0468
2025-06-04 10:43:45,003 - train_models - INFO -   NoOfMan_lag_7: 0.0442
2025-06-04 10:43:45,003 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0291
2025-06-04 10:43:45,004 - train_models - INFO -   NoOfMan_lag_1: 0.0219
2025-06-04 10:43:45,004 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-06-04 10:43:45,004 - train_models - INFO -   Quantity_rolling_mean_7: 0.0045
2025-06-04 10:43:45,005 - train_models - INFO -   Quantity_lag_7: 0.0045
2025-06-04 10:43:45,005 - train_models - INFO - Cross-validation details for 217:
2025-06-04 10:43:45,005 - train_models - INFO -   Fold 1: MAE=0.8285, RMSE=0.9752, R²=0.7121, MAPE=52.21%
2025-06-04 10:43:45,006 - train_models - INFO -   Fold 2: MAE=0.6699, RMSE=0.8763, R²=0.8463, MAPE=20.13%
2025-06-04 10:43:45,006 - train_models - INFO -   Fold 3: MAE=0.5029, RMSE=0.6957, R²=0.8652, MAPE=23.55%
2025-06-04 10:43:45,006 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.4605, R²=0.9214, MAPE=13.17%
2025-06-04 10:43:45,007 - train_models - INFO -   Fold 5: MAE=0.6291, RMSE=0.8747, R²=0.8599, MAPE=23.34%
2025-06-04 10:43:45,008 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 10:43:45,450 - train_models - INFO - Model files saved successfully
2025-06-04 10:43:45,450 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 10:43:45,452 - train_models - INFO - Model training completed successfully
2025-06-04 10:44:59,982 - train_models - INFO - Starting the model training process
2025-06-04 10:44:59,982 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 10:44:59,989 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 10:45:00,139 - train_models - INFO - Executing SQL query: 
               SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) AND SystemHours <> 0
                AND Hours <> 0 and Quantity > 0
                AND Date > '2020-01-01'
                ORDER BY Date
            
2025-06-04 10:45:01,207 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 10:45:01,294 - train_models - INFO - Read chunk of 4010 rows
2025-06-04 10:45:01,319 - train_models - INFO - Data loaded successfully. Total rows: 14010
2025-06-04 10:45:01,320 - train_models - INFO - Converting Date column to datetime format
2025-06-04 10:45:01,368 - train_models - INFO - Engineering features...
2025-06-04 10:45:01,888 - utils.feature_engineering - INFO - Engineering features
2025-06-04 10:45:01,916 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 10:45:01,923 - train_models - INFO - Creating lag features...
2025-06-04 10:45:01,933 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 10:45:02,144 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 10:45:02,145 - utils.feature_engineering - INFO - Final shape: (14010, 70)
2025-06-04 10:45:02,158 - train_models - INFO - Found 10 unique work types
2025-06-04 10:45:02,158 - train_models - INFO - Building models for 10 work types
2025-06-04 10:45:02,158 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 10:45:02,159 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 10:45:02,159 - train_models - INFO - Building model for WorkType: 202
2025-06-04 10:45:04,607 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:45:35,773 - train_models - INFO - Model for 202 - MAE: 0.2229, RMSE: 0.3299, R²: 0.7714, MAPE: 10.48%
2025-06-04 10:45:35,773 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 10:45:35,774 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3783
2025-06-04 10:45:35,774 - train_models - INFO -   NoOfMan_7day_trend: 0.1765
2025-06-04 10:45:35,774 - train_models - INFO -   NoOfMan_1day_trend: 0.1478
2025-06-04 10:45:35,775 - train_models - INFO -   NoOfMan_lag_1: 0.0889
2025-06-04 10:45:35,775 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0661
2025-06-04 10:45:35,775 - train_models - INFO -   NoOfMan_lag_7: 0.0593
2025-06-04 10:45:35,776 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0441
2025-06-04 10:45:35,776 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 10:45:35,776 - train_models - INFO -   Quantity_rolling_mean_7: 0.0024
2025-06-04 10:45:35,776 - train_models - INFO -   Quantity_1day_trend: 0.0022
2025-06-04 10:45:35,777 - train_models - INFO - Cross-validation details for 202:
2025-06-04 10:45:35,777 - train_models - INFO -   Fold 1: MAE=0.2576, RMSE=0.4312, R²=0.4673, MAPE=13.34%
2025-06-04 10:45:35,777 - train_models - INFO -   Fold 2: MAE=0.1795, RMSE=0.2531, R²=0.8425, MAPE=9.65%
2025-06-04 10:45:35,778 - train_models - INFO -   Fold 3: MAE=0.2531, RMSE=0.3834, R²=0.7904, MAPE=12.35%
2025-06-04 10:45:35,778 - train_models - INFO -   Fold 4: MAE=0.1841, RMSE=0.2338, R²=0.8907, MAPE=8.38%
2025-06-04 10:45:35,778 - train_models - INFO -   Fold 5: MAE=0.2400, RMSE=0.3481, R²=0.8659, MAPE=8.66%
2025-06-04 10:45:35,779 - train_models - INFO - Building model for WorkType: 203
2025-06-04 10:45:38,184 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:46:12,843 - train_models - INFO - Model for 203 - MAE: 0.2343, RMSE: 0.3439, R²: 0.8956, MAPE: 5.06%
2025-06-04 10:46:12,844 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 10:46:12,844 - train_models - INFO -   NoOfMan_7day_trend: 0.3292
2025-06-04 10:46:12,844 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1933
2025-06-04 10:46:12,845 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1197
2025-06-04 10:46:12,845 - train_models - INFO -   NoOfMan_1day_trend: 0.0993
2025-06-04 10:46:12,845 - train_models - INFO -   NoOfMan_lag_7: 0.0881
2025-06-04 10:46:12,846 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0736
2025-06-04 10:46:12,846 - train_models - INFO -   NoOfMan_lag_1: 0.0569
2025-06-04 10:46:12,846 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0046
2025-06-04 10:46:12,847 - train_models - INFO -   Quantity_same_dow_lag: 0.0026
2025-06-04 10:46:12,847 - train_models - INFO -   NoOfMan_lag_3: 0.0026
2025-06-04 10:46:12,847 - train_models - INFO - Cross-validation details for 203:
2025-06-04 10:46:12,847 - train_models - INFO -   Fold 1: MAE=0.2800, RMSE=0.3831, R²=0.8395, MAPE=6.01%
2025-06-04 10:46:12,848 - train_models - INFO -   Fold 2: MAE=0.3162, RMSE=0.5086, R²=0.8442, MAPE=5.88%
2025-06-04 10:46:12,848 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3268, R²=0.9162, MAPE=4.92%
2025-06-04 10:46:12,848 - train_models - INFO -   Fold 4: MAE=0.1651, RMSE=0.2487, R²=0.9428, MAPE=3.86%
2025-06-04 10:46:12,849 - train_models - INFO -   Fold 5: MAE=0.1775, RMSE=0.2523, R²=0.9351, MAPE=4.61%
2025-06-04 10:46:12,849 - train_models - INFO - Building model for WorkType: 206
2025-06-04 10:46:15,723 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:47:01,243 - train_models - INFO - Model for 206 - MAE: 1.5442, RMSE: 2.4875, R²: 0.9072, MAPE: 8.85%
2025-06-04 10:47:01,244 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 10:47:01,244 - train_models - INFO -   NoOfMan_same_dow_lag: 0.4899
2025-06-04 10:47:01,244 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1514
2025-06-04 10:47:01,245 - train_models - INFO -   DayOfWeek_feat_6: 0.0861
2025-06-04 10:47:01,245 - train_models - INFO -   NoOfMan_1day_trend: 0.0803
2025-06-04 10:47:01,245 - train_models - INFO -   NoOfMan_7day_trend: 0.0509
2025-06-04 10:47:01,246 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0352
2025-06-04 10:47:01,246 - train_models - INFO -   NoOfMan_lag_1: 0.0294
2025-06-04 10:47:01,246 - train_models - INFO -   Quantity_rolling_mean_7: 0.0161
2025-06-04 10:47:01,247 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0099
2025-06-04 10:47:01,247 - train_models - INFO -   Quantity_same_dow_lag: 0.0080
2025-06-04 10:47:01,247 - train_models - INFO - Cross-validation details for 206:
2025-06-04 10:47:01,248 - train_models - INFO -   Fold 1: MAE=2.1727, RMSE=3.2760, R²=0.8552, MAPE=10.77%
2025-06-04 10:47:01,248 - train_models - INFO -   Fold 2: MAE=1.6716, RMSE=2.4473, R²=0.9164, MAPE=8.54%
2025-06-04 10:47:01,248 - train_models - INFO -   Fold 3: MAE=1.5889, RMSE=2.9625, R²=0.8683, MAPE=11.04%
2025-06-04 10:47:01,249 - train_models - INFO -   Fold 4: MAE=0.9986, RMSE=1.4919, R²=0.9586, MAPE=7.07%
2025-06-04 10:47:01,249 - train_models - INFO -   Fold 5: MAE=1.2890, RMSE=2.2597, R²=0.9376, MAPE=6.86%
2025-06-04 10:47:01,249 - train_models - INFO - Building model for WorkType: 209
2025-06-04 10:47:03,599 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:47:40,123 - train_models - INFO - Model for 209 - MAE: 0.9220, RMSE: 1.5358, R²: 0.8666, MAPE: 12.66%
2025-06-04 10:47:40,124 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 10:47:40,124 - train_models - INFO -   NoOfMan_7day_trend: 0.4262
2025-06-04 10:47:40,124 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1845
2025-06-04 10:47:40,125 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0988
2025-06-04 10:47:40,125 - train_models - INFO -   NoOfMan_1day_trend: 0.0666
2025-06-04 10:47:40,125 - train_models - INFO -   Quantity_rolling_mean_7: 0.0482
2025-06-04 10:47:40,125 - train_models - INFO -   NoOfMan_lag_7: 0.0472
2025-06-04 10:47:40,126 - train_models - INFO -   NoOfMan_lag_1: 0.0292
2025-06-04 10:47:40,126 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0211
2025-06-04 10:47:40,126 - train_models - INFO -   Quantity_1day_trend: 0.0136
2025-06-04 10:47:40,127 - train_models - INFO -   Quantity_7day_trend: 0.0106
2025-06-04 10:47:40,127 - train_models - INFO - Cross-validation details for 209:
2025-06-04 10:47:40,127 - train_models - INFO -   Fold 1: MAE=1.0064, RMSE=1.6293, R²=0.8160, MAPE=15.14%
2025-06-04 10:47:40,128 - train_models - INFO -   Fold 2: MAE=0.9758, RMSE=1.7341, R²=0.8429, MAPE=11.87%
2025-06-04 10:47:40,128 - train_models - INFO -   Fold 3: MAE=0.7456, RMSE=1.0052, R²=0.9273, MAPE=11.77%
2025-06-04 10:47:40,128 - train_models - INFO -   Fold 4: MAE=0.9270, RMSE=1.6882, R²=0.8612, MAPE=11.24%
2025-06-04 10:47:40,129 - train_models - INFO -   Fold 5: MAE=0.9552, RMSE=1.6219, R²=0.8859, MAPE=13.29%
2025-06-04 10:47:40,129 - train_models - INFO - Building model for WorkType: 210
2025-06-04 10:47:42,800 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:48:22,182 - train_models - INFO - Model for 210 - MAE: 0.9189, RMSE: 1.3737, R²: 0.8469, MAPE: 20.24%
2025-06-04 10:48:22,183 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 10:48:22,183 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2759
2025-06-04 10:48:22,183 - train_models - INFO -   NoOfMan_7day_trend: 0.2052
2025-06-04 10:48:22,183 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1556
2025-06-04 10:48:22,184 - train_models - INFO -   NoOfMan_1day_trend: 0.0593
2025-06-04 10:48:22,184 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0517
2025-06-04 10:48:22,184 - train_models - INFO -   NoOfMan_lag_7: 0.0371
2025-06-04 10:48:22,184 - train_models - INFO -   NoOfMan_lag_1: 0.0293
2025-06-04 10:48:22,185 - train_models - INFO -   DayOfWeek_feat_6: 0.0264
2025-06-04 10:48:22,185 - train_models - INFO -   Quantity_1day_trend: 0.0229
2025-06-04 10:48:22,185 - train_models - INFO -   Quantity_7day_trend: 0.0220
2025-06-04 10:48:22,185 - train_models - INFO - Cross-validation details for 210:
2025-06-04 10:48:22,186 - train_models - INFO -   Fold 1: MAE=0.7800, RMSE=1.0523, R²=0.8591, MAPE=16.12%
2025-06-04 10:48:22,186 - train_models - INFO -   Fold 2: MAE=0.7762, RMSE=1.2159, R²=0.8652, MAPE=11.17%
2025-06-04 10:48:22,186 - train_models - INFO -   Fold 3: MAE=0.7622, RMSE=1.0721, R²=0.8958, MAPE=10.33%
2025-06-04 10:48:22,187 - train_models - INFO -   Fold 4: MAE=1.1406, RMSE=1.6543, R²=0.8063, MAPE=37.79%
2025-06-04 10:48:22,187 - train_models - INFO -   Fold 5: MAE=1.1358, RMSE=1.8737, R²=0.8081, MAPE=25.79%
2025-06-04 10:48:22,187 - train_models - INFO - Building model for WorkType: 211
2025-06-04 10:48:24,751 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:49:07,198 - train_models - INFO - Model for 211 - MAE: 0.6207, RMSE: 0.9640, R²: 0.9077, MAPE: 10.55%
2025-06-04 10:49:07,198 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 10:49:07,199 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3378
2025-06-04 10:49:07,199 - train_models - INFO -   NoOfMan_1day_trend: 0.1839
2025-06-04 10:49:07,199 - train_models - INFO -   NoOfMan_7day_trend: 0.1623
2025-06-04 10:49:07,200 - train_models - INFO -   DayOfWeek_feat_6: 0.0829
2025-06-04 10:49:07,200 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0665
2025-06-04 10:49:07,200 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-06-04 10:49:07,201 - train_models - INFO -   NoOfMan_lag_7: 0.0365
2025-06-04 10:49:07,201 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0197
2025-06-04 10:49:07,201 - train_models - INFO -   Quantity_same_dow_lag: 0.0099
2025-06-04 10:49:07,201 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0044
2025-06-04 10:49:07,202 - train_models - INFO - Cross-validation details for 211:
2025-06-04 10:49:07,202 - train_models - INFO -   Fold 1: MAE=0.7869, RMSE=1.2848, R²=0.8185, MAPE=12.75%
2025-06-04 10:49:07,202 - train_models - INFO -   Fold 2: MAE=0.7546, RMSE=1.1883, R²=0.8898, MAPE=9.42%
2025-06-04 10:49:07,203 - train_models - INFO -   Fold 3: MAE=0.5021, RMSE=0.8040, R²=0.9337, MAPE=8.71%
2025-06-04 10:49:07,203 - train_models - INFO -   Fold 4: MAE=0.5702, RMSE=0.8443, R²=0.9445, MAPE=11.77%
2025-06-04 10:49:07,203 - train_models - INFO -   Fold 5: MAE=0.4895, RMSE=0.6986, R²=0.9521, MAPE=10.08%
2025-06-04 10:49:07,204 - train_models - INFO - Building model for WorkType: 213
2025-06-04 10:49:09,709 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:49:47,774 - train_models - INFO - Model for 213 - MAE: 0.4055, RMSE: 0.5908, R²: 0.8758, MAPE: 17.53%
2025-06-04 10:49:47,775 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 10:49:47,775 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4451
2025-06-04 10:49:47,775 - train_models - INFO -   NoOfMan_7day_trend: 0.2281
2025-06-04 10:49:47,776 - train_models - INFO -   NoOfMan_1day_trend: 0.1352
2025-06-04 10:49:47,776 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0465
2025-06-04 10:49:47,776 - train_models - INFO -   NoOfMan_lag_1: 0.0447
2025-06-04 10:49:47,777 - train_models - INFO -   NoOfMan_lag_7: 0.0293
2025-06-04 10:49:47,777 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0262
2025-06-04 10:49:47,777 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 10:49:47,778 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0031
2025-06-04 10:49:47,778 - train_models - INFO -   Quantity_1day_trend: 0.0031
2025-06-04 10:49:47,778 - train_models - INFO - Cross-validation details for 213:
2025-06-04 10:49:47,779 - train_models - INFO -   Fold 1: MAE=0.6565, RMSE=0.9082, R²=0.8015, MAPE=28.48%
2025-06-04 10:49:47,779 - train_models - INFO -   Fold 2: MAE=0.3939, RMSE=0.5173, R²=0.8950, MAPE=20.63%
2025-06-04 10:49:47,779 - train_models - INFO -   Fold 3: MAE=0.3676, RMSE=0.6233, R²=0.8399, MAPE=17.14%
2025-06-04 10:49:47,780 - train_models - INFO -   Fold 4: MAE=0.2676, RMSE=0.3909, R²=0.9393, MAPE=9.96%
2025-06-04 10:49:47,780 - train_models - INFO -   Fold 5: MAE=0.3421, RMSE=0.5144, R²=0.9031, MAPE=11.44%
2025-06-04 10:49:47,780 - train_models - INFO - Building model for WorkType: 214
2025-06-04 10:49:50,396 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:50:28,035 - train_models - INFO - Model for 214 - MAE: 0.4981, RMSE: 0.7609, R²: 0.8800, MAPE: 11.01%
2025-06-04 10:50:28,035 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 10:50:28,036 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5064
2025-06-04 10:50:28,036 - train_models - INFO -   NoOfMan_7day_trend: 0.1831
2025-06-04 10:50:28,036 - train_models - INFO -   NoOfMan_1day_trend: 0.0846
2025-06-04 10:50:28,037 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0667
2025-06-04 10:50:28,037 - train_models - INFO -   NoOfMan_lag_7: 0.0471
2025-06-04 10:50:28,037 - train_models - INFO -   NoOfMan_lag_1: 0.0386
2025-06-04 10:50:28,038 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0154
2025-06-04 10:50:28,038 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0100
2025-06-04 10:50:28,038 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0067
2025-06-04 10:50:28,039 - train_models - INFO -   NoOfMan_lag_2: 0.0041
2025-06-04 10:50:28,039 - train_models - INFO - Cross-validation details for 214:
2025-06-04 10:50:28,039 - train_models - INFO -   Fold 1: MAE=0.5934, RMSE=0.7755, R²=0.8409, MAPE=14.92%
2025-06-04 10:50:28,040 - train_models - INFO -   Fold 2: MAE=0.4116, RMSE=0.5611, R²=0.9087, MAPE=9.57%
2025-06-04 10:50:28,040 - train_models - INFO -   Fold 3: MAE=0.3226, RMSE=0.4430, R²=0.9399, MAPE=9.55%
2025-06-04 10:50:28,040 - train_models - INFO -   Fold 4: MAE=0.5005, RMSE=0.9532, R²=0.8517, MAPE=8.96%
2025-06-04 10:50:28,040 - train_models - INFO -   Fold 5: MAE=0.6624, RMSE=1.0718, R²=0.8588, MAPE=12.05%
2025-06-04 10:50:28,041 - train_models - INFO - Building model for WorkType: 215
2025-06-04 10:50:30,858 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:51:15,446 - train_models - INFO - Model for 215 - MAE: 0.6748, RMSE: 1.0287, R²: 0.9023, MAPE: 14.78%
2025-06-04 10:51:15,447 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 10:51:15,447 - train_models - INFO -   DayOfWeek_feat_6: 0.1944
2025-06-04 10:51:15,448 - train_models - INFO -   NoOfMan_7day_trend: 0.1698
2025-06-04 10:51:15,448 - train_models - INFO -   NoOfMan_1day_trend: 0.1436
2025-06-04 10:51:15,448 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1342
2025-06-04 10:51:15,449 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1043
2025-06-04 10:51:15,449 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0770
2025-06-04 10:51:15,449 - train_models - INFO -   Quantity_rolling_mean_7: 0.0330
2025-06-04 10:51:15,450 - train_models - INFO -   NoOfMan_lag_1: 0.0319
2025-06-04 10:51:15,450 - train_models - INFO -   NoOfMan_lag_7: 0.0220
2025-06-04 10:51:15,450 - train_models - INFO -   Quantity_7day_trend: 0.0128
2025-06-04 10:51:15,451 - train_models - INFO - Cross-validation details for 215:
2025-06-04 10:51:15,451 - train_models - INFO -   Fold 1: MAE=0.7818, RMSE=1.0442, R²=0.8787, MAPE=20.26%
2025-06-04 10:51:15,451 - train_models - INFO -   Fold 2: MAE=0.8015, RMSE=1.1338, R²=0.8976, MAPE=16.43%
2025-06-04 10:51:15,452 - train_models - INFO -   Fold 3: MAE=0.6772, RMSE=1.1154, R²=0.8914, MAPE=12.44%
2025-06-04 10:51:15,452 - train_models - INFO -   Fold 4: MAE=0.5535, RMSE=0.8557, R²=0.9280, MAPE=14.30%
2025-06-04 10:51:15,453 - train_models - INFO -   Fold 5: MAE=0.5598, RMSE=0.9944, R²=0.9156, MAPE=10.49%
2025-06-04 10:51:15,453 - train_models - INFO - Building model for WorkType: 217
2025-06-04 10:51:17,799 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:51:50,702 - train_models - INFO - Model for 217 - MAE: 0.4236, RMSE: 0.6231, R²: 0.8936, MAPE: 16.75%
2025-06-04 10:51:50,703 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 10:51:50,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5453
2025-06-04 10:51:50,704 - train_models - INFO -   NoOfMan_7day_trend: 0.1477
2025-06-04 10:51:50,704 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1398
2025-06-04 10:51:50,705 - train_models - INFO -   NoOfMan_1day_trend: 0.0429
2025-06-04 10:51:50,705 - train_models - INFO -   NoOfMan_lag_7: 0.0332
2025-06-04 10:51:50,705 - train_models - INFO -   NoOfMan_lag_1: 0.0290
2025-06-04 10:51:50,706 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0229
2025-06-04 10:51:50,706 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-04 10:51:50,706 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-06-04 10:51:50,706 - train_models - INFO -   NoOfMan_lag_3: 0.0022
2025-06-04 10:51:50,707 - train_models - INFO - Cross-validation details for 217:
2025-06-04 10:51:50,707 - train_models - INFO -   Fold 1: MAE=0.5038, RMSE=0.6754, R²=0.8707, MAPE=21.27%
2025-06-04 10:51:50,707 - train_models - INFO -   Fold 2: MAE=0.4083, RMSE=0.5142, R²=0.8955, MAPE=20.05%
2025-06-04 10:51:50,708 - train_models - INFO -   Fold 3: MAE=0.4350, RMSE=0.7214, R²=0.8782, MAPE=14.64%
2025-06-04 10:51:50,708 - train_models - INFO -   Fold 4: MAE=0.3682, RMSE=0.5062, R²=0.9441, MAPE=13.39%
2025-06-04 10:51:50,708 - train_models - INFO -   Fold 5: MAE=0.4029, RMSE=0.6981, R²=0.8795, MAPE=14.41%
2025-06-04 10:51:50,709 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 10:51:51,267 - train_models - INFO - Model files saved successfully
2025-06-04 10:51:51,267 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 10:51:51,271 - train_models - INFO - Model training completed successfully
2025-06-04 10:52:43,859 - train_models - INFO - Starting the model training process
2025-06-04 10:52:43,859 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 10:52:43,864 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 10:52:44,034 - train_models - INFO - Executing SQL query: 
               SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) AND SystemHours <> 0
                AND Hours <> 0 and Quantity > 0
                ORDER BY Date
            
2025-06-04 10:52:44,932 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 10:52:45,125 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 10:52:45,148 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 10:52:45,149 - train_models - INFO - Converting Date column to datetime format
2025-06-04 10:52:45,177 - train_models - INFO - Engineering features...
2025-06-04 10:52:45,792 - utils.feature_engineering - INFO - Engineering features
2025-06-04 10:52:45,842 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 10:52:45,852 - train_models - INFO - Creating lag features...
2025-06-04 10:52:45,872 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 10:52:46,107 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 10:52:46,107 - utils.feature_engineering - INFO - Final shape: (15326, 70)
2025-06-04 10:52:46,124 - train_models - INFO - Found 10 unique work types
2025-06-04 10:52:46,125 - train_models - INFO - Building models for 10 work types
2025-06-04 10:52:46,125 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 10:52:46,125 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 10:52:46,126 - train_models - INFO - Building model for WorkType: 202
2025-06-04 10:52:49,417 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:53:26,492 - train_models - INFO - Model for 202 - MAE: 0.2121, RMSE: 0.3305, R²: 0.7462, MAPE: 10.12%
2025-06-04 10:53:26,492 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 10:53:26,493 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3965
2025-06-04 10:53:26,493 - train_models - INFO -   NoOfMan_7day_trend: 0.1981
2025-06-04 10:53:26,493 - train_models - INFO -   NoOfMan_1day_trend: 0.1273
2025-06-04 10:53:26,494 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-04 10:53:26,494 - train_models - INFO -   NoOfMan_lag_1: 0.0674
2025-06-04 10:53:26,494 - train_models - INFO -   NoOfMan_lag_7: 0.0659
2025-06-04 10:53:26,494 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0386
2025-06-04 10:53:26,495 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 10:53:26,495 - train_models - INFO -   Quantity_rolling_mean_7: 0.0021
2025-06-04 10:53:26,495 - train_models - INFO -   Quantity_lag_7: 0.0021
2025-06-04 10:53:26,496 - train_models - INFO - Cross-validation details for 202:
2025-06-04 10:53:26,497 - train_models - INFO -   Fold 1: MAE=0.2222, RMSE=0.4181, R²=0.3874, MAPE=11.30%
2025-06-04 10:53:26,497 - train_models - INFO -   Fold 2: MAE=0.2016, RMSE=0.3019, R²=0.7901, MAPE=11.19%
2025-06-04 10:53:26,499 - train_models - INFO -   Fold 3: MAE=0.2276, RMSE=0.3600, R²=0.7983, MAPE=11.70%
2025-06-04 10:53:26,502 - train_models - INFO -   Fold 4: MAE=0.1745, RMSE=0.2277, R²=0.8945, MAPE=8.04%
2025-06-04 10:53:26,510 - train_models - INFO -   Fold 5: MAE=0.2347, RMSE=0.3450, R²=0.8606, MAPE=8.38%
2025-06-04 10:53:26,511 - train_models - INFO - Building model for WorkType: 203
2025-06-04 10:53:29,424 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:54:10,803 - train_models - INFO - Model for 203 - MAE: 0.2242, RMSE: 0.3229, R²: 0.9147, MAPE: 4.69%
2025-06-04 10:54:10,804 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 10:54:10,804 - train_models - INFO -   NoOfMan_7day_trend: 0.3049
2025-06-04 10:54:10,804 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-04 10:54:10,805 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1217
2025-06-04 10:54:10,805 - train_models - INFO -   NoOfMan_1day_trend: 0.0916
2025-06-04 10:54:10,806 - train_models - INFO -   NoOfMan_lag_7: 0.0841
2025-06-04 10:54:10,806 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0720
2025-06-04 10:54:10,806 - train_models - INFO -   NoOfMan_lag_1: 0.0531
2025-06-04 10:54:10,807 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-06-04 10:54:10,807 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-06-04 10:54:10,807 - train_models - INFO -   NoOfMan_lag_2: 0.0026
2025-06-04 10:54:10,808 - train_models - INFO - Cross-validation details for 203:
2025-06-04 10:54:10,808 - train_models - INFO -   Fold 1: MAE=0.2863, RMSE=0.3951, R²=0.8770, MAPE=5.74%
2025-06-04 10:54:10,809 - train_models - INFO -   Fold 2: MAE=0.2562, RMSE=0.3466, R²=0.9125, MAPE=5.04%
2025-06-04 10:54:10,809 - train_models - INFO -   Fold 3: MAE=0.2273, RMSE=0.3641, R²=0.9001, MAPE=4.25%
2025-06-04 10:54:10,809 - train_models - INFO -   Fold 4: MAE=0.1799, RMSE=0.2720, R²=0.9400, MAPE=4.25%
2025-06-04 10:54:10,810 - train_models - INFO -   Fold 5: MAE=0.1711, RMSE=0.2369, R²=0.9440, MAPE=4.19%
2025-06-04 10:54:10,810 - train_models - INFO - Building model for WorkType: 206
2025-06-04 10:54:14,934 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:55:33,683 - train_models - INFO - Model for 206 - MAE: 1.4057, RMSE: 2.1460, R²: 0.9309, MAPE: 8.05%
2025-06-04 10:55:33,683 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 10:55:33,684 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5184
2025-06-04 10:55:33,684 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1536
2025-06-04 10:55:33,684 - train_models - INFO -   DayOfWeek_feat_6: 0.0712
2025-06-04 10:55:33,685 - train_models - INFO -   NoOfMan_1day_trend: 0.0702
2025-06-04 10:55:33,685 - train_models - INFO -   NoOfMan_7day_trend: 0.0527
2025-06-04 10:55:33,685 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-06-04 10:55:33,686 - train_models - INFO -   NoOfMan_lag_1: 0.0269
2025-06-04 10:55:33,686 - train_models - INFO -   Quantity_rolling_mean_7: 0.0088
2025-06-04 10:55:33,686 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0072
2025-06-04 10:55:33,687 - train_models - INFO -   NoOfMan_lag_7: 0.0070
2025-06-04 10:55:33,687 - train_models - INFO - Cross-validation details for 206:
2025-06-04 10:55:33,687 - train_models - INFO -   Fold 1: MAE=1.7286, RMSE=2.3812, R²=0.9229, MAPE=9.91%
2025-06-04 10:55:33,688 - train_models - INFO -   Fold 2: MAE=1.6104, RMSE=2.3076, R²=0.9245, MAPE=8.90%
2025-06-04 10:55:33,688 - train_models - INFO -   Fold 3: MAE=1.5339, RMSE=2.6543, R²=0.8944, MAPE=8.86%
2025-06-04 10:55:33,688 - train_models - INFO -   Fold 4: MAE=0.9707, RMSE=1.4758, R²=0.9589, MAPE=6.40%
2025-06-04 10:55:33,689 - train_models - INFO -   Fold 5: MAE=1.1851, RMSE=1.9113, R²=0.9540, MAPE=6.17%
2025-06-04 10:55:33,689 - train_models - INFO - Building model for WorkType: 209
2025-06-04 10:55:36,843 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:56:30,344 - train_models - INFO - Model for 209 - MAE: 0.8914, RMSE: 1.3908, R²: 0.8881, MAPE: 12.40%
2025-06-04 10:56:30,345 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 10:56:30,345 - train_models - INFO -   NoOfMan_7day_trend: 0.4015
2025-06-04 10:56:30,345 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2200
2025-06-04 10:56:30,346 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0985
2025-06-04 10:56:30,346 - train_models - INFO -   NoOfMan_1day_trend: 0.0666
2025-06-04 10:56:30,346 - train_models - INFO -   NoOfMan_lag_7: 0.0501
2025-06-04 10:56:30,347 - train_models - INFO -   Quantity_rolling_mean_7: 0.0481
2025-06-04 10:56:30,347 - train_models - INFO -   NoOfMan_lag_1: 0.0253
2025-06-04 10:56:30,347 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0192
2025-06-04 10:56:30,348 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0089
2025-06-04 10:56:30,348 - train_models - INFO -   Quantity_7day_trend: 0.0088
2025-06-04 10:56:30,348 - train_models - INFO - Cross-validation details for 209:
2025-06-04 10:56:30,349 - train_models - INFO -   Fold 1: MAE=1.0077, RMSE=1.4725, R²=0.8551, MAPE=13.84%
2025-06-04 10:56:30,349 - train_models - INFO -   Fold 2: MAE=1.0231, RMSE=1.7583, R²=0.8406, MAPE=15.03%
2025-06-04 10:56:30,349 - train_models - INFO -   Fold 3: MAE=0.6608, RMSE=0.8807, R²=0.9392, MAPE=10.53%
2025-06-04 10:56:30,349 - train_models - INFO -   Fold 4: MAE=0.8517, RMSE=1.3990, R²=0.9003, MAPE=11.23%
2025-06-04 10:56:30,350 - train_models - INFO -   Fold 5: MAE=0.9135, RMSE=1.4435, R²=0.9052, MAPE=11.37%
2025-06-04 10:56:30,350 - train_models - INFO - Building model for WorkType: 210
2025-06-04 10:56:34,125 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:57:28,907 - train_models - INFO - Model for 210 - MAE: 0.8222, RMSE: 1.1880, R²: 0.8881, MAPE: 17.56%
2025-06-04 10:57:28,908 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 10:57:28,908 - train_models - INFO -   NoOfMan_7day_trend: 0.2583
2025-06-04 10:57:28,908 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1966
2025-06-04 10:57:28,909 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1765
2025-06-04 10:57:28,909 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0657
2025-06-04 10:57:28,909 - train_models - INFO -   NoOfMan_1day_trend: 0.0639
2025-06-04 10:57:28,910 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-06-04 10:57:28,910 - train_models - INFO -   Quantity_1day_trend: 0.0322
2025-06-04 10:57:28,910 - train_models - INFO -   NoOfMan_lag_1: 0.0321
2025-06-04 10:57:28,911 - train_models - INFO -   DayOfWeek_feat_6: 0.0257
2025-06-04 10:57:28,911 - train_models - INFO -   Quantity_7day_trend: 0.0185
2025-06-04 10:57:28,911 - train_models - INFO - Cross-validation details for 210:
2025-06-04 10:57:28,912 - train_models - INFO -   Fold 1: MAE=0.8420, RMSE=1.1683, R²=0.8776, MAPE=13.96%
2025-06-04 10:57:28,912 - train_models - INFO -   Fold 2: MAE=0.7272, RMSE=1.0372, R²=0.9014, MAPE=12.35%
2025-06-04 10:57:28,913 - train_models - INFO -   Fold 3: MAE=0.6305, RMSE=0.8758, R²=0.9264, MAPE=8.81%
2025-06-04 10:57:28,913 - train_models - INFO -   Fold 4: MAE=0.9211, RMSE=1.2740, R²=0.8757, MAPE=27.00%
2025-06-04 10:57:28,913 - train_models - INFO -   Fold 5: MAE=0.9903, RMSE=1.5846, R²=0.8595, MAPE=25.67%
2025-06-04 10:57:28,913 - train_models - INFO - Building model for WorkType: 211
2025-06-04 10:57:32,322 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:58:29,861 - train_models - INFO - Model for 211 - MAE: 0.6443, RMSE: 0.9984, R²: 0.9099, MAPE: 11.02%
2025-06-04 10:58:29,861 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 10:58:29,862 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3618
2025-06-04 10:58:29,863 - train_models - INFO -   NoOfMan_1day_trend: 0.1848
2025-06-04 10:58:29,864 - train_models - INFO -   NoOfMan_7day_trend: 0.1830
2025-06-04 10:58:29,864 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0695
2025-06-04 10:58:29,865 - train_models - INFO -   NoOfMan_lag_1: 0.0453
2025-06-04 10:58:29,866 - train_models - INFO -   NoOfMan_lag_7: 0.0362
2025-06-04 10:58:29,866 - train_models - INFO -   DayOfWeek_feat_6: 0.0334
2025-06-04 10:58:29,867 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0257
2025-06-04 10:58:29,868 - train_models - INFO -   Quantity_same_dow_lag: 0.0125
2025-06-04 10:58:29,869 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 10:58:29,869 - train_models - INFO - Cross-validation details for 211:
2025-06-04 10:58:29,870 - train_models - INFO -   Fold 1: MAE=1.0888, RMSE=1.6864, R²=0.8022, MAPE=16.39%
2025-06-04 10:58:29,871 - train_models - INFO -   Fold 2: MAE=0.6007, RMSE=0.9716, R²=0.9118, MAPE=9.81%
2025-06-04 10:58:29,871 - train_models - INFO -   Fold 3: MAE=0.4720, RMSE=0.7228, R²=0.9546, MAPE=8.59%
2025-06-04 10:58:29,872 - train_models - INFO -   Fold 4: MAE=0.5685, RMSE=0.8997, R²=0.9323, MAPE=10.66%
2025-06-04 10:58:29,873 - train_models - INFO -   Fold 5: MAE=0.4916, RMSE=0.7115, R²=0.9483, MAPE=9.65%
2025-06-04 10:58:29,873 - train_models - INFO - Building model for WorkType: 213
2025-06-04 10:58:33,390 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 10:59:26,249 - train_models - INFO - Model for 213 - MAE: 0.3896, RMSE: 0.5826, R²: 0.8893, MAPE: 15.57%
2025-06-04 10:59:26,249 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 10:59:26,250 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4412
2025-06-04 10:59:26,250 - train_models - INFO -   NoOfMan_7day_trend: 0.2149
2025-06-04 10:59:26,250 - train_models - INFO -   NoOfMan_1day_trend: 0.1394
2025-06-04 10:59:26,251 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0524
2025-06-04 10:59:26,251 - train_models - INFO -   NoOfMan_lag_1: 0.0454
2025-06-04 10:59:26,252 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0307
2025-06-04 10:59:26,253 - train_models - INFO -   NoOfMan_lag_7: 0.0288
2025-06-04 10:59:26,253 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0062
2025-06-04 10:59:26,253 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0055
2025-06-04 10:59:26,254 - train_models - INFO -   NoOfMan_lag_2: 0.0037
2025-06-04 10:59:26,254 - train_models - INFO - Cross-validation details for 213:
2025-06-04 10:59:26,254 - train_models - INFO -   Fold 1: MAE=0.5177, RMSE=0.7689, R²=0.8616, MAPE=15.02%
2025-06-04 10:59:26,255 - train_models - INFO -   Fold 2: MAE=0.4453, RMSE=0.6093, R²=0.8726, MAPE=23.95%
2025-06-04 10:59:26,255 - train_models - INFO -   Fold 3: MAE=0.3303, RMSE=0.5635, R²=0.8823, MAPE=14.96%
2025-06-04 10:59:26,256 - train_models - INFO -   Fold 4: MAE=0.3310, RMSE=0.4831, R²=0.9113, MAPE=13.05%
2025-06-04 10:59:26,256 - train_models - INFO -   Fold 5: MAE=0.3238, RMSE=0.4883, R²=0.9189, MAPE=10.86%
2025-06-04 10:59:26,257 - train_models - INFO - Building model for WorkType: 214
2025-06-04 10:59:29,851 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 11:00:23,364 - train_models - INFO - Model for 214 - MAE: 0.4606, RMSE: 0.6960, R²: 0.8892, MAPE: 10.30%
2025-06-04 11:00:23,365 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 11:00:23,365 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5059
2025-06-04 11:00:23,366 - train_models - INFO -   NoOfMan_7day_trend: 0.1861
2025-06-04 11:00:23,366 - train_models - INFO -   NoOfMan_1day_trend: 0.0837
2025-06-04 11:00:23,367 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0655
2025-06-04 11:00:23,367 - train_models - INFO -   NoOfMan_lag_7: 0.0540
2025-06-04 11:00:23,368 - train_models - INFO -   NoOfMan_lag_1: 0.0418
2025-06-04 11:00:23,368 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-04 11:00:23,369 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0071
2025-06-04 11:00:23,369 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-04 11:00:23,370 - train_models - INFO -   NoOfMan_lag_2: 0.0035
2025-06-04 11:00:23,371 - train_models - INFO - Cross-validation details for 214:
2025-06-04 11:00:23,372 - train_models - INFO -   Fold 1: MAE=0.5008, RMSE=0.6928, R²=0.8328, MAPE=13.58%
2025-06-04 11:00:23,373 - train_models - INFO -   Fold 2: MAE=0.4204, RMSE=0.5340, R²=0.9206, MAPE=10.02%
2025-06-04 11:00:23,374 - train_models - INFO -   Fold 3: MAE=0.3151, RMSE=0.4373, R²=0.9479, MAPE=9.00%
2025-06-04 11:00:23,374 - train_models - INFO -   Fold 4: MAE=0.3053, RMSE=0.5442, R²=0.9311, MAPE=5.49%
2025-06-04 11:00:23,375 - train_models - INFO -   Fold 5: MAE=0.7616, RMSE=1.2717, R²=0.8138, MAPE=13.41%
2025-06-04 11:00:23,375 - train_models - INFO - Building model for WorkType: 215
2025-06-04 11:00:27,643 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 11:01:35,292 - train_models - INFO - Model for 215 - MAE: 0.6809, RMSE: 1.0595, R²: 0.8966, MAPE: 15.72%
2025-06-04 11:01:35,293 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 11:01:35,293 - train_models - INFO -   NoOfMan_7day_trend: 0.1741
2025-06-04 11:01:35,294 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1717
2025-06-04 11:01:35,294 - train_models - INFO -   DayOfWeek_feat_6: 0.1659
2025-06-04 11:01:35,295 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1419
2025-06-04 11:01:35,295 - train_models - INFO -   NoOfMan_1day_trend: 0.1236
2025-06-04 11:01:35,296 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0666
2025-06-04 11:01:35,296 - train_models - INFO -   NoOfMan_lag_1: 0.0333
2025-06-04 11:01:35,297 - train_models - INFO -   NoOfMan_lag_7: 0.0301
2025-06-04 11:01:35,297 - train_models - INFO -   Quantity_7day_trend: 0.0113
2025-06-04 11:01:35,298 - train_models - INFO -   Quantity_1day_trend: 0.0098
2025-06-04 11:01:35,298 - train_models - INFO - Cross-validation details for 215:
2025-06-04 11:01:35,299 - train_models - INFO -   Fold 1: MAE=0.9833, RMSE=1.5269, R²=0.8062, MAPE=26.21%
2025-06-04 11:01:35,299 - train_models - INFO -   Fold 2: MAE=0.6939, RMSE=1.0014, R²=0.9137, MAPE=16.78%
2025-06-04 11:01:35,300 - train_models - INFO -   Fold 3: MAE=0.6709, RMSE=1.0383, R²=0.9043, MAPE=11.72%
2025-06-04 11:01:35,300 - train_models - INFO -   Fold 4: MAE=0.5287, RMSE=0.8017, R²=0.9335, MAPE=13.18%
2025-06-04 11:01:35,301 - train_models - INFO -   Fold 5: MAE=0.5277, RMSE=0.9295, R²=0.9255, MAPE=10.70%
2025-06-04 11:01:35,301 - train_models - INFO - Building model for WorkType: 217
2025-06-04 11:01:38,781 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-06-04 11:02:32,670 - train_models - INFO - Model for 217 - MAE: 0.4042, RMSE: 0.5430, R²: 0.9135, MAPE: 17.24%
2025-06-04 11:02:32,671 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 11:02:32,671 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5670
2025-06-04 11:02:32,672 - train_models - INFO -   NoOfMan_7day_trend: 0.1232
2025-06-04 11:02:32,672 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0854
2025-06-04 11:02:32,673 - train_models - INFO -   NoOfMan_lag_1: 0.0694
2025-06-04 11:02:32,673 - train_models - INFO -   NoOfMan_1day_trend: 0.0641
2025-06-04 11:02:32,674 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0365
2025-06-04 11:02:32,674 - train_models - INFO -   NoOfMan_lag_7: 0.0256
2025-06-04 11:02:32,675 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 11:02:32,675 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-06-04 11:02:32,675 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0018
2025-06-04 11:02:32,676 - train_models - INFO - Cross-validation details for 217:
2025-06-04 11:02:32,676 - train_models - INFO -   Fold 1: MAE=0.5626, RMSE=0.6839, R²=0.8372, MAPE=25.36%
2025-06-04 11:02:32,677 - train_models - INFO -   Fold 2: MAE=0.4247, RMSE=0.5508, R²=0.9077, MAPE=21.23%
2025-06-04 11:02:32,677 - train_models - INFO -   Fold 3: MAE=0.3640, RMSE=0.4860, R²=0.9439, MAPE=13.25%
2025-06-04 11:02:32,678 - train_models - INFO -   Fold 4: MAE=0.3043, RMSE=0.3904, R²=0.9674, MAPE=12.79%
2025-06-04 11:02:32,678 - train_models - INFO -   Fold 5: MAE=0.3654, RMSE=0.6038, R²=0.9115, MAPE=13.56%
2025-06-04 11:02:32,679 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 11:02:33,812 - train_models - INFO - Model files saved successfully
2025-06-04 11:02:33,812 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 11:02:33,818 - train_models - INFO - Model training completed successfully
2025-06-04 13:06:13,929 - train_models - INFO - Starting the model training process
2025-06-04 13:06:13,931 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 13:06:13,939 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 13:06:14,097 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 13:06:14,907 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 13:06:14,985 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 13:06:15,006 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 13:06:15,007 - train_models - INFO - Converting Date column to datetime format
2025-06-04 13:06:15,046 - train_models - INFO - Engineering features...
2025-06-04 13:06:16,285 - utils.feature_engineering - INFO - Engineering features
2025-06-04 13:06:16,343 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 13:06:16,351 - train_models - INFO - Creating lag features...
2025-06-04 13:06:16,371 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 13:06:16,753 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 13:06:16,754 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 13:06:16,774 - train_models - INFO - Found 10 unique work types
2025-06-04 13:06:16,775 - train_models - INFO - Building models for 10 work types
2025-06-04 13:06:16,776 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 13:06:16,776 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 13:06:16,777 - train_models - INFO - Building model for WorkType: 202
2025-06-04 13:06:16,788 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:07:06,501 - train_models - INFO - Model for 202 - MAE: 0.2118, RMSE: 0.3301, R²: 0.7457, MAPE: 10.10%
2025-06-04 13:07:06,504 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 13:07:06,504 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3966
2025-06-04 13:07:06,505 - train_models - INFO -   NoOfMan_7day_trend: 0.1988
2025-06-04 13:07:06,505 - train_models - INFO -   NoOfMan_1day_trend: 0.1268
2025-06-04 13:07:06,506 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0678
2025-06-04 13:07:06,506 - train_models - INFO -   NoOfMan_lag_1: 0.0675
2025-06-04 13:07:06,506 - train_models - INFO -   NoOfMan_lag_7: 0.0662
2025-06-04 13:07:06,507 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0387
2025-06-04 13:07:06,507 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0044
2025-06-04 13:07:06,508 - train_models - INFO -   Quantity_lag_7: 0.0022
2025-06-04 13:07:06,508 - train_models - INFO -   Quantity_rolling_mean_7: 0.0022
2025-06-04 13:07:06,509 - train_models - INFO - Cross-validation details for 202:
2025-06-04 13:07:06,509 - train_models - INFO -   Fold 1: MAE=0.2223, RMSE=0.4186, R²=0.3858, MAPE=11.30%
2025-06-04 13:07:06,510 - train_models - INFO -   Fold 2: MAE=0.2068, RMSE=0.3083, R²=0.7811, MAPE=11.43%
2025-06-04 13:07:06,510 - train_models - INFO -   Fold 3: MAE=0.2267, RMSE=0.3572, R²=0.8014, MAPE=11.66%
2025-06-04 13:07:06,510 - train_models - INFO -   Fold 4: MAE=0.1722, RMSE=0.2251, R²=0.8969, MAPE=7.87%
2025-06-04 13:07:06,511 - train_models - INFO -   Fold 5: MAE=0.2311, RMSE=0.3415, R²=0.8634, MAPE=8.26%
2025-06-04 13:07:06,511 - train_models - INFO - Building model for WorkType: 203
2025-06-04 13:07:06,521 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:07:58,480 - train_models - INFO - Model for 203 - MAE: 0.2238, RMSE: 0.3226, R²: 0.9149, MAPE: 4.68%
2025-06-04 13:07:58,480 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 13:07:58,481 - train_models - INFO -   NoOfMan_7day_trend: 0.3052
2025-06-04 13:07:58,481 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2342
2025-06-04 13:07:58,482 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1220
2025-06-04 13:07:58,482 - train_models - INFO -   NoOfMan_1day_trend: 0.0913
2025-06-04 13:07:58,483 - train_models - INFO -   NoOfMan_lag_7: 0.0849
2025-06-04 13:07:58,483 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0723
2025-06-04 13:07:58,483 - train_models - INFO -   NoOfMan_lag_1: 0.0533
2025-06-04 13:07:58,484 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-06-04 13:07:58,484 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-06-04 13:07:58,485 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-06-04 13:07:58,485 - train_models - INFO - Cross-validation details for 203:
2025-06-04 13:07:58,486 - train_models - INFO -   Fold 1: MAE=0.2838, RMSE=0.3915, R²=0.8792, MAPE=5.69%
2025-06-04 13:07:58,486 - train_models - INFO -   Fold 2: MAE=0.2561, RMSE=0.3475, R²=0.9120, MAPE=5.04%
2025-06-04 13:07:58,487 - train_models - INFO -   Fold 3: MAE=0.2285, RMSE=0.3669, R²=0.8986, MAPE=4.25%
2025-06-04 13:07:58,487 - train_models - INFO -   Fold 4: MAE=0.1777, RMSE=0.2699, R²=0.9409, MAPE=4.20%
2025-06-04 13:07:58,487 - train_models - INFO -   Fold 5: MAE=0.1727, RMSE=0.2370, R²=0.9439, MAPE=4.22%
2025-06-04 13:07:58,488 - train_models - INFO - Building model for WorkType: 206
2025-06-04 13:07:58,499 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:09:05,910 - train_models - INFO - Model for 206 - MAE: 1.4074, RMSE: 2.1493, R²: 0.9308, MAPE: 8.07%
2025-06-04 13:09:05,910 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 13:09:05,911 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5192
2025-06-04 13:09:05,911 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1538
2025-06-04 13:09:05,912 - train_models - INFO -   DayOfWeek_feat_6: 0.0712
2025-06-04 13:09:05,912 - train_models - INFO -   NoOfMan_1day_trend: 0.0706
2025-06-04 13:09:05,912 - train_models - INFO -   NoOfMan_7day_trend: 0.0529
2025-06-04 13:09:05,913 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0366
2025-06-04 13:09:05,913 - train_models - INFO -   NoOfMan_lag_1: 0.0272
2025-06-04 13:09:05,914 - train_models - INFO -   Quantity_rolling_mean_7: 0.0088
2025-06-04 13:09:05,914 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0072
2025-06-04 13:09:05,915 - train_models - INFO -   NoOfMan_lag_7: 0.0071
2025-06-04 13:09:05,915 - train_models - INFO - Cross-validation details for 206:
2025-06-04 13:09:05,915 - train_models - INFO -   Fold 1: MAE=1.7312, RMSE=2.3736, R²=0.9234, MAPE=9.92%
2025-06-04 13:09:05,916 - train_models - INFO -   Fold 2: MAE=1.5977, RMSE=2.2832, R²=0.9261, MAPE=8.85%
2025-06-04 13:09:05,918 - train_models - INFO -   Fold 3: MAE=1.5386, RMSE=2.6666, R²=0.8934, MAPE=8.90%
2025-06-04 13:09:05,918 - train_models - INFO -   Fold 4: MAE=0.9702, RMSE=1.4891, R²=0.9582, MAPE=6.46%
2025-06-04 13:09:05,919 - train_models - INFO -   Fold 5: MAE=1.1994, RMSE=1.9342, R²=0.9529, MAPE=6.23%
2025-06-04 13:09:05,919 - train_models - INFO - Building model for WorkType: 209
2025-06-04 13:09:05,929 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:10:01,879 - train_models - INFO - Model for 209 - MAE: 0.8890, RMSE: 1.3839, R²: 0.8892, MAPE: 12.37%
2025-06-04 13:10:01,880 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 13:10:01,881 - train_models - INFO -   NoOfMan_7day_trend: 0.4014
2025-06-04 13:10:01,881 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2195
2025-06-04 13:10:01,882 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0996
2025-06-04 13:10:01,882 - train_models - INFO -   NoOfMan_1day_trend: 0.0674
2025-06-04 13:10:01,882 - train_models - INFO -   NoOfMan_lag_7: 0.0502
2025-06-04 13:10:01,883 - train_models - INFO -   Quantity_rolling_mean_7: 0.0480
2025-06-04 13:10:01,883 - train_models - INFO -   NoOfMan_lag_1: 0.0257
2025-06-04 13:10:01,884 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0193
2025-06-04 13:10:01,884 - train_models - INFO -   Quantity_7day_trend: 0.0089
2025-06-04 13:10:01,885 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0083
2025-06-04 13:10:01,885 - train_models - INFO - Cross-validation details for 209:
2025-06-04 13:10:01,885 - train_models - INFO -   Fold 1: MAE=1.0129, RMSE=1.4761, R²=0.8544, MAPE=13.82%
2025-06-04 13:10:01,886 - train_models - INFO -   Fold 2: MAE=1.0118, RMSE=1.7278, R²=0.8461, MAPE=14.93%
2025-06-04 13:10:01,887 - train_models - INFO -   Fold 3: MAE=0.6588, RMSE=0.8745, R²=0.9400, MAPE=10.54%
2025-06-04 13:10:01,887 - train_models - INFO -   Fold 4: MAE=0.8561, RMSE=1.4067, R²=0.8992, MAPE=11.26%
2025-06-04 13:10:01,888 - train_models - INFO -   Fold 5: MAE=0.9053, RMSE=1.4342, R²=0.9064, MAPE=11.29%
2025-06-04 13:10:01,888 - train_models - INFO - Building model for WorkType: 210
2025-06-04 13:10:01,901 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:10:58,802 - train_models - INFO - Model for 210 - MAE: 0.8203, RMSE: 1.1818, R²: 0.8893, MAPE: 17.53%
2025-06-04 13:10:58,803 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 13:10:58,803 - train_models - INFO -   NoOfMan_7day_trend: 0.2585
2025-06-04 13:10:58,804 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1964
2025-06-04 13:10:58,804 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1763
2025-06-04 13:10:58,805 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0659
2025-06-04 13:10:58,805 - train_models - INFO -   NoOfMan_1day_trend: 0.0637
2025-06-04 13:10:58,806 - train_models - INFO -   NoOfMan_lag_7: 0.0379
2025-06-04 13:10:58,806 - train_models - INFO -   Quantity_1day_trend: 0.0324
2025-06-04 13:10:58,806 - train_models - INFO -   NoOfMan_lag_1: 0.0322
2025-06-04 13:10:58,807 - train_models - INFO -   DayOfWeek_feat_6: 0.0258
2025-06-04 13:10:58,807 - train_models - INFO -   Quantity_7day_trend: 0.0191
2025-06-04 13:10:58,808 - train_models - INFO - Cross-validation details for 210:
2025-06-04 13:10:58,808 - train_models - INFO -   Fold 1: MAE=0.8406, RMSE=1.1561, R²=0.8801, MAPE=14.02%
2025-06-04 13:10:58,809 - train_models - INFO -   Fold 2: MAE=0.7251, RMSE=1.0331, R²=0.9022, MAPE=12.35%
2025-06-04 13:10:58,809 - train_models - INFO -   Fold 3: MAE=0.6315, RMSE=0.8805, R²=0.9256, MAPE=8.84%
2025-06-04 13:10:58,810 - train_models - INFO -   Fold 4: MAE=0.9206, RMSE=1.2697, R²=0.8765, MAPE=26.85%
2025-06-04 13:10:58,810 - train_models - INFO -   Fold 5: MAE=0.9837, RMSE=1.5698, R²=0.8621, MAPE=25.57%
2025-06-04 13:10:58,811 - train_models - INFO - Building model for WorkType: 211
2025-06-04 13:10:58,819 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:11:58,165 - train_models - INFO - Model for 211 - MAE: 0.6402, RMSE: 0.9919, R²: 0.9112, MAPE: 10.93%
2025-06-04 13:11:58,166 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 13:11:58,166 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3616
2025-06-04 13:11:58,166 - train_models - INFO -   NoOfMan_7day_trend: 0.1838
2025-06-04 13:11:58,167 - train_models - INFO -   NoOfMan_1day_trend: 0.1838
2025-06-04 13:11:58,167 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0697
2025-06-04 13:11:58,168 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 13:11:58,168 - train_models - INFO -   NoOfMan_lag_7: 0.0366
2025-06-04 13:11:58,169 - train_models - INFO -   DayOfWeek_feat_6: 0.0332
2025-06-04 13:11:58,169 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0258
2025-06-04 13:11:58,170 - train_models - INFO -   Quantity_same_dow_lag: 0.0129
2025-06-04 13:11:58,170 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0056
2025-06-04 13:11:58,170 - train_models - INFO - Cross-validation details for 211:
2025-06-04 13:11:58,171 - train_models - INFO -   Fold 1: MAE=1.0752, RMSE=1.6638, R²=0.8074, MAPE=16.02%
2025-06-04 13:11:58,171 - train_models - INFO -   Fold 2: MAE=0.6008, RMSE=0.9621, R²=0.9136, MAPE=9.68%
2025-06-04 13:11:58,172 - train_models - INFO -   Fold 3: MAE=0.4565, RMSE=0.7031, R²=0.9571, MAPE=8.25%
2025-06-04 13:11:58,172 - train_models - INFO -   Fold 4: MAE=0.5683, RMSE=0.9042, R²=0.9316, MAPE=10.87%
2025-06-04 13:11:58,173 - train_models - INFO -   Fold 5: MAE=0.5004, RMSE=0.7265, R²=0.9461, MAPE=9.84%
2025-06-04 13:11:58,173 - train_models - INFO - Building model for WorkType: 213
2025-06-04 13:11:58,185 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:12:51,381 - train_models - INFO - Model for 213 - MAE: 0.3880, RMSE: 0.5794, R²: 0.8907, MAPE: 15.54%
2025-06-04 13:12:51,381 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 13:12:51,382 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4416
2025-06-04 13:12:51,382 - train_models - INFO -   NoOfMan_7day_trend: 0.2157
2025-06-04 13:12:51,383 - train_models - INFO -   NoOfMan_1day_trend: 0.1397
2025-06-04 13:12:51,383 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0523
2025-06-04 13:12:51,383 - train_models - INFO -   NoOfMan_lag_1: 0.0454
2025-06-04 13:12:51,384 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0309
2025-06-04 13:12:51,384 - train_models - INFO -   NoOfMan_lag_7: 0.0292
2025-06-04 13:12:51,385 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0063
2025-06-04 13:12:51,385 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0055
2025-06-04 13:12:51,385 - train_models - INFO -   NoOfMan_lag_2: 0.0039
2025-06-04 13:12:51,386 - train_models - INFO - Cross-validation details for 213:
2025-06-04 13:12:51,386 - train_models - INFO -   Fold 1: MAE=0.5163, RMSE=0.7663, R²=0.8625, MAPE=14.97%
2025-06-04 13:12:51,387 - train_models - INFO -   Fold 2: MAE=0.4433, RMSE=0.6051, R²=0.8743, MAPE=23.91%
2025-06-04 13:12:51,387 - train_models - INFO -   Fold 3: MAE=0.3248, RMSE=0.5527, R²=0.8868, MAPE=14.71%
2025-06-04 13:12:51,388 - train_models - INFO -   Fold 4: MAE=0.3309, RMSE=0.4824, R²=0.9116, MAPE=13.14%
2025-06-04 13:12:51,388 - train_models - INFO -   Fold 5: MAE=0.3244, RMSE=0.4906, R²=0.9181, MAPE=10.96%
2025-06-04 13:12:51,388 - train_models - INFO - Building model for WorkType: 214
2025-06-04 13:12:51,398 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:13:42,751 - train_models - INFO - Model for 214 - MAE: 0.4567, RMSE: 0.6902, R²: 0.8912, MAPE: 10.22%
2025-06-04 13:13:42,751 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 13:13:42,752 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5063
2025-06-04 13:13:42,752 - train_models - INFO -   NoOfMan_7day_trend: 0.1864
2025-06-04 13:13:42,753 - train_models - INFO -   NoOfMan_1day_trend: 0.0839
2025-06-04 13:13:42,753 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0652
2025-06-04 13:13:42,754 - train_models - INFO -   NoOfMan_lag_7: 0.0542
2025-06-04 13:13:42,754 - train_models - INFO -   NoOfMan_lag_1: 0.0419
2025-06-04 13:13:42,754 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-04 13:13:42,755 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0073
2025-06-04 13:13:42,756 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0065
2025-06-04 13:13:42,756 - train_models - INFO -   Quantity_same_dow_lag: 0.0035
2025-06-04 13:13:42,757 - train_models - INFO - Cross-validation details for 214:
2025-06-04 13:13:42,757 - train_models - INFO -   Fold 1: MAE=0.4918, RMSE=0.6837, R²=0.8372, MAPE=13.32%
2025-06-04 13:13:42,758 - train_models - INFO -   Fold 2: MAE=0.4176, RMSE=0.5316, R²=0.9213, MAPE=9.92%
2025-06-04 13:13:42,758 - train_models - INFO -   Fold 3: MAE=0.3105, RMSE=0.4309, R²=0.9494, MAPE=8.86%
2025-06-04 13:13:42,758 - train_models - INFO -   Fold 4: MAE=0.3060, RMSE=0.5414, R²=0.9318, MAPE=5.56%
2025-06-04 13:13:42,759 - train_models - INFO -   Fold 5: MAE=0.7574, RMSE=1.2634, R²=0.8162, MAPE=13.43%
2025-06-04 13:13:42,759 - train_models - INFO - Building model for WorkType: 215
2025-06-04 13:13:42,772 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:14:44,219 - train_models - INFO - Model for 215 - MAE: 0.6756, RMSE: 1.0523, R²: 0.8980, MAPE: 15.55%
2025-06-04 13:14:44,220 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 13:14:44,220 - train_models - INFO -   NoOfMan_7day_trend: 0.1732
2025-06-04 13:14:44,221 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1718
2025-06-04 13:14:44,221 - train_models - INFO -   DayOfWeek_feat_6: 0.1661
2025-06-04 13:14:44,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1433
2025-06-04 13:14:44,222 - train_models - INFO -   NoOfMan_1day_trend: 0.1260
2025-06-04 13:14:44,222 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0659
2025-06-04 13:14:44,223 - train_models - INFO -   NoOfMan_lag_1: 0.0335
2025-06-04 13:14:44,223 - train_models - INFO -   NoOfMan_lag_7: 0.0300
2025-06-04 13:14:44,223 - train_models - INFO -   Quantity_7day_trend: 0.0115
2025-06-04 13:14:44,224 - train_models - INFO -   Quantity_rolling_mean_7: 0.0101
2025-06-04 13:14:44,224 - train_models - INFO - Cross-validation details for 215:
2025-06-04 13:14:44,225 - train_models - INFO -   Fold 1: MAE=0.9782, RMSE=1.5211, R²=0.8077, MAPE=25.79%
2025-06-04 13:14:44,225 - train_models - INFO -   Fold 2: MAE=0.6982, RMSE=1.0071, R²=0.9127, MAPE=16.64%
2025-06-04 13:14:44,226 - train_models - INFO -   Fold 3: MAE=0.6556, RMSE=1.0211, R²=0.9074, MAPE=11.54%
2025-06-04 13:14:44,226 - train_models - INFO -   Fold 4: MAE=0.5172, RMSE=0.7901, R²=0.9354, MAPE=13.04%
2025-06-04 13:14:44,227 - train_models - INFO -   Fold 5: MAE=0.5289, RMSE=0.9220, R²=0.9267, MAPE=10.74%
2025-06-04 13:14:44,227 - train_models - INFO - Building model for WorkType: 217
2025-06-04 13:14:44,236 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 13:15:29,186 - train_models - INFO - Model for 217 - MAE: 0.4052, RMSE: 0.5428, R²: 0.9132, MAPE: 17.34%
2025-06-04 13:15:29,187 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 13:15:29,188 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5673
2025-06-04 13:15:29,188 - train_models - INFO -   NoOfMan_7day_trend: 0.1232
2025-06-04 13:15:29,188 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0853
2025-06-04 13:15:29,189 - train_models - INFO -   NoOfMan_lag_1: 0.0699
2025-06-04 13:15:29,189 - train_models - INFO -   NoOfMan_1day_trend: 0.0644
2025-06-04 13:15:29,190 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0362
2025-06-04 13:15:29,190 - train_models - INFO -   NoOfMan_lag_7: 0.0258
2025-06-04 13:15:29,191 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0047
2025-06-04 13:15:29,191 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0019
2025-06-04 13:15:29,192 - train_models - INFO -   NoOfMan_lag_2: 0.0018
2025-06-04 13:15:29,192 - train_models - INFO - Cross-validation details for 217:
2025-06-04 13:15:29,192 - train_models - INFO -   Fold 1: MAE=0.5785, RMSE=0.6967, R²=0.8311, MAPE=26.19%
2025-06-04 13:15:29,193 - train_models - INFO -   Fold 2: MAE=0.4155, RMSE=0.5392, R²=0.9115, MAPE=20.73%
2025-06-04 13:15:29,193 - train_models - INFO -   Fold 3: MAE=0.3600, RMSE=0.4801, R²=0.9453, MAPE=13.17%
2025-06-04 13:15:29,194 - train_models - INFO -   Fold 4: MAE=0.3056, RMSE=0.3919, R²=0.9671, MAPE=12.90%
2025-06-04 13:15:29,194 - train_models - INFO -   Fold 5: MAE=0.3662, RMSE=0.6060, R²=0.9109, MAPE=13.70%
2025-06-04 13:15:29,195 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 13:15:30,797 - train_models - INFO - Model files saved successfully
2025-06-04 13:15:30,797 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 13:15:30,804 - train_models - INFO - Model training completed successfully
2025-06-04 14:10:01,434 - train_models - INFO - Starting the model training process
2025-06-04 14:10:01,434 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 14:10:01,441 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 14:10:01,629 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 14:10:02,450 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 14:10:02,700 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 14:10:02,719 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 14:10:02,720 - train_models - INFO - Converting Date column to datetime format
2025-06-04 14:10:02,757 - train_models - INFO - Engineering features...
2025-06-04 14:10:03,855 - utils.feature_engineering - INFO - Engineering features
2025-06-04 14:10:03,912 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 14:10:03,920 - train_models - INFO - Creating lag features...
2025-06-04 14:10:03,940 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 14:10:04,298 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 14:10:04,299 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 14:10:04,327 - train_models - INFO - Found 10 unique work types
2025-06-04 14:10:04,328 - train_models - INFO - Building models for 10 work types
2025-06-04 14:10:04,336 - utils.feature_builder - INFO - Built feature set: 4 numeric, 2 categorical
2025-06-04 14:10:04,337 - train_models - INFO - Using 4 numeric and 2 categorical features
2025-06-04 14:10:04,337 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7']
2025-06-04 14:10:04,338 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-04 14:10:04,338 - train_models - INFO - Building model for WorkType: 202
2025-06-04 14:10:04,348 - train_models - INFO - Using 4 numeric features and 2 categorical features
2025-06-04 14:10:04,369 - train_models - ERROR - Error building models: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-06-04 14:10:04,560 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 205, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 375, in fit
    estimator._compute_missing_values_in_feature_mask(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X, estimator_name=self.__class__.__name__
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\tree\_classes.py", line 214, in _compute_missing_values_in_feature_mask
    assert_all_finite(X, **common_kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 210, in assert_all_finite
    _assert_all_finite(
    ~~~~~~~~~~~~~~~~~~^
        X.data if sp.issparse(X) else X,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X,
        ^^
    ...<4 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values

2025-06-04 14:10:04,562 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-04 14:10:05,212 - train_models - INFO - Model files saved successfully
2025-06-04 14:10:05,212 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 14:10:05,216 - train_models - INFO - Model training completed successfully
2025-06-04 14:10:51,535 - train_models - INFO - Starting the model training process
2025-06-04 14:10:51,536 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 14:10:51,543 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 14:10:51,685 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 14:10:52,503 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 14:10:52,573 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 14:10:52,597 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 14:10:52,598 - train_models - INFO - Converting Date column to datetime format
2025-06-04 14:10:52,625 - train_models - INFO - Engineering features...
2025-06-04 14:10:53,586 - utils.feature_engineering - INFO - Engineering features
2025-06-04 14:10:53,641 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 14:10:53,650 - train_models - INFO - Creating lag features...
2025-06-04 14:10:53,669 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 14:10:54,024 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 14:10:54,025 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 14:10:54,047 - train_models - INFO - Found 10 unique work types
2025-06-04 14:10:54,047 - train_models - INFO - Building models for 10 work types
2025-06-04 14:10:54,050 - utils.feature_builder - INFO - Built feature set: 4 numeric, 2 categorical
2025-06-04 14:10:54,050 - train_models - INFO - Using 4 numeric and 2 categorical features
2025-06-04 14:10:54,051 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7']
2025-06-04 14:10:54,051 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-04 14:10:54,052 - train_models - INFO - Building model for WorkType: 202
2025-06-04 14:10:54,064 - train_models - INFO - Using 4 numeric features and 2 categorical features
2025-06-04 14:10:54,081 - train_models - ERROR - Error building models: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-06-04 14:10:54,094 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 205, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 375, in fit
    estimator._compute_missing_values_in_feature_mask(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X, estimator_name=self.__class__.__name__
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\tree\_classes.py", line 214, in _compute_missing_values_in_feature_mask
    assert_all_finite(X, **common_kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 210, in assert_all_finite
    _assert_all_finite(
    ~~~~~~~~~~~~~~~~~~^
        X.data if sp.issparse(X) else X,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X,
        ^^
    ...<4 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values

2025-06-04 14:10:54,096 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-04 14:10:54,630 - train_models - INFO - Model files saved successfully
2025-06-04 14:10:54,631 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 14:10:54,634 - train_models - INFO - Model training completed successfully
2025-06-04 14:12:12,126 - train_models - INFO - Starting the model training process
2025-06-04 14:12:12,126 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 14:12:12,133 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 14:12:12,274 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 14:12:13,057 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 14:12:13,127 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 14:12:13,149 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 14:12:13,150 - train_models - INFO - Converting Date column to datetime format
2025-06-04 14:12:13,172 - train_models - INFO - Engineering features...
2025-06-04 14:12:14,071 - utils.feature_engineering - INFO - Engineering features
2025-06-04 14:12:14,126 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 14:12:14,134 - train_models - INFO - Creating lag features...
2025-06-04 14:12:14,153 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 14:12:14,516 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 14:12:14,516 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 14:12:14,538 - train_models - INFO - Found 10 unique work types
2025-06-04 14:12:14,539 - train_models - INFO - Building models for 10 work types
2025-06-04 14:12:14,541 - utils.feature_builder - INFO - Built feature set: 4 numeric, 2 categorical
2025-06-04 14:12:14,541 - train_models - INFO - Using 4 numeric and 2 categorical features
2025-06-04 14:12:14,542 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7']
2025-06-04 14:12:14,542 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-04 14:12:14,543 - train_models - INFO - Building model for WorkType: 202
2025-06-04 14:12:14,552 - train_models - INFO - Using 4 numeric features and 2 categorical features
2025-06-04 14:12:14,571 - train_models - ERROR - Error building models: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-06-04 14:12:14,581 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 205, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 375, in fit
    estimator._compute_missing_values_in_feature_mask(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X, estimator_name=self.__class__.__name__
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\tree\_classes.py", line 214, in _compute_missing_values_in_feature_mask
    assert_all_finite(X, **common_kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 210, in assert_all_finite
    _assert_all_finite(
    ~~~~~~~~~~~~~~~~~~^
        X.data if sp.issparse(X) else X,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X,
        ^^
    ...<4 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values

2025-06-04 14:12:14,584 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-04 14:12:15,127 - train_models - INFO - Model files saved successfully
2025-06-04 14:12:15,128 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 14:12:15,131 - train_models - INFO - Model training completed successfully
2025-06-04 14:20:00,219 - train_models - INFO - Starting the model training process
2025-06-04 14:20:00,219 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 14:20:00,226 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 14:20:00,363 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 14:20:01,227 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 14:20:01,310 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 14:20:01,331 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 14:20:01,331 - train_models - INFO - Converting Date column to datetime format
2025-06-04 14:20:01,356 - train_models - INFO - Engineering features...
2025-06-04 14:20:02,280 - utils.feature_engineering - INFO - Engineering features
2025-06-04 14:20:02,363 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 14:20:02,375 - train_models - INFO - Creating lag features...
2025-06-04 14:20:02,403 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 14:20:02,812 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 14:20:02,812 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 14:20:02,843 - train_models - INFO - Found 10 unique work types
2025-06-04 14:20:02,843 - train_models - INFO - Building models for 10 work types
2025-06-04 14:20:02,844 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-06-04 14:20:02,844 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-06-04 14:20:02,845 - train_models - INFO - Building model for WorkType: 202
2025-06-04 14:20:06,889 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:20:56,511 - train_models - INFO - Model for 202 - MAE: 0.2115, RMSE: 0.3285, R²: 0.7502, MAPE: 10.10%
2025-06-04 14:20:56,512 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 14:20:56,512 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3966
2025-06-04 14:20:56,513 - train_models - INFO -   NoOfMan_7day_trend: 0.1980
2025-06-04 14:20:56,513 - train_models - INFO -   NoOfMan_1day_trend: 0.1275
2025-06-04 14:20:56,514 - train_models - INFO -   NoOfMan_lag_1: 0.0681
2025-06-04 14:20:56,514 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0676
2025-06-04 14:20:56,514 - train_models - INFO -   NoOfMan_lag_7: 0.0659
2025-06-04 14:20:56,515 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0387
2025-06-04 14:20:56,515 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 14:20:56,516 - train_models - INFO -   Quantity_lag_7: 0.0022
2025-06-04 14:20:56,516 - train_models - INFO -   Quantity_rolling_mean_7: 0.0022
2025-06-04 14:20:56,517 - train_models - INFO - Cross-validation details for 202:
2025-06-04 14:20:56,517 - train_models - INFO -   Fold 1: MAE=0.2192, RMSE=0.4124, R²=0.4038, MAPE=11.18%
2025-06-04 14:20:56,517 - train_models - INFO -   Fold 2: MAE=0.2041, RMSE=0.3034, R²=0.7879, MAPE=11.29%
2025-06-04 14:20:56,518 - train_models - INFO -   Fold 3: MAE=0.2275, RMSE=0.3580, R²=0.8005, MAPE=11.75%
2025-06-04 14:20:56,518 - train_models - INFO -   Fold 4: MAE=0.1738, RMSE=0.2260, R²=0.8960, MAPE=8.02%
2025-06-04 14:20:56,519 - train_models - INFO -   Fold 5: MAE=0.2328, RMSE=0.3426, R²=0.8626, MAPE=8.29%
2025-06-04 14:20:56,519 - train_models - INFO - Building model for WorkType: 203
2025-06-04 14:21:00,009 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:21:52,490 - train_models - INFO - Model for 203 - MAE: 0.2207, RMSE: 0.3188, R²: 0.9169, MAPE: 4.61%
2025-06-04 14:21:52,491 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 14:21:52,491 - train_models - INFO -   NoOfMan_7day_trend: 0.3021
2025-06-04 14:21:52,492 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2349
2025-06-04 14:21:52,492 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1199
2025-06-04 14:21:52,492 - train_models - INFO -   NoOfMan_1day_trend: 0.0945
2025-06-04 14:21:52,493 - train_models - INFO -   NoOfMan_lag_7: 0.0830
2025-06-04 14:21:52,493 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0716
2025-06-04 14:21:52,494 - train_models - INFO -   NoOfMan_lag_1: 0.0568
2025-06-04 14:21:52,494 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-06-04 14:21:52,495 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-06-04 14:21:52,495 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-06-04 14:21:52,496 - train_models - INFO - Cross-validation details for 203:
2025-06-04 14:21:52,496 - train_models - INFO -   Fold 1: MAE=0.2751, RMSE=0.3824, R²=0.8848, MAPE=5.51%
2025-06-04 14:21:52,497 - train_models - INFO -   Fold 2: MAE=0.2491, RMSE=0.3415, R²=0.9150, MAPE=4.91%
2025-06-04 14:21:52,497 - train_models - INFO -   Fold 3: MAE=0.2283, RMSE=0.3681, R²=0.8979, MAPE=4.24%
2025-06-04 14:21:52,498 - train_models - INFO -   Fold 4: MAE=0.1781, RMSE=0.2656, R²=0.9428, MAPE=4.17%
2025-06-04 14:21:52,498 - train_models - INFO -   Fold 5: MAE=0.1727, RMSE=0.2365, R²=0.9442, MAPE=4.22%
2025-06-04 14:21:52,498 - train_models - INFO - Building model for WorkType: 206
2025-06-04 14:21:56,802 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:23:03,783 - train_models - INFO - Model for 206 - MAE: 1.3873, RMSE: 2.1264, R²: 0.9321, MAPE: 7.94%
2025-06-04 14:23:03,784 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 14:23:03,784 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5196
2025-06-04 14:23:03,785 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1520
2025-06-04 14:23:03,785 - train_models - INFO -   NoOfMan_1day_trend: 0.0740
2025-06-04 14:23:03,786 - train_models - INFO -   DayOfWeek_feat_6: 0.0710
2025-06-04 14:23:03,786 - train_models - INFO -   NoOfMan_7day_trend: 0.0499
2025-06-04 14:23:03,786 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0379
2025-06-04 14:23:03,787 - train_models - INFO -   NoOfMan_lag_1: 0.0289
2025-06-04 14:23:03,787 - train_models - INFO -   Quantity_rolling_mean_7: 0.0085
2025-06-04 14:23:03,788 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0069
2025-06-04 14:23:03,788 - train_models - INFO -   NoOfMan_lag_7: 0.0068
2025-06-04 14:23:03,789 - train_models - INFO - Cross-validation details for 206:
2025-06-04 14:23:03,789 - train_models - INFO -   Fold 1: MAE=1.7147, RMSE=2.3579, R²=0.9244, MAPE=9.76%
2025-06-04 14:23:03,790 - train_models - INFO -   Fold 2: MAE=1.5788, RMSE=2.2428, R²=0.9287, MAPE=8.69%
2025-06-04 14:23:03,790 - train_models - INFO -   Fold 3: MAE=1.5172, RMSE=2.6742, R²=0.8928, MAPE=8.77%
2025-06-04 14:23:03,790 - train_models - INFO -   Fold 4: MAE=0.9487, RMSE=1.4620, R²=0.9597, MAPE=6.38%
2025-06-04 14:23:03,791 - train_models - INFO -   Fold 5: MAE=1.1769, RMSE=1.8950, R²=0.9547, MAPE=6.11%
2025-06-04 14:23:03,791 - train_models - INFO - Building model for WorkType: 209
2025-06-04 14:23:07,269 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:24:02,089 - train_models - INFO - Model for 209 - MAE: 0.8790, RMSE: 1.3744, R²: 0.8911, MAPE: 12.23%
2025-06-04 14:24:02,089 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 14:24:02,090 - train_models - INFO -   NoOfMan_7day_trend: 0.4015
2025-06-04 14:24:02,090 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2195
2025-06-04 14:24:02,091 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0988
2025-06-04 14:24:02,091 - train_models - INFO -   NoOfMan_1day_trend: 0.0679
2025-06-04 14:24:02,092 - train_models - INFO -   NoOfMan_lag_7: 0.0500
2025-06-04 14:24:02,092 - train_models - INFO -   Quantity_rolling_mean_7: 0.0482
2025-06-04 14:24:02,093 - train_models - INFO -   NoOfMan_lag_1: 0.0260
2025-06-04 14:24:02,093 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0193
2025-06-04 14:24:02,093 - train_models - INFO -   Quantity_7day_trend: 0.0091
2025-06-04 14:24:02,094 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-06-04 14:24:02,094 - train_models - INFO - Cross-validation details for 209:
2025-06-04 14:24:02,095 - train_models - INFO -   Fold 1: MAE=0.9819, RMSE=1.4332, R²=0.8627, MAPE=13.38%
2025-06-04 14:24:02,095 - train_models - INFO -   Fold 2: MAE=1.0064, RMSE=1.7217, R²=0.8472, MAPE=14.69%
2025-06-04 14:24:02,096 - train_models - INFO -   Fold 3: MAE=0.6511, RMSE=0.8710, R²=0.9405, MAPE=10.40%
2025-06-04 14:24:02,096 - train_models - INFO -   Fold 4: MAE=0.8430, RMSE=1.3955, R²=0.9008, MAPE=11.13%
2025-06-04 14:24:02,097 - train_models - INFO -   Fold 5: MAE=0.9125, RMSE=1.4508, R²=0.9043, MAPE=11.54%
2025-06-04 14:24:02,097 - train_models - INFO - Building model for WorkType: 210
2025-06-04 14:24:05,683 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:25:01,511 - train_models - INFO - Model for 210 - MAE: 0.8111, RMSE: 1.1754, R²: 0.8906, MAPE: 17.41%
2025-06-04 14:25:01,512 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 14:25:01,512 - train_models - INFO -   NoOfMan_7day_trend: 0.2594
2025-06-04 14:25:01,513 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1927
2025-06-04 14:25:01,513 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1762
2025-06-04 14:25:01,514 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0659
2025-06-04 14:25:01,514 - train_models - INFO -   NoOfMan_1day_trend: 0.0643
2025-06-04 14:25:01,514 - train_models - INFO -   NoOfMan_lag_7: 0.0387
2025-06-04 14:25:01,515 - train_models - INFO -   Quantity_1day_trend: 0.0329
2025-06-04 14:25:01,515 - train_models - INFO -   NoOfMan_lag_1: 0.0328
2025-06-04 14:25:01,516 - train_models - INFO -   DayOfWeek_feat_6: 0.0258
2025-06-04 14:25:01,516 - train_models - INFO -   Quantity_7day_trend: 0.0197
2025-06-04 14:25:01,516 - train_models - INFO - Cross-validation details for 210:
2025-06-04 14:25:01,517 - train_models - INFO -   Fold 1: MAE=0.8253, RMSE=1.1353, R²=0.8844, MAPE=13.80%
2025-06-04 14:25:01,517 - train_models - INFO -   Fold 2: MAE=0.7127, RMSE=1.0310, R²=0.9026, MAPE=12.11%
2025-06-04 14:25:01,518 - train_models - INFO -   Fold 3: MAE=0.6199, RMSE=0.8603, R²=0.9290, MAPE=8.68%
2025-06-04 14:25:01,518 - train_models - INFO -   Fold 4: MAE=0.9102, RMSE=1.2604, R²=0.8783, MAPE=26.75%
2025-06-04 14:25:01,519 - train_models - INFO -   Fold 5: MAE=0.9873, RMSE=1.5900, R²=0.8585, MAPE=25.71%
2025-06-04 14:25:01,519 - train_models - INFO - Building model for WorkType: 211
2025-06-04 14:25:05,253 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:26:02,659 - train_models - INFO - Model for 211 - MAE: 0.6402, RMSE: 0.9841, R²: 0.9127, MAPE: 10.83%
2025-06-04 14:26:02,660 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 14:26:02,660 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3618
2025-06-04 14:26:02,661 - train_models - INFO -   NoOfMan_1day_trend: 0.1880
2025-06-04 14:26:02,661 - train_models - INFO -   NoOfMan_7day_trend: 0.1796
2025-06-04 14:26:02,661 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0693
2025-06-04 14:26:02,662 - train_models - INFO -   NoOfMan_lag_1: 0.0485
2025-06-04 14:26:02,662 - train_models - INFO -   NoOfMan_lag_7: 0.0349
2025-06-04 14:26:02,663 - train_models - INFO -   DayOfWeek_feat_6: 0.0330
2025-06-04 14:26:02,663 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0263
2025-06-04 14:26:02,664 - train_models - INFO -   Quantity_same_dow_lag: 0.0117
2025-06-04 14:26:02,664 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0059
2025-06-04 14:26:02,664 - train_models - INFO - Cross-validation details for 211:
2025-06-04 14:26:02,665 - train_models - INFO -   Fold 1: MAE=1.0750, RMSE=1.6368, R²=0.8136, MAPE=15.97%
2025-06-04 14:26:02,665 - train_models - INFO -   Fold 2: MAE=0.6174, RMSE=0.9751, R²=0.9112, MAPE=10.18%
2025-06-04 14:26:02,666 - train_models - INFO -   Fold 3: MAE=0.4534, RMSE=0.7012, R²=0.9573, MAPE=8.14%
2025-06-04 14:26:02,666 - train_models - INFO -   Fold 4: MAE=0.5606, RMSE=0.8924, R²=0.9334, MAPE=10.37%
2025-06-04 14:26:02,667 - train_models - INFO -   Fold 5: MAE=0.4945, RMSE=0.7153, R²=0.9478, MAPE=9.50%
2025-06-04 14:26:02,667 - train_models - INFO - Building model for WorkType: 213
2025-06-04 14:26:06,070 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:26:59,006 - train_models - INFO - Model for 213 - MAE: 0.3885, RMSE: 0.5805, R²: 0.8901, MAPE: 15.43%
2025-06-04 14:26:59,007 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 14:26:59,007 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4444
2025-06-04 14:26:59,007 - train_models - INFO -   NoOfMan_7day_trend: 0.2089
2025-06-04 14:26:59,008 - train_models - INFO -   NoOfMan_1day_trend: 0.1447
2025-06-04 14:26:59,008 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0520
2025-06-04 14:26:59,009 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 14:26:59,009 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0307
2025-06-04 14:26:59,010 - train_models - INFO -   NoOfMan_lag_7: 0.0271
2025-06-04 14:26:59,010 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0070
2025-06-04 14:26:59,010 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0054
2025-06-04 14:26:59,011 - train_models - INFO -   NoOfMan_lag_2: 0.0036
2025-06-04 14:26:59,011 - train_models - INFO - Cross-validation details for 213:
2025-06-04 14:26:59,012 - train_models - INFO -   Fold 1: MAE=0.5258, RMSE=0.7773, R²=0.8585, MAPE=15.03%
2025-06-04 14:26:59,012 - train_models - INFO -   Fold 2: MAE=0.4440, RMSE=0.6090, R²=0.8727, MAPE=23.59%
2025-06-04 14:26:59,013 - train_models - INFO -   Fold 3: MAE=0.3262, RMSE=0.5589, R²=0.8842, MAPE=14.75%
2025-06-04 14:26:59,013 - train_models - INFO -   Fold 4: MAE=0.3256, RMSE=0.4747, R²=0.9144, MAPE=12.99%
2025-06-04 14:26:59,014 - train_models - INFO -   Fold 5: MAE=0.3210, RMSE=0.4824, R²=0.9208, MAPE=10.79%
2025-06-04 14:26:59,014 - train_models - INFO - Building model for WorkType: 214
2025-06-04 14:27:02,520 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:27:54,446 - train_models - INFO - Model for 214 - MAE: 0.4591, RMSE: 0.6912, R²: 0.8908, MAPE: 10.26%
2025-06-04 14:27:54,447 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 14:27:54,447 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5065
2025-06-04 14:27:54,448 - train_models - INFO -   NoOfMan_7day_trend: 0.1858
2025-06-04 14:27:54,448 - train_models - INFO -   NoOfMan_1day_trend: 0.0847
2025-06-04 14:27:54,448 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0652
2025-06-04 14:27:54,449 - train_models - INFO -   NoOfMan_lag_7: 0.0537
2025-06-04 14:27:54,449 - train_models - INFO -   NoOfMan_lag_1: 0.0421
2025-06-04 14:27:54,450 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0119
2025-06-04 14:27:54,450 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0075
2025-06-04 14:27:54,450 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0065
2025-06-04 14:27:54,451 - train_models - INFO -   NoOfMan_lag_2: 0.0034
2025-06-04 14:27:54,451 - train_models - INFO - Cross-validation details for 214:
2025-06-04 14:27:54,452 - train_models - INFO -   Fold 1: MAE=0.4953, RMSE=0.6865, R²=0.8358, MAPE=13.48%
2025-06-04 14:27:54,452 - train_models - INFO -   Fold 2: MAE=0.4245, RMSE=0.5362, R²=0.9199, MAPE=10.03%
2025-06-04 14:27:54,452 - train_models - INFO -   Fold 3: MAE=0.3166, RMSE=0.4362, R²=0.9482, MAPE=8.98%
2025-06-04 14:27:54,453 - train_models - INFO -   Fold 4: MAE=0.3054, RMSE=0.5383, R²=0.9326, MAPE=5.51%
2025-06-04 14:27:54,453 - train_models - INFO -   Fold 5: MAE=0.7537, RMSE=1.2588, R²=0.8176, MAPE=13.32%
2025-06-04 14:27:54,454 - train_models - INFO - Building model for WorkType: 215
2025-06-04 14:27:58,281 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:28:59,296 - train_models - INFO - Model for 215 - MAE: 0.6755, RMSE: 1.0518, R²: 0.8981, MAPE: 15.53%
2025-06-04 14:28:59,297 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 14:28:59,298 - train_models - INFO -   NoOfMan_7day_trend: 0.1736
2025-06-04 14:28:59,298 - train_models - INFO -   DayOfWeek_feat_6: 0.1681
2025-06-04 14:28:59,299 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1673
2025-06-04 14:28:59,299 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1435
2025-06-04 14:28:59,300 - train_models - INFO -   NoOfMan_1day_trend: 0.1257
2025-06-04 14:28:59,300 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0665
2025-06-04 14:28:59,300 - train_models - INFO -   NoOfMan_lag_1: 0.0347
2025-06-04 14:28:59,301 - train_models - INFO -   NoOfMan_lag_7: 0.0291
2025-06-04 14:28:59,301 - train_models - INFO -   Quantity_7day_trend: 0.0128
2025-06-04 14:28:59,302 - train_models - INFO -   Quantity_rolling_mean_7: 0.0101
2025-06-04 14:28:59,302 - train_models - INFO - Cross-validation details for 215:
2025-06-04 14:28:59,303 - train_models - INFO -   Fold 1: MAE=0.9710, RMSE=1.5149, R²=0.8092, MAPE=25.92%
2025-06-04 14:28:59,303 - train_models - INFO -   Fold 2: MAE=0.6903, RMSE=0.9951, R²=0.9148, MAPE=16.46%
2025-06-04 14:28:59,304 - train_models - INFO -   Fold 3: MAE=0.6672, RMSE=1.0316, R²=0.9055, MAPE=11.70%
2025-06-04 14:28:59,304 - train_models - INFO -   Fold 4: MAE=0.5227, RMSE=0.7961, R²=0.9344, MAPE=12.98%
2025-06-04 14:28:59,304 - train_models - INFO -   Fold 5: MAE=0.5265, RMSE=0.9213, R²=0.9268, MAPE=10.58%
2025-06-04 14:28:59,305 - train_models - INFO - Building model for WorkType: 217
2025-06-04 14:29:02,675 - train_models - INFO - Using 26 numeric features and 4 categorical features
2025-06-04 14:29:48,347 - train_models - INFO - Model for 217 - MAE: 0.4119, RMSE: 0.5522, R²: 0.9102, MAPE: 17.42%
2025-06-04 14:29:48,348 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 14:29:48,348 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5730
2025-06-04 14:29:48,349 - train_models - INFO -   NoOfMan_7day_trend: 0.1209
2025-06-04 14:29:48,349 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0839
2025-06-04 14:29:48,350 - train_models - INFO -   NoOfMan_1day_trend: 0.0660
2025-06-04 14:29:48,350 - train_models - INFO -   NoOfMan_lag_1: 0.0660
2025-06-04 14:29:48,351 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0379
2025-06-04 14:29:48,351 - train_models - INFO -   NoOfMan_lag_7: 0.0244
2025-06-04 14:29:48,351 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0048
2025-06-04 14:29:48,352 - train_models - INFO -   NoOfMan_lag_2: 0.0017
2025-06-04 14:29:48,352 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0017
2025-06-04 14:29:48,353 - train_models - INFO - Cross-validation details for 217:
2025-06-04 14:29:48,353 - train_models - INFO -   Fold 1: MAE=0.5945, RMSE=0.7118, R²=0.8237, MAPE=26.22%
2025-06-04 14:29:48,354 - train_models - INFO -   Fold 2: MAE=0.4202, RMSE=0.5484, R²=0.9085, MAPE=20.98%
2025-06-04 14:29:48,354 - train_models - INFO -   Fold 3: MAE=0.3635, RMSE=0.4859, R²=0.9439, MAPE=13.21%
2025-06-04 14:29:48,355 - train_models - INFO -   Fold 4: MAE=0.3146, RMSE=0.4084, R²=0.9643, MAPE=13.11%
2025-06-04 14:29:48,355 - train_models - INFO -   Fold 5: MAE=0.3667, RMSE=0.6065, R²=0.9107, MAPE=13.58%
2025-06-04 14:29:48,356 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 14:29:49,153 - train_models - INFO - Model files saved successfully
2025-06-04 14:29:49,154 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 14:29:49,160 - train_models - INFO - Model training completed successfully
2025-06-04 14:59:56,083 - train_models - INFO - Starting the model training process
2025-06-04 14:59:56,083 - train_models - INFO - Feature tiers enabled: ['BASIC']
2025-06-04 14:59:56,084 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 14:59:56,093 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 14:59:56,239 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 14:59:57,029 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 14:59:57,099 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 14:59:57,118 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 14:59:57,119 - train_models - INFO - Converting Date column to datetime format
2025-06-04 14:59:57,142 - train_models - INFO - Engineering features...
2025-06-04 14:59:58,252 - utils.feature_engineering - INFO - Engineering features
2025-06-04 14:59:58,308 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 14:59:58,316 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 14:59:58,317 - train_models - INFO - Using lag days: [1, 7]
2025-06-04 14:59:58,317 - train_models - INFO - Using rolling windows: [7]
2025-06-04 14:59:58,337 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 14:59:58,529 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 14:59:58,529 - utils.feature_engineering - INFO - Final shape: (15326, 48)
2025-06-04 14:59:58,548 - train_models - INFO - Found 10 unique work types
2025-06-04 14:59:58,549 - train_models - INFO - Building models for 10 work types
2025-06-04 14:59:58,549 - train_models - INFO - Using feature tiers: ['BASIC']
2025-06-04 14:59:58,549 - utils.feature_builder - INFO - Built feature set: 4 numeric, 2 categorical
2025-06-04 14:59:58,550 - train_models - INFO - Tiered feature system generated 4 numeric features and 2 categorical features
2025-06-04 14:59:58,550 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7']
2025-06-04 14:59:58,551 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-04 14:59:58,551 - train_models - INFO - Building model for WorkType: 202
2025-06-04 14:59:58,561 - train_models - INFO - Available features for 202: 4 numeric, 2 categorical
2025-06-04 15:00:17,700 - train_models - ERROR - Error building models: dictionary update sequence element #0 has length 3; 2 is required
2025-06-04 15:00:17,702 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 248, in build_models
    if 'cat' in dict(preprocessor_fitted.transformers_):
                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: dictionary update sequence element #0 has length 3; 2 is required

2025-06-04 15:00:17,706 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-04 15:00:18,339 - train_models - INFO - Model files saved successfully
2025-06-04 15:00:18,339 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 15:00:18,340 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 15:00:18,344 - train_models - INFO - Model training completed successfully
2025-06-04 15:05:39,318 - train_models - INFO - Starting the model training process
2025-06-04 15:05:39,319 - train_models - INFO - Feature tiers enabled: ['BASIC']
2025-06-04 15:05:39,319 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 15:05:39,326 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 15:05:39,464 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 15:05:40,263 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 15:05:40,334 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 15:05:40,353 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 15:05:40,354 - train_models - INFO - Converting Date column to datetime format
2025-06-04 15:05:40,376 - train_models - INFO - Engineering features...
2025-06-04 15:05:41,297 - utils.feature_engineering - INFO - Engineering features
2025-06-04 15:05:41,352 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 15:05:41,360 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 15:05:41,360 - train_models - INFO - Using lag days: [1, 7]
2025-06-04 15:05:41,361 - train_models - INFO - Using rolling windows: [7]
2025-06-04 15:05:41,380 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 15:05:41,572 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 15:05:41,573 - utils.feature_engineering - INFO - Final shape: (15326, 48)
2025-06-04 15:05:41,592 - train_models - INFO - Found 10 unique work types
2025-06-04 15:05:41,592 - train_models - INFO - Building models for 10 work types
2025-06-04 15:05:41,593 - train_models - INFO - Using feature tiers: ['BASIC']
2025-06-04 15:05:41,593 - utils.feature_builder - INFO - Built feature set: 4 numeric, 2 categorical
2025-06-04 15:05:41,594 - train_models - INFO - Tiered feature system generated 4 numeric features and 2 categorical features
2025-06-04 15:05:41,594 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7']
2025-06-04 15:05:41,595 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-04 15:05:41,595 - train_models - INFO - Building model for WorkType: 202
2025-06-04 15:05:41,602 - train_models - INFO - Available features for 202: 4 numeric, 2 categorical
2025-06-04 15:06:00,546 - train_models - INFO - Model for 202 - MAE: 0.4636, RMSE: 0.6000, R²: 0.3023, MAPE: 24.89%
2025-06-04 15:06:00,547 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 15:06:00,547 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6413
2025-06-04 15:06:00,548 - train_models - INFO -   NoOfMan_lag_1: 0.1307
2025-06-04 15:06:00,548 - train_models - INFO -   NoOfMan_lag_7: 0.0881
2025-06-04 15:06:00,549 - train_models - INFO -   DayOfWeek_feat_4: 0.0183
2025-06-04 15:06:00,549 - train_models - INFO -   DayOfWeek_feat_0: 0.0112
2025-06-04 15:06:00,550 - train_models - INFO -   DayOfWeek_feat_1: 0.0106
2025-06-04 15:06:00,550 - train_models - INFO -   DayOfWeek_feat_3: 0.0099
2025-06-04 15:06:00,550 - train_models - INFO -   Month_feat_12: 0.0088
2025-06-04 15:06:00,551 - train_models - INFO -   DayOfWeek_feat_2: 0.0086
2025-06-04 15:06:00,551 - train_models - INFO -   Month_feat_3: 0.0074
2025-06-04 15:06:00,552 - train_models - INFO - Cross-validation details for 202:
2025-06-04 15:06:00,552 - train_models - INFO -   Fold 1: MAE=0.3214, RMSE=0.4563, R²=0.2701, MAPE=19.98%
2025-06-04 15:06:00,553 - train_models - INFO -   Fold 2: MAE=0.3870, RMSE=0.4984, R²=0.4279, MAPE=24.07%
2025-06-04 15:06:00,553 - train_models - INFO -   Fold 3: MAE=0.5005, RMSE=0.6643, R²=0.3132, MAPE=29.77%
2025-06-04 15:06:00,553 - train_models - INFO -   Fold 4: MAE=0.5381, RMSE=0.6648, R²=0.1007, MAPE=26.59%
2025-06-04 15:06:00,554 - train_models - INFO -   Fold 5: MAE=0.5709, RMSE=0.7162, R²=0.3993, MAPE=24.03%
2025-06-04 15:06:00,554 - train_models - INFO - Building model for WorkType: 203
2025-06-04 15:06:00,563 - train_models - INFO - Available features for 203: 4 numeric, 2 categorical
2025-06-04 15:06:21,954 - train_models - INFO - Model for 203 - MAE: 0.6628, RMSE: 0.8742, R²: 0.3802, MAPE: 13.80%
2025-06-04 15:06:21,954 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 15:06:21,955 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5319
2025-06-04 15:06:21,955 - train_models - INFO -   NoOfMan_lag_1: 0.2070
2025-06-04 15:06:21,956 - train_models - INFO -   NoOfMan_lag_7: 0.1050
2025-06-04 15:06:21,956 - train_models - INFO -   DayOfWeek_feat_4: 0.0192
2025-06-04 15:06:21,957 - train_models - INFO -   DayOfWeek_feat_0: 0.0173
2025-06-04 15:06:21,957 - train_models - INFO -   DayOfWeek_feat_1: 0.0130
2025-06-04 15:06:21,957 - train_models - INFO -   Month_feat_4: 0.0102
2025-06-04 15:06:21,958 - train_models - INFO -   Month_feat_6: 0.0099
2025-06-04 15:06:21,958 - train_models - INFO -   Month_feat_2: 0.0090
2025-06-04 15:06:21,959 - train_models - INFO -   Month_feat_8: 0.0088
2025-06-04 15:06:21,959 - train_models - INFO - Cross-validation details for 203:
2025-06-04 15:06:21,960 - train_models - INFO -   Fold 1: MAE=0.6241, RMSE=0.8282, R²=0.4596, MAPE=12.14%
2025-06-04 15:06:21,960 - train_models - INFO -   Fold 2: MAE=0.6689, RMSE=0.9041, R²=0.4045, MAPE=13.32%
2025-06-04 15:06:21,961 - train_models - INFO -   Fold 3: MAE=0.7156, RMSE=0.9468, R²=0.3244, MAPE=13.94%
2025-06-04 15:06:21,961 - train_models - INFO -   Fold 4: MAE=0.6758, RMSE=0.8719, R²=0.3828, MAPE=14.88%
2025-06-04 15:06:21,961 - train_models - INFO -   Fold 5: MAE=0.6297, RMSE=0.8197, R²=0.3296, MAPE=14.72%
2025-06-04 15:06:21,962 - train_models - INFO - Building model for WorkType: 206
2025-06-04 15:06:21,971 - train_models - INFO - Available features for 206: 4 numeric, 2 categorical
2025-06-04 15:06:47,725 - train_models - INFO - Model for 206 - MAE: 2.2097, RMSE: 3.1994, R²: 0.8486, MAPE: 13.05%
2025-06-04 15:06:47,726 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 15:06:47,726 - train_models - INFO -   DayOfWeek_feat_6: 0.3999
2025-06-04 15:06:47,727 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3470
2025-06-04 15:06:47,727 - train_models - INFO -   DayOfWeek_feat_4: 0.1147
2025-06-04 15:06:47,728 - train_models - INFO -   NoOfMan_lag_1: 0.0444
2025-06-04 15:06:47,728 - train_models - INFO -   NoOfMan_lag_7: 0.0271
2025-06-04 15:06:47,729 - train_models - INFO -   DayOfWeek_feat_5: 0.0188
2025-06-04 15:06:47,729 - train_models - INFO -   IsWeekend_feat: 0.0152
2025-06-04 15:06:47,729 - train_models - INFO -   DayOfWeek_feat_3: 0.0047
2025-06-04 15:06:47,730 - train_models - INFO -   Month_feat_12: 0.0041
2025-06-04 15:06:47,730 - train_models - INFO -   Month_feat_11: 0.0036
2025-06-04 15:06:47,730 - train_models - INFO - Cross-validation details for 206:
2025-06-04 15:06:47,731 - train_models - INFO -   Fold 1: MAE=2.3042, RMSE=3.2196, R²=0.8590, MAPE=13.29%
2025-06-04 15:06:47,731 - train_models - INFO -   Fold 2: MAE=2.3240, RMSE=3.2137, R²=0.8536, MAPE=12.74%
2025-06-04 15:06:47,732 - train_models - INFO -   Fold 3: MAE=2.3703, RMSE=3.7565, R²=0.7884, MAPE=15.33%
2025-06-04 15:06:47,732 - train_models - INFO -   Fold 4: MAE=1.8560, RMSE=2.6328, R²=0.8692, MAPE=11.33%
2025-06-04 15:06:47,733 - train_models - INFO -   Fold 5: MAE=2.1938, RMSE=3.1746, R²=0.8730, MAPE=12.58%
2025-06-04 15:06:47,733 - train_models - INFO - Building model for WorkType: 209
2025-06-04 15:06:47,741 - train_models - INFO - Available features for 209: 4 numeric, 2 categorical
2025-06-04 15:07:08,717 - train_models - INFO - Model for 209 - MAE: 2.0365, RMSE: 2.8354, R²: 0.5421, MAPE: 27.22%
2025-06-04 15:07:08,718 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 15:07:08,718 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6505
2025-06-04 15:07:08,718 - train_models - INFO -   NoOfMan_lag_1: 0.0866
2025-06-04 15:07:08,719 - train_models - INFO -   NoOfMan_lag_7: 0.0865
2025-06-04 15:07:08,719 - train_models - INFO -   DayOfWeek_feat_1: 0.0529
2025-06-04 15:07:08,720 - train_models - INFO -   DayOfWeek_feat_0: 0.0251
2025-06-04 15:07:08,720 - train_models - INFO -   DayOfWeek_feat_3: 0.0178
2025-06-04 15:07:08,721 - train_models - INFO -   DayOfWeek_feat_6: 0.0129
2025-06-04 15:07:08,721 - train_models - INFO -   Month_feat_1: 0.0118
2025-06-04 15:07:08,722 - train_models - INFO -   DayOfWeek_feat_2: 0.0104
2025-06-04 15:07:08,722 - train_models - INFO -   DayOfWeek_feat_4: 0.0071
2025-06-04 15:07:08,722 - train_models - INFO - Cross-validation details for 209:
2025-06-04 15:07:08,723 - train_models - INFO -   Fold 1: MAE=1.8902, RMSE=2.7642, R²=0.4893, MAPE=25.39%
2025-06-04 15:07:08,723 - train_models - INFO -   Fold 2: MAE=2.2411, RMSE=3.1744, R²=0.4804, MAPE=31.30%
2025-06-04 15:07:08,724 - train_models - INFO -   Fold 3: MAE=1.7049, RMSE=2.2326, R²=0.6090, MAPE=24.95%
2025-06-04 15:07:08,724 - train_models - INFO -   Fold 4: MAE=2.1347, RMSE=2.9566, R²=0.5546, MAPE=27.79%
2025-06-04 15:07:08,725 - train_models - INFO -   Fold 5: MAE=2.2117, RMSE=3.0490, R²=0.5771, MAPE=26.68%
2025-06-04 15:07:08,725 - train_models - INFO - Building model for WorkType: 210
2025-06-04 15:07:08,734 - train_models - INFO - Available features for 210: 4 numeric, 2 categorical
2025-06-04 15:07:29,659 - train_models - INFO - Model for 210 - MAE: 1.5521, RMSE: 2.1368, R²: 0.6382, MAPE: 30.99%
2025-06-04 15:07:29,659 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 15:07:29,660 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5826
2025-06-04 15:07:29,660 - train_models - INFO -   NoOfMan_lag_1: 0.0821
2025-06-04 15:07:29,661 - train_models - INFO -   NoOfMan_lag_7: 0.0816
2025-06-04 15:07:29,661 - train_models - INFO -   DayOfWeek_feat_1: 0.0683
2025-06-04 15:07:29,661 - train_models - INFO -   DayOfWeek_feat_6: 0.0663
2025-06-04 15:07:29,662 - train_models - INFO -   DayOfWeek_feat_0: 0.0548
2025-06-04 15:07:29,662 - train_models - INFO -   DayOfWeek_feat_2: 0.0145
2025-06-04 15:07:29,663 - train_models - INFO -   DayOfWeek_feat_3: 0.0079
2025-06-04 15:07:29,663 - train_models - INFO -   Month_feat_1: 0.0070
2025-06-04 15:07:29,664 - train_models - INFO -   Month_feat_11: 0.0068
2025-06-04 15:07:29,664 - train_models - INFO - Cross-validation details for 210:
2025-06-04 15:07:29,665 - train_models - INFO -   Fold 1: MAE=1.2601, RMSE=1.7195, R²=0.7349, MAPE=21.29%
2025-06-04 15:07:29,665 - train_models - INFO -   Fold 2: MAE=1.4175, RMSE=1.9515, R²=0.6510, MAPE=22.49%
2025-06-04 15:07:29,665 - train_models - INFO -   Fold 3: MAE=1.3999, RMSE=1.8711, R²=0.6641, MAPE=19.31%
2025-06-04 15:07:29,666 - train_models - INFO -   Fold 4: MAE=1.7312, RMSE=2.3513, R²=0.5766, MAPE=47.01%
2025-06-04 15:07:29,666 - train_models - INFO -   Fold 5: MAE=1.9520, RMSE=2.7905, R²=0.5642, MAPE=44.86%
2025-06-04 15:07:29,667 - train_models - INFO - Building model for WorkType: 211
2025-06-04 15:07:29,675 - train_models - INFO - Available features for 211: 4 numeric, 2 categorical
2025-06-04 15:07:51,870 - train_models - INFO - Model for 211 - MAE: 1.5727, RMSE: 2.1672, R²: 0.5902, MAPE: 24.58%
2025-06-04 15:07:51,871 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 15:07:51,871 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5252
2025-06-04 15:07:51,872 - train_models - INFO -   DayOfWeek_feat_6: 0.1887
2025-06-04 15:07:51,872 - train_models - INFO -   NoOfMan_lag_1: 0.0950
2025-06-04 15:07:51,873 - train_models - INFO -   NoOfMan_lag_7: 0.0783
2025-06-04 15:07:51,873 - train_models - INFO -   DayOfWeek_feat_4: 0.0115
2025-06-04 15:07:51,873 - train_models - INFO -   DayOfWeek_feat_0: 0.0110
2025-06-04 15:07:51,874 - train_models - INFO -   Month_feat_12: 0.0092
2025-06-04 15:07:51,874 - train_models - INFO -   Month_feat_7: 0.0089
2025-06-04 15:07:51,875 - train_models - INFO -   DayOfWeek_feat_1: 0.0080
2025-06-04 15:07:51,875 - train_models - INFO -   DayOfWeek_feat_5: 0.0078
2025-06-04 15:07:51,876 - train_models - INFO - Cross-validation details for 211:
2025-06-04 15:07:51,876 - train_models - INFO -   Fold 1: MAE=2.1784, RMSE=3.1975, R²=0.2888, MAPE=39.28%
2025-06-04 15:07:51,876 - train_models - INFO -   Fold 2: MAE=1.5731, RMSE=2.1186, R²=0.5809, MAPE=20.94%
2025-06-04 15:07:51,877 - train_models - INFO -   Fold 3: MAE=1.3429, RMSE=1.7905, R²=0.7217, MAPE=15.96%
2025-06-04 15:07:51,877 - train_models - INFO -   Fold 4: MAE=1.4162, RMSE=1.9691, R²=0.6757, MAPE=22.72%
2025-06-04 15:07:51,878 - train_models - INFO -   Fold 5: MAE=1.3528, RMSE=1.7602, R²=0.6837, MAPE=24.01%
2025-06-04 15:07:51,878 - train_models - INFO - Building model for WorkType: 213
2025-06-04 15:07:51,887 - train_models - INFO - Available features for 213: 4 numeric, 2 categorical
2025-06-04 15:08:12,781 - train_models - INFO - Model for 213 - MAE: 0.8333, RMSE: 1.1348, R²: 0.5759, MAPE: 34.96%
2025-06-04 15:08:12,782 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 15:08:12,782 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6595
2025-06-04 15:08:12,782 - train_models - INFO -   NoOfMan_lag_1: 0.0923
2025-06-04 15:08:12,783 - train_models - INFO -   NoOfMan_lag_7: 0.0886
2025-06-04 15:08:12,783 - train_models - INFO -   DayOfWeek_feat_4: 0.0285
2025-06-04 15:08:12,784 - train_models - INFO -   DayOfWeek_feat_1: 0.0278
2025-06-04 15:08:12,784 - train_models - INFO -   Month_feat_7: 0.0181
2025-06-04 15:08:12,785 - train_models - INFO -   Month_feat_8: 0.0136
2025-06-04 15:08:12,785 - train_models - INFO -   DayOfWeek_feat_3: 0.0121
2025-06-04 15:08:12,785 - train_models - INFO -   Month_feat_6: 0.0109
2025-06-04 15:08:12,786 - train_models - INFO -   DayOfWeek_feat_0: 0.0083
2025-06-04 15:08:12,786 - train_models - INFO - Cross-validation details for 213:
2025-06-04 15:08:12,787 - train_models - INFO -   Fold 1: MAE=0.8864, RMSE=1.2365, R²=0.6421, MAPE=26.21%
2025-06-04 15:08:12,787 - train_models - INFO -   Fold 2: MAE=0.7994, RMSE=1.1428, R²=0.5518, MAPE=41.01%
2025-06-04 15:08:12,788 - train_models - INFO -   Fold 3: MAE=0.7453, RMSE=1.0691, R²=0.5764, MAPE=36.85%
2025-06-04 15:08:12,789 - train_models - INFO -   Fold 4: MAE=0.8601, RMSE=1.1017, R²=0.5390, MAPE=36.93%
2025-06-04 15:08:12,789 - train_models - INFO -   Fold 5: MAE=0.8753, RMSE=1.1240, R²=0.5703, MAPE=33.80%
2025-06-04 15:08:12,789 - train_models - INFO - Building model for WorkType: 214
2025-06-04 15:08:12,798 - train_models - INFO - Available features for 214: 4 numeric, 2 categorical
2025-06-04 15:08:34,301 - train_models - INFO - Model for 214 - MAE: 1.0462, RMSE: 1.3824, R²: 0.5625, MAPE: 25.29%
2025-06-04 15:08:34,302 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 15:08:34,302 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6932
2025-06-04 15:08:34,303 - train_models - INFO -   NoOfMan_lag_1: 0.0792
2025-06-04 15:08:34,303 - train_models - INFO -   NoOfMan_lag_7: 0.0703
2025-06-04 15:08:34,304 - train_models - INFO -   DayOfWeek_feat_6: 0.0357
2025-06-04 15:08:34,304 - train_models - INFO -   DayOfWeek_feat_4: 0.0261
2025-06-04 15:08:34,304 - train_models - INFO -   DayOfWeek_feat_1: 0.0239
2025-06-04 15:08:34,305 - train_models - INFO -   Month_feat_6: 0.0074
2025-06-04 15:08:34,305 - train_models - INFO -   Month_feat_7: 0.0072
2025-06-04 15:08:34,306 - train_models - INFO -   DayOfWeek_feat_3: 0.0066
2025-06-04 15:08:34,306 - train_models - INFO -   Month_feat_12: 0.0055
2025-06-04 15:08:34,307 - train_models - INFO - Cross-validation details for 214:
2025-06-04 15:08:34,307 - train_models - INFO -   Fold 1: MAE=0.9612, RMSE=1.2544, R²=0.4519, MAPE=26.95%
2025-06-04 15:08:34,307 - train_models - INFO -   Fold 2: MAE=1.0288, RMSE=1.3028, R²=0.5272, MAPE=26.00%
2025-06-04 15:08:34,308 - train_models - INFO -   Fold 3: MAE=0.8217, RMSE=1.1024, R²=0.6690, MAPE=22.88%
2025-06-04 15:08:34,308 - train_models - INFO -   Fold 4: MAE=0.9799, RMSE=1.3223, R²=0.5933, MAPE=21.25%
2025-06-04 15:08:34,309 - train_models - INFO -   Fold 5: MAE=1.4394, RMSE=1.9303, R²=0.5710, MAPE=29.36%
2025-06-04 15:08:34,309 - train_models - INFO - Building model for WorkType: 215
2025-06-04 15:08:34,317 - train_models - INFO - Available features for 215: 4 numeric, 2 categorical
2025-06-04 15:08:57,368 - train_models - INFO - Model for 215 - MAE: 1.3741, RMSE: 2.0020, R²: 0.6405, MAPE: 30.42%
2025-06-04 15:08:57,368 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 15:08:57,369 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4277
2025-06-04 15:08:57,369 - train_models - INFO -   DayOfWeek_feat_6: 0.2587
2025-06-04 15:08:57,370 - train_models - INFO -   NoOfMan_lag_1: 0.0906
2025-06-04 15:08:57,370 - train_models - INFO -   DayOfWeek_feat_0: 0.0735
2025-06-04 15:08:57,370 - train_models - INFO -   NoOfMan_lag_7: 0.0673
2025-06-04 15:08:57,371 - train_models - INFO -   Month_feat_11: 0.0126
2025-06-04 15:08:57,371 - train_models - INFO -   Month_feat_2: 0.0100
2025-06-04 15:08:57,372 - train_models - INFO -   Month_feat_12: 0.0085
2025-06-04 15:08:57,372 - train_models - INFO -   DayOfWeek_feat_4: 0.0075
2025-06-04 15:08:57,373 - train_models - INFO -   DayOfWeek_feat_1: 0.0073
2025-06-04 15:08:57,373 - train_models - INFO - Cross-validation details for 215:
2025-06-04 15:08:57,373 - train_models - INFO -   Fold 1: MAE=1.4946, RMSE=2.3392, R²=0.5451, MAPE=42.57%
2025-06-04 15:08:57,374 - train_models - INFO -   Fold 2: MAE=1.2318, RMSE=1.7477, R²=0.7372, MAPE=25.98%
2025-06-04 15:08:57,374 - train_models - INFO -   Fold 3: MAE=1.4018, RMSE=1.9632, R²=0.6577, MAPE=26.20%
2025-06-04 15:08:57,375 - train_models - INFO -   Fold 4: MAE=1.2900, RMSE=1.8076, R²=0.6617, MAPE=29.28%
2025-06-04 15:08:57,375 - train_models - INFO -   Fold 5: MAE=1.4522, RMSE=2.1523, R²=0.6006, MAPE=28.08%
2025-06-04 15:08:57,376 - train_models - INFO - Building model for WorkType: 217
2025-06-04 15:08:57,386 - train_models - INFO - Available features for 217: 4 numeric, 2 categorical
2025-06-04 15:09:17,026 - train_models - INFO - Model for 217 - MAE: 0.9036, RMSE: 1.2174, R²: 0.6054, MAPE: 36.45%
2025-06-04 15:09:17,027 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 15:09:17,027 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.7412
2025-06-04 15:09:17,028 - train_models - INFO -   NoOfMan_lag_1: 0.1223
2025-06-04 15:09:17,028 - train_models - INFO -   NoOfMan_lag_7: 0.0616
2025-06-04 15:09:17,029 - train_models - INFO -   DayOfWeek_feat_0: 0.0079
2025-06-04 15:09:17,029 - train_models - INFO -   Month_feat_1: 0.0075
2025-06-04 15:09:17,030 - train_models - INFO -   DayOfWeek_feat_4: 0.0071
2025-06-04 15:09:17,030 - train_models - INFO -   DayOfWeek_feat_2: 0.0054
2025-06-04 15:09:17,031 - train_models - INFO -   DayOfWeek_feat_1: 0.0050
2025-06-04 15:09:17,031 - train_models - INFO -   Month_feat_12: 0.0050
2025-06-04 15:09:17,031 - train_models - INFO -   Month_feat_2: 0.0047
2025-06-04 15:09:17,032 - train_models - INFO - Cross-validation details for 217:
2025-06-04 15:09:17,032 - train_models - INFO -   Fold 1: MAE=0.8488, RMSE=1.1334, R²=0.5529, MAPE=34.66%
2025-06-04 15:09:17,033 - train_models - INFO -   Fold 2: MAE=0.8096, RMSE=1.1049, R²=0.6285, MAPE=36.55%
2025-06-04 15:09:17,033 - train_models - INFO -   Fold 3: MAE=0.8717, RMSE=1.1556, R²=0.6829, MAPE=32.19%
2025-06-04 15:09:17,033 - train_models - INFO -   Fold 4: MAE=0.9704, RMSE=1.2668, R²=0.6563, MAPE=36.55%
2025-06-04 15:09:17,034 - train_models - INFO -   Fold 5: MAE=1.0173, RMSE=1.4263, R²=0.5063, MAPE=42.32%
2025-06-04 15:09:17,035 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 15:09:18,459 - train_models - INFO - Model files saved successfully
2025-06-04 15:09:18,459 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 15:09:18,460 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 15:09:18,464 - train_models - INFO - Model training completed successfully
2025-06-04 15:17:19,873 - train_models - INFO - Starting the model training process
2025-06-04 15:17:19,874 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-04 15:17:19,874 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 15:17:19,881 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 15:17:20,014 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 15:17:20,805 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 15:17:20,876 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 15:17:20,895 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 15:17:20,895 - train_models - INFO - Converting Date column to datetime format
2025-06-04 15:17:20,920 - train_models - INFO - Engineering features...
2025-06-04 15:17:22,028 - utils.feature_engineering - INFO - Engineering features
2025-06-04 15:17:22,083 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 15:17:22,091 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 15:17:22,091 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-04 15:17:22,092 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-04 15:17:22,111 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 15:17:22,430 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 15:17:22,431 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-04 15:17:22,452 - train_models - INFO - Found 10 unique work types
2025-06-04 15:17:22,452 - train_models - INFO - Building models for 10 work types
2025-06-04 15:17:22,453 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-04 15:17:22,454 - utils.feature_builder - INFO - Built feature set: 20 numeric, 3 categorical
2025-06-04 15:17:22,454 - train_models - INFO - Tiered feature system generated 20 numeric features and 3 categorical features
2025-06-04 15:17:22,454 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-04 15:17:22,455 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 15:17:22,455 - train_models - INFO - Building model for WorkType: 202
2025-06-04 15:17:22,464 - train_models - INFO - Available features for 202: 20 numeric, 3 categorical
2025-06-04 15:17:52,589 - train_models - INFO - Model for 202 - MAE: 0.1994, RMSE: 0.3121, R²: 0.7815, MAPE: 9.60%
2025-06-04 15:17:52,590 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 15:17:52,590 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3950
2025-06-04 15:17:52,590 - train_models - INFO -   NoOfMan_7day_trend: 0.2006
2025-06-04 15:17:52,591 - train_models - INFO -   NoOfMan_1day_trend: 0.1286
2025-06-04 15:17:52,591 - train_models - INFO -   NoOfMan_lag_1: 0.0694
2025-06-04 15:17:52,592 - train_models - INFO -   NoOfMan_lag_7: 0.0669
2025-06-04 15:17:52,592 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0660
2025-06-04 15:17:52,593 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0387
2025-06-04 15:17:52,593 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-04 15:17:52,594 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-04 15:17:52,594 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0029
2025-06-04 15:17:52,595 - train_models - INFO - Cross-validation details for 202:
2025-06-04 15:17:52,595 - train_models - INFO -   Fold 1: MAE=0.1935, RMSE=0.3645, R²=0.5342, MAPE=9.99%
2025-06-04 15:17:52,595 - train_models - INFO -   Fold 2: MAE=0.1949, RMSE=0.3088, R²=0.7804, MAPE=10.82%
2025-06-04 15:17:52,596 - train_models - INFO -   Fold 3: MAE=0.2210, RMSE=0.3474, R²=0.8122, MAPE=11.31%
2025-06-04 15:17:52,596 - train_models - INFO -   Fold 4: MAE=0.1749, RMSE=0.2254, R²=0.8966, MAPE=8.06%
2025-06-04 15:17:52,597 - train_models - INFO -   Fold 5: MAE=0.2125, RMSE=0.3145, R²=0.8842, MAPE=7.80%
2025-06-04 15:17:52,597 - train_models - INFO - Building model for WorkType: 203
2025-06-04 15:17:52,607 - train_models - INFO - Available features for 203: 20 numeric, 3 categorical
2025-06-04 15:18:27,446 - train_models - INFO - Model for 203 - MAE: 0.2196, RMSE: 0.3163, R²: 0.9181, MAPE: 4.56%
2025-06-04 15:18:27,446 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 15:18:27,447 - train_models - INFO -   NoOfMan_7day_trend: 0.3026
2025-06-04 15:18:27,447 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2339
2025-06-04 15:18:27,448 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1189
2025-06-04 15:18:27,448 - train_models - INFO -   NoOfMan_1day_trend: 0.0951
2025-06-04 15:18:27,449 - train_models - INFO -   NoOfMan_lag_7: 0.0815
2025-06-04 15:18:27,449 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0718
2025-06-04 15:18:27,450 - train_models - INFO -   NoOfMan_lag_1: 0.0571
2025-06-04 15:18:27,450 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0066
2025-06-04 15:18:27,451 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 15:18:27,451 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0032
2025-06-04 15:18:27,451 - train_models - INFO - Cross-validation details for 203:
2025-06-04 15:18:27,452 - train_models - INFO -   Fold 1: MAE=0.2765, RMSE=0.3792, R²=0.8867, MAPE=5.49%
2025-06-04 15:18:27,452 - train_models - INFO -   Fold 2: MAE=0.2417, RMSE=0.3329, R²=0.9193, MAPE=4.75%
2025-06-04 15:18:27,453 - train_models - INFO -   Fold 3: MAE=0.2303, RMSE=0.3724, R²=0.8955, MAPE=4.25%
2025-06-04 15:18:27,453 - train_models - INFO -   Fold 4: MAE=0.1754, RMSE=0.2616, R²=0.9445, MAPE=4.09%
2025-06-04 15:18:27,454 - train_models - INFO -   Fold 5: MAE=0.1741, RMSE=0.2352, R²=0.9448, MAPE=4.21%
2025-06-04 15:18:27,454 - train_models - INFO - Building model for WorkType: 206
2025-06-04 15:18:27,464 - train_models - INFO - Available features for 206: 20 numeric, 3 categorical
2025-06-04 15:19:13,156 - train_models - INFO - Model for 206 - MAE: 1.3311, RMSE: 2.0363, R²: 0.9376, MAPE: 7.60%
2025-06-04 15:19:13,157 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 15:19:13,158 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5223
2025-06-04 15:19:13,158 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1557
2025-06-04 15:19:13,158 - train_models - INFO -   NoOfMan_1day_trend: 0.0763
2025-06-04 15:19:13,159 - train_models - INFO -   DayOfWeek_feat_6: 0.0713
2025-06-04 15:19:13,159 - train_models - INFO -   NoOfMan_7day_trend: 0.0534
2025-06-04 15:19:13,160 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0375
2025-06-04 15:19:13,160 - train_models - INFO -   NoOfMan_lag_1: 0.0307
2025-06-04 15:19:13,161 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0077
2025-06-04 15:19:13,161 - train_models - INFO -   NoOfMan_lag_7: 0.0077
2025-06-04 15:19:13,162 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-04 15:19:13,162 - train_models - INFO - Cross-validation details for 206:
2025-06-04 15:19:13,162 - train_models - INFO -   Fold 1: MAE=1.6898, RMSE=2.3204, R²=0.9268, MAPE=9.50%
2025-06-04 15:19:13,163 - train_models - INFO -   Fold 2: MAE=1.4958, RMSE=2.1396, R²=0.9351, MAPE=8.30%
2025-06-04 15:19:13,163 - train_models - INFO -   Fold 3: MAE=1.4572, RMSE=2.5441, R²=0.9030, MAPE=8.37%
2025-06-04 15:19:13,164 - train_models - INFO -   Fold 4: MAE=0.9016, RMSE=1.4185, R²=0.9620, MAPE=6.09%
2025-06-04 15:19:13,164 - train_models - INFO -   Fold 5: MAE=1.1109, RMSE=1.7587, R²=0.9610, MAPE=5.73%
2025-06-04 15:19:13,165 - train_models - INFO - Building model for WorkType: 209
2025-06-04 15:19:13,174 - train_models - INFO - Available features for 209: 20 numeric, 3 categorical
2025-06-04 15:19:50,478 - train_models - INFO - Model for 209 - MAE: 0.8440, RMSE: 1.3160, R²: 0.9010, MAPE: 11.65%
2025-06-04 15:19:50,479 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 15:19:50,480 - train_models - INFO -   NoOfMan_7day_trend: 0.4156
2025-06-04 15:19:50,480 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2547
2025-06-04 15:19:50,481 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0992
2025-06-04 15:19:50,481 - train_models - INFO -   NoOfMan_1day_trend: 0.0722
2025-06-04 15:19:50,482 - train_models - INFO -   NoOfMan_lag_7: 0.0548
2025-06-04 15:19:50,482 - train_models - INFO -   NoOfMan_lag_1: 0.0312
2025-06-04 15:19:50,483 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0202
2025-06-04 15:19:50,483 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0100
2025-06-04 15:19:50,483 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0095
2025-06-04 15:19:50,484 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0042
2025-06-04 15:19:50,484 - train_models - INFO - Cross-validation details for 209:
2025-06-04 15:19:50,485 - train_models - INFO -   Fold 1: MAE=0.9462, RMSE=1.3696, R²=0.8746, MAPE=13.21%
2025-06-04 15:19:50,485 - train_models - INFO -   Fold 2: MAE=0.8931, RMSE=1.5007, R²=0.8839, MAPE=13.40%
2025-06-04 15:19:50,486 - train_models - INFO -   Fold 3: MAE=0.6477, RMSE=0.8762, R²=0.9398, MAPE=10.18%
2025-06-04 15:19:50,486 - train_models - INFO -   Fold 4: MAE=0.8316, RMSE=1.3936, R²=0.9010, MAPE=10.62%
2025-06-04 15:19:50,487 - train_models - INFO -   Fold 5: MAE=0.9013, RMSE=1.4399, R²=0.9057, MAPE=10.83%
2025-06-04 15:19:50,487 - train_models - INFO - Building model for WorkType: 210
2025-06-04 15:19:50,500 - train_models - INFO - Available features for 210: 20 numeric, 3 categorical
2025-06-04 15:20:28,519 - train_models - INFO - Model for 210 - MAE: 0.7875, RMSE: 1.1560, R²: 0.8943, MAPE: 17.05%
2025-06-04 15:20:28,519 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 15:20:28,520 - train_models - INFO -   NoOfMan_7day_trend: 0.2821
2025-06-04 15:20:28,520 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1973
2025-06-04 15:20:28,520 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1848
2025-06-04 15:20:28,521 - train_models - INFO -   NoOfMan_1day_trend: 0.0872
2025-06-04 15:20:28,521 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0667
2025-06-04 15:20:28,522 - train_models - INFO -   NoOfMan_lag_7: 0.0489
2025-06-04 15:20:28,522 - train_models - INFO -   NoOfMan_lag_1: 0.0402
2025-06-04 15:20:28,522 - train_models - INFO -   DayOfWeek_feat_6: 0.0270
2025-06-04 15:20:28,523 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0122
2025-06-04 15:20:28,523 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0087
2025-06-04 15:20:28,523 - train_models - INFO - Cross-validation details for 210:
2025-06-04 15:20:28,524 - train_models - INFO -   Fold 1: MAE=0.7734, RMSE=1.0522, R²=0.9007, MAPE=13.28%
2025-06-04 15:20:28,524 - train_models - INFO -   Fold 2: MAE=0.6763, RMSE=1.0094, R²=0.9066, MAPE=11.24%
2025-06-04 15:20:28,525 - train_models - INFO -   Fold 3: MAE=0.6152, RMSE=0.8609, R²=0.9289, MAPE=8.51%
2025-06-04 15:20:28,525 - train_models - INFO -   Fold 4: MAE=0.9194, RMSE=1.2829, R²=0.8740, MAPE=27.62%
2025-06-04 15:20:28,525 - train_models - INFO -   Fold 5: MAE=0.9529, RMSE=1.5748, R²=0.8612, MAPE=24.60%
2025-06-04 15:20:28,526 - train_models - INFO - Building model for WorkType: 211
2025-06-04 15:20:28,535 - train_models - INFO - Available features for 211: 20 numeric, 3 categorical
2025-06-04 15:21:08,210 - train_models - INFO - Model for 211 - MAE: 0.6178, RMSE: 0.9684, R²: 0.9147, MAPE: 10.51%
2025-06-04 15:21:08,211 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 15:21:08,211 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3609
2025-06-04 15:21:08,212 - train_models - INFO -   NoOfMan_1day_trend: 0.1891
2025-06-04 15:21:08,212 - train_models - INFO -   NoOfMan_7day_trend: 0.1827
2025-06-04 15:21:08,212 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0700
2025-06-04 15:21:08,213 - train_models - INFO -   NoOfMan_lag_1: 0.0504
2025-06-04 15:21:08,213 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-04 15:21:08,214 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0345
2025-06-04 15:21:08,214 - train_models - INFO -   DayOfWeek_feat_6: 0.0333
2025-06-04 15:21:08,215 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0063
2025-06-04 15:21:08,215 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0054
2025-06-04 15:21:08,216 - train_models - INFO - Cross-validation details for 211:
2025-06-04 15:21:08,216 - train_models - INFO -   Fold 1: MAE=1.0591, RMSE=1.6452, R²=0.8117, MAPE=16.03%
2025-06-04 15:21:08,217 - train_models - INFO -   Fold 2: MAE=0.5979, RMSE=0.9677, R²=0.9126, MAPE=9.75%
2025-06-04 15:21:08,217 - train_models - INFO -   Fold 3: MAE=0.4442, RMSE=0.6838, R²=0.9594, MAPE=7.96%
2025-06-04 15:21:08,218 - train_models - INFO -   Fold 4: MAE=0.5550, RMSE=0.9015, R²=0.9320, MAPE=10.28%
2025-06-04 15:21:08,218 - train_models - INFO -   Fold 5: MAE=0.4328, RMSE=0.6438, R²=0.9577, MAPE=8.51%
2025-06-04 15:21:08,218 - train_models - INFO - Building model for WorkType: 213
2025-06-04 15:21:08,228 - train_models - INFO - Available features for 213: 20 numeric, 3 categorical
2025-06-04 15:21:44,518 - train_models - INFO - Model for 213 - MAE: 0.3792, RMSE: 0.5646, R²: 0.8962, MAPE: 15.17%
2025-06-04 15:21:44,518 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 15:21:44,519 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4437
2025-06-04 15:21:44,519 - train_models - INFO -   NoOfMan_7day_trend: 0.2092
2025-06-04 15:21:44,520 - train_models - INFO -   NoOfMan_1day_trend: 0.1461
2025-06-04 15:21:44,520 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0521
2025-06-04 15:21:44,521 - train_models - INFO -   NoOfMan_lag_1: 0.0488
2025-06-04 15:21:44,521 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0304
2025-06-04 15:21:44,522 - train_models - INFO -   NoOfMan_lag_7: 0.0275
2025-06-04 15:21:44,522 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-04 15:21:44,522 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0055
2025-06-04 15:21:44,523 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0043
2025-06-04 15:21:44,523 - train_models - INFO - Cross-validation details for 213:
2025-06-04 15:21:44,524 - train_models - INFO -   Fold 1: MAE=0.5099, RMSE=0.7556, R²=0.8663, MAPE=14.43%
2025-06-04 15:21:44,524 - train_models - INFO -   Fold 2: MAE=0.4395, RMSE=0.6041, R²=0.8748, MAPE=23.64%
2025-06-04 15:21:44,525 - train_models - INFO -   Fold 3: MAE=0.3093, RMSE=0.5152, R²=0.9016, MAPE=14.47%
2025-06-04 15:21:44,525 - train_models - INFO -   Fold 4: MAE=0.3230, RMSE=0.4732, R²=0.9149, MAPE=12.82%
2025-06-04 15:21:44,526 - train_models - INFO -   Fold 5: MAE=0.3141, RMSE=0.4748, R²=0.9233, MAPE=10.49%
2025-06-04 15:21:44,526 - train_models - INFO - Building model for WorkType: 214
2025-06-04 15:21:44,535 - train_models - INFO - Available features for 214: 20 numeric, 3 categorical
2025-06-04 15:22:20,040 - train_models - INFO - Model for 214 - MAE: 0.4451, RMSE: 0.6755, R²: 0.8956, MAPE: 9.93%
2025-06-04 15:22:20,040 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 15:22:20,041 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5041
2025-06-04 15:22:20,041 - train_models - INFO -   NoOfMan_7day_trend: 0.1879
2025-06-04 15:22:20,041 - train_models - INFO -   NoOfMan_1day_trend: 0.0859
2025-06-04 15:22:20,042 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0651
2025-06-04 15:22:20,042 - train_models - INFO -   NoOfMan_lag_7: 0.0545
2025-06-04 15:22:20,043 - train_models - INFO -   NoOfMan_lag_1: 0.0428
2025-06-04 15:22:20,043 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0123
2025-06-04 15:22:20,044 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0078
2025-06-04 15:22:20,044 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0070
2025-06-04 15:22:20,045 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0066
2025-06-04 15:22:20,045 - train_models - INFO - Cross-validation details for 214:
2025-06-04 15:22:20,046 - train_models - INFO -   Fold 1: MAE=0.4876, RMSE=0.6749, R²=0.8413, MAPE=13.28%
2025-06-04 15:22:20,046 - train_models - INFO -   Fold 2: MAE=0.4041, RMSE=0.5187, R²=0.9251, MAPE=9.50%
2025-06-04 15:22:20,047 - train_models - INFO -   Fold 3: MAE=0.3057, RMSE=0.4249, R²=0.9508, MAPE=8.82%
2025-06-04 15:22:20,047 - train_models - INFO -   Fold 4: MAE=0.2955, RMSE=0.5268, R²=0.9354, MAPE=5.33%
2025-06-04 15:22:20,047 - train_models - INFO -   Fold 5: MAE=0.7327, RMSE=1.2320, R²=0.8252, MAPE=12.72%
2025-06-04 15:22:20,048 - train_models - INFO - Building model for WorkType: 215
2025-06-04 15:22:20,057 - train_models - INFO - Available features for 215: 20 numeric, 3 categorical
2025-06-04 15:23:01,088 - train_models - INFO - Model for 215 - MAE: 0.6410, RMSE: 1.0262, R²: 0.9029, MAPE: 14.75%
2025-06-04 15:23:01,089 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 15:23:01,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1838
2025-06-04 15:23:01,090 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1701
2025-06-04 15:23:01,090 - train_models - INFO -   DayOfWeek_feat_6: 0.1683
2025-06-04 15:23:01,091 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1486
2025-06-04 15:23:01,091 - train_models - INFO -   NoOfMan_1day_trend: 0.1347
2025-06-04 15:23:01,091 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0661
2025-06-04 15:23:01,092 - train_models - INFO -   NoOfMan_lag_1: 0.0414
2025-06-04 15:23:01,092 - train_models - INFO -   NoOfMan_lag_7: 0.0344
2025-06-04 15:23:01,093 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0076
2025-06-04 15:23:01,093 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0075
2025-06-04 15:23:01,094 - train_models - INFO - Cross-validation details for 215:
2025-06-04 15:23:01,094 - train_models - INFO -   Fold 1: MAE=0.9248, RMSE=1.4769, R²=0.8187, MAPE=25.18%
2025-06-04 15:23:01,095 - train_models - INFO -   Fold 2: MAE=0.6762, RMSE=1.0134, R²=0.9116, MAPE=15.30%
2025-06-04 15:23:01,095 - train_models - INFO -   Fold 3: MAE=0.6348, RMSE=1.0167, R²=0.9082, MAPE=11.31%
2025-06-04 15:23:01,095 - train_models - INFO -   Fold 4: MAE=0.4718, RMSE=0.7444, R²=0.9426, MAPE=11.88%
2025-06-04 15:23:01,096 - train_models - INFO -   Fold 5: MAE=0.4972, RMSE=0.8794, R²=0.9333, MAPE=10.06%
2025-06-04 15:23:01,096 - train_models - INFO - Building model for WorkType: 217
2025-06-04 15:23:01,106 - train_models - INFO - Available features for 217: 20 numeric, 3 categorical
2025-06-04 15:23:31,217 - train_models - INFO - Model for 217 - MAE: 0.3966, RMSE: 0.5342, R²: 0.9154, MAPE: 16.70%
2025-06-04 15:23:31,218 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 15:23:31,218 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5719
2025-06-04 15:23:31,219 - train_models - INFO -   NoOfMan_7day_trend: 0.1215
2025-06-04 15:23:31,219 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0836
2025-06-04 15:23:31,219 - train_models - INFO -   NoOfMan_1day_trend: 0.0669
2025-06-04 15:23:31,220 - train_models - INFO -   NoOfMan_lag_1: 0.0666
2025-06-04 15:23:31,220 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0377
2025-06-04 15:23:31,221 - train_models - INFO -   NoOfMan_lag_7: 0.0246
2025-06-04 15:23:31,221 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 15:23:31,222 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0042
2025-06-04 15:23:31,222 - train_models - INFO -   NoOfMan_lag_3: 0.0023
2025-06-04 15:23:31,223 - train_models - INFO - Cross-validation details for 217:
2025-06-04 15:23:31,223 - train_models - INFO -   Fold 1: MAE=0.5753, RMSE=0.6987, R²=0.8301, MAPE=25.24%
2025-06-04 15:23:31,223 - train_models - INFO -   Fold 2: MAE=0.4049, RMSE=0.5321, R²=0.9138, MAPE=20.23%
2025-06-04 15:23:31,224 - train_models - INFO -   Fold 3: MAE=0.3488, RMSE=0.4677, R²=0.9481, MAPE=12.47%
2025-06-04 15:23:31,224 - train_models - INFO -   Fold 4: MAE=0.3061, RMSE=0.3901, R²=0.9674, MAPE=12.66%
2025-06-04 15:23:31,225 - train_models - INFO -   Fold 5: MAE=0.3482, RMSE=0.5825, R²=0.9177, MAPE=12.92%
2025-06-04 15:23:31,226 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 15:23:32,546 - train_models - INFO - Model files saved successfully
2025-06-04 15:23:32,547 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 15:23:32,547 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 15:23:32,553 - train_models - INFO - Model training completed successfully
2025-06-04 15:30:05,736 - train_models - INFO - Starting the model training process
2025-06-04 15:30:05,736 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 15:30:05,737 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 15:30:05,743 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 15:30:05,879 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 15:30:06,668 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 15:30:06,738 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 15:30:06,757 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 15:30:06,758 - train_models - INFO - Converting Date column to datetime format
2025-06-04 15:30:06,780 - train_models - INFO - Engineering features...
2025-06-04 15:30:07,910 - utils.feature_engineering - INFO - Engineering features
2025-06-04 15:30:07,966 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 15:30:07,974 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 15:30:07,974 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-04 15:30:07,975 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-04 15:30:07,994 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 15:30:08,364 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 15:30:08,365 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 15:30:08,387 - train_models - INFO - Found 10 unique work types
2025-06-04 15:30:08,387 - train_models - INFO - Building models for 10 work types
2025-06-04 15:30:08,388 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 15:30:08,388 - utils.feature_builder - INFO - Built feature set: 50 numeric, 3 categorical
2025-06-04 15:30:08,389 - train_models - INFO - Tiered feature system generated 50 numeric features and 3 categorical features
2025-06-04 15:30:08,389 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'NoOfMan_lag_90', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_90', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-04 15:30:08,390 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 15:30:08,392 - train_models - INFO - Building model for WorkType: 202
2025-06-04 15:30:08,401 - train_models - INFO - Available features for 202: 34 numeric, 3 categorical
2025-06-04 15:31:04,079 - train_models - INFO - Model for 202 - MAE: 0.2202, RMSE: 0.3380, R²: 0.7382, MAPE: 10.47%
2025-06-04 15:31:04,079 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 15:31:04,080 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3957
2025-06-04 15:31:04,080 - train_models - INFO -   NoOfMan_7day_trend: 0.1952
2025-06-04 15:31:04,081 - train_models - INFO -   NoOfMan_1day_trend: 0.1226
2025-06-04 15:31:04,081 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0670
2025-06-04 15:31:04,082 - train_models - INFO -   NoOfMan_lag_1: 0.0654
2025-06-04 15:31:04,082 - train_models - INFO -   NoOfMan_lag_7: 0.0635
2025-06-04 15:31:04,083 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0375
2025-06-04 15:31:04,083 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0124
2025-06-04 15:31:04,084 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0042
2025-06-04 15:31:04,084 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0024
2025-06-04 15:31:04,084 - train_models - INFO - Cross-validation details for 202:
2025-06-04 15:31:04,085 - train_models - INFO -   Fold 1: MAE=0.2241, RMSE=0.4172, R²=0.3900, MAPE=11.44%
2025-06-04 15:31:04,085 - train_models - INFO -   Fold 2: MAE=0.2166, RMSE=0.3107, R²=0.7776, MAPE=11.86%
2025-06-04 15:31:04,086 - train_models - INFO -   Fold 3: MAE=0.2381, RMSE=0.3748, R²=0.7814, MAPE=12.18%
2025-06-04 15:31:04,086 - train_models - INFO -   Fold 4: MAE=0.1812, RMSE=0.2370, R²=0.8857, MAPE=8.28%
2025-06-04 15:31:04,087 - train_models - INFO -   Fold 5: MAE=0.2409, RMSE=0.3501, R²=0.8564, MAPE=8.61%
2025-06-04 15:31:04,087 - train_models - INFO - Building model for WorkType: 203
2025-06-04 15:31:04,095 - train_models - INFO - Available features for 203: 34 numeric, 3 categorical
2025-06-04 15:32:01,900 - train_models - INFO - Model for 203 - MAE: 0.2340, RMSE: 0.3324, R²: 0.9098, MAPE: 4.93%
2025-06-04 15:32:01,901 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 15:32:01,901 - train_models - INFO -   NoOfMan_7day_trend: 0.3003
2025-06-04 15:32:01,902 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2339
2025-06-04 15:32:01,902 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1189
2025-06-04 15:32:01,903 - train_models - INFO -   NoOfMan_1day_trend: 0.0935
2025-06-04 15:32:01,903 - train_models - INFO -   NoOfMan_lag_7: 0.0797
2025-06-04 15:32:01,903 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0704
2025-06-04 15:32:01,904 - train_models - INFO -   NoOfMan_lag_1: 0.0559
2025-06-04 15:32:01,904 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0059
2025-06-04 15:32:01,905 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-06-04 15:32:01,905 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0029
2025-06-04 15:32:01,906 - train_models - INFO - Cross-validation details for 203:
2025-06-04 15:32:01,906 - train_models - INFO -   Fold 1: MAE=0.2960, RMSE=0.4006, R²=0.8736, MAPE=5.97%
2025-06-04 15:32:01,906 - train_models - INFO -   Fold 2: MAE=0.2598, RMSE=0.3516, R²=0.9099, MAPE=5.14%
2025-06-04 15:32:01,907 - train_models - INFO -   Fold 3: MAE=0.2463, RMSE=0.3814, R²=0.8903, MAPE=4.66%
2025-06-04 15:32:01,907 - train_models - INFO -   Fold 4: MAE=0.1900, RMSE=0.2859, R²=0.9337, MAPE=4.55%
2025-06-04 15:32:01,908 - train_models - INFO -   Fold 5: MAE=0.1780, RMSE=0.2424, R²=0.9414, MAPE=4.33%
2025-06-04 15:32:01,908 - train_models - INFO - Building model for WorkType: 206
2025-06-04 15:32:01,919 - train_models - INFO - Available features for 206: 34 numeric, 3 categorical
2025-06-04 15:33:17,020 - train_models - INFO - Model for 206 - MAE: 1.4470, RMSE: 2.1782, R²: 0.9288, MAPE: 8.26%
2025-06-04 15:33:17,021 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 15:33:17,021 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5192
2025-06-04 15:33:17,021 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1513
2025-06-04 15:33:17,022 - train_models - INFO -   NoOfMan_1day_trend: 0.0727
2025-06-04 15:33:17,023 - train_models - INFO -   DayOfWeek_feat_6: 0.0708
2025-06-04 15:33:17,023 - train_models - INFO -   NoOfMan_7day_trend: 0.0487
2025-06-04 15:33:17,023 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0370
2025-06-04 15:33:17,024 - train_models - INFO -   NoOfMan_lag_1: 0.0279
2025-06-04 15:33:17,024 - train_models - INFO -   Quantity_rolling_mean_7: 0.0082
2025-06-04 15:33:17,025 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0066
2025-06-04 15:33:17,025 - train_models - INFO -   NoOfMan_lag_7: 0.0061
2025-06-04 15:33:17,026 - train_models - INFO - Cross-validation details for 206:
2025-06-04 15:33:17,026 - train_models - INFO -   Fold 1: MAE=1.7765, RMSE=2.4267, R²=0.9199, MAPE=10.17%
2025-06-04 15:33:17,027 - train_models - INFO -   Fold 2: MAE=1.6604, RMSE=2.3366, R²=0.9226, MAPE=9.08%
2025-06-04 15:33:17,027 - train_models - INFO -   Fold 3: MAE=1.5597, RMSE=2.6862, R²=0.8918, MAPE=9.01%
2025-06-04 15:33:17,027 - train_models - INFO -   Fold 4: MAE=1.0084, RMSE=1.5186, R²=0.9565, MAPE=6.60%
2025-06-04 15:33:17,028 - train_models - INFO -   Fold 5: MAE=1.2299, RMSE=1.9230, R²=0.9534, MAPE=6.45%
2025-06-04 15:33:17,028 - train_models - INFO - Building model for WorkType: 209
2025-06-04 15:33:17,039 - train_models - INFO - Available features for 209: 34 numeric, 3 categorical
2025-06-04 15:34:17,392 - train_models - INFO - Model for 209 - MAE: 0.9080, RMSE: 1.4166, R²: 0.8844, MAPE: 12.59%
2025-06-04 15:34:17,393 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 15:34:17,393 - train_models - INFO -   NoOfMan_7day_trend: 0.3998
2025-06-04 15:34:17,394 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2192
2025-06-04 15:34:17,394 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0978
2025-06-04 15:34:17,394 - train_models - INFO -   NoOfMan_1day_trend: 0.0701
2025-06-04 15:34:17,395 - train_models - INFO -   NoOfMan_lag_7: 0.0481
2025-06-04 15:34:17,395 - train_models - INFO -   Quantity_rolling_mean_7: 0.0480
2025-06-04 15:34:17,396 - train_models - INFO -   NoOfMan_lag_1: 0.0256
2025-06-04 15:34:17,396 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0186
2025-06-04 15:34:17,397 - train_models - INFO -   Quantity_7day_trend: 0.0089
2025-06-04 15:34:17,397 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0079
2025-06-04 15:34:17,397 - train_models - INFO - Cross-validation details for 209:
2025-06-04 15:34:17,398 - train_models - INFO -   Fold 1: MAE=1.0065, RMSE=1.4879, R²=0.8520, MAPE=13.83%
2025-06-04 15:34:17,398 - train_models - INFO -   Fold 2: MAE=1.0249, RMSE=1.7401, R²=0.8439, MAPE=15.05%
2025-06-04 15:34:17,399 - train_models - INFO -   Fold 3: MAE=0.6837, RMSE=0.9099, R²=0.9351, MAPE=10.81%
2025-06-04 15:34:17,399 - train_models - INFO -   Fold 4: MAE=0.8823, RMSE=1.4639, R²=0.8908, MAPE=11.42%
2025-06-04 15:34:17,400 - train_models - INFO -   Fold 5: MAE=0.9422, RMSE=1.4811, R²=0.9002, MAPE=11.84%
2025-06-04 15:34:17,400 - train_models - INFO - Building model for WorkType: 210
2025-06-04 15:34:17,410 - train_models - INFO - Available features for 210: 34 numeric, 3 categorical
2025-06-04 15:35:19,139 - train_models - INFO - Model for 210 - MAE: 0.8247, RMSE: 1.1989, R²: 0.8863, MAPE: 18.20%
2025-06-04 15:35:19,139 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 15:35:19,140 - train_models - INFO -   NoOfMan_7day_trend: 0.2633
2025-06-04 15:35:19,140 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1928
2025-06-04 15:35:19,141 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1747
2025-06-04 15:35:19,141 - train_models - INFO -   NoOfMan_1day_trend: 0.0800
2025-06-04 15:35:19,142 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0663
2025-06-04 15:35:19,142 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-04 15:35:19,142 - train_models - INFO -   NoOfMan_lag_1: 0.0327
2025-06-04 15:35:19,143 - train_models - INFO -   DayOfWeek_feat_6: 0.0258
2025-06-04 15:35:19,143 - train_models - INFO -   Quantity_7day_trend: 0.0228
2025-06-04 15:35:19,144 - train_models - INFO -   Quantity_rolling_mean_7: 0.0132
2025-06-04 15:35:19,144 - train_models - INFO - Cross-validation details for 210:
2025-06-04 15:35:19,144 - train_models - INFO -   Fold 1: MAE=0.8139, RMSE=1.1063, R²=0.8903, MAPE=14.07%
2025-06-04 15:35:19,145 - train_models - INFO -   Fold 2: MAE=0.7314, RMSE=1.0519, R²=0.8986, MAPE=12.35%
2025-06-04 15:35:19,146 - train_models - INFO -   Fold 3: MAE=0.6452, RMSE=0.8915, R²=0.9237, MAPE=9.02%
2025-06-04 15:35:19,147 - train_models - INFO -   Fold 4: MAE=0.9301, RMSE=1.3127, R²=0.8680, MAPE=28.91%
2025-06-04 15:35:19,147 - train_models - INFO -   Fold 5: MAE=1.0028, RMSE=1.6319, R²=0.8509, MAPE=26.65%
2025-06-04 15:35:19,148 - train_models - INFO - Building model for WorkType: 211
2025-06-04 15:35:19,158 - train_models - INFO - Available features for 211: 34 numeric, 3 categorical
2025-06-04 15:36:24,087 - train_models - INFO - Model for 211 - MAE: 0.6721, RMSE: 1.0229, R²: 0.9061, MAPE: 11.36%
2025-06-04 15:36:24,088 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 15:36:24,088 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3612
2025-06-04 15:36:24,089 - train_models - INFO -   NoOfMan_1day_trend: 0.1863
2025-06-04 15:36:24,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1788
2025-06-04 15:36:24,089 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0687
2025-06-04 15:36:24,090 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 15:36:24,090 - train_models - INFO -   NoOfMan_lag_7: 0.0338
2025-06-04 15:36:24,090 - train_models - INFO -   DayOfWeek_feat_6: 0.0328
2025-06-04 15:36:24,091 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0244
2025-06-04 15:36:24,091 - train_models - INFO -   Quantity_same_dow_lag: 0.0118
2025-06-04 15:36:24,092 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0053
2025-06-04 15:36:24,092 - train_models - INFO - Cross-validation details for 211:
2025-06-04 15:36:24,092 - train_models - INFO -   Fold 1: MAE=1.1131, RMSE=1.6879, R²=0.8018, MAPE=16.52%
2025-06-04 15:36:24,093 - train_models - INFO -   Fold 2: MAE=0.6377, RMSE=1.0083, R²=0.9051, MAPE=9.99%
2025-06-04 15:36:24,093 - train_models - INFO -   Fold 3: MAE=0.5174, RMSE=0.7660, R²=0.9491, MAPE=9.38%
2025-06-04 15:36:24,094 - train_models - INFO -   Fold 4: MAE=0.5720, RMSE=0.9087, R²=0.9309, MAPE=10.43%
2025-06-04 15:36:24,094 - train_models - INFO -   Fold 5: MAE=0.5204, RMSE=0.7437, R²=0.9435, MAPE=10.47%
2025-06-04 15:36:24,095 - train_models - INFO - Building model for WorkType: 213
2025-06-04 15:36:24,104 - train_models - INFO - Available features for 213: 34 numeric, 3 categorical
2025-06-04 15:37:23,048 - train_models - INFO - Model for 213 - MAE: 0.3967, RMSE: 0.5849, R²: 0.8886, MAPE: 15.87%
2025-06-04 15:37:23,048 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 15:37:23,049 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4439
2025-06-04 15:37:23,049 - train_models - INFO -   NoOfMan_7day_trend: 0.2079
2025-06-04 15:37:23,050 - train_models - INFO -   NoOfMan_1day_trend: 0.1439
2025-06-04 15:37:23,050 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0513
2025-06-04 15:37:23,051 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 15:37:23,051 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0298
2025-06-04 15:37:23,051 - train_models - INFO -   NoOfMan_lag_7: 0.0262
2025-06-04 15:37:23,052 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-04 15:37:23,052 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0048
2025-06-04 15:37:23,052 - train_models - INFO -   Combined_KPI: 0.0031
2025-06-04 15:37:23,053 - train_models - INFO - Cross-validation details for 213:
2025-06-04 15:37:23,053 - train_models - INFO -   Fold 1: MAE=0.5309, RMSE=0.7763, R²=0.8589, MAPE=15.20%
2025-06-04 15:37:23,054 - train_models - INFO -   Fold 2: MAE=0.4540, RMSE=0.6177, R²=0.8690, MAPE=24.29%
2025-06-04 15:37:23,054 - train_models - INFO -   Fold 3: MAE=0.3220, RMSE=0.5434, R²=0.8906, MAPE=14.70%
2025-06-04 15:37:23,055 - train_models - INFO -   Fold 4: MAE=0.3445, RMSE=0.4972, R²=0.9061, MAPE=13.68%
2025-06-04 15:37:23,055 - train_models - INFO -   Fold 5: MAE=0.3320, RMSE=0.4899, R²=0.9184, MAPE=11.49%
2025-06-04 15:37:23,055 - train_models - INFO - Building model for WorkType: 214
2025-06-04 15:37:23,067 - train_models - INFO - Available features for 214: 34 numeric, 3 categorical
2025-06-04 15:38:20,597 - train_models - INFO - Model for 214 - MAE: 0.4693, RMSE: 0.7039, R²: 0.8868, MAPE: 10.56%
2025-06-04 15:38:20,598 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 15:38:20,598 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5062
2025-06-04 15:38:20,599 - train_models - INFO -   NoOfMan_7day_trend: 0.1853
2025-06-04 15:38:20,599 - train_models - INFO -   NoOfMan_1day_trend: 0.0840
2025-06-04 15:38:20,599 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0648
2025-06-04 15:38:20,600 - train_models - INFO -   NoOfMan_lag_7: 0.0528
2025-06-04 15:38:20,600 - train_models - INFO -   NoOfMan_lag_1: 0.0413
2025-06-04 15:38:20,601 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-04 15:38:20,601 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0071
2025-06-04 15:38:20,602 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0064
2025-06-04 15:38:20,602 - train_models - INFO -   NoOfMan_lag_2: 0.0032
2025-06-04 15:38:20,603 - train_models - INFO - Cross-validation details for 214:
2025-06-04 15:38:20,603 - train_models - INFO -   Fold 1: MAE=0.5097, RMSE=0.6985, R²=0.8301, MAPE=13.93%
2025-06-04 15:38:20,603 - train_models - INFO -   Fold 2: MAE=0.4309, RMSE=0.5501, R²=0.9157, MAPE=10.21%
2025-06-04 15:38:20,604 - train_models - INFO -   Fold 3: MAE=0.3255, RMSE=0.4498, R²=0.9449, MAPE=9.32%
2025-06-04 15:38:20,604 - train_models - INFO -   Fold 4: MAE=0.3131, RMSE=0.5497, R²=0.9297, MAPE=5.72%
2025-06-04 15:38:20,605 - train_models - INFO -   Fold 5: MAE=0.7671, RMSE=1.2715, R²=0.8139, MAPE=13.64%
2025-06-04 15:38:20,605 - train_models - INFO - Building model for WorkType: 215
2025-06-04 15:38:20,616 - train_models - INFO - Available features for 215: 34 numeric, 3 categorical
2025-06-04 15:39:18,939 - train_models - INFO - Starting the model training process
2025-06-04 15:39:18,940 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 15:39:18,940 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 15:39:18,946 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 15:39:19,095 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 15:39:19,885 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 15:39:19,957 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 15:39:19,976 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 15:39:19,976 - train_models - INFO - Converting Date column to datetime format
2025-06-04 15:39:19,999 - train_models - INFO - Engineering features...
2025-06-04 15:39:21,100 - utils.feature_engineering - INFO - Engineering features
2025-06-04 15:39:21,156 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 15:39:21,164 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 15:39:21,164 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-04 15:39:21,165 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-04 15:39:21,185 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 15:39:21,543 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 15:39:21,544 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 15:39:21,565 - train_models - INFO - Found 10 unique work types
2025-06-04 15:39:21,565 - train_models - INFO - Building models for 10 work types
2025-06-04 15:39:21,566 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 15:39:21,566 - utils.feature_builder - INFO - Built feature set: 50 numeric, 3 categorical
2025-06-04 15:39:21,567 - train_models - INFO - Tiered feature system generated 50 numeric features and 3 categorical features
2025-06-04 15:39:21,567 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'NoOfMan_lag_90', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_90', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-04 15:39:21,568 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 15:39:21,569 - train_models - INFO - Building model for WorkType: 202
2025-06-04 15:39:21,577 - train_models - INFO - Available features for 202: 34 numeric, 3 categorical
2025-06-04 15:40:16,676 - train_models - INFO - Model for 202 - MAE: 0.2202, RMSE: 0.3380, R²: 0.7382, MAPE: 10.47%
2025-06-04 15:40:16,677 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 15:40:16,677 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3957
2025-06-04 15:40:16,678 - train_models - INFO -   NoOfMan_7day_trend: 0.1952
2025-06-04 15:40:16,678 - train_models - INFO -   NoOfMan_1day_trend: 0.1226
2025-06-04 15:40:16,679 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0670
2025-06-04 15:40:16,679 - train_models - INFO -   NoOfMan_lag_1: 0.0654
2025-06-04 15:40:16,680 - train_models - INFO -   NoOfMan_lag_7: 0.0635
2025-06-04 15:40:16,680 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0375
2025-06-04 15:40:16,681 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0124
2025-06-04 15:40:16,681 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0042
2025-06-04 15:40:16,681 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0024
2025-06-04 15:40:16,682 - train_models - INFO - Cross-validation details for 202:
2025-06-04 15:40:16,682 - train_models - INFO -   Fold 1: MAE=0.2241, RMSE=0.4172, R²=0.3900, MAPE=11.44%
2025-06-04 15:40:16,683 - train_models - INFO -   Fold 2: MAE=0.2166, RMSE=0.3107, R²=0.7776, MAPE=11.86%
2025-06-04 15:40:16,683 - train_models - INFO -   Fold 3: MAE=0.2381, RMSE=0.3748, R²=0.7814, MAPE=12.18%
2025-06-04 15:40:16,684 - train_models - INFO -   Fold 4: MAE=0.1812, RMSE=0.2370, R²=0.8857, MAPE=8.28%
2025-06-04 15:40:16,684 - train_models - INFO -   Fold 5: MAE=0.2409, RMSE=0.3501, R²=0.8564, MAPE=8.61%
2025-06-04 15:40:16,685 - train_models - INFO - Building model for WorkType: 203
2025-06-04 15:40:16,695 - train_models - INFO - Available features for 203: 34 numeric, 3 categorical
2025-06-04 15:41:14,062 - train_models - INFO - Model for 203 - MAE: 0.2340, RMSE: 0.3324, R²: 0.9098, MAPE: 4.93%
2025-06-04 15:41:14,063 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 15:41:14,063 - train_models - INFO -   NoOfMan_7day_trend: 0.3003
2025-06-04 15:41:14,064 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2339
2025-06-04 15:41:14,064 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1189
2025-06-04 15:41:14,065 - train_models - INFO -   NoOfMan_1day_trend: 0.0935
2025-06-04 15:41:14,065 - train_models - INFO -   NoOfMan_lag_7: 0.0797
2025-06-04 15:41:14,066 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0704
2025-06-04 15:41:14,066 - train_models - INFO -   NoOfMan_lag_1: 0.0559
2025-06-04 15:41:14,066 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0059
2025-06-04 15:41:14,067 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-06-04 15:41:14,067 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0029
2025-06-04 15:41:14,068 - train_models - INFO - Cross-validation details for 203:
2025-06-04 15:41:14,068 - train_models - INFO -   Fold 1: MAE=0.2960, RMSE=0.4006, R²=0.8736, MAPE=5.97%
2025-06-04 15:41:14,069 - train_models - INFO -   Fold 2: MAE=0.2598, RMSE=0.3516, R²=0.9099, MAPE=5.14%
2025-06-04 15:41:14,069 - train_models - INFO -   Fold 3: MAE=0.2463, RMSE=0.3814, R²=0.8903, MAPE=4.66%
2025-06-04 15:41:14,070 - train_models - INFO -   Fold 4: MAE=0.1900, RMSE=0.2859, R²=0.9337, MAPE=4.55%
2025-06-04 15:41:14,070 - train_models - INFO -   Fold 5: MAE=0.1780, RMSE=0.2424, R²=0.9414, MAPE=4.33%
2025-06-04 15:41:14,070 - train_models - INFO - Building model for WorkType: 206
2025-06-04 15:41:14,081 - train_models - INFO - Available features for 206: 34 numeric, 3 categorical
2025-06-04 15:42:28,590 - train_models - INFO - Model for 206 - MAE: 1.4470, RMSE: 2.1782, R²: 0.9288, MAPE: 8.26%
2025-06-04 15:42:28,591 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 15:42:28,592 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5192
2025-06-04 15:42:28,592 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1513
2025-06-04 15:42:28,592 - train_models - INFO -   NoOfMan_1day_trend: 0.0727
2025-06-04 15:42:28,593 - train_models - INFO -   DayOfWeek_feat_6: 0.0708
2025-06-04 15:42:28,593 - train_models - INFO -   NoOfMan_7day_trend: 0.0487
2025-06-04 15:42:28,594 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0370
2025-06-04 15:42:28,594 - train_models - INFO -   NoOfMan_lag_1: 0.0279
2025-06-04 15:42:28,595 - train_models - INFO -   Quantity_rolling_mean_7: 0.0082
2025-06-04 15:42:28,595 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0066
2025-06-04 15:42:28,595 - train_models - INFO -   NoOfMan_lag_7: 0.0061
2025-06-04 15:42:28,596 - train_models - INFO - Cross-validation details for 206:
2025-06-04 15:42:28,596 - train_models - INFO -   Fold 1: MAE=1.7765, RMSE=2.4267, R²=0.9199, MAPE=10.17%
2025-06-04 15:42:28,597 - train_models - INFO -   Fold 2: MAE=1.6604, RMSE=2.3366, R²=0.9226, MAPE=9.08%
2025-06-04 15:42:28,597 - train_models - INFO -   Fold 3: MAE=1.5597, RMSE=2.6862, R²=0.8918, MAPE=9.01%
2025-06-04 15:42:28,598 - train_models - INFO -   Fold 4: MAE=1.0084, RMSE=1.5186, R²=0.9565, MAPE=6.60%
2025-06-04 15:42:28,598 - train_models - INFO -   Fold 5: MAE=1.2299, RMSE=1.9230, R²=0.9534, MAPE=6.45%
2025-06-04 15:42:28,598 - train_models - INFO - Building model for WorkType: 209
2025-06-04 15:42:28,608 - train_models - INFO - Available features for 209: 34 numeric, 3 categorical
2025-06-04 15:43:29,075 - train_models - INFO - Model for 209 - MAE: 0.9080, RMSE: 1.4166, R²: 0.8844, MAPE: 12.59%
2025-06-04 15:43:29,076 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 15:43:29,076 - train_models - INFO -   NoOfMan_7day_trend: 0.3998
2025-06-04 15:43:29,076 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2192
2025-06-04 15:43:29,077 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0978
2025-06-04 15:43:29,077 - train_models - INFO -   NoOfMan_1day_trend: 0.0701
2025-06-04 15:43:29,078 - train_models - INFO -   NoOfMan_lag_7: 0.0481
2025-06-04 15:43:29,078 - train_models - INFO -   Quantity_rolling_mean_7: 0.0480
2025-06-04 15:43:29,079 - train_models - INFO -   NoOfMan_lag_1: 0.0256
2025-06-04 15:43:29,079 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0186
2025-06-04 15:43:29,080 - train_models - INFO -   Quantity_7day_trend: 0.0089
2025-06-04 15:43:29,080 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0079
2025-06-04 15:43:29,081 - train_models - INFO - Cross-validation details for 209:
2025-06-04 15:43:29,081 - train_models - INFO -   Fold 1: MAE=1.0065, RMSE=1.4879, R²=0.8520, MAPE=13.83%
2025-06-04 15:43:29,081 - train_models - INFO -   Fold 2: MAE=1.0249, RMSE=1.7401, R²=0.8439, MAPE=15.05%
2025-06-04 15:43:29,082 - train_models - INFO -   Fold 3: MAE=0.6837, RMSE=0.9099, R²=0.9351, MAPE=10.81%
2025-06-04 15:43:29,082 - train_models - INFO -   Fold 4: MAE=0.8823, RMSE=1.4639, R²=0.8908, MAPE=11.42%
2025-06-04 15:43:29,083 - train_models - INFO -   Fold 5: MAE=0.9422, RMSE=1.4811, R²=0.9002, MAPE=11.84%
2025-06-04 15:43:29,083 - train_models - INFO - Building model for WorkType: 210
2025-06-04 15:43:29,092 - train_models - INFO - Available features for 210: 34 numeric, 3 categorical
2025-06-04 15:44:30,511 - train_models - INFO - Model for 210 - MAE: 0.8247, RMSE: 1.1989, R²: 0.8863, MAPE: 18.20%
2025-06-04 15:44:30,512 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 15:44:30,512 - train_models - INFO -   NoOfMan_7day_trend: 0.2633
2025-06-04 15:44:30,513 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1928
2025-06-04 15:44:30,513 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1747
2025-06-04 15:44:30,513 - train_models - INFO -   NoOfMan_1day_trend: 0.0800
2025-06-04 15:44:30,514 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0663
2025-06-04 15:44:30,514 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-04 15:44:30,515 - train_models - INFO -   NoOfMan_lag_1: 0.0327
2025-06-04 15:44:30,515 - train_models - INFO -   DayOfWeek_feat_6: 0.0258
2025-06-04 15:44:30,516 - train_models - INFO -   Quantity_7day_trend: 0.0228
2025-06-04 15:44:30,516 - train_models - INFO -   Quantity_rolling_mean_7: 0.0132
2025-06-04 15:44:30,516 - train_models - INFO - Cross-validation details for 210:
2025-06-04 15:44:30,517 - train_models - INFO -   Fold 1: MAE=0.8139, RMSE=1.1063, R²=0.8903, MAPE=14.07%
2025-06-04 15:44:30,517 - train_models - INFO -   Fold 2: MAE=0.7314, RMSE=1.0519, R²=0.8986, MAPE=12.35%
2025-06-04 15:44:30,518 - train_models - INFO -   Fold 3: MAE=0.6452, RMSE=0.8915, R²=0.9237, MAPE=9.02%
2025-06-04 15:44:30,518 - train_models - INFO -   Fold 4: MAE=0.9301, RMSE=1.3127, R²=0.8680, MAPE=28.91%
2025-06-04 15:44:30,519 - train_models - INFO -   Fold 5: MAE=1.0028, RMSE=1.6319, R²=0.8509, MAPE=26.65%
2025-06-04 15:44:30,519 - train_models - INFO - Building model for WorkType: 211
2025-06-04 15:44:30,532 - train_models - INFO - Available features for 211: 34 numeric, 3 categorical
2025-06-04 15:45:34,439 - train_models - INFO - Model for 211 - MAE: 0.6721, RMSE: 1.0229, R²: 0.9061, MAPE: 11.36%
2025-06-04 15:45:34,440 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 15:45:34,440 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3612
2025-06-04 15:45:34,441 - train_models - INFO -   NoOfMan_1day_trend: 0.1863
2025-06-04 15:45:34,441 - train_models - INFO -   NoOfMan_7day_trend: 0.1788
2025-06-04 15:45:34,442 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0687
2025-06-04 15:45:34,442 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 15:45:34,443 - train_models - INFO -   NoOfMan_lag_7: 0.0338
2025-06-04 15:45:34,443 - train_models - INFO -   DayOfWeek_feat_6: 0.0328
2025-06-04 15:45:34,444 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0244
2025-06-04 15:45:34,444 - train_models - INFO -   Quantity_same_dow_lag: 0.0118
2025-06-04 15:45:34,444 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0053
2025-06-04 15:45:34,445 - train_models - INFO - Cross-validation details for 211:
2025-06-04 15:45:34,445 - train_models - INFO -   Fold 1: MAE=1.1131, RMSE=1.6879, R²=0.8018, MAPE=16.52%
2025-06-04 15:45:34,446 - train_models - INFO -   Fold 2: MAE=0.6377, RMSE=1.0083, R²=0.9051, MAPE=9.99%
2025-06-04 15:45:34,446 - train_models - INFO -   Fold 3: MAE=0.5174, RMSE=0.7660, R²=0.9491, MAPE=9.38%
2025-06-04 15:45:34,447 - train_models - INFO -   Fold 4: MAE=0.5720, RMSE=0.9087, R²=0.9309, MAPE=10.43%
2025-06-04 15:45:34,447 - train_models - INFO -   Fold 5: MAE=0.5204, RMSE=0.7437, R²=0.9435, MAPE=10.47%
2025-06-04 15:45:34,447 - train_models - INFO - Building model for WorkType: 213
2025-06-04 15:45:34,457 - train_models - INFO - Available features for 213: 34 numeric, 3 categorical
2025-06-04 15:46:32,802 - train_models - INFO - Model for 213 - MAE: 0.3967, RMSE: 0.5849, R²: 0.8886, MAPE: 15.87%
2025-06-04 15:46:32,802 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 15:46:32,803 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4439
2025-06-04 15:46:32,803 - train_models - INFO -   NoOfMan_7day_trend: 0.2079
2025-06-04 15:46:32,804 - train_models - INFO -   NoOfMan_1day_trend: 0.1439
2025-06-04 15:46:32,804 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0513
2025-06-04 15:46:32,804 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 15:46:32,805 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0298
2025-06-04 15:46:32,805 - train_models - INFO -   NoOfMan_lag_7: 0.0262
2025-06-04 15:46:32,806 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-04 15:46:32,806 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0048
2025-06-04 15:46:32,807 - train_models - INFO -   Combined_KPI: 0.0031
2025-06-04 15:46:32,807 - train_models - INFO - Cross-validation details for 213:
2025-06-04 15:46:32,807 - train_models - INFO -   Fold 1: MAE=0.5309, RMSE=0.7763, R²=0.8589, MAPE=15.20%
2025-06-04 15:46:32,808 - train_models - INFO -   Fold 2: MAE=0.4540, RMSE=0.6177, R²=0.8690, MAPE=24.29%
2025-06-04 15:46:32,808 - train_models - INFO -   Fold 3: MAE=0.3220, RMSE=0.5434, R²=0.8906, MAPE=14.70%
2025-06-04 15:46:32,809 - train_models - INFO -   Fold 4: MAE=0.3445, RMSE=0.4972, R²=0.9061, MAPE=13.68%
2025-06-04 15:46:32,809 - train_models - INFO -   Fold 5: MAE=0.3320, RMSE=0.4899, R²=0.9184, MAPE=11.49%
2025-06-04 15:46:32,810 - train_models - INFO - Building model for WorkType: 214
2025-06-04 15:46:32,819 - train_models - INFO - Available features for 214: 34 numeric, 3 categorical
2025-06-04 15:47:29,932 - train_models - INFO - Model for 214 - MAE: 0.4693, RMSE: 0.7039, R²: 0.8868, MAPE: 10.56%
2025-06-04 15:47:29,933 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 15:47:29,933 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5062
2025-06-04 15:47:29,933 - train_models - INFO -   NoOfMan_7day_trend: 0.1853
2025-06-04 15:47:29,934 - train_models - INFO -   NoOfMan_1day_trend: 0.0840
2025-06-04 15:47:29,934 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0648
2025-06-04 15:47:29,935 - train_models - INFO -   NoOfMan_lag_7: 0.0528
2025-06-04 15:47:29,935 - train_models - INFO -   NoOfMan_lag_1: 0.0413
2025-06-04 15:47:29,936 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-04 15:47:29,936 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0071
2025-06-04 15:47:29,937 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0064
2025-06-04 15:47:29,937 - train_models - INFO -   NoOfMan_lag_2: 0.0032
2025-06-04 15:47:29,937 - train_models - INFO - Cross-validation details for 214:
2025-06-04 15:47:29,938 - train_models - INFO -   Fold 1: MAE=0.5097, RMSE=0.6985, R²=0.8301, MAPE=13.93%
2025-06-04 15:47:29,939 - train_models - INFO -   Fold 2: MAE=0.4309, RMSE=0.5501, R²=0.9157, MAPE=10.21%
2025-06-04 15:47:29,939 - train_models - INFO -   Fold 3: MAE=0.3255, RMSE=0.4498, R²=0.9449, MAPE=9.32%
2025-06-04 15:47:29,939 - train_models - INFO -   Fold 4: MAE=0.3131, RMSE=0.5497, R²=0.9297, MAPE=5.72%
2025-06-04 15:47:29,940 - train_models - INFO -   Fold 5: MAE=0.7671, RMSE=1.2715, R²=0.8139, MAPE=13.64%
2025-06-04 15:47:29,940 - train_models - INFO - Building model for WorkType: 215
2025-06-04 15:47:29,950 - train_models - INFO - Available features for 215: 34 numeric, 3 categorical
2025-06-04 15:48:36,918 - train_models - INFO - Model for 215 - MAE: 0.6975, RMSE: 1.0822, R²: 0.8920, MAPE: 16.14%
2025-06-04 15:48:36,919 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 15:48:36,919 - train_models - INFO -   NoOfMan_7day_trend: 0.1723
2025-06-04 15:48:36,920 - train_models - INFO -   DayOfWeek_feat_6: 0.1682
2025-06-04 15:48:36,920 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1670
2025-06-04 15:48:36,920 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1431
2025-06-04 15:48:36,921 - train_models - INFO -   NoOfMan_1day_trend: 0.1295
2025-06-04 15:48:36,921 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0649
2025-06-04 15:48:36,922 - train_models - INFO -   NoOfMan_lag_1: 0.0339
2025-06-04 15:48:36,922 - train_models - INFO -   NoOfMan_lag_7: 0.0284
2025-06-04 15:48:36,923 - train_models - INFO -   Quantity_7day_trend: 0.0130
2025-06-04 15:48:36,923 - train_models - INFO -   Quantity_rolling_mean_7: 0.0100
2025-06-04 15:48:36,923 - train_models - INFO - Cross-validation details for 215:
2025-06-04 15:48:36,924 - train_models - INFO -   Fold 1: MAE=1.0100, RMSE=1.5668, R²=0.7959, MAPE=26.73%
2025-06-04 15:48:36,924 - train_models - INFO -   Fold 2: MAE=0.7162, RMSE=1.0302, R²=0.9087, MAPE=16.86%
2025-06-04 15:48:36,925 - train_models - INFO -   Fold 3: MAE=0.6822, RMSE=1.0555, R²=0.9011, MAPE=12.43%
2025-06-04 15:48:36,925 - train_models - INFO -   Fold 4: MAE=0.5365, RMSE=0.8214, R²=0.9301, MAPE=13.61%
2025-06-04 15:48:36,926 - train_models - INFO -   Fold 5: MAE=0.5424, RMSE=0.9369, R²=0.9243, MAPE=11.07%
2025-06-04 15:48:36,926 - train_models - INFO - Building model for WorkType: 217
2025-06-04 15:48:36,938 - train_models - INFO - Available features for 217: 34 numeric, 3 categorical
2025-06-04 15:49:27,608 - train_models - INFO - Model for 217 - MAE: 0.4205, RMSE: 0.5611, R²: 0.9081, MAPE: 17.88%
2025-06-04 15:49:27,609 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 15:49:27,609 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5728
2025-06-04 15:49:27,610 - train_models - INFO -   NoOfMan_7day_trend: 0.1203
2025-06-04 15:49:27,610 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0834
2025-06-04 15:49:27,611 - train_models - INFO -   NoOfMan_1day_trend: 0.0652
2025-06-04 15:49:27,611 - train_models - INFO -   NoOfMan_lag_1: 0.0651
2025-06-04 15:49:27,612 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0374
2025-06-04 15:49:27,612 - train_models - INFO -   NoOfMan_lag_7: 0.0238
2025-06-04 15:49:27,612 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 15:49:27,613 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0024
2025-06-04 15:49:27,613 - train_models - INFO -   NoOfMan_lag_2: 0.0015
2025-06-04 15:49:27,614 - train_models - INFO - Cross-validation details for 217:
2025-06-04 15:49:27,614 - train_models - INFO -   Fold 1: MAE=0.5836, RMSE=0.7021, R²=0.8284, MAPE=26.22%
2025-06-04 15:49:27,615 - train_models - INFO -   Fold 2: MAE=0.4375, RMSE=0.5694, R²=0.9013, MAPE=22.17%
2025-06-04 15:49:27,615 - train_models - INFO -   Fold 3: MAE=0.3764, RMSE=0.4999, R²=0.9406, MAPE=13.32%
2025-06-04 15:49:27,616 - train_models - INFO -   Fold 4: MAE=0.3239, RMSE=0.4158, R²=0.9630, MAPE=13.41%
2025-06-04 15:49:27,616 - train_models - INFO -   Fold 5: MAE=0.3814, RMSE=0.6183, R²=0.9072, MAPE=14.30%
2025-06-04 15:49:27,617 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 15:49:28,912 - train_models - INFO - Model files saved successfully
2025-06-04 15:49:28,912 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 15:49:28,913 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 15:49:28,918 - train_models - INFO - Model training completed successfully
2025-06-04 16:21:40,823 - train_models - INFO - Starting the model training process
2025-06-04 16:21:40,824 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:21:40,824 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 16:21:40,831 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 16:21:40,981 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 16:21:41,777 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 16:21:41,848 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 16:21:41,867 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 16:21:41,867 - train_models - INFO - Converting Date column to datetime format
2025-06-04 16:21:41,890 - train_models - INFO - Engineering features...
2025-06-04 16:21:43,103 - utils.feature_engineering - INFO - Engineering features
2025-06-04 16:21:43,158 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 16:21:43,166 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 16:21:43,166 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-04 16:21:43,167 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-04 16:21:43,187 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 16:21:43,549 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 16:21:43,550 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 16:21:43,572 - train_models - INFO - Found 10 unique work types
2025-06-04 16:21:43,573 - train_models - INFO - Building models for 10 work types
2025-06-04 16:21:43,574 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:21:43,574 - utils.feature_builder - INFO - Built feature set: 50 numeric, 3 categorical
2025-06-04 16:21:43,575 - train_models - INFO - Tiered feature system generated 50 numeric features and 3 categorical features
2025-06-04 16:21:43,575 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'NoOfMan_lag_90', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_90', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-04 16:21:43,576 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 16:21:43,576 - train_models - INFO - Building model for WorkType: 202
2025-06-04 16:21:43,586 - train_models - INFO - Available features for 202: 34 numeric, 3 categorical
2025-06-04 16:22:40,241 - train_models - INFO - Model for 202 - MAE: 0.2202, RMSE: 0.3380, R²: 0.7382, MAPE: 10.47%
2025-06-04 16:22:40,242 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 16:22:40,242 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3957
2025-06-04 16:22:40,243 - train_models - INFO -   NoOfMan_7day_trend: 0.1952
2025-06-04 16:22:40,243 - train_models - INFO -   NoOfMan_1day_trend: 0.1226
2025-06-04 16:22:40,244 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0670
2025-06-04 16:22:40,244 - train_models - INFO -   NoOfMan_lag_1: 0.0654
2025-06-04 16:22:40,245 - train_models - INFO -   NoOfMan_lag_7: 0.0635
2025-06-04 16:22:40,245 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0375
2025-06-04 16:22:40,246 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0124
2025-06-04 16:22:40,246 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0042
2025-06-04 16:22:40,247 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0024
2025-06-04 16:22:40,247 - train_models - INFO - Cross-validation details for 202:
2025-06-04 16:22:40,247 - train_models - INFO -   Fold 1: MAE=0.2241, RMSE=0.4172, R²=0.3900, MAPE=11.44%
2025-06-04 16:22:40,248 - train_models - INFO -   Fold 2: MAE=0.2166, RMSE=0.3107, R²=0.7776, MAPE=11.86%
2025-06-04 16:22:40,248 - train_models - INFO -   Fold 3: MAE=0.2381, RMSE=0.3748, R²=0.7814, MAPE=12.18%
2025-06-04 16:22:40,249 - train_models - INFO -   Fold 4: MAE=0.1812, RMSE=0.2370, R²=0.8857, MAPE=8.28%
2025-06-04 16:22:40,249 - train_models - INFO -   Fold 5: MAE=0.2409, RMSE=0.3501, R²=0.8564, MAPE=8.61%
2025-06-04 16:22:40,250 - train_models - INFO - Building model for WorkType: 203
2025-06-04 16:22:40,261 - train_models - INFO - Available features for 203: 34 numeric, 3 categorical
2025-06-04 16:23:38,091 - train_models - INFO - Model for 203 - MAE: 0.2340, RMSE: 0.3324, R²: 0.9098, MAPE: 4.93%
2025-06-04 16:23:38,092 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 16:23:38,092 - train_models - INFO -   NoOfMan_7day_trend: 0.3003
2025-06-04 16:23:38,093 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2339
2025-06-04 16:23:38,093 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1189
2025-06-04 16:23:38,093 - train_models - INFO -   NoOfMan_1day_trend: 0.0935
2025-06-04 16:23:38,094 - train_models - INFO -   NoOfMan_lag_7: 0.0797
2025-06-04 16:23:38,094 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0704
2025-06-04 16:23:38,095 - train_models - INFO -   NoOfMan_lag_1: 0.0559
2025-06-04 16:23:38,095 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0059
2025-06-04 16:23:38,096 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-06-04 16:23:38,096 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0029
2025-06-04 16:23:38,097 - train_models - INFO - Cross-validation details for 203:
2025-06-04 16:23:38,097 - train_models - INFO -   Fold 1: MAE=0.2960, RMSE=0.4006, R²=0.8736, MAPE=5.97%
2025-06-04 16:23:38,098 - train_models - INFO -   Fold 2: MAE=0.2598, RMSE=0.3516, R²=0.9099, MAPE=5.14%
2025-06-04 16:23:38,098 - train_models - INFO -   Fold 3: MAE=0.2463, RMSE=0.3814, R²=0.8903, MAPE=4.66%
2025-06-04 16:23:38,099 - train_models - INFO -   Fold 4: MAE=0.1900, RMSE=0.2859, R²=0.9337, MAPE=4.55%
2025-06-04 16:23:38,099 - train_models - INFO -   Fold 5: MAE=0.1780, RMSE=0.2424, R²=0.9414, MAPE=4.33%
2025-06-04 16:23:38,100 - train_models - INFO - Building model for WorkType: 206
2025-06-04 16:23:38,110 - train_models - INFO - Available features for 206: 34 numeric, 3 categorical
2025-06-04 16:24:52,741 - train_models - INFO - Model for 206 - MAE: 1.4470, RMSE: 2.1782, R²: 0.9288, MAPE: 8.26%
2025-06-04 16:24:52,742 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 16:24:52,742 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5192
2025-06-04 16:24:52,743 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1513
2025-06-04 16:24:52,743 - train_models - INFO -   NoOfMan_1day_trend: 0.0727
2025-06-04 16:24:52,744 - train_models - INFO -   DayOfWeek_feat_6: 0.0708
2025-06-04 16:24:52,744 - train_models - INFO -   NoOfMan_7day_trend: 0.0487
2025-06-04 16:24:52,745 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0370
2025-06-04 16:24:52,745 - train_models - INFO -   NoOfMan_lag_1: 0.0279
2025-06-04 16:24:52,745 - train_models - INFO -   Quantity_rolling_mean_7: 0.0082
2025-06-04 16:24:52,746 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0066
2025-06-04 16:24:52,746 - train_models - INFO -   NoOfMan_lag_7: 0.0061
2025-06-04 16:24:52,747 - train_models - INFO - Cross-validation details for 206:
2025-06-04 16:24:52,747 - train_models - INFO -   Fold 1: MAE=1.7765, RMSE=2.4267, R²=0.9199, MAPE=10.17%
2025-06-04 16:24:52,748 - train_models - INFO -   Fold 2: MAE=1.6604, RMSE=2.3366, R²=0.9226, MAPE=9.08%
2025-06-04 16:24:52,748 - train_models - INFO -   Fold 3: MAE=1.5597, RMSE=2.6862, R²=0.8918, MAPE=9.01%
2025-06-04 16:24:52,749 - train_models - INFO -   Fold 4: MAE=1.0084, RMSE=1.5186, R²=0.9565, MAPE=6.60%
2025-06-04 16:24:52,749 - train_models - INFO -   Fold 5: MAE=1.2299, RMSE=1.9230, R²=0.9534, MAPE=6.45%
2025-06-04 16:24:52,749 - train_models - INFO - Building model for WorkType: 209
2025-06-04 16:24:52,759 - train_models - INFO - Available features for 209: 34 numeric, 3 categorical
2025-06-04 16:25:54,699 - train_models - INFO - Model for 209 - MAE: 0.9080, RMSE: 1.4166, R²: 0.8844, MAPE: 12.59%
2025-06-04 16:25:54,700 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 16:25:54,700 - train_models - INFO -   NoOfMan_7day_trend: 0.3998
2025-06-04 16:25:54,701 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2192
2025-06-04 16:25:54,701 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0978
2025-06-04 16:25:54,702 - train_models - INFO -   NoOfMan_1day_trend: 0.0701
2025-06-04 16:25:54,702 - train_models - INFO -   NoOfMan_lag_7: 0.0481
2025-06-04 16:25:54,703 - train_models - INFO -   Quantity_rolling_mean_7: 0.0480
2025-06-04 16:25:54,703 - train_models - INFO -   NoOfMan_lag_1: 0.0256
2025-06-04 16:25:54,704 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0186
2025-06-04 16:25:54,704 - train_models - INFO -   Quantity_7day_trend: 0.0089
2025-06-04 16:25:54,705 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0079
2025-06-04 16:25:54,705 - train_models - INFO - Cross-validation details for 209:
2025-06-04 16:25:54,705 - train_models - INFO -   Fold 1: MAE=1.0065, RMSE=1.4879, R²=0.8520, MAPE=13.83%
2025-06-04 16:25:54,706 - train_models - INFO -   Fold 2: MAE=1.0249, RMSE=1.7401, R²=0.8439, MAPE=15.05%
2025-06-04 16:25:54,706 - train_models - INFO -   Fold 3: MAE=0.6837, RMSE=0.9099, R²=0.9351, MAPE=10.81%
2025-06-04 16:25:54,707 - train_models - INFO -   Fold 4: MAE=0.8823, RMSE=1.4639, R²=0.8908, MAPE=11.42%
2025-06-04 16:25:54,707 - train_models - INFO -   Fold 5: MAE=0.9422, RMSE=1.4811, R²=0.9002, MAPE=11.84%
2025-06-04 16:25:54,708 - train_models - INFO - Building model for WorkType: 210
2025-06-04 16:25:54,718 - train_models - INFO - Available features for 210: 34 numeric, 3 categorical
2025-06-04 16:26:58,458 - train_models - INFO - Model for 210 - MAE: 0.8247, RMSE: 1.1989, R²: 0.8863, MAPE: 18.20%
2025-06-04 16:26:58,458 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 16:26:58,459 - train_models - INFO -   NoOfMan_7day_trend: 0.2633
2025-06-04 16:26:58,459 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1928
2025-06-04 16:26:58,460 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1747
2025-06-04 16:26:58,460 - train_models - INFO -   NoOfMan_1day_trend: 0.0800
2025-06-04 16:26:58,460 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0663
2025-06-04 16:26:58,461 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-04 16:26:58,461 - train_models - INFO -   NoOfMan_lag_1: 0.0327
2025-06-04 16:26:58,462 - train_models - INFO -   DayOfWeek_feat_6: 0.0258
2025-06-04 16:26:58,462 - train_models - INFO -   Quantity_7day_trend: 0.0228
2025-06-04 16:26:58,463 - train_models - INFO -   Quantity_rolling_mean_7: 0.0132
2025-06-04 16:26:58,463 - train_models - INFO - Cross-validation details for 210:
2025-06-04 16:26:58,463 - train_models - INFO -   Fold 1: MAE=0.8139, RMSE=1.1063, R²=0.8903, MAPE=14.07%
2025-06-04 16:26:58,464 - train_models - INFO -   Fold 2: MAE=0.7314, RMSE=1.0519, R²=0.8986, MAPE=12.35%
2025-06-04 16:26:58,464 - train_models - INFO -   Fold 3: MAE=0.6452, RMSE=0.8915, R²=0.9237, MAPE=9.02%
2025-06-04 16:26:58,465 - train_models - INFO -   Fold 4: MAE=0.9301, RMSE=1.3127, R²=0.8680, MAPE=28.91%
2025-06-04 16:26:58,465 - train_models - INFO -   Fold 5: MAE=1.0028, RMSE=1.6319, R²=0.8509, MAPE=26.65%
2025-06-04 16:26:58,466 - train_models - INFO - Building model for WorkType: 211
2025-06-04 16:26:58,482 - train_models - INFO - Available features for 211: 34 numeric, 3 categorical
2025-06-04 16:28:03,881 - train_models - INFO - Model for 211 - MAE: 0.6721, RMSE: 1.0229, R²: 0.9061, MAPE: 11.36%
2025-06-04 16:28:03,882 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 16:28:03,882 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3612
2025-06-04 16:28:03,883 - train_models - INFO -   NoOfMan_1day_trend: 0.1863
2025-06-04 16:28:03,883 - train_models - INFO -   NoOfMan_7day_trend: 0.1788
2025-06-04 16:28:03,883 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0687
2025-06-04 16:28:03,884 - train_models - INFO -   NoOfMan_lag_1: 0.0470
2025-06-04 16:28:03,884 - train_models - INFO -   NoOfMan_lag_7: 0.0338
2025-06-04 16:28:03,885 - train_models - INFO -   DayOfWeek_feat_6: 0.0328
2025-06-04 16:28:03,885 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0244
2025-06-04 16:28:03,886 - train_models - INFO -   Quantity_same_dow_lag: 0.0118
2025-06-04 16:28:03,886 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0053
2025-06-04 16:28:03,887 - train_models - INFO - Cross-validation details for 211:
2025-06-04 16:28:03,887 - train_models - INFO -   Fold 1: MAE=1.1131, RMSE=1.6879, R²=0.8018, MAPE=16.52%
2025-06-04 16:28:03,888 - train_models - INFO -   Fold 2: MAE=0.6377, RMSE=1.0083, R²=0.9051, MAPE=9.99%
2025-06-04 16:28:03,888 - train_models - INFO -   Fold 3: MAE=0.5174, RMSE=0.7660, R²=0.9491, MAPE=9.38%
2025-06-04 16:28:03,888 - train_models - INFO -   Fold 4: MAE=0.5720, RMSE=0.9087, R²=0.9309, MAPE=10.43%
2025-06-04 16:28:03,889 - train_models - INFO -   Fold 5: MAE=0.5204, RMSE=0.7437, R²=0.9435, MAPE=10.47%
2025-06-04 16:28:03,889 - train_models - INFO - Building model for WorkType: 213
2025-06-04 16:28:03,900 - train_models - INFO - Available features for 213: 34 numeric, 3 categorical
2025-06-04 16:29:03,711 - train_models - INFO - Model for 213 - MAE: 0.3967, RMSE: 0.5849, R²: 0.8886, MAPE: 15.87%
2025-06-04 16:29:03,712 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 16:29:03,713 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4439
2025-06-04 16:29:03,713 - train_models - INFO -   NoOfMan_7day_trend: 0.2079
2025-06-04 16:29:03,713 - train_models - INFO -   NoOfMan_1day_trend: 0.1439
2025-06-04 16:29:03,714 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0513
2025-06-04 16:29:03,714 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-06-04 16:29:03,715 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0298
2025-06-04 16:29:03,715 - train_models - INFO -   NoOfMan_lag_7: 0.0262
2025-06-04 16:29:03,716 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0065
2025-06-04 16:29:03,716 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0048
2025-06-04 16:29:03,717 - train_models - INFO -   Combined_KPI: 0.0031
2025-06-04 16:29:03,717 - train_models - INFO - Cross-validation details for 213:
2025-06-04 16:29:03,718 - train_models - INFO -   Fold 1: MAE=0.5309, RMSE=0.7763, R²=0.8589, MAPE=15.20%
2025-06-04 16:29:03,718 - train_models - INFO -   Fold 2: MAE=0.4540, RMSE=0.6177, R²=0.8690, MAPE=24.29%
2025-06-04 16:29:03,718 - train_models - INFO -   Fold 3: MAE=0.3220, RMSE=0.5434, R²=0.8906, MAPE=14.70%
2025-06-04 16:29:03,719 - train_models - INFO -   Fold 4: MAE=0.3445, RMSE=0.4972, R²=0.9061, MAPE=13.68%
2025-06-04 16:29:03,719 - train_models - INFO -   Fold 5: MAE=0.3320, RMSE=0.4899, R²=0.9184, MAPE=11.49%
2025-06-04 16:29:03,720 - train_models - INFO - Building model for WorkType: 214
2025-06-04 16:29:03,730 - train_models - INFO - Available features for 214: 34 numeric, 3 categorical
2025-06-04 16:30:00,824 - train_models - INFO - Model for 214 - MAE: 0.4693, RMSE: 0.7039, R²: 0.8868, MAPE: 10.56%
2025-06-04 16:30:00,825 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 16:30:00,825 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5062
2025-06-04 16:30:00,825 - train_models - INFO -   NoOfMan_7day_trend: 0.1853
2025-06-04 16:30:00,826 - train_models - INFO -   NoOfMan_1day_trend: 0.0840
2025-06-04 16:30:00,826 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0648
2025-06-04 16:30:00,827 - train_models - INFO -   NoOfMan_lag_7: 0.0528
2025-06-04 16:30:00,827 - train_models - INFO -   NoOfMan_lag_1: 0.0413
2025-06-04 16:30:00,827 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-04 16:30:00,828 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0071
2025-06-04 16:30:00,828 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0064
2025-06-04 16:30:00,829 - train_models - INFO -   NoOfMan_lag_2: 0.0032
2025-06-04 16:30:00,829 - train_models - INFO - Cross-validation details for 214:
2025-06-04 16:30:00,830 - train_models - INFO -   Fold 1: MAE=0.5097, RMSE=0.6985, R²=0.8301, MAPE=13.93%
2025-06-04 16:30:00,830 - train_models - INFO -   Fold 2: MAE=0.4309, RMSE=0.5501, R²=0.9157, MAPE=10.21%
2025-06-04 16:30:00,831 - train_models - INFO -   Fold 3: MAE=0.3255, RMSE=0.4498, R²=0.9449, MAPE=9.32%
2025-06-04 16:30:00,831 - train_models - INFO -   Fold 4: MAE=0.3131, RMSE=0.5497, R²=0.9297, MAPE=5.72%
2025-06-04 16:30:00,832 - train_models - INFO -   Fold 5: MAE=0.7671, RMSE=1.2715, R²=0.8139, MAPE=13.64%
2025-06-04 16:30:00,832 - train_models - INFO - Building model for WorkType: 215
2025-06-04 16:30:00,845 - train_models - INFO - Available features for 215: 34 numeric, 3 categorical
2025-06-04 16:31:08,397 - train_models - INFO - Model for 215 - MAE: 0.6975, RMSE: 1.0822, R²: 0.8920, MAPE: 16.14%
2025-06-04 16:31:08,398 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 16:31:08,398 - train_models - INFO -   NoOfMan_7day_trend: 0.1723
2025-06-04 16:31:08,398 - train_models - INFO -   DayOfWeek_feat_6: 0.1682
2025-06-04 16:31:08,399 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1670
2025-06-04 16:31:08,399 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1431
2025-06-04 16:31:08,400 - train_models - INFO -   NoOfMan_1day_trend: 0.1295
2025-06-04 16:31:08,400 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0649
2025-06-04 16:31:08,400 - train_models - INFO -   NoOfMan_lag_1: 0.0339
2025-06-04 16:31:08,401 - train_models - INFO -   NoOfMan_lag_7: 0.0284
2025-06-04 16:31:08,401 - train_models - INFO -   Quantity_7day_trend: 0.0130
2025-06-04 16:31:08,402 - train_models - INFO -   Quantity_rolling_mean_7: 0.0100
2025-06-04 16:31:08,402 - train_models - INFO - Cross-validation details for 215:
2025-06-04 16:31:08,402 - train_models - INFO -   Fold 1: MAE=1.0100, RMSE=1.5668, R²=0.7959, MAPE=26.73%
2025-06-04 16:31:08,403 - train_models - INFO -   Fold 2: MAE=0.7162, RMSE=1.0302, R²=0.9087, MAPE=16.86%
2025-06-04 16:31:08,403 - train_models - INFO -   Fold 3: MAE=0.6822, RMSE=1.0555, R²=0.9011, MAPE=12.43%
2025-06-04 16:31:08,404 - train_models - INFO -   Fold 4: MAE=0.5365, RMSE=0.8214, R²=0.9301, MAPE=13.61%
2025-06-04 16:31:08,404 - train_models - INFO -   Fold 5: MAE=0.5424, RMSE=0.9369, R²=0.9243, MAPE=11.07%
2025-06-04 16:31:08,405 - train_models - INFO - Building model for WorkType: 217
2025-06-04 16:31:08,418 - train_models - INFO - Available features for 217: 34 numeric, 3 categorical
2025-06-04 16:31:58,539 - train_models - INFO - Model for 217 - MAE: 0.4205, RMSE: 0.5611, R²: 0.9081, MAPE: 17.88%
2025-06-04 16:31:58,539 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 16:31:58,540 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5728
2025-06-04 16:31:58,540 - train_models - INFO -   NoOfMan_7day_trend: 0.1203
2025-06-04 16:31:58,541 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0834
2025-06-04 16:31:58,541 - train_models - INFO -   NoOfMan_1day_trend: 0.0652
2025-06-04 16:31:58,542 - train_models - INFO -   NoOfMan_lag_1: 0.0651
2025-06-04 16:31:58,542 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0374
2025-06-04 16:31:58,543 - train_models - INFO -   NoOfMan_lag_7: 0.0238
2025-06-04 16:31:58,543 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-06-04 16:31:58,544 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0024
2025-06-04 16:31:58,544 - train_models - INFO -   NoOfMan_lag_2: 0.0015
2025-06-04 16:31:58,544 - train_models - INFO - Cross-validation details for 217:
2025-06-04 16:31:58,545 - train_models - INFO -   Fold 1: MAE=0.5836, RMSE=0.7021, R²=0.8284, MAPE=26.22%
2025-06-04 16:31:58,545 - train_models - INFO -   Fold 2: MAE=0.4375, RMSE=0.5694, R²=0.9013, MAPE=22.17%
2025-06-04 16:31:58,546 - train_models - INFO -   Fold 3: MAE=0.3764, RMSE=0.4999, R²=0.9406, MAPE=13.32%
2025-06-04 16:31:58,546 - train_models - INFO -   Fold 4: MAE=0.3239, RMSE=0.4158, R²=0.9630, MAPE=13.41%
2025-06-04 16:31:58,547 - train_models - INFO -   Fold 5: MAE=0.3814, RMSE=0.6183, R²=0.9072, MAPE=14.30%
2025-06-04 16:31:58,548 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 16:31:59,992 - train_models - INFO - Model files saved successfully
2025-06-04 16:31:59,992 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 16:31:59,993 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 16:31:59,998 - train_models - INFO - Model training completed successfully
2025-06-04 16:41:10,625 - train_models - INFO - Starting the model training process
2025-06-04 16:41:10,625 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:41:10,626 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 16:41:10,633 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 16:41:10,778 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 16:41:11,630 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 16:41:11,710 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 16:41:11,730 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 16:41:11,730 - train_models - INFO - Converting Date column to datetime format
2025-06-04 16:41:11,762 - train_models - INFO - Engineering features...
2025-06-04 16:41:12,942 - utils.feature_engineering - INFO - Engineering features
2025-06-04 16:41:13,000 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 16:41:13,008 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 16:41:13,008 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-04 16:41:13,009 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-04 16:41:13,027 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 16:41:13,412 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 16:41:13,412 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 16:41:13,439 - train_models - INFO - Found 10 unique work types
2025-06-04 16:41:13,439 - train_models - INFO - Building models for 10 work types
2025-06-04 16:41:13,440 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:41:13,441 - utils.feature_builder - INFO - Built feature set: 47 numeric, 3 categorical
2025-06-04 16:41:13,441 - train_models - INFO - Tiered feature system generated 47 numeric features and 3 categorical features
2025-06-04 16:41:13,442 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-04 16:41:13,442 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 16:41:13,443 - train_models - INFO - Building model for WorkType: 202
2025-06-04 16:41:13,454 - train_models - INFO - Available features for 202: 32 numeric, 3 categorical
2025-06-04 16:42:11,027 - train_models - INFO - Starting the model training process
2025-06-04 16:42:11,028 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:42:11,028 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 16:42:11,038 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 16:42:11,181 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 16:42:11,901 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 16:42:11,969 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 16:42:11,989 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 16:42:11,989 - train_models - INFO - Converting Date column to datetime format
2025-06-04 16:42:12,014 - train_models - INFO - Engineering features...
2025-06-04 16:42:12,907 - utils.feature_engineering - INFO - Engineering features
2025-06-04 16:42:12,969 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 16:42:12,977 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 16:42:12,977 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-04 16:42:12,978 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-04 16:42:13,000 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 16:42:13,400 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 16:42:13,400 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-04 16:42:13,426 - train_models - INFO - Found 10 unique work types
2025-06-04 16:42:13,426 - train_models - INFO - Building models for 10 work types
2025-06-04 16:42:13,427 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-04 16:42:13,427 - utils.feature_builder - INFO - Built feature set: 47 numeric, 3 categorical
2025-06-04 16:42:13,428 - train_models - INFO - Tiered feature system generated 47 numeric features and 3 categorical features
2025-06-04 16:42:13,428 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-04 16:42:13,429 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 16:42:13,431 - train_models - INFO - Building model for WorkType: 202
2025-06-04 16:42:13,441 - train_models - INFO - Available features for 202: 32 numeric, 3 categorical
2025-06-04 16:43:10,397 - train_models - INFO - Model for 202 - MAE: 0.2191, RMSE: 0.3372, R²: 0.7389, MAPE: 10.41%
2025-06-04 16:43:10,398 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 16:43:10,398 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3961
2025-06-04 16:43:10,399 - train_models - INFO -   NoOfMan_7day_trend: 0.1952
2025-06-04 16:43:10,399 - train_models - INFO -   NoOfMan_1day_trend: 0.1230
2025-06-04 16:43:10,399 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0671
2025-06-04 16:43:10,400 - train_models - INFO -   NoOfMan_lag_1: 0.0655
2025-06-04 16:43:10,400 - train_models - INFO -   NoOfMan_lag_7: 0.0638
2025-06-04 16:43:10,400 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0375
2025-06-04 16:43:10,401 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0124
2025-06-04 16:43:10,401 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0044
2025-06-04 16:43:10,402 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0026
2025-06-04 16:43:10,402 - train_models - INFO - Cross-validation details for 202:
2025-06-04 16:43:10,403 - train_models - INFO -   Fold 1: MAE=0.2229, RMSE=0.4187, R²=0.3854, MAPE=11.36%
2025-06-04 16:43:10,403 - train_models - INFO -   Fold 2: MAE=0.2107, RMSE=0.3038, R²=0.7874, MAPE=11.54%
2025-06-04 16:43:10,404 - train_models - INFO -   Fold 3: MAE=0.2382, RMSE=0.3754, R²=0.7806, MAPE=12.14%
2025-06-04 16:43:10,404 - train_models - INFO -   Fold 4: MAE=0.1833, RMSE=0.2392, R²=0.8836, MAPE=8.38%
2025-06-04 16:43:10,405 - train_models - INFO -   Fold 5: MAE=0.2403, RMSE=0.3489, R²=0.8574, MAPE=8.62%
2025-06-04 16:43:10,405 - train_models - INFO - Building model for WorkType: 203
2025-06-04 16:43:10,414 - train_models - INFO - Available features for 203: 32 numeric, 3 categorical
2025-06-04 16:43:54,992 - train_models - INFO - Starting the model training process
2025-06-04 16:43:54,992 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-04 16:43:54,993 - train_models - INFO - Training from SQL database (command line argument)
2025-06-04 16:43:55,000 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-04 16:43:55,140 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-04 16:43:55,934 - train_models - INFO - Read chunk of 10000 rows
2025-06-04 16:43:56,006 - train_models - INFO - Read chunk of 5326 rows
2025-06-04 16:43:56,025 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-04 16:43:56,025 - train_models - INFO - Converting Date column to datetime format
2025-06-04 16:43:56,048 - train_models - INFO - Engineering features...
2025-06-04 16:43:57,038 - utils.feature_engineering - INFO - Engineering features
2025-06-04 16:43:57,095 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-04 16:43:57,103 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-04 16:43:57,103 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-04 16:43:57,104 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-04 16:43:57,125 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-04 16:43:57,434 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-04 16:43:57,434 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-04 16:43:57,456 - train_models - INFO - Found 10 unique work types
2025-06-04 16:43:57,456 - train_models - INFO - Building models for 10 work types
2025-06-04 16:43:57,457 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-04 16:43:57,457 - utils.feature_builder - INFO - Built feature set: 20 numeric, 3 categorical
2025-06-04 16:43:57,458 - train_models - INFO - Tiered feature system generated 20 numeric features and 3 categorical features
2025-06-04 16:43:57,458 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-04 16:43:57,459 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-04 16:43:57,459 - train_models - INFO - Building model for WorkType: 202
2025-06-04 16:43:57,470 - train_models - INFO - Available features for 202: 20 numeric, 3 categorical
2025-06-04 16:44:29,622 - train_models - INFO - Model for 202 - MAE: 0.1994, RMSE: 0.3121, R²: 0.7815, MAPE: 9.60%
2025-06-04 16:44:29,623 - train_models - INFO - Top 10 most important features for 202:
2025-06-04 16:44:29,623 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3950
2025-06-04 16:44:29,623 - train_models - INFO -   NoOfMan_7day_trend: 0.2006
2025-06-04 16:44:29,624 - train_models - INFO -   NoOfMan_1day_trend: 0.1286
2025-06-04 16:44:29,624 - train_models - INFO -   NoOfMan_lag_1: 0.0694
2025-06-04 16:44:29,625 - train_models - INFO -   NoOfMan_lag_7: 0.0669
2025-06-04 16:44:29,625 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0660
2025-06-04 16:44:29,625 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0387
2025-06-04 16:44:29,626 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-04 16:44:29,626 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-04 16:44:29,627 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0029
2025-06-04 16:44:29,627 - train_models - INFO - Cross-validation details for 202:
2025-06-04 16:44:29,628 - train_models - INFO -   Fold 1: MAE=0.1935, RMSE=0.3645, R²=0.5342, MAPE=9.99%
2025-06-04 16:44:29,628 - train_models - INFO -   Fold 2: MAE=0.1949, RMSE=0.3088, R²=0.7804, MAPE=10.82%
2025-06-04 16:44:29,629 - train_models - INFO -   Fold 3: MAE=0.2210, RMSE=0.3474, R²=0.8122, MAPE=11.31%
2025-06-04 16:44:29,629 - train_models - INFO -   Fold 4: MAE=0.1749, RMSE=0.2254, R²=0.8966, MAPE=8.06%
2025-06-04 16:44:29,630 - train_models - INFO -   Fold 5: MAE=0.2125, RMSE=0.3145, R²=0.8842, MAPE=7.80%
2025-06-04 16:44:29,630 - train_models - INFO - Building model for WorkType: 203
2025-06-04 16:44:29,640 - train_models - INFO - Available features for 203: 20 numeric, 3 categorical
2025-06-04 16:45:06,823 - train_models - INFO - Model for 203 - MAE: 0.2196, RMSE: 0.3163, R²: 0.9181, MAPE: 4.56%
2025-06-04 16:45:06,823 - train_models - INFO - Top 10 most important features for 203:
2025-06-04 16:45:06,824 - train_models - INFO -   NoOfMan_7day_trend: 0.3026
2025-06-04 16:45:06,824 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2339
2025-06-04 16:45:06,825 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1189
2025-06-04 16:45:06,825 - train_models - INFO -   NoOfMan_1day_trend: 0.0951
2025-06-04 16:45:06,826 - train_models - INFO -   NoOfMan_lag_7: 0.0815
2025-06-04 16:45:06,826 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0718
2025-06-04 16:45:06,827 - train_models - INFO -   NoOfMan_lag_1: 0.0571
2025-06-04 16:45:06,827 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0066
2025-06-04 16:45:06,828 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 16:45:06,828 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0032
2025-06-04 16:45:06,829 - train_models - INFO - Cross-validation details for 203:
2025-06-04 16:45:06,829 - train_models - INFO -   Fold 1: MAE=0.2765, RMSE=0.3792, R²=0.8867, MAPE=5.49%
2025-06-04 16:45:06,829 - train_models - INFO -   Fold 2: MAE=0.2417, RMSE=0.3329, R²=0.9193, MAPE=4.75%
2025-06-04 16:45:06,830 - train_models - INFO -   Fold 3: MAE=0.2303, RMSE=0.3724, R²=0.8955, MAPE=4.25%
2025-06-04 16:45:06,830 - train_models - INFO -   Fold 4: MAE=0.1754, RMSE=0.2616, R²=0.9445, MAPE=4.09%
2025-06-04 16:45:06,831 - train_models - INFO -   Fold 5: MAE=0.1741, RMSE=0.2352, R²=0.9448, MAPE=4.21%
2025-06-04 16:45:06,831 - train_models - INFO - Building model for WorkType: 206
2025-06-04 16:45:06,842 - train_models - INFO - Available features for 206: 20 numeric, 3 categorical
2025-06-04 16:45:56,483 - train_models - INFO - Model for 206 - MAE: 1.3311, RMSE: 2.0363, R²: 0.9376, MAPE: 7.60%
2025-06-04 16:45:56,483 - train_models - INFO - Top 10 most important features for 206:
2025-06-04 16:45:56,484 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5223
2025-06-04 16:45:56,484 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1557
2025-06-04 16:45:56,485 - train_models - INFO -   NoOfMan_1day_trend: 0.0763
2025-06-04 16:45:56,485 - train_models - INFO -   DayOfWeek_feat_6: 0.0713
2025-06-04 16:45:56,486 - train_models - INFO -   NoOfMan_7day_trend: 0.0534
2025-06-04 16:45:56,486 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0375
2025-06-04 16:45:56,487 - train_models - INFO -   NoOfMan_lag_1: 0.0307
2025-06-04 16:45:56,487 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0077
2025-06-04 16:45:56,488 - train_models - INFO -   NoOfMan_lag_7: 0.0077
2025-06-04 16:45:56,488 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-04 16:45:56,488 - train_models - INFO - Cross-validation details for 206:
2025-06-04 16:45:56,489 - train_models - INFO -   Fold 1: MAE=1.6898, RMSE=2.3204, R²=0.9268, MAPE=9.50%
2025-06-04 16:45:56,489 - train_models - INFO -   Fold 2: MAE=1.4958, RMSE=2.1396, R²=0.9351, MAPE=8.30%
2025-06-04 16:45:56,490 - train_models - INFO -   Fold 3: MAE=1.4572, RMSE=2.5441, R²=0.9030, MAPE=8.37%
2025-06-04 16:45:56,490 - train_models - INFO -   Fold 4: MAE=0.9016, RMSE=1.4185, R²=0.9620, MAPE=6.09%
2025-06-04 16:45:56,491 - train_models - INFO -   Fold 5: MAE=1.1109, RMSE=1.7587, R²=0.9610, MAPE=5.73%
2025-06-04 16:45:56,491 - train_models - INFO - Building model for WorkType: 209
2025-06-04 16:45:56,504 - train_models - INFO - Available features for 209: 20 numeric, 3 categorical
2025-06-04 16:46:53,745 - train_models - INFO - Model for 209 - MAE: 0.8440, RMSE: 1.3160, R²: 0.9010, MAPE: 11.65%
2025-06-04 16:46:53,746 - train_models - INFO - Top 10 most important features for 209:
2025-06-04 16:46:53,747 - train_models - INFO -   NoOfMan_7day_trend: 0.4156
2025-06-04 16:46:53,747 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2547
2025-06-04 16:46:53,748 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0992
2025-06-04 16:46:53,748 - train_models - INFO -   NoOfMan_1day_trend: 0.0722
2025-06-04 16:46:53,749 - train_models - INFO -   NoOfMan_lag_7: 0.0548
2025-06-04 16:46:53,749 - train_models - INFO -   NoOfMan_lag_1: 0.0312
2025-06-04 16:46:53,750 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0202
2025-06-04 16:46:53,750 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0100
2025-06-04 16:46:53,751 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0095
2025-06-04 16:46:53,751 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0042
2025-06-04 16:46:53,752 - train_models - INFO - Cross-validation details for 209:
2025-06-04 16:46:53,752 - train_models - INFO -   Fold 1: MAE=0.9462, RMSE=1.3696, R²=0.8746, MAPE=13.21%
2025-06-04 16:46:53,753 - train_models - INFO -   Fold 2: MAE=0.8931, RMSE=1.5007, R²=0.8839, MAPE=13.40%
2025-06-04 16:46:53,753 - train_models - INFO -   Fold 3: MAE=0.6477, RMSE=0.8762, R²=0.9398, MAPE=10.18%
2025-06-04 16:46:53,754 - train_models - INFO -   Fold 4: MAE=0.8316, RMSE=1.3936, R²=0.9010, MAPE=10.62%
2025-06-04 16:46:53,754 - train_models - INFO -   Fold 5: MAE=0.9013, RMSE=1.4399, R²=0.9057, MAPE=10.83%
2025-06-04 16:46:53,755 - train_models - INFO - Building model for WorkType: 210
2025-06-04 16:46:53,764 - train_models - INFO - Available features for 210: 20 numeric, 3 categorical
2025-06-04 16:47:38,972 - train_models - INFO - Model for 210 - MAE: 0.7875, RMSE: 1.1560, R²: 0.8943, MAPE: 17.05%
2025-06-04 16:47:38,972 - train_models - INFO - Top 10 most important features for 210:
2025-06-04 16:47:38,973 - train_models - INFO -   NoOfMan_7day_trend: 0.2821
2025-06-04 16:47:38,973 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1973
2025-06-04 16:47:38,974 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1848
2025-06-04 16:47:38,975 - train_models - INFO -   NoOfMan_1day_trend: 0.0872
2025-06-04 16:47:38,975 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0667
2025-06-04 16:47:38,975 - train_models - INFO -   NoOfMan_lag_7: 0.0489
2025-06-04 16:47:38,976 - train_models - INFO -   NoOfMan_lag_1: 0.0402
2025-06-04 16:47:38,976 - train_models - INFO -   DayOfWeek_feat_6: 0.0270
2025-06-04 16:47:38,977 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0122
2025-06-04 16:47:38,977 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0087
2025-06-04 16:47:38,978 - train_models - INFO - Cross-validation details for 210:
2025-06-04 16:47:38,978 - train_models - INFO -   Fold 1: MAE=0.7734, RMSE=1.0522, R²=0.9007, MAPE=13.28%
2025-06-04 16:47:38,979 - train_models - INFO -   Fold 2: MAE=0.6763, RMSE=1.0094, R²=0.9066, MAPE=11.24%
2025-06-04 16:47:38,980 - train_models - INFO -   Fold 3: MAE=0.6152, RMSE=0.8609, R²=0.9289, MAPE=8.51%
2025-06-04 16:47:38,980 - train_models - INFO -   Fold 4: MAE=0.9194, RMSE=1.2829, R²=0.8740, MAPE=27.62%
2025-06-04 16:47:38,981 - train_models - INFO -   Fold 5: MAE=0.9529, RMSE=1.5748, R²=0.8612, MAPE=24.60%
2025-06-04 16:47:38,981 - train_models - INFO - Building model for WorkType: 211
2025-06-04 16:47:38,993 - train_models - INFO - Available features for 211: 20 numeric, 3 categorical
2025-06-04 16:48:24,598 - train_models - INFO - Model for 211 - MAE: 0.6178, RMSE: 0.9684, R²: 0.9147, MAPE: 10.51%
2025-06-04 16:48:24,599 - train_models - INFO - Top 10 most important features for 211:
2025-06-04 16:48:24,600 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3609
2025-06-04 16:48:24,600 - train_models - INFO -   NoOfMan_1day_trend: 0.1891
2025-06-04 16:48:24,601 - train_models - INFO -   NoOfMan_7day_trend: 0.1827
2025-06-04 16:48:24,601 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0700
2025-06-04 16:48:24,602 - train_models - INFO -   NoOfMan_lag_1: 0.0504
2025-06-04 16:48:24,602 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-04 16:48:24,603 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0345
2025-06-04 16:48:24,603 - train_models - INFO -   DayOfWeek_feat_6: 0.0333
2025-06-04 16:48:24,604 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0063
2025-06-04 16:48:24,604 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0054
2025-06-04 16:48:24,605 - train_models - INFO - Cross-validation details for 211:
2025-06-04 16:48:24,605 - train_models - INFO -   Fold 1: MAE=1.0591, RMSE=1.6452, R²=0.8117, MAPE=16.03%
2025-06-04 16:48:24,606 - train_models - INFO -   Fold 2: MAE=0.5979, RMSE=0.9677, R²=0.9126, MAPE=9.75%
2025-06-04 16:48:24,606 - train_models - INFO -   Fold 3: MAE=0.4442, RMSE=0.6838, R²=0.9594, MAPE=7.96%
2025-06-04 16:48:24,607 - train_models - INFO -   Fold 4: MAE=0.5550, RMSE=0.9015, R²=0.9320, MAPE=10.28%
2025-06-04 16:48:24,608 - train_models - INFO -   Fold 5: MAE=0.4328, RMSE=0.6438, R²=0.9577, MAPE=8.51%
2025-06-04 16:48:24,608 - train_models - INFO - Building model for WorkType: 213
2025-06-04 16:48:24,618 - train_models - INFO - Available features for 213: 20 numeric, 3 categorical
2025-06-04 16:49:06,002 - train_models - INFO - Model for 213 - MAE: 0.3792, RMSE: 0.5646, R²: 0.8962, MAPE: 15.17%
2025-06-04 16:49:06,002 - train_models - INFO - Top 10 most important features for 213:
2025-06-04 16:49:06,003 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4437
2025-06-04 16:49:06,003 - train_models - INFO -   NoOfMan_7day_trend: 0.2092
2025-06-04 16:49:06,004 - train_models - INFO -   NoOfMan_1day_trend: 0.1461
2025-06-04 16:49:06,004 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0521
2025-06-04 16:49:06,005 - train_models - INFO -   NoOfMan_lag_1: 0.0488
2025-06-04 16:49:06,005 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0304
2025-06-04 16:49:06,006 - train_models - INFO -   NoOfMan_lag_7: 0.0275
2025-06-04 16:49:06,006 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0068
2025-06-04 16:49:06,007 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0055
2025-06-04 16:49:06,007 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0043
2025-06-04 16:49:06,008 - train_models - INFO - Cross-validation details for 213:
2025-06-04 16:49:06,008 - train_models - INFO -   Fold 1: MAE=0.5099, RMSE=0.7556, R²=0.8663, MAPE=14.43%
2025-06-04 16:49:06,009 - train_models - INFO -   Fold 2: MAE=0.4395, RMSE=0.6041, R²=0.8748, MAPE=23.64%
2025-06-04 16:49:06,009 - train_models - INFO -   Fold 3: MAE=0.3093, RMSE=0.5152, R²=0.9016, MAPE=14.47%
2025-06-04 16:49:06,010 - train_models - INFO -   Fold 4: MAE=0.3230, RMSE=0.4732, R²=0.9149, MAPE=12.82%
2025-06-04 16:49:06,010 - train_models - INFO -   Fold 5: MAE=0.3141, RMSE=0.4748, R²=0.9233, MAPE=10.49%
2025-06-04 16:49:06,011 - train_models - INFO - Building model for WorkType: 214
2025-06-04 16:49:06,023 - train_models - INFO - Available features for 214: 20 numeric, 3 categorical
2025-06-04 16:49:46,502 - train_models - INFO - Model for 214 - MAE: 0.4451, RMSE: 0.6755, R²: 0.8956, MAPE: 9.93%
2025-06-04 16:49:46,502 - train_models - INFO - Top 10 most important features for 214:
2025-06-04 16:49:46,503 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5041
2025-06-04 16:49:46,503 - train_models - INFO -   NoOfMan_7day_trend: 0.1879
2025-06-04 16:49:46,504 - train_models - INFO -   NoOfMan_1day_trend: 0.0859
2025-06-04 16:49:46,504 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0651
2025-06-04 16:49:46,505 - train_models - INFO -   NoOfMan_lag_7: 0.0545
2025-06-04 16:49:46,506 - train_models - INFO -   NoOfMan_lag_1: 0.0428
2025-06-04 16:49:46,506 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0123
2025-06-04 16:49:46,507 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0078
2025-06-04 16:49:46,507 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0070
2025-06-04 16:49:46,507 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0066
2025-06-04 16:49:46,508 - train_models - INFO - Cross-validation details for 214:
2025-06-04 16:49:46,508 - train_models - INFO -   Fold 1: MAE=0.4876, RMSE=0.6749, R²=0.8413, MAPE=13.28%
2025-06-04 16:49:46,509 - train_models - INFO -   Fold 2: MAE=0.4041, RMSE=0.5187, R²=0.9251, MAPE=9.50%
2025-06-04 16:49:46,509 - train_models - INFO -   Fold 3: MAE=0.3057, RMSE=0.4249, R²=0.9508, MAPE=8.82%
2025-06-04 16:49:46,510 - train_models - INFO -   Fold 4: MAE=0.2955, RMSE=0.5268, R²=0.9354, MAPE=5.33%
2025-06-04 16:49:46,510 - train_models - INFO -   Fold 5: MAE=0.7327, RMSE=1.2320, R²=0.8252, MAPE=12.72%
2025-06-04 16:49:46,511 - train_models - INFO - Building model for WorkType: 215
2025-06-04 16:49:46,520 - train_models - INFO - Available features for 215: 20 numeric, 3 categorical
2025-06-04 16:50:31,876 - train_models - INFO - Model for 215 - MAE: 0.6410, RMSE: 1.0262, R²: 0.9029, MAPE: 14.75%
2025-06-04 16:50:31,876 - train_models - INFO - Top 10 most important features for 215:
2025-06-04 16:50:31,877 - train_models - INFO -   NoOfMan_7day_trend: 0.1838
2025-06-04 16:50:31,877 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1701
2025-06-04 16:50:31,878 - train_models - INFO -   DayOfWeek_feat_6: 0.1683
2025-06-04 16:50:31,879 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1486
2025-06-04 16:50:31,879 - train_models - INFO -   NoOfMan_1day_trend: 0.1347
2025-06-04 16:50:31,880 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0661
2025-06-04 16:50:31,880 - train_models - INFO -   NoOfMan_lag_1: 0.0414
2025-06-04 16:50:31,881 - train_models - INFO -   NoOfMan_lag_7: 0.0344
2025-06-04 16:50:31,881 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0076
2025-06-04 16:50:31,881 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0075
2025-06-04 16:50:31,882 - train_models - INFO - Cross-validation details for 215:
2025-06-04 16:50:31,882 - train_models - INFO -   Fold 1: MAE=0.9248, RMSE=1.4769, R²=0.8187, MAPE=25.18%
2025-06-04 16:50:31,883 - train_models - INFO -   Fold 2: MAE=0.6762, RMSE=1.0134, R²=0.9116, MAPE=15.30%
2025-06-04 16:50:31,884 - train_models - INFO -   Fold 3: MAE=0.6348, RMSE=1.0167, R²=0.9082, MAPE=11.31%
2025-06-04 16:50:31,884 - train_models - INFO -   Fold 4: MAE=0.4718, RMSE=0.7444, R²=0.9426, MAPE=11.88%
2025-06-04 16:50:31,885 - train_models - INFO -   Fold 5: MAE=0.4972, RMSE=0.8794, R²=0.9333, MAPE=10.06%
2025-06-04 16:50:31,885 - train_models - INFO - Building model for WorkType: 217
2025-06-04 16:50:31,897 - train_models - INFO - Available features for 217: 20 numeric, 3 categorical
2025-06-04 16:51:06,133 - train_models - INFO - Model for 217 - MAE: 0.3966, RMSE: 0.5342, R²: 0.9154, MAPE: 16.70%
2025-06-04 16:51:06,134 - train_models - INFO - Top 10 most important features for 217:
2025-06-04 16:51:06,134 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5719
2025-06-04 16:51:06,135 - train_models - INFO -   NoOfMan_7day_trend: 0.1215
2025-06-04 16:51:06,135 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0836
2025-06-04 16:51:06,136 - train_models - INFO -   NoOfMan_1day_trend: 0.0669
2025-06-04 16:51:06,136 - train_models - INFO -   NoOfMan_lag_1: 0.0666
2025-06-04 16:51:06,137 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0377
2025-06-04 16:51:06,137 - train_models - INFO -   NoOfMan_lag_7: 0.0246
2025-06-04 16:51:06,138 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-06-04 16:51:06,139 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0042
2025-06-04 16:51:06,139 - train_models - INFO -   NoOfMan_lag_3: 0.0023
2025-06-04 16:51:06,140 - train_models - INFO - Cross-validation details for 217:
2025-06-04 16:51:06,140 - train_models - INFO -   Fold 1: MAE=0.5753, RMSE=0.6987, R²=0.8301, MAPE=25.24%
2025-06-04 16:51:06,141 - train_models - INFO -   Fold 2: MAE=0.4049, RMSE=0.5321, R²=0.9138, MAPE=20.23%
2025-06-04 16:51:06,141 - train_models - INFO -   Fold 3: MAE=0.3488, RMSE=0.4677, R²=0.9481, MAPE=12.47%
2025-06-04 16:51:06,142 - train_models - INFO -   Fold 4: MAE=0.3061, RMSE=0.3901, R²=0.9674, MAPE=12.66%
2025-06-04 16:51:06,142 - train_models - INFO -   Fold 5: MAE=0.3482, RMSE=0.5825, R²=0.9177, MAPE=12.92%
2025-06-04 16:51:06,144 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-04 16:51:07,563 - train_models - INFO - Model files saved successfully
2025-06-04 16:51:07,563 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-04 16:51:07,564 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-04 16:51:07,571 - train_models - INFO - Model training completed successfully
2025-06-05 11:05:17,040 - train_models - INFO - Starting the model training process
2025-06-05 11:05:17,041 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-05 11:05:17,041 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 11:05:17,060 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 11:05:17,474 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 11:05:19,618 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 11:05:20,012 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 11:05:20,071 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 11:05:20,072 - train_models - INFO - Converting Date column to datetime format
2025-06-05 11:05:20,112 - train_models - INFO - Engineering features...
2025-06-05 11:05:21,298 - utils.feature_engineering - INFO - Engineering features
2025-06-05 11:05:21,370 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 11:05:21,379 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 11:05:21,379 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-05 11:05:21,380 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-05 11:05:21,401 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 11:05:21,764 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 11:05:21,765 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-05 11:05:21,788 - train_models - INFO - Found 10 unique work types
2025-06-05 11:05:21,789 - train_models - INFO - Building models for 10 work types
2025-06-05 11:05:21,789 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-05 11:05:21,790 - utils.feature_builder - INFO - Built feature set: 20 numeric, 3 categorical
2025-06-05 11:05:21,790 - train_models - INFO - Tiered feature system generated 20 numeric features and 3 categorical features
2025-06-05 11:05:21,791 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-05 11:05:21,791 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-05 11:05:21,792 - train_models - INFO - Building model for WorkType: 202
2025-06-05 11:05:21,803 - train_models - INFO - Available features for 202: 20 numeric, 3 categorical
2025-06-05 11:06:04,707 - train_models - INFO - Starting the model training process
2025-06-05 11:06:04,737 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-05 11:06:04,751 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 11:06:04,787 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 11:06:05,249 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 11:06:07,499 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 11:06:07,643 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 11:06:07,696 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 11:06:07,701 - train_models - INFO - Converting Date column to datetime format
2025-06-05 11:06:07,740 - train_models - INFO - Engineering features...
2025-06-05 11:06:11,254 - utils.feature_engineering - INFO - Engineering features
2025-06-05 11:06:11,409 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 11:06:11,443 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 11:06:11,447 - train_models - INFO - Using lag days: [1, 2, 7, 28, 365]
2025-06-05 11:06:11,452 - train_models - INFO - Using rolling windows: [7, 21, 30, 90]
2025-06-05 11:06:11,516 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 11:06:12,895 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 11:06:12,925 - utils.feature_engineering - INFO - Final shape: (15326, 69)
2025-06-05 11:06:13,134 - train_models - INFO - Found 10 unique work types
2025-06-05 11:06:13,255 - train_models - INFO - Building models for 10 work types
2025-06-05 11:06:13,358 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE', 'ADVANCED']
2025-06-05 11:06:13,419 - utils.feature_builder - INFO - Built feature set: 50 numeric, 3 categorical
2025-06-05 11:06:13,690 - train_models - INFO - Tiered feature system generated 50 numeric features and 3 categorical features
2025-06-05 11:06:13,783 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'DayOfYear', 'NoOfMan_lag_90', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_90', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_lag_30', 'Hours_lag_1', 'Hours_lag_7', 'SystemHours_lag_1', 'SystemHours_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'SystemKPI_lag_7', 'Quantity_rolling_mean_7', 'Quantity_rolling_mean_30', 'Hours_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Combined_KPI', 'Workers_Predicted_from_Quantity', 'Quantity_same_dow_lag', 'Quantity_7day_trend', 'Hours_7day_trend', 'Workload_Intensity', 'Seasonal_Factor', 'Capacity_Utilization']
2025-06-05 11:06:13,827 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-05 11:06:13,883 - train_models - INFO - Building model for WorkType: 202
2025-06-05 11:06:13,956 - train_models - INFO - Available features for 202: 34 numeric, 3 categorical
2025-06-05 11:24:49,183 - train_models - INFO - Starting the model training process
2025-06-05 11:24:49,184 - train_models - INFO - Feature tiers enabled: ['BASIC']
2025-06-05 11:24:49,184 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 11:24:49,191 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 11:24:49,475 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 11:24:50,267 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 11:24:50,365 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 11:24:50,414 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 11:24:50,442 - train_models - INFO - Converting Date column to datetime format
2025-06-05 11:24:50,482 - train_models - INFO - Engineering features...
2025-06-05 11:24:51,671 - utils.feature_engineering - INFO - Engineering features
2025-06-05 11:24:51,733 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 11:24:51,742 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 11:24:51,743 - train_models - INFO - Using lag days: [1, 7]
2025-06-05 11:24:51,744 - train_models - INFO - Using rolling windows: [7]
2025-06-05 11:24:51,764 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 11:24:51,957 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 11:24:51,958 - utils.feature_engineering - INFO - Final shape: (15326, 48)
2025-06-05 11:24:51,975 - train_models - INFO - Found 10 unique work types
2025-06-05 11:24:51,976 - train_models - INFO - Building models for 10 work types
2025-06-05 11:24:51,976 - train_models - INFO - Using feature tiers: ['BASIC']
2025-06-05 11:24:51,977 - utils.feature_builder - INFO - Built feature set: 8 numeric, 2 categorical
2025-06-05 11:24:51,977 - train_models - INFO - Tiered feature system generated 8 numeric features and 2 categorical features
2025-06-05 11:24:51,978 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7']
2025-06-05 11:24:51,978 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-05 11:24:51,979 - train_models - INFO - Building model for WorkType: 202
2025-06-05 11:24:51,988 - train_models - INFO - Available features for 202: 8 numeric, 2 categorical
2025-06-05 11:25:10,757 - train_models - INFO - Model for 202 - MAE: 0.4716, RMSE: 0.6044, R²: 0.2946, MAPE: 25.22%
2025-06-05 11:25:10,770 - train_models - INFO - Top 10 most important features for 202:
2025-06-05 11:25:10,770 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5862
2025-06-05 11:25:10,771 - train_models - INFO -   NoOfMan_lag_1: 0.0845
2025-06-05 11:25:10,771 - train_models - INFO -   Quantity_lag_7: 0.0603
2025-06-05 11:25:10,772 - train_models - INFO -   Quantity_rolling_mean_7: 0.0544
2025-06-05 11:25:10,772 - train_models - INFO -   NoOfMan_lag_7: 0.0472
2025-06-05 11:25:10,773 - train_models - INFO -   Quantity_lag_1: 0.0441
2025-06-05 11:25:10,773 - train_models - INFO -   ResourceKPI_lag_1: 0.0424
2025-06-05 11:25:10,773 - train_models - INFO -   DayOfWeek_feat_4: 0.0144
2025-06-05 11:25:10,774 - train_models - INFO -   DayOfWeek_feat_0: 0.0066
2025-06-05 11:25:10,774 - train_models - INFO -   DayOfWeek_feat_1: 0.0064
2025-06-05 11:25:10,775 - train_models - INFO - Cross-validation details for 202:
2025-06-05 11:25:10,775 - train_models - INFO -   Fold 1: MAE=0.3179, RMSE=0.4607, R²=0.2562, MAPE=19.81%
2025-06-05 11:25:10,776 - train_models - INFO -   Fold 2: MAE=0.4039, RMSE=0.5114, R²=0.3976, MAPE=24.88%
2025-06-05 11:25:10,776 - train_models - INFO -   Fold 3: MAE=0.5192, RMSE=0.6730, R²=0.2951, MAPE=30.55%
2025-06-05 11:25:10,777 - train_models - INFO -   Fold 4: MAE=0.5238, RMSE=0.6473, R²=0.1474, MAPE=25.79%
2025-06-05 11:25:10,777 - train_models - INFO -   Fold 5: MAE=0.5932, RMSE=0.7297, R²=0.3766, MAPE=25.05%
2025-06-05 11:25:10,778 - train_models - INFO - Building model for WorkType: 203
2025-06-05 11:25:10,786 - train_models - INFO - Available features for 203: 8 numeric, 2 categorical
2025-06-05 11:25:30,619 - train_models - INFO - Model for 203 - MAE: 0.6689, RMSE: 0.8810, R²: 0.3709, MAPE: 13.95%
2025-06-05 11:25:30,619 - train_models - INFO - Top 10 most important features for 203:
2025-06-05 11:25:30,620 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4841
2025-06-05 11:25:30,620 - train_models - INFO -   NoOfMan_lag_1: 0.1557
2025-06-05 11:25:30,621 - train_models - INFO -   Quantity_lag_7: 0.0623
2025-06-05 11:25:30,621 - train_models - INFO -   NoOfMan_lag_7: 0.0600
2025-06-05 11:25:30,622 - train_models - INFO -   Quantity_rolling_mean_7: 0.0599
2025-06-05 11:25:30,622 - train_models - INFO -   Quantity_lag_1: 0.0428
2025-06-05 11:25:30,623 - train_models - INFO -   ResourceKPI_lag_1: 0.0386
2025-06-05 11:25:30,623 - train_models - INFO -   DayOfWeek_feat_4: 0.0157
2025-06-05 11:25:30,624 - train_models - INFO -   DayOfWeek_feat_0: 0.0115
2025-06-05 11:25:30,624 - train_models - INFO -   DayOfWeek_feat_1: 0.0088
2025-06-05 11:25:30,625 - train_models - INFO - Cross-validation details for 203:
2025-06-05 11:25:30,625 - train_models - INFO -   Fold 1: MAE=0.6413, RMSE=0.8413, R²=0.4424, MAPE=12.60%
2025-06-05 11:25:30,626 - train_models - INFO -   Fold 2: MAE=0.6789, RMSE=0.9185, R²=0.3854, MAPE=13.49%
2025-06-05 11:25:30,626 - train_models - INFO -   Fold 3: MAE=0.7154, RMSE=0.9432, R²=0.3295, MAPE=14.00%
2025-06-05 11:25:30,627 - train_models - INFO -   Fold 4: MAE=0.6826, RMSE=0.8783, R²=0.3737, MAPE=15.00%
2025-06-05 11:25:30,627 - train_models - INFO -   Fold 5: MAE=0.6261, RMSE=0.8236, R²=0.3233, MAPE=14.67%
2025-06-05 11:25:30,628 - train_models - INFO - Building model for WorkType: 206
2025-06-05 11:25:30,636 - train_models - INFO - Available features for 206: 8 numeric, 2 categorical
2025-06-05 11:25:55,654 - train_models - INFO - Model for 206 - MAE: 2.2907, RMSE: 3.2909, R²: 0.8385, MAPE: 13.84%
2025-06-05 11:25:55,655 - train_models - INFO - Top 10 most important features for 206:
2025-06-05 11:25:55,655 - train_models - INFO -   DayOfWeek_feat_6: 0.3994
2025-06-05 11:25:55,656 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3174
2025-06-05 11:25:55,656 - train_models - INFO -   DayOfWeek_feat_4: 0.1121
2025-06-05 11:25:55,657 - train_models - INFO -   Quantity_rolling_mean_7: 0.0328
2025-06-05 11:25:55,657 - train_models - INFO -   NoOfMan_lag_1: 0.0289
2025-06-05 11:25:55,657 - train_models - INFO -   DayOfWeek_feat_5: 0.0173
2025-06-05 11:25:55,658 - train_models - INFO -   ResourceKPI_lag_1: 0.0172
2025-06-05 11:25:55,658 - train_models - INFO -   NoOfMan_lag_7: 0.0157
2025-06-05 11:25:55,659 - train_models - INFO -   IsWeekend_feat: 0.0147
2025-06-05 11:25:55,659 - train_models - INFO -   Quantity_lag_1: 0.0118
2025-06-05 11:25:55,660 - train_models - INFO - Cross-validation details for 206:
2025-06-05 11:25:55,660 - train_models - INFO -   Fold 1: MAE=2.4949, RMSE=3.2334, R²=0.8578, MAPE=14.95%
2025-06-05 11:25:55,661 - train_models - INFO -   Fold 2: MAE=2.3178, RMSE=3.2333, R²=0.8518, MAPE=12.67%
2025-06-05 11:25:55,661 - train_models - INFO -   Fold 3: MAE=2.5755, RMSE=4.0444, R²=0.7548, MAPE=17.08%
2025-06-05 11:25:55,662 - train_models - INFO -   Fold 4: MAE=1.8671, RMSE=2.7739, R²=0.8548, MAPE=11.82%
2025-06-05 11:25:55,662 - train_models - INFO -   Fold 5: MAE=2.1983, RMSE=3.1694, R²=0.8734, MAPE=12.67%
2025-06-05 11:25:55,663 - train_models - INFO - Building model for WorkType: 209
2025-06-05 11:25:55,670 - train_models - INFO - Available features for 209: 8 numeric, 2 categorical
2025-06-05 11:26:16,648 - train_models - INFO - Model for 209 - MAE: 2.0197, RMSE: 2.8269, R²: 0.5432, MAPE: 27.36%
2025-06-05 11:26:16,649 - train_models - INFO - Top 10 most important features for 209:
2025-06-05 11:26:16,649 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4676
2025-06-05 11:26:16,650 - train_models - INFO -   Quantity_rolling_mean_7: 0.1921
2025-06-05 11:26:16,650 - train_models - INFO -   Quantity_lag_1: 0.0494
2025-06-05 11:26:16,651 - train_models - INFO -   DayOfWeek_feat_1: 0.0493
2025-06-05 11:26:16,651 - train_models - INFO -   ResourceKPI_lag_1: 0.0424
2025-06-05 11:26:16,652 - train_models - INFO -   NoOfMan_lag_7: 0.0395
2025-06-05 11:26:16,652 - train_models - INFO -   Quantity_lag_7: 0.0381
2025-06-05 11:26:16,653 - train_models - INFO -   NoOfMan_lag_1: 0.0349
2025-06-05 11:26:16,653 - train_models - INFO -   DayOfWeek_feat_0: 0.0241
2025-06-05 11:26:16,654 - train_models - INFO -   DayOfWeek_feat_3: 0.0125
2025-06-05 11:26:16,654 - train_models - INFO - Cross-validation details for 209:
2025-06-05 11:26:16,655 - train_models - INFO -   Fold 1: MAE=1.7358, RMSE=2.4484, R²=0.5993, MAPE=23.24%
2025-06-05 11:26:16,655 - train_models - INFO -   Fold 2: MAE=2.3350, RMSE=3.4729, R²=0.3781, MAPE=32.16%
2025-06-05 11:26:16,656 - train_models - INFO -   Fold 3: MAE=1.7915, RMSE=2.3725, R²=0.5585, MAPE=26.95%
2025-06-05 11:26:16,656 - train_models - INFO -   Fold 4: MAE=2.0078, RMSE=2.7612, R²=0.6115, MAPE=27.23%
2025-06-05 11:26:16,657 - train_models - INFO -   Fold 5: MAE=2.2282, RMSE=3.0795, R²=0.5686, MAPE=27.24%
2025-06-05 11:26:16,657 - train_models - INFO - Building model for WorkType: 210
2025-06-05 11:26:16,664 - train_models - INFO - Available features for 210: 8 numeric, 2 categorical
2025-06-05 11:26:36,674 - train_models - INFO - Model for 210 - MAE: 1.5722, RMSE: 2.1833, R²: 0.6206, MAPE: 31.89%
2025-06-05 11:26:36,675 - train_models - INFO - Top 10 most important features for 210:
2025-06-05 11:26:36,675 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5181
2025-06-05 11:26:36,676 - train_models - INFO -   Quantity_rolling_mean_7: 0.0686
2025-06-05 11:26:36,676 - train_models - INFO -   DayOfWeek_feat_1: 0.0662
2025-06-05 11:26:36,677 - train_models - INFO -   DayOfWeek_feat_6: 0.0659
2025-06-05 11:26:36,677 - train_models - INFO -   DayOfWeek_feat_0: 0.0520
2025-06-05 11:26:36,678 - train_models - INFO -   Quantity_lag_1: 0.0402
2025-06-05 11:26:36,678 - train_models - INFO -   NoOfMan_lag_7: 0.0400
2025-06-05 11:26:36,679 - train_models - INFO -   NoOfMan_lag_1: 0.0384
2025-06-05 11:26:36,679 - train_models - INFO -   ResourceKPI_lag_1: 0.0332
2025-06-05 11:26:36,680 - train_models - INFO -   Quantity_lag_7: 0.0325
2025-06-05 11:26:36,680 - train_models - INFO - Cross-validation details for 210:
2025-06-05 11:26:36,681 - train_models - INFO -   Fold 1: MAE=1.2894, RMSE=1.7288, R²=0.7320, MAPE=21.43%
2025-06-05 11:26:36,681 - train_models - INFO -   Fold 2: MAE=1.5145, RMSE=2.1827, R²=0.5635, MAPE=24.58%
2025-06-05 11:26:36,682 - train_models - INFO -   Fold 3: MAE=1.4162, RMSE=1.8907, R²=0.6570, MAPE=19.90%
2025-06-05 11:26:36,683 - train_models - INFO -   Fold 4: MAE=1.6981, RMSE=2.3218, R²=0.5872, MAPE=47.15%
2025-06-05 11:26:36,683 - train_models - INFO -   Fold 5: MAE=1.9429, RMSE=2.7927, R²=0.5635, MAPE=46.39%
2025-06-05 11:26:36,683 - train_models - INFO - Building model for WorkType: 211
2025-06-05 11:26:36,691 - train_models - INFO - Available features for 211: 8 numeric, 2 categorical
2025-06-05 11:26:59,106 - train_models - INFO - Model for 211 - MAE: 1.5572, RMSE: 2.1690, R²: 0.5907, MAPE: 24.42%
2025-06-05 11:26:59,106 - train_models - INFO - Top 10 most important features for 211:
2025-06-05 11:26:59,107 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4921
2025-06-05 11:26:59,107 - train_models - INFO -   DayOfWeek_feat_6: 0.1868
2025-06-05 11:26:59,108 - train_models - INFO -   NoOfMan_lag_1: 0.0580
2025-06-05 11:26:59,108 - train_models - INFO -   Quantity_rolling_mean_7: 0.0475
2025-06-05 11:26:59,109 - train_models - INFO -   NoOfMan_lag_7: 0.0455
2025-06-05 11:26:59,109 - train_models - INFO -   Quantity_lag_1: 0.0332
2025-06-05 11:26:59,110 - train_models - INFO -   Quantity_lag_7: 0.0320
2025-06-05 11:26:59,110 - train_models - INFO -   ResourceKPI_lag_1: 0.0284
2025-06-05 11:26:59,111 - train_models - INFO -   DayOfWeek_feat_4: 0.0093
2025-06-05 11:26:59,111 - train_models - INFO -   DayOfWeek_feat_0: 0.0086
2025-06-05 11:26:59,112 - train_models - INFO - Cross-validation details for 211:
2025-06-05 11:26:59,112 - train_models - INFO -   Fold 1: MAE=2.1240, RMSE=3.1331, R²=0.3172, MAPE=38.11%
2025-06-05 11:26:59,113 - train_models - INFO -   Fold 2: MAE=1.5554, RMSE=2.0999, R²=0.5882, MAPE=21.47%
2025-06-05 11:26:59,113 - train_models - INFO -   Fold 3: MAE=1.3185, RMSE=1.7808, R²=0.7247, MAPE=15.97%
2025-06-05 11:26:59,114 - train_models - INFO -   Fold 4: MAE=1.4216, RMSE=2.0158, R²=0.6601, MAPE=23.25%
2025-06-05 11:26:59,114 - train_models - INFO -   Fold 5: MAE=1.3664, RMSE=1.8156, R²=0.6634, MAPE=23.30%
2025-06-05 11:26:59,115 - train_models - INFO - Building model for WorkType: 213
2025-06-05 11:26:59,121 - train_models - INFO - Available features for 213: 8 numeric, 2 categorical
2025-06-05 11:27:18,439 - train_models - INFO - Model for 213 - MAE: 0.8500, RMSE: 1.1689, R²: 0.5522, MAPE: 36.38%
2025-06-05 11:27:18,439 - train_models - INFO - Top 10 most important features for 213:
2025-06-05 11:27:18,440 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6295
2025-06-05 11:27:18,440 - train_models - INFO -   NoOfMan_lag_7: 0.0578
2025-06-05 11:27:18,441 - train_models - INFO -   NoOfMan_lag_1: 0.0563
2025-06-05 11:27:18,441 - train_models - INFO -   Quantity_rolling_mean_7: 0.0369
2025-06-05 11:27:18,442 - train_models - INFO -   Quantity_lag_7: 0.0347
2025-06-05 11:27:18,442 - train_models - INFO -   Quantity_lag_1: 0.0306
2025-06-05 11:27:18,443 - train_models - INFO -   ResourceKPI_lag_1: 0.0302
2025-06-05 11:27:18,443 - train_models - INFO -   DayOfWeek_feat_4: 0.0270
2025-06-05 11:27:18,443 - train_models - INFO -   DayOfWeek_feat_1: 0.0257
2025-06-05 11:27:18,444 - train_models - INFO -   Month_feat_7: 0.0129
2025-06-05 11:27:18,444 - train_models - INFO - Cross-validation details for 213:
2025-06-05 11:27:18,445 - train_models - INFO -   Fold 1: MAE=0.9366, RMSE=1.3337, R²=0.5835, MAPE=28.50%
2025-06-05 11:27:18,445 - train_models - INFO -   Fold 2: MAE=0.8384, RMSE=1.1767, R²=0.5247, MAPE=44.33%
2025-06-05 11:27:18,445 - train_models - INFO -   Fold 3: MAE=0.7556, RMSE=1.0797, R²=0.5679, MAPE=39.86%
2025-06-05 11:27:18,446 - train_models - INFO -   Fold 4: MAE=0.8722, RMSE=1.1347, R²=0.5110, MAPE=36.76%
2025-06-05 11:27:18,446 - train_models - INFO -   Fold 5: MAE=0.8472, RMSE=1.1196, R²=0.5736, MAPE=32.46%
2025-06-05 11:27:18,447 - train_models - INFO - Building model for WorkType: 214
2025-06-05 11:27:18,456 - train_models - INFO - Available features for 214: 8 numeric, 2 categorical
2025-06-05 11:27:38,626 - train_models - INFO - Model for 214 - MAE: 1.0427, RMSE: 1.3791, R²: 0.5652, MAPE: 25.16%
2025-06-05 11:27:38,626 - train_models - INFO - Top 10 most important features for 214:
2025-06-05 11:27:38,627 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6642
2025-06-05 11:27:38,627 - train_models - INFO -   NoOfMan_lag_1: 0.0448
2025-06-05 11:27:38,628 - train_models - INFO -   NoOfMan_lag_7: 0.0397
2025-06-05 11:27:38,628 - train_models - INFO -   Quantity_lag_7: 0.0360
2025-06-05 11:27:38,629 - train_models - INFO -   Quantity_lag_1: 0.0328
2025-06-05 11:27:38,629 - train_models - INFO -   DayOfWeek_feat_6: 0.0327
2025-06-05 11:27:38,630 - train_models - INFO -   ResourceKPI_lag_1: 0.0305
2025-06-05 11:27:38,630 - train_models - INFO -   Quantity_rolling_mean_7: 0.0304
2025-06-05 11:27:38,630 - train_models - INFO -   DayOfWeek_feat_4: 0.0237
2025-06-05 11:27:38,631 - train_models - INFO -   DayOfWeek_feat_1: 0.0221
2025-06-05 11:27:38,631 - train_models - INFO - Cross-validation details for 214:
2025-06-05 11:27:38,632 - train_models - INFO -   Fold 1: MAE=0.9756, RMSE=1.2641, R²=0.4434, MAPE=27.06%
2025-06-05 11:27:38,632 - train_models - INFO -   Fold 2: MAE=0.9814, RMSE=1.2616, R²=0.5566, MAPE=24.72%
2025-06-05 11:27:38,633 - train_models - INFO -   Fold 3: MAE=0.8076, RMSE=1.0844, R²=0.6797, MAPE=22.27%
2025-06-05 11:27:38,634 - train_models - INFO -   Fold 4: MAE=0.9992, RMSE=1.3417, R²=0.5813, MAPE=21.69%
2025-06-05 11:27:38,634 - train_models - INFO -   Fold 5: MAE=1.4499, RMSE=1.9436, R²=0.5651, MAPE=30.04%
2025-06-05 11:27:38,635 - train_models - INFO - Building model for WorkType: 215
2025-06-05 11:27:38,643 - train_models - INFO - Available features for 215: 8 numeric, 2 categorical
2025-06-05 11:28:01,934 - train_models - INFO - Model for 215 - MAE: 1.3632, RMSE: 1.9846, R²: 0.6461, MAPE: 30.26%
2025-06-05 11:28:01,935 - train_models - INFO - Top 10 most important features for 215:
2025-06-05 11:28:01,935 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3735
2025-06-05 11:28:01,936 - train_models - INFO -   DayOfWeek_feat_6: 0.2574
2025-06-05 11:28:01,936 - train_models - INFO -   DayOfWeek_feat_0: 0.0713
2025-06-05 11:28:01,937 - train_models - INFO -   Quantity_rolling_mean_7: 0.0575
2025-06-05 11:28:01,937 - train_models - INFO -   Quantity_lag_1: 0.0462
2025-06-05 11:28:01,938 - train_models - INFO -   NoOfMan_lag_1: 0.0430
2025-06-05 11:28:01,938 - train_models - INFO -   ResourceKPI_lag_1: 0.0400
2025-06-05 11:28:01,939 - train_models - INFO -   NoOfMan_lag_7: 0.0322
2025-06-05 11:28:01,939 - train_models - INFO -   Quantity_lag_7: 0.0275
2025-06-05 11:28:01,940 - train_models - INFO -   Month_feat_11: 0.0067
2025-06-05 11:28:01,940 - train_models - INFO - Cross-validation details for 215:
2025-06-05 11:28:01,941 - train_models - INFO -   Fold 1: MAE=1.5069, RMSE=2.3107, R²=0.5562, MAPE=42.66%
2025-06-05 11:28:01,941 - train_models - INFO -   Fold 2: MAE=1.2145, RMSE=1.6982, R²=0.7519, MAPE=25.90%
2025-06-05 11:28:01,942 - train_models - INFO -   Fold 3: MAE=1.3829, RMSE=1.9413, R²=0.6653, MAPE=25.41%
2025-06-05 11:28:01,942 - train_models - INFO -   Fold 4: MAE=1.2824, RMSE=1.8369, R²=0.6506, MAPE=29.65%
2025-06-05 11:28:01,943 - train_models - INFO -   Fold 5: MAE=1.4296, RMSE=2.1360, R²=0.6066, MAPE=27.70%
2025-06-05 11:28:01,943 - train_models - INFO - Building model for WorkType: 217
2025-06-05 11:28:01,953 - train_models - INFO - Available features for 217: 8 numeric, 2 categorical
2025-06-05 11:28:19,729 - train_models - INFO - Model for 217 - MAE: 0.9003, RMSE: 1.2095, R²: 0.6090, MAPE: 36.53%
2025-06-05 11:28:19,729 - train_models - INFO - Top 10 most important features for 217:
2025-06-05 11:28:19,730 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.7159
2025-06-05 11:28:19,730 - train_models - INFO -   NoOfMan_lag_1: 0.0980
2025-06-05 11:28:19,731 - train_models - INFO -   NoOfMan_lag_7: 0.0380
2025-06-05 11:28:19,731 - train_models - INFO -   Quantity_lag_7: 0.0337
2025-06-05 11:28:19,732 - train_models - INFO -   Quantity_rolling_mean_7: 0.0274
2025-06-05 11:28:19,732 - train_models - INFO -   Quantity_lag_1: 0.0227
2025-06-05 11:28:19,733 - train_models - INFO -   ResourceKPI_lag_1: 0.0205
2025-06-05 11:28:19,733 - train_models - INFO -   Month_feat_1: 0.0054
2025-06-05 11:28:19,734 - train_models - INFO -   DayOfWeek_feat_0: 0.0049
2025-06-05 11:28:19,734 - train_models - INFO -   DayOfWeek_feat_4: 0.0047
2025-06-05 11:28:19,735 - train_models - INFO - Cross-validation details for 217:
2025-06-05 11:28:19,735 - train_models - INFO -   Fold 1: MAE=0.8768, RMSE=1.1559, R²=0.5350, MAPE=34.54%
2025-06-05 11:28:19,736 - train_models - INFO -   Fold 2: MAE=0.8187, RMSE=1.0949, R²=0.6352, MAPE=38.84%
2025-06-05 11:28:19,736 - train_models - INFO -   Fold 3: MAE=0.8170, RMSE=1.1059, R²=0.7096, MAPE=30.36%
2025-06-05 11:28:19,736 - train_models - INFO -   Fold 4: MAE=0.9669, RMSE=1.2752, R²=0.6517, MAPE=37.33%
2025-06-05 11:28:19,737 - train_models - INFO -   Fold 5: MAE=1.0218, RMSE=1.4155, R²=0.5137, MAPE=41.59%
2025-06-05 11:28:19,738 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-05 11:28:21,273 - train_models - INFO - Model files saved successfully
2025-06-05 11:28:21,274 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-05 11:28:21,274 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-05 11:28:21,280 - train_models - INFO - Model training completed successfully
2025-06-05 11:47:01,604 - train_models - INFO - Starting the model training process
2025-06-05 11:47:01,605 - train_models - INFO - Feature tiers enabled: ['BASIC']
2025-06-05 11:47:01,605 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 11:47:01,612 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 11:47:01,884 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 11:47:02,742 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 11:47:02,877 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 11:47:02,923 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 11:47:02,924 - train_models - INFO - Converting Date column to datetime format
2025-06-05 11:47:02,962 - train_models - INFO - Engineering features...
2025-06-05 11:47:04,224 - utils.feature_engineering - INFO - Engineering features
2025-06-05 11:47:04,280 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 11:47:04,289 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 11:47:04,290 - train_models - INFO - Using lag days: [1, 7]
2025-06-05 11:47:04,290 - train_models - INFO - Using rolling windows: [7]
2025-06-05 11:47:04,310 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 11:47:04,511 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 11:47:04,511 - utils.feature_engineering - INFO - Final shape: (15326, 48)
2025-06-05 11:47:04,530 - train_models - INFO - Found 10 unique work types
2025-06-05 11:47:04,531 - train_models - INFO - Building models for 10 work types
2025-06-05 11:47:04,531 - train_models - INFO - Using feature tiers: ['BASIC']
2025-06-05 11:47:04,532 - utils.feature_builder - INFO - Built feature set: 17 numeric, 2 categorical
2025-06-05 11:47:04,532 - train_models - INFO - Tiered feature system generated 17 numeric features and 2 categorical features
2025-06-05 11:47:04,533 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'Year_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_std_14', 'Quantity_rolling_mean_7']
2025-06-05 11:47:04,533 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-05 11:47:04,534 - train_models - INFO - Building model for WorkType: 202
2025-06-05 11:47:04,542 - train_models - INFO - Available features for 202: 12 numeric, 2 categorical
2025-06-05 11:47:29,388 - train_models - INFO - Model for 202 - MAE: 0.4643, RMSE: 0.5994, R²: 0.3028, MAPE: 24.74%
2025-06-05 11:47:29,388 - train_models - INFO - Top 10 most important features for 202:
2025-06-05 11:47:29,389 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5654
2025-06-05 11:47:29,389 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0901
2025-06-05 11:47:29,390 - train_models - INFO -   NoOfMan_lag_1: 0.0641
2025-06-05 11:47:29,390 - train_models - INFO -   Quantity_lag_7: 0.0359
2025-06-05 11:47:29,391 - train_models - INFO -   Quantity_rolling_mean_7: 0.0338
2025-06-05 11:47:29,391 - train_models - INFO -   SystemKPI_lag_1: 0.0315
2025-06-05 11:47:29,392 - train_models - INFO -   NoOfMan_lag_7: 0.0311
2025-06-05 11:47:29,392 - train_models - INFO -   ResourceKPI_lag_7: 0.0301
2025-06-05 11:47:29,393 - train_models - INFO -   Quantity_lag_1: 0.0265
2025-06-05 11:47:29,393 - train_models - INFO -   ResourceKPI_lag_1: 0.0248
2025-06-05 11:47:29,394 - train_models - INFO - Cross-validation details for 202:
2025-06-05 11:47:29,394 - train_models - INFO -   Fold 1: MAE=0.3227, RMSE=0.4726, R²=0.2171, MAPE=19.93%
2025-06-05 11:47:29,395 - train_models - INFO -   Fold 2: MAE=0.3856, RMSE=0.4976, R²=0.4295, MAPE=24.02%
2025-06-05 11:47:29,395 - train_models - INFO -   Fold 3: MAE=0.5123, RMSE=0.6670, R²=0.3075, MAPE=29.86%
2025-06-05 11:47:29,395 - train_models - INFO -   Fold 4: MAE=0.5178, RMSE=0.6400, R²=0.1665, MAPE=25.30%
2025-06-05 11:47:29,396 - train_models - INFO -   Fold 5: MAE=0.5832, RMSE=0.7197, R²=0.3934, MAPE=24.61%
2025-06-05 11:47:29,396 - train_models - INFO - Building model for WorkType: 203
2025-06-05 11:47:29,405 - train_models - INFO - Available features for 203: 12 numeric, 2 categorical
2025-06-05 11:47:56,068 - train_models - INFO - Model for 203 - MAE: 0.6620, RMSE: 0.8837, R²: 0.3653, MAPE: 13.99%
2025-06-05 11:47:56,068 - train_models - INFO - Top 10 most important features for 203:
2025-06-05 11:47:56,069 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4655
2025-06-05 11:47:56,069 - train_models - INFO -   NoOfMan_lag_1: 0.1229
2025-06-05 11:47:56,070 - train_models - INFO -   NoOfMan_rolling_std_7: 0.1081
2025-06-05 11:47:56,070 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-05 11:47:56,071 - train_models - INFO -   Quantity_rolling_mean_7: 0.0380
2025-06-05 11:47:56,071 - train_models - INFO -   ResourceKPI_lag_7: 0.0324
2025-06-05 11:47:56,071 - train_models - INFO -   SystemKPI_lag_1: 0.0319
2025-06-05 11:47:56,072 - train_models - INFO -   Quantity_lag_7: 0.0296
2025-06-05 11:47:56,072 - train_models - INFO -   Quantity_lag_1: 0.0263
2025-06-05 11:47:56,073 - train_models - INFO -   ResourceKPI_lag_1: 0.0241
2025-06-05 11:47:56,073 - train_models - INFO - Cross-validation details for 203:
2025-06-05 11:47:56,074 - train_models - INFO -   Fold 1: MAE=0.6454, RMSE=0.8374, R²=0.4476, MAPE=12.87%
2025-06-05 11:47:56,074 - train_models - INFO -   Fold 2: MAE=0.6531, RMSE=0.8896, R²=0.4234, MAPE=13.33%
2025-06-05 11:47:56,075 - train_models - INFO -   Fold 3: MAE=0.7557, RMSE=1.0283, R²=0.2031, MAPE=14.88%
2025-06-05 11:47:56,075 - train_models - INFO -   Fold 4: MAE=0.6495, RMSE=0.8459, R²=0.4191, MAPE=14.46%
2025-06-05 11:47:56,076 - train_models - INFO -   Fold 5: MAE=0.6060, RMSE=0.8176, R²=0.3331, MAPE=14.39%
2025-06-05 11:47:56,076 - train_models - INFO - Building model for WorkType: 206
2025-06-05 11:47:56,086 - train_models - INFO - Available features for 206: 12 numeric, 2 categorical
2025-06-05 11:48:30,315 - train_models - INFO - Model for 206 - MAE: 2.1983, RMSE: 3.2873, R²: 0.8383, MAPE: 13.36%
2025-06-05 11:48:30,315 - train_models - INFO - Top 10 most important features for 206:
2025-06-05 11:48:30,316 - train_models - INFO -   DayOfWeek_feat_6: 0.3984
2025-06-05 11:48:30,316 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3072
2025-06-05 11:48:30,317 - train_models - INFO -   DayOfWeek_feat_4: 0.1117
2025-06-05 11:48:30,317 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0313
2025-06-05 11:48:30,318 - train_models - INFO -   Quantity_rolling_mean_7: 0.0289
2025-06-05 11:48:30,318 - train_models - INFO -   NoOfMan_lag_1: 0.0180
2025-06-05 11:48:30,319 - train_models - INFO -   IsWeekend_feat: 0.0159
2025-06-05 11:48:30,319 - train_models - INFO -   DayOfWeek_feat_5: 0.0154
2025-06-05 11:48:30,320 - train_models - INFO -   ResourceKPI_lag_1: 0.0130
2025-06-05 11:48:30,320 - train_models - INFO -   NoOfMan_lag_7: 0.0113
2025-06-05 11:48:30,321 - train_models - INFO - Cross-validation details for 206:
2025-06-05 11:48:30,321 - train_models - INFO -   Fold 1: MAE=2.2850, RMSE=3.1242, R²=0.8672, MAPE=13.72%
2025-06-05 11:48:30,322 - train_models - INFO -   Fold 2: MAE=2.2841, RMSE=3.2466, R²=0.8506, MAPE=12.67%
2025-06-05 11:48:30,322 - train_models - INFO -   Fold 3: MAE=2.4573, RMSE=4.1372, R²=0.7434, MAPE=16.33%
2025-06-05 11:48:30,322 - train_models - INFO -   Fold 4: MAE=1.8051, RMSE=2.7318, R²=0.8592, MAPE=11.76%
2025-06-05 11:48:30,323 - train_models - INFO -   Fold 5: MAE=2.1602, RMSE=3.1967, R²=0.8712, MAPE=12.35%
2025-06-05 11:48:30,323 - train_models - INFO - Building model for WorkType: 209
2025-06-05 11:48:30,331 - train_models - INFO - Available features for 209: 12 numeric, 2 categorical
2025-06-05 11:48:56,959 - train_models - INFO - Model for 209 - MAE: 1.9737, RMSE: 2.8028, R²: 0.5526, MAPE: 26.76%
2025-06-05 11:48:56,960 - train_models - INFO - Top 10 most important features for 209:
2025-06-05 11:48:56,960 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4480
2025-06-05 11:48:56,961 - train_models - INFO -   Quantity_rolling_mean_7: 0.1758
2025-06-05 11:48:56,961 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0606
2025-06-05 11:48:56,962 - train_models - INFO -   DayOfWeek_feat_1: 0.0478
2025-06-05 11:48:56,962 - train_models - INFO -   Quantity_lag_1: 0.0358
2025-06-05 11:48:56,962 - train_models - INFO -   ResourceKPI_lag_1: 0.0279
2025-06-05 11:48:56,963 - train_models - INFO -   NoOfMan_lag_7: 0.0272
2025-06-05 11:48:56,963 - train_models - INFO -   Quantity_lag_7: 0.0246
2025-06-05 11:48:56,964 - train_models - INFO -   SystemKPI_lag_1: 0.0244
2025-06-05 11:48:56,964 - train_models - INFO -   NoOfMan_lag_1: 0.0239
2025-06-05 11:48:56,965 - train_models - INFO - Cross-validation details for 209:
2025-06-05 11:48:56,965 - train_models - INFO -   Fold 1: MAE=1.7620, RMSE=2.4826, R²=0.5881, MAPE=23.75%
2025-06-05 11:48:56,966 - train_models - INFO -   Fold 2: MAE=2.2416, RMSE=3.3946, R²=0.4058, MAPE=30.52%
2025-06-05 11:48:56,966 - train_models - INFO -   Fold 3: MAE=1.6867, RMSE=2.2652, R²=0.5975, MAPE=24.94%
2025-06-05 11:48:56,966 - train_models - INFO -   Fold 4: MAE=1.9583, RMSE=2.7482, R²=0.6152, MAPE=26.23%
2025-06-05 11:48:56,967 - train_models - INFO -   Fold 5: MAE=2.2201, RMSE=3.1236, R²=0.5562, MAPE=28.36%
2025-06-05 11:48:56,967 - train_models - INFO - Building model for WorkType: 210
2025-06-05 11:48:56,976 - train_models - INFO - Available features for 210: 12 numeric, 2 categorical
2025-06-05 11:49:23,442 - train_models - INFO - Model for 210 - MAE: 1.5404, RMSE: 2.1650, R²: 0.6291, MAPE: 31.04%
2025-06-05 11:49:23,443 - train_models - INFO - Top 10 most important features for 210:
2025-06-05 11:49:23,443 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5005
2025-06-05 11:49:23,444 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0673
2025-06-05 11:49:23,444 - train_models - INFO -   DayOfWeek_feat_1: 0.0658
2025-06-05 11:49:23,445 - train_models - INFO -   DayOfWeek_feat_6: 0.0577
2025-06-05 11:49:23,445 - train_models - INFO -   Quantity_rolling_mean_7: 0.0540
2025-06-05 11:49:23,445 - train_models - INFO -   DayOfWeek_feat_0: 0.0502
2025-06-05 11:49:23,446 - train_models - INFO -   SystemKPI_lag_1: 0.0273
2025-06-05 11:49:23,446 - train_models - INFO -   Quantity_lag_1: 0.0254
2025-06-05 11:49:23,447 - train_models - INFO -   NoOfMan_lag_7: 0.0252
2025-06-05 11:49:23,447 - train_models - INFO -   NoOfMan_lag_1: 0.0236
2025-06-05 11:49:23,448 - train_models - INFO - Cross-validation details for 210:
2025-06-05 11:49:23,448 - train_models - INFO -   Fold 1: MAE=1.3447, RMSE=1.8466, R²=0.6942, MAPE=21.76%
2025-06-05 11:49:23,449 - train_models - INFO -   Fold 2: MAE=1.4137, RMSE=2.0398, R²=0.6187, MAPE=22.93%
2025-06-05 11:49:23,449 - train_models - INFO -   Fold 3: MAE=1.3394, RMSE=1.8412, R²=0.6748, MAPE=18.76%
2025-06-05 11:49:23,449 - train_models - INFO -   Fold 4: MAE=1.6568, RMSE=2.2746, R²=0.6038, MAPE=43.48%
2025-06-05 11:49:23,450 - train_models - INFO -   Fold 5: MAE=1.9474, RMSE=2.8226, R²=0.5541, MAPE=48.28%
2025-06-05 11:49:23,450 - train_models - INFO - Building model for WorkType: 211
2025-06-05 11:49:23,460 - train_models - INFO - Available features for 211: 12 numeric, 2 categorical
2025-06-05 11:49:52,045 - train_models - INFO - Model for 211 - MAE: 1.5046, RMSE: 2.1936, R²: 0.5739, MAPE: 24.38%
2025-06-05 11:49:52,046 - train_models - INFO - Top 10 most important features for 211:
2025-06-05 11:49:52,046 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4768
2025-06-05 11:49:52,047 - train_models - INFO -   DayOfWeek_feat_6: 0.1823
2025-06-05 11:49:52,047 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0761
2025-06-05 11:49:52,047 - train_models - INFO -   Quantity_rolling_mean_7: 0.0330
2025-06-05 11:49:52,048 - train_models - INFO -   NoOfMan_lag_7: 0.0326
2025-06-05 11:49:52,048 - train_models - INFO -   NoOfMan_lag_1: 0.0305
2025-06-05 11:49:52,048 - train_models - INFO -   ResourceKPI_lag_7: 0.0227
2025-06-05 11:49:52,049 - train_models - INFO -   Quantity_lag_1: 0.0222
2025-06-05 11:49:52,049 - train_models - INFO -   SystemKPI_lag_1: 0.0218
2025-06-05 11:49:52,050 - train_models - INFO -   Quantity_lag_7: 0.0197
2025-06-05 11:49:52,050 - train_models - INFO - Cross-validation details for 211:
2025-06-05 11:49:52,051 - train_models - INFO -   Fold 1: MAE=2.0821, RMSE=3.4672, R²=0.1638, MAPE=36.74%
2025-06-05 11:49:52,051 - train_models - INFO -   Fold 2: MAE=1.5502, RMSE=2.0830, R²=0.5948, MAPE=22.35%
2025-06-05 11:49:52,052 - train_models - INFO -   Fold 3: MAE=1.2652, RMSE=1.7061, R²=0.7473, MAPE=15.79%
2025-06-05 11:49:52,052 - train_models - INFO -   Fold 4: MAE=1.3190, RMSE=1.9118, R²=0.6943, MAPE=22.65%
2025-06-05 11:49:52,052 - train_models - INFO -   Fold 5: MAE=1.3066, RMSE=1.7999, R²=0.6692, MAPE=24.39%
2025-06-05 11:49:52,053 - train_models - INFO - Building model for WorkType: 213
2025-06-05 11:49:52,061 - train_models - INFO - Available features for 213: 12 numeric, 2 categorical
2025-06-05 11:50:18,606 - train_models - INFO - Model for 213 - MAE: 0.8556, RMSE: 1.1855, R²: 0.5375, MAPE: 37.09%
2025-06-05 11:50:18,606 - train_models - INFO - Top 10 most important features for 213:
2025-06-05 11:50:18,606 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6142
2025-06-05 11:50:18,607 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0857
2025-06-05 11:50:18,607 - train_models - INFO -   NoOfMan_lag_7: 0.0366
2025-06-05 11:50:18,608 - train_models - INFO -   NoOfMan_lag_1: 0.0344
2025-06-05 11:50:18,608 - train_models - INFO -   SystemKPI_lag_1: 0.0299
2025-06-05 11:50:18,609 - train_models - INFO -   DayOfWeek_feat_4: 0.0252
2025-06-05 11:50:18,609 - train_models - INFO -   DayOfWeek_feat_1: 0.0248
2025-06-05 11:50:18,611 - train_models - INFO -   ResourceKPI_lag_7: 0.0230
2025-06-05 11:50:18,611 - train_models - INFO -   Quantity_rolling_mean_7: 0.0209
2025-06-05 11:50:18,612 - train_models - INFO -   Quantity_lag_7: 0.0193
2025-06-05 11:50:18,613 - train_models - INFO - Cross-validation details for 213:
2025-06-05 11:50:18,613 - train_models - INFO -   Fold 1: MAE=0.9299, RMSE=1.3218, R²=0.5909, MAPE=28.61%
2025-06-05 11:50:18,614 - train_models - INFO -   Fold 2: MAE=0.8619, RMSE=1.2014, R²=0.5046, MAPE=47.11%
2025-06-05 11:50:18,614 - train_models - INFO -   Fold 3: MAE=0.8051, RMSE=1.2063, R²=0.4607, MAPE=42.97%
2025-06-05 11:50:18,615 - train_models - INFO -   Fold 4: MAE=0.8307, RMSE=1.0941, R²=0.5454, MAPE=34.60%
2025-06-05 11:50:18,615 - train_models - INFO -   Fold 5: MAE=0.8506, RMSE=1.1037, R²=0.5856, MAPE=32.16%
2025-06-05 11:50:18,615 - train_models - INFO - Building model for WorkType: 214
2025-06-05 11:50:18,623 - train_models - INFO - Available features for 214: 12 numeric, 2 categorical
2025-06-05 11:50:45,373 - train_models - INFO - Model for 214 - MAE: 1.0477, RMSE: 1.3881, R²: 0.5614, MAPE: 24.96%
2025-06-05 11:50:45,374 - train_models - INFO - Top 10 most important features for 214:
2025-06-05 11:50:45,374 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6449
2025-06-05 11:50:45,375 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0672
2025-06-05 11:50:45,375 - train_models - INFO -   DayOfWeek_feat_6: 0.0306
2025-06-05 11:50:45,376 - train_models - INFO -   NoOfMan_lag_1: 0.0296
2025-06-05 11:50:45,376 - train_models - INFO -   NoOfMan_lag_7: 0.0267
2025-06-05 11:50:45,376 - train_models - INFO -   DayOfWeek_feat_4: 0.0224
2025-06-05 11:50:45,377 - train_models - INFO -   Quantity_lag_1: 0.0219
2025-06-05 11:50:45,377 - train_models - INFO -   ResourceKPI_lag_7: 0.0217
2025-06-05 11:50:45,378 - train_models - INFO -   DayOfWeek_feat_1: 0.0210
2025-06-05 11:50:45,378 - train_models - INFO -   Quantity_rolling_mean_7: 0.0205
2025-06-05 11:50:45,379 - train_models - INFO - Cross-validation details for 214:
2025-06-05 11:50:45,379 - train_models - INFO -   Fold 1: MAE=0.9904, RMSE=1.2821, R²=0.4274, MAPE=27.42%
2025-06-05 11:50:45,380 - train_models - INFO -   Fold 2: MAE=0.9718, RMSE=1.2399, R²=0.5717, MAPE=24.03%
2025-06-05 11:50:45,380 - train_models - INFO -   Fold 3: MAE=0.8083, RMSE=1.1090, R²=0.6650, MAPE=22.19%
2025-06-05 11:50:45,381 - train_models - INFO -   Fold 4: MAE=0.9580, RMSE=1.2952, R²=0.6098, MAPE=20.52%
2025-06-05 11:50:45,381 - train_models - INFO -   Fold 5: MAE=1.5100, RMSE=2.0141, R²=0.5330, MAPE=30.65%
2025-06-05 11:50:45,381 - train_models - INFO - Building model for WorkType: 215
2025-06-05 11:50:45,389 - train_models - INFO - Available features for 215: 12 numeric, 2 categorical
2025-06-05 11:51:15,308 - train_models - INFO - Model for 215 - MAE: 1.3093, RMSE: 1.9401, R²: 0.6617, MAPE: 30.32%
2025-06-05 11:51:15,309 - train_models - INFO - Top 10 most important features for 215:
2025-06-05 11:51:15,309 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3546
2025-06-05 11:51:15,310 - train_models - INFO -   DayOfWeek_feat_6: 0.2555
2025-06-05 11:51:15,310 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0752
2025-06-05 11:51:15,311 - train_models - INFO -   DayOfWeek_feat_0: 0.0694
2025-06-05 11:51:15,311 - train_models - INFO -   Quantity_rolling_mean_7: 0.0416
2025-06-05 11:51:15,312 - train_models - INFO -   Quantity_lag_1: 0.0328
2025-06-05 11:51:15,312 - train_models - INFO -   NoOfMan_lag_1: 0.0293
2025-06-05 11:51:15,313 - train_models - INFO -   ResourceKPI_lag_1: 0.0228
2025-06-05 11:51:15,313 - train_models - INFO -   ResourceKPI_lag_7: 0.0205
2025-06-05 11:51:15,313 - train_models - INFO -   SystemKPI_lag_1: 0.0192
2025-06-05 11:51:15,314 - train_models - INFO - Cross-validation details for 215:
2025-06-05 11:51:15,314 - train_models - INFO -   Fold 1: MAE=1.5191, RMSE=2.3326, R²=0.5477, MAPE=45.04%
2025-06-05 11:51:15,315 - train_models - INFO -   Fold 2: MAE=1.1602, RMSE=1.6843, R²=0.7559, MAPE=25.94%
2025-06-05 11:51:15,315 - train_models - INFO -   Fold 3: MAE=1.3331, RMSE=1.8913, R²=0.6823, MAPE=24.31%
2025-06-05 11:51:15,316 - train_models - INFO -   Fold 4: MAE=1.2210, RMSE=1.7969, R²=0.6656, MAPE=29.97%
2025-06-05 11:51:15,316 - train_models - INFO -   Fold 5: MAE=1.3133, RMSE=1.9955, R²=0.6566, MAPE=26.35%
2025-06-05 11:51:15,317 - train_models - INFO - Building model for WorkType: 217
2025-06-05 11:51:15,327 - train_models - INFO - Available features for 217: 12 numeric, 2 categorical
2025-06-05 11:51:38,485 - train_models - INFO - Model for 217 - MAE: 0.8901, RMSE: 1.2028, R²: 0.6127, MAPE: 36.66%
2025-06-05 11:51:38,485 - train_models - INFO - Top 10 most important features for 217:
2025-06-05 11:51:38,486 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.7041
2025-06-05 11:51:38,486 - train_models - INFO -   NoOfMan_lag_1: 0.0833
2025-06-05 11:51:38,487 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0572
2025-06-05 11:51:38,488 - train_models - INFO -   NoOfMan_lag_7: 0.0257
2025-06-05 11:51:38,488 - train_models - INFO -   SystemKPI_lag_1: 0.0193
2025-06-05 11:51:38,489 - train_models - INFO -   Quantity_lag_7: 0.0190
2025-06-05 11:51:38,489 - train_models - INFO -   Quantity_rolling_mean_7: 0.0168
2025-06-05 11:51:38,490 - train_models - INFO -   ResourceKPI_lag_7: 0.0141
2025-06-05 11:51:38,490 - train_models - INFO -   Quantity_lag_1: 0.0134
2025-06-05 11:51:38,491 - train_models - INFO -   ResourceKPI_lag_1: 0.0117
2025-06-05 11:51:38,491 - train_models - INFO - Cross-validation details for 217:
2025-06-05 11:51:38,492 - train_models - INFO -   Fold 1: MAE=0.8642, RMSE=1.1429, R²=0.5454, MAPE=34.61%
2025-06-05 11:51:38,492 - train_models - INFO -   Fold 2: MAE=0.8217, RMSE=1.1019, R²=0.6305, MAPE=38.35%
2025-06-05 11:51:38,493 - train_models - INFO -   Fold 3: MAE=0.7941, RMSE=1.0937, R²=0.7159, MAPE=30.22%
2025-06-05 11:51:38,493 - train_models - INFO -   Fold 4: MAE=0.9330, RMSE=1.2476, R²=0.6666, MAPE=37.19%
2025-06-05 11:51:38,494 - train_models - INFO -   Fold 5: MAE=1.0373, RMSE=1.4278, R²=0.5052, MAPE=42.95%
2025-06-05 11:51:38,495 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-05 11:51:39,767 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-05 11:51:40,019 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 501, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-05 11:51:40,025 - train_models - INFO - Model training completed successfully
2025-06-05 12:04:46,090 - train_models - INFO - Starting the model training process
2025-06-05 12:04:46,090 - train_models - INFO - Feature tiers enabled: ['BASIC']
2025-06-05 12:04:46,091 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 12:04:46,099 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 12:04:46,392 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 12:04:47,172 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 12:04:47,280 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 12:04:47,326 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 12:04:47,326 - train_models - INFO - Converting Date column to datetime format
2025-06-05 12:04:47,356 - train_models - INFO - Engineering features...
2025-06-05 12:04:48,571 - utils.feature_engineering - INFO - Engineering features
2025-06-05 12:04:48,631 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 12:04:48,638 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 12:04:48,639 - train_models - INFO - Using lag days: [1, 7]
2025-06-05 12:04:48,639 - train_models - INFO - Using rolling windows: [7]
2025-06-05 12:04:48,663 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 12:04:48,864 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 12:04:48,864 - utils.feature_engineering - INFO - Final shape: (15326, 48)
2025-06-05 12:04:48,883 - train_models - INFO - Found 10 unique work types
2025-06-05 12:04:48,884 - train_models - INFO - Building models for 10 work types
2025-06-05 12:04:48,884 - train_models - INFO - Using feature tiers: ['BASIC']
2025-06-05 12:04:48,885 - utils.feature_builder - INFO - Built feature set: 17 numeric, 2 categorical
2025-06-05 12:04:48,885 - train_models - INFO - Tiered feature system generated 17 numeric features and 2 categorical features
2025-06-05 12:04:48,886 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'Year_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'ResourceKPI_lag_7', 'SystemKPI_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_std_14', 'Quantity_rolling_mean_7']
2025-06-05 12:04:48,886 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-05 12:04:48,887 - train_models - INFO - Building model for WorkType: 202
2025-06-05 12:04:48,896 - train_models - INFO - Available features for 202: 12 numeric, 2 categorical
2025-06-05 12:05:13,990 - train_models - INFO - Model for 202 - MAE: 0.4643, RMSE: 0.5994, R²: 0.3028, MAPE: 24.74%
2025-06-05 12:05:13,991 - train_models - INFO - Top 10 most important features for 202:
2025-06-05 12:05:13,992 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5654
2025-06-05 12:05:13,992 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0901
2025-06-05 12:05:13,993 - train_models - INFO -   NoOfMan_lag_1: 0.0641
2025-06-05 12:05:13,993 - train_models - INFO -   Quantity_lag_7: 0.0359
2025-06-05 12:05:13,993 - train_models - INFO -   Quantity_rolling_mean_7: 0.0338
2025-06-05 12:05:13,994 - train_models - INFO -   SystemKPI_lag_1: 0.0315
2025-06-05 12:05:13,994 - train_models - INFO -   NoOfMan_lag_7: 0.0311
2025-06-05 12:05:13,995 - train_models - INFO -   ResourceKPI_lag_7: 0.0301
2025-06-05 12:05:13,995 - train_models - INFO -   Quantity_lag_1: 0.0265
2025-06-05 12:05:13,996 - train_models - INFO -   ResourceKPI_lag_1: 0.0248
2025-06-05 12:05:13,996 - train_models - INFO - Cross-validation details for 202:
2025-06-05 12:05:13,997 - train_models - INFO -   Fold 1: MAE=0.3227, RMSE=0.4726, R²=0.2171, MAPE=19.93%
2025-06-05 12:05:13,997 - train_models - INFO -   Fold 2: MAE=0.3856, RMSE=0.4976, R²=0.4295, MAPE=24.02%
2025-06-05 12:05:13,997 - train_models - INFO -   Fold 3: MAE=0.5123, RMSE=0.6670, R²=0.3075, MAPE=29.86%
2025-06-05 12:05:13,998 - train_models - INFO -   Fold 4: MAE=0.5178, RMSE=0.6400, R²=0.1665, MAPE=25.30%
2025-06-05 12:05:13,998 - train_models - INFO -   Fold 5: MAE=0.5832, RMSE=0.7197, R²=0.3934, MAPE=24.61%
2025-06-05 12:05:13,999 - train_models - INFO - Building model for WorkType: 203
2025-06-05 12:05:14,008 - train_models - INFO - Available features for 203: 12 numeric, 2 categorical
2025-06-05 12:05:41,991 - train_models - INFO - Model for 203 - MAE: 0.6620, RMSE: 0.8837, R²: 0.3653, MAPE: 13.99%
2025-06-05 12:05:41,991 - train_models - INFO - Top 10 most important features for 203:
2025-06-05 12:05:41,992 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4655
2025-06-05 12:05:41,992 - train_models - INFO -   NoOfMan_lag_1: 0.1229
2025-06-05 12:05:41,993 - train_models - INFO -   NoOfMan_rolling_std_7: 0.1081
2025-06-05 12:05:41,993 - train_models - INFO -   NoOfMan_lag_7: 0.0382
2025-06-05 12:05:41,994 - train_models - INFO -   Quantity_rolling_mean_7: 0.0380
2025-06-05 12:05:41,994 - train_models - INFO -   ResourceKPI_lag_7: 0.0324
2025-06-05 12:05:41,995 - train_models - INFO -   SystemKPI_lag_1: 0.0319
2025-06-05 12:05:41,995 - train_models - INFO -   Quantity_lag_7: 0.0296
2025-06-05 12:05:41,996 - train_models - INFO -   Quantity_lag_1: 0.0263
2025-06-05 12:05:41,996 - train_models - INFO -   ResourceKPI_lag_1: 0.0241
2025-06-05 12:05:41,997 - train_models - INFO - Cross-validation details for 203:
2025-06-05 12:05:41,997 - train_models - INFO -   Fold 1: MAE=0.6454, RMSE=0.8374, R²=0.4476, MAPE=12.87%
2025-06-05 12:05:41,998 - train_models - INFO -   Fold 2: MAE=0.6531, RMSE=0.8896, R²=0.4234, MAPE=13.33%
2025-06-05 12:05:41,998 - train_models - INFO -   Fold 3: MAE=0.7557, RMSE=1.0283, R²=0.2031, MAPE=14.88%
2025-06-05 12:05:41,999 - train_models - INFO -   Fold 4: MAE=0.6495, RMSE=0.8459, R²=0.4191, MAPE=14.46%
2025-06-05 12:05:41,999 - train_models - INFO -   Fold 5: MAE=0.6060, RMSE=0.8176, R²=0.3331, MAPE=14.39%
2025-06-05 12:05:42,000 - train_models - INFO - Building model for WorkType: 206
2025-06-05 12:05:42,009 - train_models - INFO - Available features for 206: 12 numeric, 2 categorical
2025-06-05 12:06:16,418 - train_models - INFO - Model for 206 - MAE: 2.1983, RMSE: 3.2873, R²: 0.8383, MAPE: 13.36%
2025-06-05 12:06:16,419 - train_models - INFO - Top 10 most important features for 206:
2025-06-05 12:06:16,419 - train_models - INFO -   DayOfWeek_feat_6: 0.3984
2025-06-05 12:06:16,420 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3072
2025-06-05 12:06:16,420 - train_models - INFO -   DayOfWeek_feat_4: 0.1117
2025-06-05 12:06:16,421 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0313
2025-06-05 12:06:16,421 - train_models - INFO -   Quantity_rolling_mean_7: 0.0289
2025-06-05 12:06:16,422 - train_models - INFO -   NoOfMan_lag_1: 0.0180
2025-06-05 12:06:16,422 - train_models - INFO -   IsWeekend_feat: 0.0159
2025-06-05 12:06:16,422 - train_models - INFO -   DayOfWeek_feat_5: 0.0154
2025-06-05 12:06:16,423 - train_models - INFO -   ResourceKPI_lag_1: 0.0130
2025-06-05 12:06:16,423 - train_models - INFO -   NoOfMan_lag_7: 0.0113
2025-06-05 12:06:16,424 - train_models - INFO - Cross-validation details for 206:
2025-06-05 12:06:16,424 - train_models - INFO -   Fold 1: MAE=2.2850, RMSE=3.1242, R²=0.8672, MAPE=13.72%
2025-06-05 12:06:16,425 - train_models - INFO -   Fold 2: MAE=2.2841, RMSE=3.2466, R²=0.8506, MAPE=12.67%
2025-06-05 12:06:16,425 - train_models - INFO -   Fold 3: MAE=2.4573, RMSE=4.1372, R²=0.7434, MAPE=16.33%
2025-06-05 12:06:16,425 - train_models - INFO -   Fold 4: MAE=1.8051, RMSE=2.7318, R²=0.8592, MAPE=11.76%
2025-06-05 12:06:16,426 - train_models - INFO -   Fold 5: MAE=2.1602, RMSE=3.1967, R²=0.8712, MAPE=12.35%
2025-06-05 12:06:16,426 - train_models - INFO - Building model for WorkType: 209
2025-06-05 12:06:16,437 - train_models - INFO - Available features for 209: 12 numeric, 2 categorical
2025-06-05 12:06:48,244 - train_models - INFO - Model for 209 - MAE: 1.9737, RMSE: 2.8028, R²: 0.5526, MAPE: 26.76%
2025-06-05 12:06:48,244 - train_models - INFO - Top 10 most important features for 209:
2025-06-05 12:06:48,245 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4480
2025-06-05 12:06:48,245 - train_models - INFO -   Quantity_rolling_mean_7: 0.1758
2025-06-05 12:06:48,246 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0606
2025-06-05 12:06:48,246 - train_models - INFO -   DayOfWeek_feat_1: 0.0478
2025-06-05 12:06:48,246 - train_models - INFO -   Quantity_lag_1: 0.0358
2025-06-05 12:06:48,247 - train_models - INFO -   ResourceKPI_lag_1: 0.0279
2025-06-05 12:06:48,247 - train_models - INFO -   NoOfMan_lag_7: 0.0272
2025-06-05 12:06:48,248 - train_models - INFO -   Quantity_lag_7: 0.0246
2025-06-05 12:06:48,248 - train_models - INFO -   SystemKPI_lag_1: 0.0244
2025-06-05 12:06:48,249 - train_models - INFO -   NoOfMan_lag_1: 0.0239
2025-06-05 12:06:48,249 - train_models - INFO - Cross-validation details for 209:
2025-06-05 12:06:48,250 - train_models - INFO -   Fold 1: MAE=1.7620, RMSE=2.4826, R²=0.5881, MAPE=23.75%
2025-06-05 12:06:48,250 - train_models - INFO -   Fold 2: MAE=2.2416, RMSE=3.3946, R²=0.4058, MAPE=30.52%
2025-06-05 12:06:48,251 - train_models - INFO -   Fold 3: MAE=1.6867, RMSE=2.2652, R²=0.5975, MAPE=24.94%
2025-06-05 12:06:48,251 - train_models - INFO -   Fold 4: MAE=1.9583, RMSE=2.7482, R²=0.6152, MAPE=26.23%
2025-06-05 12:06:48,252 - train_models - INFO -   Fold 5: MAE=2.2201, RMSE=3.1236, R²=0.5562, MAPE=28.36%
2025-06-05 12:06:48,252 - train_models - INFO - Building model for WorkType: 210
2025-06-05 12:06:48,263 - train_models - INFO - Available features for 210: 12 numeric, 2 categorical
2025-06-05 12:07:15,748 - train_models - INFO - Model for 210 - MAE: 1.5404, RMSE: 2.1650, R²: 0.6291, MAPE: 31.04%
2025-06-05 12:07:15,749 - train_models - INFO - Top 10 most important features for 210:
2025-06-05 12:07:15,750 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5005
2025-06-05 12:07:15,750 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0673
2025-06-05 12:07:15,750 - train_models - INFO -   DayOfWeek_feat_1: 0.0658
2025-06-05 12:07:15,751 - train_models - INFO -   DayOfWeek_feat_6: 0.0577
2025-06-05 12:07:15,751 - train_models - INFO -   Quantity_rolling_mean_7: 0.0540
2025-06-05 12:07:15,752 - train_models - INFO -   DayOfWeek_feat_0: 0.0502
2025-06-05 12:07:15,752 - train_models - INFO -   SystemKPI_lag_1: 0.0273
2025-06-05 12:07:15,753 - train_models - INFO -   Quantity_lag_1: 0.0254
2025-06-05 12:07:15,753 - train_models - INFO -   NoOfMan_lag_7: 0.0252
2025-06-05 12:07:15,754 - train_models - INFO -   NoOfMan_lag_1: 0.0236
2025-06-05 12:07:15,754 - train_models - INFO - Cross-validation details for 210:
2025-06-05 12:07:15,755 - train_models - INFO -   Fold 1: MAE=1.3447, RMSE=1.8466, R²=0.6942, MAPE=21.76%
2025-06-05 12:07:15,755 - train_models - INFO -   Fold 2: MAE=1.4137, RMSE=2.0398, R²=0.6187, MAPE=22.93%
2025-06-05 12:07:15,756 - train_models - INFO -   Fold 3: MAE=1.3394, RMSE=1.8412, R²=0.6748, MAPE=18.76%
2025-06-05 12:07:15,756 - train_models - INFO -   Fold 4: MAE=1.6568, RMSE=2.2746, R²=0.6038, MAPE=43.48%
2025-06-05 12:07:15,757 - train_models - INFO -   Fold 5: MAE=1.9474, RMSE=2.8226, R²=0.5541, MAPE=48.28%
2025-06-05 12:07:15,757 - train_models - INFO - Building model for WorkType: 211
2025-06-05 12:07:15,768 - train_models - INFO - Available features for 211: 12 numeric, 2 categorical
2025-06-05 12:07:46,506 - train_models - INFO - Model for 211 - MAE: 1.5046, RMSE: 2.1936, R²: 0.5739, MAPE: 24.38%
2025-06-05 12:07:46,507 - train_models - INFO - Top 10 most important features for 211:
2025-06-05 12:07:46,507 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4768
2025-06-05 12:07:46,508 - train_models - INFO -   DayOfWeek_feat_6: 0.1823
2025-06-05 12:07:46,508 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0761
2025-06-05 12:07:46,509 - train_models - INFO -   Quantity_rolling_mean_7: 0.0330
2025-06-05 12:07:46,509 - train_models - INFO -   NoOfMan_lag_7: 0.0326
2025-06-05 12:07:46,510 - train_models - INFO -   NoOfMan_lag_1: 0.0305
2025-06-05 12:07:46,510 - train_models - INFO -   ResourceKPI_lag_7: 0.0227
2025-06-05 12:07:46,511 - train_models - INFO -   Quantity_lag_1: 0.0222
2025-06-05 12:07:46,511 - train_models - INFO -   SystemKPI_lag_1: 0.0218
2025-06-05 12:07:46,512 - train_models - INFO -   Quantity_lag_7: 0.0197
2025-06-05 12:07:46,512 - train_models - INFO - Cross-validation details for 211:
2025-06-05 12:07:46,513 - train_models - INFO -   Fold 1: MAE=2.0821, RMSE=3.4672, R²=0.1638, MAPE=36.74%
2025-06-05 12:07:46,513 - train_models - INFO -   Fold 2: MAE=1.5502, RMSE=2.0830, R²=0.5948, MAPE=22.35%
2025-06-05 12:07:46,514 - train_models - INFO -   Fold 3: MAE=1.2652, RMSE=1.7061, R²=0.7473, MAPE=15.79%
2025-06-05 12:07:46,514 - train_models - INFO -   Fold 4: MAE=1.3190, RMSE=1.9118, R²=0.6943, MAPE=22.65%
2025-06-05 12:07:46,515 - train_models - INFO -   Fold 5: MAE=1.3066, RMSE=1.7999, R²=0.6692, MAPE=24.39%
2025-06-05 12:07:46,515 - train_models - INFO - Building model for WorkType: 213
2025-06-05 12:07:46,523 - train_models - INFO - Available features for 213: 12 numeric, 2 categorical
2025-06-05 12:08:14,866 - train_models - INFO - Model for 213 - MAE: 0.8556, RMSE: 1.1855, R²: 0.5375, MAPE: 37.09%
2025-06-05 12:08:14,866 - train_models - INFO - Top 10 most important features for 213:
2025-06-05 12:08:14,867 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6142
2025-06-05 12:08:14,867 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0857
2025-06-05 12:08:14,868 - train_models - INFO -   NoOfMan_lag_7: 0.0366
2025-06-05 12:08:14,868 - train_models - INFO -   NoOfMan_lag_1: 0.0344
2025-06-05 12:08:14,869 - train_models - INFO -   SystemKPI_lag_1: 0.0299
2025-06-05 12:08:14,869 - train_models - INFO -   DayOfWeek_feat_4: 0.0252
2025-06-05 12:08:14,870 - train_models - INFO -   DayOfWeek_feat_1: 0.0248
2025-06-05 12:08:14,870 - train_models - INFO -   ResourceKPI_lag_7: 0.0230
2025-06-05 12:08:14,871 - train_models - INFO -   Quantity_rolling_mean_7: 0.0209
2025-06-05 12:08:14,871 - train_models - INFO -   Quantity_lag_7: 0.0193
2025-06-05 12:08:14,871 - train_models - INFO - Cross-validation details for 213:
2025-06-05 12:08:14,872 - train_models - INFO -   Fold 1: MAE=0.9299, RMSE=1.3218, R²=0.5909, MAPE=28.61%
2025-06-05 12:08:14,872 - train_models - INFO -   Fold 2: MAE=0.8619, RMSE=1.2014, R²=0.5046, MAPE=47.11%
2025-06-05 12:08:14,873 - train_models - INFO -   Fold 3: MAE=0.8051, RMSE=1.2063, R²=0.4607, MAPE=42.97%
2025-06-05 12:08:14,873 - train_models - INFO -   Fold 4: MAE=0.8307, RMSE=1.0941, R²=0.5454, MAPE=34.60%
2025-06-05 12:08:14,874 - train_models - INFO -   Fold 5: MAE=0.8506, RMSE=1.1037, R²=0.5856, MAPE=32.16%
2025-06-05 12:08:14,874 - train_models - INFO - Building model for WorkType: 214
2025-06-05 12:08:14,882 - train_models - INFO - Available features for 214: 12 numeric, 2 categorical
2025-06-05 12:08:43,416 - train_models - INFO - Model for 214 - MAE: 1.0477, RMSE: 1.3881, R²: 0.5614, MAPE: 24.96%
2025-06-05 12:08:43,417 - train_models - INFO - Top 10 most important features for 214:
2025-06-05 12:08:43,417 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6449
2025-06-05 12:08:43,418 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0672
2025-06-05 12:08:43,418 - train_models - INFO -   DayOfWeek_feat_6: 0.0306
2025-06-05 12:08:43,419 - train_models - INFO -   NoOfMan_lag_1: 0.0296
2025-06-05 12:08:43,419 - train_models - INFO -   NoOfMan_lag_7: 0.0267
2025-06-05 12:08:43,420 - train_models - INFO -   DayOfWeek_feat_4: 0.0224
2025-06-05 12:08:43,420 - train_models - INFO -   Quantity_lag_1: 0.0219
2025-06-05 12:08:43,421 - train_models - INFO -   ResourceKPI_lag_7: 0.0217
2025-06-05 12:08:43,421 - train_models - INFO -   DayOfWeek_feat_1: 0.0210
2025-06-05 12:08:43,422 - train_models - INFO -   Quantity_rolling_mean_7: 0.0205
2025-06-05 12:08:43,422 - train_models - INFO - Cross-validation details for 214:
2025-06-05 12:08:43,422 - train_models - INFO -   Fold 1: MAE=0.9904, RMSE=1.2821, R²=0.4274, MAPE=27.42%
2025-06-05 12:08:43,423 - train_models - INFO -   Fold 2: MAE=0.9718, RMSE=1.2399, R²=0.5717, MAPE=24.03%
2025-06-05 12:08:43,423 - train_models - INFO -   Fold 3: MAE=0.8083, RMSE=1.1090, R²=0.6650, MAPE=22.19%
2025-06-05 12:08:43,424 - train_models - INFO -   Fold 4: MAE=0.9580, RMSE=1.2952, R²=0.6098, MAPE=20.52%
2025-06-05 12:08:43,424 - train_models - INFO -   Fold 5: MAE=1.5100, RMSE=2.0141, R²=0.5330, MAPE=30.65%
2025-06-05 12:08:43,425 - train_models - INFO - Building model for WorkType: 215
2025-06-05 12:08:43,436 - train_models - INFO - Available features for 215: 12 numeric, 2 categorical
2025-06-05 12:09:16,057 - train_models - INFO - Model for 215 - MAE: 1.3093, RMSE: 1.9401, R²: 0.6617, MAPE: 30.32%
2025-06-05 12:09:16,057 - train_models - INFO - Top 10 most important features for 215:
2025-06-05 12:09:16,058 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3546
2025-06-05 12:09:16,058 - train_models - INFO -   DayOfWeek_feat_6: 0.2555
2025-06-05 12:09:16,059 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0752
2025-06-05 12:09:16,059 - train_models - INFO -   DayOfWeek_feat_0: 0.0694
2025-06-05 12:09:16,060 - train_models - INFO -   Quantity_rolling_mean_7: 0.0416
2025-06-05 12:09:16,060 - train_models - INFO -   Quantity_lag_1: 0.0328
2025-06-05 12:09:16,060 - train_models - INFO -   NoOfMan_lag_1: 0.0293
2025-06-05 12:09:16,061 - train_models - INFO -   ResourceKPI_lag_1: 0.0228
2025-06-05 12:09:16,061 - train_models - INFO -   ResourceKPI_lag_7: 0.0205
2025-06-05 12:09:16,062 - train_models - INFO -   SystemKPI_lag_1: 0.0192
2025-06-05 12:09:16,062 - train_models - INFO - Cross-validation details for 215:
2025-06-05 12:09:16,063 - train_models - INFO -   Fold 1: MAE=1.5191, RMSE=2.3326, R²=0.5477, MAPE=45.04%
2025-06-05 12:09:16,063 - train_models - INFO -   Fold 2: MAE=1.1602, RMSE=1.6843, R²=0.7559, MAPE=25.94%
2025-06-05 12:09:16,064 - train_models - INFO -   Fold 3: MAE=1.3331, RMSE=1.8913, R²=0.6823, MAPE=24.31%
2025-06-05 12:09:16,064 - train_models - INFO -   Fold 4: MAE=1.2210, RMSE=1.7969, R²=0.6656, MAPE=29.97%
2025-06-05 12:09:16,065 - train_models - INFO -   Fold 5: MAE=1.3133, RMSE=1.9955, R²=0.6566, MAPE=26.35%
2025-06-05 12:09:16,065 - train_models - INFO - Building model for WorkType: 217
2025-06-05 12:09:16,074 - train_models - INFO - Available features for 217: 12 numeric, 2 categorical
2025-06-05 12:09:41,514 - train_models - INFO - Model for 217 - MAE: 0.8901, RMSE: 1.2028, R²: 0.6127, MAPE: 36.66%
2025-06-05 12:09:41,514 - train_models - INFO - Top 10 most important features for 217:
2025-06-05 12:09:41,515 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.7041
2025-06-05 12:09:41,515 - train_models - INFO -   NoOfMan_lag_1: 0.0833
2025-06-05 12:09:41,515 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0572
2025-06-05 12:09:41,516 - train_models - INFO -   NoOfMan_lag_7: 0.0257
2025-06-05 12:09:41,516 - train_models - INFO -   SystemKPI_lag_1: 0.0193
2025-06-05 12:09:41,516 - train_models - INFO -   Quantity_lag_7: 0.0190
2025-06-05 12:09:41,517 - train_models - INFO -   Quantity_rolling_mean_7: 0.0168
2025-06-05 12:09:41,517 - train_models - INFO -   ResourceKPI_lag_7: 0.0141
2025-06-05 12:09:41,517 - train_models - INFO -   Quantity_lag_1: 0.0134
2025-06-05 12:09:41,518 - train_models - INFO -   ResourceKPI_lag_1: 0.0117
2025-06-05 12:09:41,518 - train_models - INFO - Cross-validation details for 217:
2025-06-05 12:09:41,518 - train_models - INFO -   Fold 1: MAE=0.8642, RMSE=1.1429, R²=0.5454, MAPE=34.61%
2025-06-05 12:09:41,518 - train_models - INFO -   Fold 2: MAE=0.8217, RMSE=1.1019, R²=0.6305, MAPE=38.35%
2025-06-05 12:09:41,519 - train_models - INFO -   Fold 3: MAE=0.7941, RMSE=1.0937, R²=0.7159, MAPE=30.22%
2025-06-05 12:09:41,519 - train_models - INFO -   Fold 4: MAE=0.9330, RMSE=1.2476, R²=0.6666, MAPE=37.19%
2025-06-05 12:09:41,520 - train_models - INFO -   Fold 5: MAE=1.0373, RMSE=1.4278, R²=0.5052, MAPE=42.95%
2025-06-05 12:09:41,521 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-05 12:09:43,239 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-05 12:09:43,589 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 501, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-05 12:09:43,597 - train_models - INFO - Model training completed successfully
2025-06-05 12:10:16,236 - train_models - INFO - Starting the model training process
2025-06-05 12:10:16,237 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-05 12:10:16,238 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 12:10:16,244 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 12:10:16,507 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 12:10:17,422 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 12:10:17,576 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 12:10:17,638 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 12:10:17,640 - train_models - INFO - Converting Date column to datetime format
2025-06-05 12:10:17,679 - train_models - INFO - Engineering features...
2025-06-05 12:10:18,651 - utils.feature_engineering - INFO - Engineering features
2025-06-05 12:10:18,716 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 12:10:18,726 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 12:10:18,726 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-05 12:10:18,727 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-05 12:10:18,749 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 12:10:19,093 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 12:10:19,094 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-05 12:10:19,116 - train_models - INFO - Found 10 unique work types
2025-06-05 12:10:19,117 - train_models - INFO - Building models for 10 work types
2025-06-05 12:10:19,118 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-05 12:10:19,118 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-05 12:10:19,119 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-05 12:10:19,121 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-05 12:10:19,122 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-05 12:10:19,122 - train_models - INFO - Building model for WorkType: 202
2025-06-05 12:10:19,131 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-05 12:10:57,354 - train_models - INFO - Model for 202 - MAE: 0.2060, RMSE: 0.3183, R²: 0.7758, MAPE: 9.95%
2025-06-05 12:10:57,355 - train_models - INFO - Top 10 most important features for 202:
2025-06-05 12:10:57,355 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3945
2025-06-05 12:10:57,356 - train_models - INFO -   NoOfMan_7day_trend: 0.1995
2025-06-05 12:10:57,356 - train_models - INFO -   NoOfMan_1day_trend: 0.1272
2025-06-05 12:10:57,357 - train_models - INFO -   NoOfMan_lag_1: 0.0681
2025-06-05 12:10:57,357 - train_models - INFO -   NoOfMan_lag_7: 0.0660
2025-06-05 12:10:57,358 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0657
2025-06-05 12:10:57,358 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0385
2025-06-05 12:10:57,359 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0056
2025-06-05 12:10:57,359 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-06-05 12:10:57,359 - train_models - INFO -   Quantity_lag_1: 0.0026
2025-06-05 12:10:57,360 - train_models - INFO - Cross-validation details for 202:
2025-06-05 12:10:57,360 - train_models - INFO -   Fold 1: MAE=0.1933, RMSE=0.3631, R²=0.5378, MAPE=10.09%
2025-06-05 12:10:57,361 - train_models - INFO -   Fold 2: MAE=0.2063, RMSE=0.3166, R²=0.7691, MAPE=11.41%
2025-06-05 12:10:57,361 - train_models - INFO -   Fold 3: MAE=0.2291, RMSE=0.3526, R²=0.8065, MAPE=11.86%
2025-06-05 12:10:57,362 - train_models - INFO -   Fold 4: MAE=0.1778, RMSE=0.2307, R²=0.8917, MAPE=8.19%
2025-06-05 12:10:57,363 - train_models - INFO -   Fold 5: MAE=0.2233, RMSE=0.3282, R²=0.8739, MAPE=8.21%
2025-06-05 12:10:57,363 - train_models - INFO - Building model for WorkType: 203
2025-06-05 12:10:57,373 - train_models - INFO - Available features for 203: 24 numeric, 3 categorical
2025-06-05 12:11:40,874 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3238, R²: 0.9142, MAPE: 4.70%
2025-06-05 12:11:40,874 - train_models - INFO - Top 10 most important features for 203:
2025-06-05 12:11:40,875 - train_models - INFO -   NoOfMan_7day_trend: 0.3018
2025-06-05 12:11:40,875 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-05 12:11:40,876 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1184
2025-06-05 12:11:40,876 - train_models - INFO -   NoOfMan_1day_trend: 0.0947
2025-06-05 12:11:40,877 - train_models - INFO -   NoOfMan_lag_7: 0.0806
2025-06-05 12:11:40,877 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0713
2025-06-05 12:11:40,878 - train_models - INFO -   NoOfMan_lag_1: 0.0564
2025-06-05 12:11:40,878 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-05 12:11:40,878 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-05 12:11:40,879 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0031
2025-06-05 12:11:40,879 - train_models - INFO - Cross-validation details for 203:
2025-06-05 12:11:40,879 - train_models - INFO -   Fold 1: MAE=0.2843, RMSE=0.3898, R²=0.8803, MAPE=5.66%
2025-06-05 12:11:40,880 - train_models - INFO -   Fold 2: MAE=0.2526, RMSE=0.3473, R²=0.9121, MAPE=4.96%
2025-06-05 12:11:40,880 - train_models - INFO -   Fold 3: MAE=0.2361, RMSE=0.3774, R²=0.8926, MAPE=4.36%
2025-06-05 12:11:40,881 - train_models - INFO -   Fold 4: MAE=0.1807, RMSE=0.2655, R²=0.9428, MAPE=4.20%
2025-06-05 12:11:40,882 - train_models - INFO -   Fold 5: MAE=0.1774, RMSE=0.2390, R²=0.9430, MAPE=4.31%
2025-06-05 12:11:40,882 - train_models - INFO - Building model for WorkType: 206
2025-06-05 12:11:40,892 - train_models - INFO - Available features for 206: 24 numeric, 3 categorical
2025-06-05 12:12:36,866 - train_models - INFO - Model for 206 - MAE: 1.3672, RMSE: 2.0797, R²: 0.9350, MAPE: 7.89%
2025-06-05 12:12:36,867 - train_models - INFO - Top 10 most important features for 206:
2025-06-05 12:12:36,867 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5202
2025-06-05 12:12:36,867 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1515
2025-06-05 12:12:36,868 - train_models - INFO -   NoOfMan_1day_trend: 0.0754
2025-06-05 12:12:36,868 - train_models - INFO -   DayOfWeek_feat_6: 0.0710
2025-06-05 12:12:36,869 - train_models - INFO -   NoOfMan_7day_trend: 0.0527
2025-06-05 12:12:36,869 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-06-05 12:12:36,870 - train_models - INFO -   NoOfMan_lag_1: 0.0288
2025-06-05 12:12:36,870 - train_models - INFO -   Quantity_rolling_mean_7: 0.0088
2025-06-05 12:12:36,871 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0070
2025-06-05 12:12:36,871 - train_models - INFO -   NoOfMan_lag_7: 0.0067
2025-06-05 12:12:36,871 - train_models - INFO - Cross-validation details for 206:
2025-06-05 12:12:36,872 - train_models - INFO -   Fold 1: MAE=1.6833, RMSE=2.3248, R²=0.9265, MAPE=9.82%
2025-06-05 12:12:36,872 - train_models - INFO -   Fold 2: MAE=1.5605, RMSE=2.2138, R²=0.9305, MAPE=8.54%
2025-06-05 12:12:36,873 - train_models - INFO -   Fold 3: MAE=1.5067, RMSE=2.6043, R²=0.8983, MAPE=8.79%
2025-06-05 12:12:36,873 - train_models - INFO -   Fold 4: MAE=0.9201, RMSE=1.4096, R²=0.9625, MAPE=6.19%
2025-06-05 12:12:36,874 - train_models - INFO -   Fold 5: MAE=1.1654, RMSE=1.8461, R²=0.9571, MAPE=6.12%
2025-06-05 12:12:36,874 - train_models - INFO - Building model for WorkType: 209
2025-06-05 12:12:36,884 - train_models - INFO - Available features for 209: 24 numeric, 3 categorical
2025-06-05 12:13:22,584 - train_models - INFO - Model for 209 - MAE: 0.8910, RMSE: 1.3922, R²: 0.8883, MAPE: 12.27%
2025-06-05 12:13:22,585 - train_models - INFO - Top 10 most important features for 209:
2025-06-05 12:13:22,585 - train_models - INFO -   NoOfMan_7day_trend: 0.4067
2025-06-05 12:13:22,586 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2159
2025-06-05 12:13:22,586 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0955
2025-06-05 12:13:22,586 - train_models - INFO -   NoOfMan_1day_trend: 0.0728
2025-06-05 12:13:22,587 - train_models - INFO -   NoOfMan_lag_7: 0.0503
2025-06-05 12:13:22,587 - train_models - INFO -   Quantity_rolling_mean_7: 0.0487
2025-06-05 12:13:22,588 - train_models - INFO -   NoOfMan_lag_1: 0.0275
2025-06-05 12:13:22,588 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0205
2025-06-05 12:13:22,589 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0100
2025-06-05 12:13:22,589 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-06-05 12:13:22,590 - train_models - INFO - Cross-validation details for 209:
2025-06-05 12:13:22,590 - train_models - INFO -   Fold 1: MAE=0.9852, RMSE=1.4513, R²=0.8592, MAPE=13.47%
2025-06-05 12:13:22,590 - train_models - INFO -   Fold 2: MAE=1.0351, RMSE=1.7406, R²=0.8438, MAPE=15.20%
2025-06-05 12:13:22,591 - train_models - INFO -   Fold 3: MAE=0.6519, RMSE=0.8754, R²=0.9399, MAPE=10.47%
2025-06-05 12:13:22,591 - train_models - INFO -   Fold 4: MAE=0.8386, RMSE=1.3931, R²=0.9011, MAPE=10.85%
2025-06-05 12:13:22,592 - train_models - INFO -   Fold 5: MAE=0.9442, RMSE=1.5007, R²=0.8975, MAPE=11.35%
2025-06-05 12:13:22,592 - train_models - INFO - Building model for WorkType: 210
2025-06-05 12:13:22,603 - train_models - INFO - Available features for 210: 24 numeric, 3 categorical
2025-06-05 12:14:09,037 - train_models - INFO - Model for 210 - MAE: 0.8066, RMSE: 1.1843, R²: 0.8887, MAPE: 17.44%
2025-06-05 12:14:09,038 - train_models - INFO - Top 10 most important features for 210:
2025-06-05 12:14:09,038 - train_models - INFO -   NoOfMan_7day_trend: 0.2797
2025-06-05 12:14:09,039 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1969
2025-06-05 12:14:09,039 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1741
2025-06-05 12:14:09,040 - train_models - INFO -   NoOfMan_1day_trend: 0.0857
2025-06-05 12:14:09,040 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0658
2025-06-05 12:14:09,040 - train_models - INFO -   NoOfMan_lag_7: 0.0394
2025-06-05 12:14:09,041 - train_models - INFO -   NoOfMan_lag_1: 0.0355
2025-06-05 12:14:09,041 - train_models - INFO -   DayOfWeek_feat_6: 0.0268
2025-06-05 12:14:09,042 - train_models - INFO -   Quantity_rolling_mean_7: 0.0139
2025-06-05 12:14:09,042 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-05 12:14:09,043 - train_models - INFO - Cross-validation details for 210:
2025-06-05 12:14:09,044 - train_models - INFO -   Fold 1: MAE=0.8194, RMSE=1.1372, R²=0.8840, MAPE=13.65%
2025-06-05 12:14:09,044 - train_models - INFO -   Fold 2: MAE=0.7315, RMSE=1.0827, R²=0.8926, MAPE=12.40%
2025-06-05 12:14:09,045 - train_models - INFO -   Fold 3: MAE=0.6101, RMSE=0.8482, R²=0.9310, MAPE=8.55%
2025-06-05 12:14:09,045 - train_models - INFO -   Fold 4: MAE=0.9206, RMSE=1.2887, R²=0.8728, MAPE=27.86%
2025-06-05 12:14:09,046 - train_models - INFO -   Fold 5: MAE=0.9515, RMSE=1.5648, R²=0.8630, MAPE=24.74%
2025-06-05 12:14:09,046 - train_models - INFO - Building model for WorkType: 211
2025-06-05 12:14:09,056 - train_models - INFO - Available features for 211: 24 numeric, 3 categorical
2025-06-05 12:14:57,243 - train_models - INFO - Model for 211 - MAE: 0.6309, RMSE: 0.9778, R²: 0.9135, MAPE: 10.72%
2025-06-05 12:14:57,244 - train_models - INFO - Top 10 most important features for 211:
2025-06-05 12:14:57,245 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3604
2025-06-05 12:14:57,245 - train_models - INFO -   NoOfMan_1day_trend: 0.1886
2025-06-05 12:14:57,245 - train_models - INFO -   NoOfMan_7day_trend: 0.1815
2025-06-05 12:14:57,246 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0693
2025-06-05 12:14:57,246 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-06-05 12:14:57,247 - train_models - INFO -   NoOfMan_lag_7: 0.0359
2025-06-05 12:14:57,247 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0340
2025-06-05 12:14:57,248 - train_models - INFO -   DayOfWeek_feat_6: 0.0333
2025-06-05 12:14:57,248 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0058
2025-06-05 12:14:57,248 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0049
2025-06-05 12:14:57,249 - train_models - INFO - Cross-validation details for 211:
2025-06-05 12:14:57,249 - train_models - INFO -   Fold 1: MAE=1.0639, RMSE=1.6412, R²=0.8126, MAPE=16.32%
2025-06-05 12:14:57,250 - train_models - INFO -   Fold 2: MAE=0.6086, RMSE=0.9744, R²=0.9113, MAPE=9.76%
2025-06-05 12:14:57,250 - train_models - INFO -   Fold 3: MAE=0.4599, RMSE=0.7014, R²=0.9573, MAPE=8.25%
2025-06-05 12:14:57,251 - train_models - INFO -   Fold 4: MAE=0.5661, RMSE=0.9105, R²=0.9307, MAPE=10.46%
2025-06-05 12:14:57,251 - train_models - INFO -   Fold 5: MAE=0.4558, RMSE=0.6614, R²=0.9553, MAPE=8.81%
2025-06-05 12:14:57,252 - train_models - INFO - Building model for WorkType: 213
2025-06-05 12:14:57,261 - train_models - INFO - Available features for 213: 24 numeric, 3 categorical
2025-06-05 12:15:42,104 - train_models - INFO - Model for 213 - MAE: 0.3867, RMSE: 0.5703, R²: 0.8941, MAPE: 15.54%
2025-06-05 12:15:42,104 - train_models - INFO - Top 10 most important features for 213:
2025-06-05 12:15:42,105 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4434
2025-06-05 12:15:42,105 - train_models - INFO -   NoOfMan_7day_trend: 0.2090
2025-06-05 12:15:42,106 - train_models - INFO -   NoOfMan_1day_trend: 0.1451
2025-06-05 12:15:42,106 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0520
2025-06-05 12:15:42,106 - train_models - INFO -   NoOfMan_lag_1: 0.0471
2025-06-05 12:15:42,107 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0302
2025-06-05 12:15:42,107 - train_models - INFO -   NoOfMan_lag_7: 0.0267
2025-06-05 12:15:42,108 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0066
2025-06-05 12:15:42,108 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0050
2025-06-05 12:15:42,109 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0040
2025-06-05 12:15:42,109 - train_models - INFO - Cross-validation details for 213:
2025-06-05 12:15:42,110 - train_models - INFO -   Fold 1: MAE=0.5203, RMSE=0.7658, R²=0.8627, MAPE=14.89%
2025-06-05 12:15:42,110 - train_models - INFO -   Fold 2: MAE=0.4477, RMSE=0.6054, R²=0.8742, MAPE=24.13%
2025-06-05 12:15:42,110 - train_models - INFO -   Fold 3: MAE=0.3160, RMSE=0.5208, R²=0.8995, MAPE=14.81%
2025-06-05 12:15:42,111 - train_models - INFO -   Fold 4: MAE=0.3301, RMSE=0.4815, R²=0.9120, MAPE=13.12%
2025-06-05 12:15:42,111 - train_models - INFO -   Fold 5: MAE=0.3195, RMSE=0.4781, R²=0.9222, MAPE=10.73%
2025-06-05 12:15:42,112 - train_models - INFO - Building model for WorkType: 214
2025-06-05 12:15:42,121 - train_models - INFO - Available features for 214: 24 numeric, 3 categorical
2025-06-05 12:16:26,752 - train_models - INFO - Model for 214 - MAE: 0.4551, RMSE: 0.6869, R²: 0.8921, MAPE: 10.18%
2025-06-05 12:16:26,752 - train_models - INFO - Top 10 most important features for 214:
2025-06-05 12:16:26,753 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5040
2025-06-05 12:16:26,753 - train_models - INFO -   NoOfMan_7day_trend: 0.1867
2025-06-05 12:16:26,754 - train_models - INFO -   NoOfMan_1day_trend: 0.0849
2025-06-05 12:16:26,754 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0645
2025-06-05 12:16:26,755 - train_models - INFO -   NoOfMan_lag_7: 0.0534
2025-06-05 12:16:26,755 - train_models - INFO -   NoOfMan_lag_1: 0.0417
2025-06-05 12:16:26,756 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0119
2025-06-05 12:16:26,756 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-06-05 12:16:26,757 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0068
2025-06-05 12:16:26,757 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0067
2025-06-05 12:16:26,758 - train_models - INFO - Cross-validation details for 214:
2025-06-05 12:16:26,758 - train_models - INFO -   Fold 1: MAE=0.4930, RMSE=0.6834, R²=0.8373, MAPE=13.52%
2025-06-05 12:16:26,759 - train_models - INFO -   Fold 2: MAE=0.4115, RMSE=0.5240, R²=0.9235, MAPE=9.74%
2025-06-05 12:16:26,759 - train_models - INFO -   Fold 3: MAE=0.3050, RMSE=0.4275, R²=0.9502, MAPE=8.78%
2025-06-05 12:16:26,760 - train_models - INFO -   Fold 4: MAE=0.3088, RMSE=0.5360, R²=0.9332, MAPE=5.63%
2025-06-05 12:16:26,760 - train_models - INFO -   Fold 5: MAE=0.7573, RMSE=1.2635, R²=0.8162, MAPE=13.26%
2025-06-05 12:16:26,760 - train_models - INFO - Building model for WorkType: 215
2025-06-05 12:16:26,771 - train_models - INFO - Available features for 215: 24 numeric, 3 categorical
2025-06-05 12:17:22,157 - train_models - INFO - Model for 215 - MAE: 0.6548, RMSE: 1.0373, R²: 0.9009, MAPE: 14.98%
2025-06-05 12:17:22,157 - train_models - INFO - Top 10 most important features for 215:
2025-06-05 12:17:22,158 - train_models - INFO -   NoOfMan_7day_trend: 0.1812
2025-06-05 12:17:22,158 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1696
2025-06-05 12:17:22,159 - train_models - INFO -   DayOfWeek_feat_6: 0.1686
2025-06-05 12:17:22,159 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1418
2025-06-05 12:17:22,160 - train_models - INFO -   NoOfMan_1day_trend: 0.1332
2025-06-05 12:17:22,160 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0650
2025-06-05 12:17:22,161 - train_models - INFO -   NoOfMan_lag_1: 0.0352
2025-06-05 12:17:22,161 - train_models - INFO -   NoOfMan_lag_7: 0.0293
2025-06-05 12:17:22,162 - train_models - INFO -   Quantity_rolling_mean_7: 0.0103
2025-06-05 12:17:22,162 - train_models - INFO -   Quantity_lag_1: 0.0102
2025-06-05 12:17:22,163 - train_models - INFO - Cross-validation details for 215:
2025-06-05 12:17:22,163 - train_models - INFO -   Fold 1: MAE=0.9506, RMSE=1.4905, R²=0.8153, MAPE=25.62%
2025-06-05 12:17:22,164 - train_models - INFO -   Fold 2: MAE=0.6761, RMSE=1.0026, R²=0.9135, MAPE=15.01%
2025-06-05 12:17:22,164 - train_models - INFO -   Fold 3: MAE=0.6484, RMSE=1.0351, R²=0.9049, MAPE=11.52%
2025-06-05 12:17:22,165 - train_models - INFO -   Fold 4: MAE=0.4934, RMSE=0.7674, R²=0.9390, MAPE=12.41%
2025-06-05 12:17:22,166 - train_models - INFO -   Fold 5: MAE=0.5056, RMSE=0.8912, R²=0.9315, MAPE=10.31%
2025-06-05 12:17:22,167 - train_models - INFO - Building model for WorkType: 217
2025-06-05 12:17:22,180 - train_models - INFO - Available features for 217: 24 numeric, 3 categorical
2025-06-05 12:18:01,253 - train_models - INFO - Model for 217 - MAE: 0.4113, RMSE: 0.5503, R²: 0.9105, MAPE: 17.32%
2025-06-05 12:18:01,254 - train_models - INFO - Top 10 most important features for 217:
2025-06-05 12:18:01,254 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5716
2025-06-05 12:18:01,255 - train_models - INFO -   NoOfMan_7day_trend: 0.1210
2025-06-05 12:18:01,255 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0832
2025-06-05 12:18:01,256 - train_models - INFO -   NoOfMan_1day_trend: 0.0666
2025-06-05 12:18:01,256 - train_models - INFO -   NoOfMan_lag_1: 0.0660
2025-06-05 12:18:01,257 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0377
2025-06-05 12:18:01,257 - train_models - INFO -   NoOfMan_lag_7: 0.0241
2025-06-05 12:18:01,258 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-06-05 12:18:01,258 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0040
2025-06-05 12:18:01,258 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-06-05 12:18:01,259 - train_models - INFO - Cross-validation details for 217:
2025-06-05 12:18:01,259 - train_models - INFO -   Fold 1: MAE=0.5941, RMSE=0.7161, R²=0.8215, MAPE=25.99%
2025-06-05 12:18:01,260 - train_models - INFO -   Fold 2: MAE=0.4204, RMSE=0.5471, R²=0.9089, MAPE=21.07%
2025-06-05 12:18:01,260 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.4860, R²=0.9439, MAPE=13.15%
2025-06-05 12:18:01,261 - train_models - INFO -   Fold 4: MAE=0.3151, RMSE=0.4015, R²=0.9655, MAPE=13.01%
2025-06-05 12:18:01,261 - train_models - INFO -   Fold 5: MAE=0.3625, RMSE=0.6007, R²=0.9124, MAPE=13.38%
2025-06-05 12:18:01,263 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-05 12:18:02,617 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-05 12:18:02,629 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 501, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-05 12:18:02,637 - train_models - INFO - Model training completed successfully
2025-06-05 13:09:44,327 - train_models - INFO - Starting the model training process
2025-06-05 13:09:44,327 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-05 13:09:44,328 - train_models - INFO - Training from SQL database (command line argument)
2025-06-05 13:09:44,336 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-05 13:09:44,768 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-05 13:09:45,608 - train_models - INFO - Read chunk of 10000 rows
2025-06-05 13:09:45,705 - train_models - INFO - Read chunk of 5326 rows
2025-06-05 13:09:45,748 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-05 13:09:45,749 - train_models - INFO - Converting Date column to datetime format
2025-06-05 13:09:45,774 - train_models - INFO - Engineering features...
2025-06-05 13:09:46,753 - utils.feature_engineering - INFO - Engineering features
2025-06-05 13:09:46,809 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-05 13:09:46,817 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-05 13:09:46,817 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-05 13:09:46,817 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-05 13:09:46,836 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-05 13:09:47,330 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-05 13:09:47,331 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-05 13:09:47,357 - train_models - INFO - Found 10 unique work types
2025-06-05 13:09:47,358 - train_models - INFO - Building models for 10 work types
2025-06-05 13:09:47,358 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-05 13:09:47,359 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-05 13:09:47,359 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-05 13:09:47,360 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-05 13:09:47,360 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-05 13:09:47,360 - train_models - INFO - Building model for WorkType: 202
2025-06-05 13:09:47,373 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-05 13:10:24,319 - train_models - INFO - Model for 202 - MAE: 0.2060, RMSE: 0.3183, R²: 0.7758, MAPE: 9.95%
2025-06-05 13:10:24,320 - train_models - INFO - Top 10 most important features for 202:
2025-06-05 13:10:24,320 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3945
2025-06-05 13:10:24,321 - train_models - INFO -   NoOfMan_7day_trend: 0.1995
2025-06-05 13:10:24,321 - train_models - INFO -   NoOfMan_1day_trend: 0.1272
2025-06-05 13:10:24,322 - train_models - INFO -   NoOfMan_lag_1: 0.0681
2025-06-05 13:10:24,322 - train_models - INFO -   NoOfMan_lag_7: 0.0660
2025-06-05 13:10:24,323 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0657
2025-06-05 13:10:24,323 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0385
2025-06-05 13:10:24,324 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0056
2025-06-05 13:10:24,324 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-06-05 13:10:24,324 - train_models - INFO -   Quantity_lag_1: 0.0026
2025-06-05 13:10:24,325 - train_models - INFO - Cross-validation details for 202:
2025-06-05 13:10:24,325 - train_models - INFO -   Fold 1: MAE=0.1933, RMSE=0.3631, R²=0.5378, MAPE=10.09%
2025-06-05 13:10:24,326 - train_models - INFO -   Fold 2: MAE=0.2063, RMSE=0.3166, R²=0.7691, MAPE=11.41%
2025-06-05 13:10:24,326 - train_models - INFO -   Fold 3: MAE=0.2291, RMSE=0.3526, R²=0.8065, MAPE=11.86%
2025-06-05 13:10:24,327 - train_models - INFO -   Fold 4: MAE=0.1778, RMSE=0.2307, R²=0.8917, MAPE=8.19%
2025-06-05 13:10:24,327 - train_models - INFO -   Fold 5: MAE=0.2233, RMSE=0.3282, R²=0.8739, MAPE=8.21%
2025-06-05 13:10:24,328 - train_models - INFO - Building model for WorkType: 203
2025-06-05 13:10:24,340 - train_models - INFO - Available features for 203: 24 numeric, 3 categorical
2025-06-05 13:11:06,325 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3238, R²: 0.9142, MAPE: 4.70%
2025-06-05 13:11:06,326 - train_models - INFO - Top 10 most important features for 203:
2025-06-05 13:11:06,326 - train_models - INFO -   NoOfMan_7day_trend: 0.3018
2025-06-05 13:11:06,327 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-05 13:11:06,327 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1184
2025-06-05 13:11:06,328 - train_models - INFO -   NoOfMan_1day_trend: 0.0947
2025-06-05 13:11:06,328 - train_models - INFO -   NoOfMan_lag_7: 0.0806
2025-06-05 13:11:06,329 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0713
2025-06-05 13:11:06,329 - train_models - INFO -   NoOfMan_lag_1: 0.0564
2025-06-05 13:11:06,329 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-05 13:11:06,330 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-05 13:11:06,330 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0031
2025-06-05 13:11:06,331 - train_models - INFO - Cross-validation details for 203:
2025-06-05 13:11:06,331 - train_models - INFO -   Fold 1: MAE=0.2843, RMSE=0.3898, R²=0.8803, MAPE=5.66%
2025-06-05 13:11:06,332 - train_models - INFO -   Fold 2: MAE=0.2526, RMSE=0.3473, R²=0.9121, MAPE=4.96%
2025-06-05 13:11:06,332 - train_models - INFO -   Fold 3: MAE=0.2361, RMSE=0.3774, R²=0.8926, MAPE=4.36%
2025-06-05 13:11:06,333 - train_models - INFO -   Fold 4: MAE=0.1807, RMSE=0.2655, R²=0.9428, MAPE=4.20%
2025-06-05 13:11:06,333 - train_models - INFO -   Fold 5: MAE=0.1774, RMSE=0.2390, R²=0.9430, MAPE=4.31%
2025-06-05 13:11:06,334 - train_models - INFO - Building model for WorkType: 206
2025-06-05 13:11:06,342 - train_models - INFO - Available features for 206: 24 numeric, 3 categorical
2025-06-05 13:12:00,752 - train_models - INFO - Model for 206 - MAE: 1.3672, RMSE: 2.0797, R²: 0.9350, MAPE: 7.89%
2025-06-05 13:12:00,753 - train_models - INFO - Top 10 most important features for 206:
2025-06-05 13:12:00,753 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5202
2025-06-05 13:12:00,754 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1515
2025-06-05 13:12:00,754 - train_models - INFO -   NoOfMan_1day_trend: 0.0754
2025-06-05 13:12:00,755 - train_models - INFO -   DayOfWeek_feat_6: 0.0710
2025-06-05 13:12:00,755 - train_models - INFO -   NoOfMan_7day_trend: 0.0527
2025-06-05 13:12:00,755 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-06-05 13:12:00,756 - train_models - INFO -   NoOfMan_lag_1: 0.0288
2025-06-05 13:12:00,756 - train_models - INFO -   Quantity_rolling_mean_7: 0.0088
2025-06-05 13:12:00,757 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0070
2025-06-05 13:12:00,757 - train_models - INFO -   NoOfMan_lag_7: 0.0067
2025-06-05 13:12:00,758 - train_models - INFO - Cross-validation details for 206:
2025-06-05 13:12:00,758 - train_models - INFO -   Fold 1: MAE=1.6833, RMSE=2.3248, R²=0.9265, MAPE=9.82%
2025-06-05 13:12:00,759 - train_models - INFO -   Fold 2: MAE=1.5605, RMSE=2.2138, R²=0.9305, MAPE=8.54%
2025-06-05 13:12:00,759 - train_models - INFO -   Fold 3: MAE=1.5067, RMSE=2.6043, R²=0.8983, MAPE=8.79%
2025-06-05 13:12:00,760 - train_models - INFO -   Fold 4: MAE=0.9201, RMSE=1.4096, R²=0.9625, MAPE=6.19%
2025-06-05 13:12:00,760 - train_models - INFO -   Fold 5: MAE=1.1654, RMSE=1.8461, R²=0.9571, MAPE=6.12%
2025-06-05 13:12:00,760 - train_models - INFO - Building model for WorkType: 209
2025-06-05 13:12:00,773 - train_models - INFO - Available features for 209: 24 numeric, 3 categorical
2025-06-05 13:12:45,020 - train_models - INFO - Model for 209 - MAE: 0.8910, RMSE: 1.3922, R²: 0.8883, MAPE: 12.27%
2025-06-05 13:12:45,020 - train_models - INFO - Top 10 most important features for 209:
2025-06-05 13:12:45,021 - train_models - INFO -   NoOfMan_7day_trend: 0.4067
2025-06-05 13:12:45,021 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2159
2025-06-05 13:12:45,022 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0955
2025-06-05 13:12:45,022 - train_models - INFO -   NoOfMan_1day_trend: 0.0728
2025-06-05 13:12:45,023 - train_models - INFO -   NoOfMan_lag_7: 0.0503
2025-06-05 13:12:45,023 - train_models - INFO -   Quantity_rolling_mean_7: 0.0487
2025-06-05 13:12:45,023 - train_models - INFO -   NoOfMan_lag_1: 0.0275
2025-06-05 13:12:45,024 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0205
2025-06-05 13:12:45,024 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0100
2025-06-05 13:12:45,025 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-06-05 13:12:45,025 - train_models - INFO - Cross-validation details for 209:
2025-06-05 13:12:45,026 - train_models - INFO -   Fold 1: MAE=0.9852, RMSE=1.4513, R²=0.8592, MAPE=13.47%
2025-06-05 13:12:45,026 - train_models - INFO -   Fold 2: MAE=1.0351, RMSE=1.7406, R²=0.8438, MAPE=15.20%
2025-06-05 13:12:45,027 - train_models - INFO -   Fold 3: MAE=0.6519, RMSE=0.8754, R²=0.9399, MAPE=10.47%
2025-06-05 13:12:45,027 - train_models - INFO -   Fold 4: MAE=0.8386, RMSE=1.3931, R²=0.9011, MAPE=10.85%
2025-06-05 13:12:45,028 - train_models - INFO -   Fold 5: MAE=0.9442, RMSE=1.5007, R²=0.8975, MAPE=11.35%
2025-06-05 13:12:45,028 - train_models - INFO - Building model for WorkType: 210
2025-06-05 13:12:45,038 - train_models - INFO - Available features for 210: 24 numeric, 3 categorical
2025-06-05 13:13:30,022 - train_models - INFO - Model for 210 - MAE: 0.8066, RMSE: 1.1843, R²: 0.8887, MAPE: 17.44%
2025-06-05 13:13:30,023 - train_models - INFO - Top 10 most important features for 210:
2025-06-05 13:13:30,023 - train_models - INFO -   NoOfMan_7day_trend: 0.2797
2025-06-05 13:13:30,024 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1969
2025-06-05 13:13:30,024 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1741
2025-06-05 13:13:30,024 - train_models - INFO -   NoOfMan_1day_trend: 0.0857
2025-06-05 13:13:30,025 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0658
2025-06-05 13:13:30,025 - train_models - INFO -   NoOfMan_lag_7: 0.0394
2025-06-05 13:13:30,026 - train_models - INFO -   NoOfMan_lag_1: 0.0355
2025-06-05 13:13:30,026 - train_models - INFO -   DayOfWeek_feat_6: 0.0268
2025-06-05 13:13:30,027 - train_models - INFO -   Quantity_rolling_mean_7: 0.0139
2025-06-05 13:13:30,027 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-05 13:13:30,028 - train_models - INFO - Cross-validation details for 210:
2025-06-05 13:13:30,028 - train_models - INFO -   Fold 1: MAE=0.8194, RMSE=1.1372, R²=0.8840, MAPE=13.65%
2025-06-05 13:13:30,029 - train_models - INFO -   Fold 2: MAE=0.7315, RMSE=1.0827, R²=0.8926, MAPE=12.40%
2025-06-05 13:13:30,029 - train_models - INFO -   Fold 3: MAE=0.6101, RMSE=0.8482, R²=0.9310, MAPE=8.55%
2025-06-05 13:13:30,030 - train_models - INFO -   Fold 4: MAE=0.9206, RMSE=1.2887, R²=0.8728, MAPE=27.86%
2025-06-05 13:13:30,030 - train_models - INFO -   Fold 5: MAE=0.9515, RMSE=1.5648, R²=0.8630, MAPE=24.74%
2025-06-05 13:13:30,030 - train_models - INFO - Building model for WorkType: 211
2025-06-05 13:13:30,041 - train_models - INFO - Available features for 211: 24 numeric, 3 categorical
2025-06-05 13:14:25,896 - train_models - INFO - Model for 211 - MAE: 0.6309, RMSE: 0.9778, R²: 0.9135, MAPE: 10.72%
2025-06-05 13:14:25,897 - train_models - INFO - Top 10 most important features for 211:
2025-06-05 13:14:25,897 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3604
2025-06-05 13:14:25,898 - train_models - INFO -   NoOfMan_1day_trend: 0.1886
2025-06-05 13:14:25,898 - train_models - INFO -   NoOfMan_7day_trend: 0.1815
2025-06-05 13:14:25,898 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0693
2025-06-05 13:14:25,899 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-06-05 13:14:25,899 - train_models - INFO -   NoOfMan_lag_7: 0.0359
2025-06-05 13:14:25,900 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0340
2025-06-05 13:14:25,900 - train_models - INFO -   DayOfWeek_feat_6: 0.0333
2025-06-05 13:14:25,901 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0058
2025-06-05 13:14:25,901 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0049
2025-06-05 13:14:25,902 - train_models - INFO - Cross-validation details for 211:
2025-06-05 13:14:25,902 - train_models - INFO -   Fold 1: MAE=1.0639, RMSE=1.6412, R²=0.8126, MAPE=16.32%
2025-06-05 13:14:25,902 - train_models - INFO -   Fold 2: MAE=0.6086, RMSE=0.9744, R²=0.9113, MAPE=9.76%
2025-06-05 13:14:25,903 - train_models - INFO -   Fold 3: MAE=0.4599, RMSE=0.7014, R²=0.9573, MAPE=8.25%
2025-06-05 13:14:25,903 - train_models - INFO -   Fold 4: MAE=0.5661, RMSE=0.9105, R²=0.9307, MAPE=10.46%
2025-06-05 13:14:25,904 - train_models - INFO -   Fold 5: MAE=0.4558, RMSE=0.6614, R²=0.9553, MAPE=8.81%
2025-06-05 13:14:25,904 - train_models - INFO - Building model for WorkType: 213
2025-06-05 13:14:25,918 - train_models - INFO - Available features for 213: 24 numeric, 3 categorical
2025-06-05 13:15:17,765 - train_models - INFO - Model for 213 - MAE: 0.3867, RMSE: 0.5703, R²: 0.8941, MAPE: 15.54%
2025-06-05 13:15:17,765 - train_models - INFO - Top 10 most important features for 213:
2025-06-05 13:15:17,766 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4434
2025-06-05 13:15:17,766 - train_models - INFO -   NoOfMan_7day_trend: 0.2090
2025-06-05 13:15:17,767 - train_models - INFO -   NoOfMan_1day_trend: 0.1451
2025-06-05 13:15:17,767 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0520
2025-06-05 13:15:17,768 - train_models - INFO -   NoOfMan_lag_1: 0.0471
2025-06-05 13:15:17,768 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0302
2025-06-05 13:15:17,769 - train_models - INFO -   NoOfMan_lag_7: 0.0267
2025-06-05 13:15:17,769 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0066
2025-06-05 13:15:17,770 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0050
2025-06-05 13:15:17,770 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0040
2025-06-05 13:15:17,771 - train_models - INFO - Cross-validation details for 213:
2025-06-05 13:15:17,771 - train_models - INFO -   Fold 1: MAE=0.5203, RMSE=0.7658, R²=0.8627, MAPE=14.89%
2025-06-05 13:15:17,771 - train_models - INFO -   Fold 2: MAE=0.4477, RMSE=0.6054, R²=0.8742, MAPE=24.13%
2025-06-05 13:15:17,772 - train_models - INFO -   Fold 3: MAE=0.3160, RMSE=0.5208, R²=0.8995, MAPE=14.81%
2025-06-05 13:15:17,772 - train_models - INFO -   Fold 4: MAE=0.3301, RMSE=0.4815, R²=0.9120, MAPE=13.12%
2025-06-05 13:15:17,773 - train_models - INFO -   Fold 5: MAE=0.3195, RMSE=0.4781, R²=0.9222, MAPE=10.73%
2025-06-05 13:15:17,773 - train_models - INFO - Building model for WorkType: 214
2025-06-05 13:15:17,785 - train_models - INFO - Available features for 214: 24 numeric, 3 categorical
2025-06-05 13:16:00,609 - train_models - INFO - Model for 214 - MAE: 0.4551, RMSE: 0.6869, R²: 0.8921, MAPE: 10.18%
2025-06-05 13:16:00,610 - train_models - INFO - Top 10 most important features for 214:
2025-06-05 13:16:00,610 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5040
2025-06-05 13:16:00,611 - train_models - INFO -   NoOfMan_7day_trend: 0.1867
2025-06-05 13:16:00,611 - train_models - INFO -   NoOfMan_1day_trend: 0.0849
2025-06-05 13:16:00,612 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0645
2025-06-05 13:16:00,612 - train_models - INFO -   NoOfMan_lag_7: 0.0534
2025-06-05 13:16:00,612 - train_models - INFO -   NoOfMan_lag_1: 0.0417
2025-06-05 13:16:00,613 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0119
2025-06-05 13:16:00,613 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-06-05 13:16:00,614 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0068
2025-06-05 13:16:00,614 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0067
2025-06-05 13:16:00,614 - train_models - INFO - Cross-validation details for 214:
2025-06-05 13:16:00,615 - train_models - INFO -   Fold 1: MAE=0.4930, RMSE=0.6834, R²=0.8373, MAPE=13.52%
2025-06-05 13:16:00,615 - train_models - INFO -   Fold 2: MAE=0.4115, RMSE=0.5240, R²=0.9235, MAPE=9.74%
2025-06-05 13:16:00,616 - train_models - INFO -   Fold 3: MAE=0.3050, RMSE=0.4275, R²=0.9502, MAPE=8.78%
2025-06-05 13:16:00,616 - train_models - INFO -   Fold 4: MAE=0.3088, RMSE=0.5360, R²=0.9332, MAPE=5.63%
2025-06-05 13:16:00,617 - train_models - INFO -   Fold 5: MAE=0.7573, RMSE=1.2635, R²=0.8162, MAPE=13.26%
2025-06-05 13:16:00,617 - train_models - INFO - Building model for WorkType: 215
2025-06-05 13:16:00,629 - train_models - INFO - Available features for 215: 24 numeric, 3 categorical
2025-06-05 13:16:49,399 - train_models - INFO - Model for 215 - MAE: 0.6548, RMSE: 1.0373, R²: 0.9009, MAPE: 14.98%
2025-06-05 13:16:49,399 - train_models - INFO - Top 10 most important features for 215:
2025-06-05 13:16:49,400 - train_models - INFO -   NoOfMan_7day_trend: 0.1812
2025-06-05 13:16:49,400 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1696
2025-06-05 13:16:49,401 - train_models - INFO -   DayOfWeek_feat_6: 0.1686
2025-06-05 13:16:49,401 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1418
2025-06-05 13:16:49,402 - train_models - INFO -   NoOfMan_1day_trend: 0.1332
2025-06-05 13:16:49,402 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0650
2025-06-05 13:16:49,403 - train_models - INFO -   NoOfMan_lag_1: 0.0352
2025-06-05 13:16:49,403 - train_models - INFO -   NoOfMan_lag_7: 0.0293
2025-06-05 13:16:49,404 - train_models - INFO -   Quantity_rolling_mean_7: 0.0103
2025-06-05 13:16:49,404 - train_models - INFO -   Quantity_lag_1: 0.0102
2025-06-05 13:16:49,404 - train_models - INFO - Cross-validation details for 215:
2025-06-05 13:16:49,405 - train_models - INFO -   Fold 1: MAE=0.9506, RMSE=1.4905, R²=0.8153, MAPE=25.62%
2025-06-05 13:16:49,405 - train_models - INFO -   Fold 2: MAE=0.6761, RMSE=1.0026, R²=0.9135, MAPE=15.01%
2025-06-05 13:16:49,406 - train_models - INFO -   Fold 3: MAE=0.6484, RMSE=1.0351, R²=0.9049, MAPE=11.52%
2025-06-05 13:16:49,406 - train_models - INFO -   Fold 4: MAE=0.4934, RMSE=0.7674, R²=0.9390, MAPE=12.41%
2025-06-05 13:16:49,407 - train_models - INFO -   Fold 5: MAE=0.5056, RMSE=0.8912, R²=0.9315, MAPE=10.31%
2025-06-05 13:16:49,407 - train_models - INFO - Building model for WorkType: 217
2025-06-05 13:16:49,416 - train_models - INFO - Available features for 217: 24 numeric, 3 categorical
2025-06-05 13:17:25,401 - train_models - INFO - Model for 217 - MAE: 0.4113, RMSE: 0.5503, R²: 0.9105, MAPE: 17.32%
2025-06-05 13:17:25,402 - train_models - INFO - Top 10 most important features for 217:
2025-06-05 13:17:25,402 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5716
2025-06-05 13:17:25,403 - train_models - INFO -   NoOfMan_7day_trend: 0.1210
2025-06-05 13:17:25,403 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0832
2025-06-05 13:17:25,403 - train_models - INFO -   NoOfMan_1day_trend: 0.0666
2025-06-05 13:17:25,404 - train_models - INFO -   NoOfMan_lag_1: 0.0660
2025-06-05 13:17:25,404 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0377
2025-06-05 13:17:25,405 - train_models - INFO -   NoOfMan_lag_7: 0.0241
2025-06-05 13:17:25,405 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-06-05 13:17:25,406 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0040
2025-06-05 13:17:25,406 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-06-05 13:17:25,407 - train_models - INFO - Cross-validation details for 217:
2025-06-05 13:17:25,407 - train_models - INFO -   Fold 1: MAE=0.5941, RMSE=0.7161, R²=0.8215, MAPE=25.99%
2025-06-05 13:17:25,407 - train_models - INFO -   Fold 2: MAE=0.4204, RMSE=0.5471, R²=0.9089, MAPE=21.07%
2025-06-05 13:17:25,408 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.4860, R²=0.9439, MAPE=13.15%
2025-06-05 13:17:25,408 - train_models - INFO -   Fold 4: MAE=0.3151, RMSE=0.4015, R²=0.9655, MAPE=13.01%
2025-06-05 13:17:25,409 - train_models - INFO -   Fold 5: MAE=0.3625, RMSE=0.6007, R²=0.9124, MAPE=13.38%
2025-06-05 13:17:25,410 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-05 13:17:26,784 - train_models - INFO - Model files saved successfully
2025-06-05 13:17:26,785 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-05 13:17:26,785 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-05 13:17:26,791 - train_models - INFO - Model training completed successfully
2025-06-07 16:12:33,764 - train_models - INFO - Starting the model training process
2025-06-07 16:12:33,770 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:12:33,770 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-06-07 16:12:58,194 - train_models - INFO - Starting the model training process
2025-06-07 16:12:58,195 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:12:58,195 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:12:58,202 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:13:03,203 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:13:04,148 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:13:04,278 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:13:04,320 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:13:04,321 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:13:04,343 - train_models - INFO - Engineering features...
2025-06-07 16:13:05,467 - utils.feature_engineering - INFO - Engineering features
2025-06-07 16:13:05,525 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-07 16:13:05,532 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 16:13:05,533 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 16:13:05,533 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 16:13:05,554 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-07 16:13:05,879 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 16:13:05,879 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-07 16:13:05,900 - train_models - INFO - Found 10 unique work types
2025-06-07 16:13:05,901 - train_models - INFO - Building models for 10 work types
2025-06-07 16:13:05,901 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:13:05,902 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-07 16:13:05,902 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-07 16:13:05,903 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-07 16:13:05,903 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 16:13:05,904 - train_models - INFO - Building model for WorkType: 202
2025-06-07 16:13:05,912 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-07 16:13:43,524 - train_models - INFO - Model for 202 - MAE: 0.2060, RMSE: 0.3183, R²: 0.7758, MAPE: 9.95%
2025-06-07 16:13:43,525 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 16:13:43,525 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3945
2025-06-07 16:13:43,526 - train_models - INFO -   NoOfMan_7day_trend: 0.1995
2025-06-07 16:13:43,526 - train_models - INFO -   NoOfMan_1day_trend: 0.1272
2025-06-07 16:13:43,527 - train_models - INFO -   NoOfMan_lag_1: 0.0681
2025-06-07 16:13:43,527 - train_models - INFO -   NoOfMan_lag_7: 0.0660
2025-06-07 16:13:43,528 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0657
2025-06-07 16:13:43,528 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0385
2025-06-07 16:13:43,529 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0056
2025-06-07 16:13:43,529 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-06-07 16:13:43,530 - train_models - INFO -   Quantity_lag_1: 0.0026
2025-06-07 16:13:43,530 - train_models - INFO - Cross-validation details for 202:
2025-06-07 16:13:43,531 - train_models - INFO -   Fold 1: MAE=0.1933, RMSE=0.3631, R²=0.5378, MAPE=10.09%
2025-06-07 16:13:43,531 - train_models - INFO -   Fold 2: MAE=0.2063, RMSE=0.3166, R²=0.7691, MAPE=11.41%
2025-06-07 16:13:43,532 - train_models - INFO -   Fold 3: MAE=0.2291, RMSE=0.3526, R²=0.8065, MAPE=11.86%
2025-06-07 16:13:43,532 - train_models - INFO -   Fold 4: MAE=0.1778, RMSE=0.2307, R²=0.8917, MAPE=8.19%
2025-06-07 16:13:43,533 - train_models - INFO -   Fold 5: MAE=0.2233, RMSE=0.3282, R²=0.8739, MAPE=8.21%
2025-06-07 16:13:43,533 - train_models - INFO - Building model for WorkType: 203
2025-06-07 16:13:43,546 - train_models - INFO - Available features for 203: 24 numeric, 3 categorical
2025-06-07 16:14:26,170 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3238, R²: 0.9142, MAPE: 4.70%
2025-06-07 16:14:26,171 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 16:14:26,171 - train_models - INFO -   NoOfMan_7day_trend: 0.3018
2025-06-07 16:14:26,172 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-07 16:14:26,172 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1184
2025-06-07 16:14:26,173 - train_models - INFO -   NoOfMan_1day_trend: 0.0947
2025-06-07 16:14:26,173 - train_models - INFO -   NoOfMan_lag_7: 0.0806
2025-06-07 16:14:26,174 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0713
2025-06-07 16:14:26,174 - train_models - INFO -   NoOfMan_lag_1: 0.0564
2025-06-07 16:14:26,174 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-07 16:14:26,175 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-07 16:14:26,175 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0031
2025-06-07 16:14:26,176 - train_models - INFO - Cross-validation details for 203:
2025-06-07 16:14:26,176 - train_models - INFO -   Fold 1: MAE=0.2843, RMSE=0.3898, R²=0.8803, MAPE=5.66%
2025-06-07 16:14:26,177 - train_models - INFO -   Fold 2: MAE=0.2526, RMSE=0.3473, R²=0.9121, MAPE=4.96%
2025-06-07 16:14:26,177 - train_models - INFO -   Fold 3: MAE=0.2361, RMSE=0.3774, R²=0.8926, MAPE=4.36%
2025-06-07 16:14:26,178 - train_models - INFO -   Fold 4: MAE=0.1807, RMSE=0.2655, R²=0.9428, MAPE=4.20%
2025-06-07 16:14:26,178 - train_models - INFO -   Fold 5: MAE=0.1774, RMSE=0.2390, R²=0.9430, MAPE=4.31%
2025-06-07 16:14:26,179 - train_models - INFO - Building model for WorkType: 206
2025-06-07 16:14:26,192 - train_models - INFO - Available features for 206: 24 numeric, 3 categorical
2025-06-07 16:15:59,485 - train_models - INFO - Starting the model training process
2025-06-07 16:15:59,485 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:15:59,486 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:15:59,492 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:15:59,804 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:16:00,856 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:16:00,994 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:16:01,040 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:16:01,041 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:16:01,066 - train_models - ERROR - Error in train_from_sql: cannot access local variable 'work_types' where it is not associated with a value
2025-06-07 16:16:01,068 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 412, in train_from_sql
    for work_type in work_types:
                     ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'work_types' where it is not associated with a value

2025-06-07 16:16:01,070 - train_models - ERROR - SQL training failed. Check logs for details.
2025-06-07 16:17:40,284 - train_models - INFO - Starting the model training process
2025-06-07 16:17:40,284 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:17:40,285 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:17:40,291 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:17:40,644 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:17:41,585 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:17:41,708 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:17:41,753 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:17:41,753 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:17:41,775 - train_models - ERROR - Error in train_from_sql: cannot access local variable 'lag_features_df' where it is not associated with a value
2025-06-07 16:17:41,776 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 410, in train_from_sql
    work_types = lag_features_df['WorkType'].unique()
                 ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'lag_features_df' where it is not associated with a value

2025-06-07 16:17:41,779 - train_models - ERROR - SQL training failed. Check logs for details.
2025-06-07 16:18:33,332 - train_models - INFO - Starting the model training process
2025-06-07 16:18:33,332 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:18:33,333 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:18:33,340 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:18:33,665 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:18:34,709 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:18:34,835 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:18:34,883 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:18:34,884 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:18:34,908 - train_models - ERROR - Error in train_from_sql: cannot access local variable 'lag_features_df' where it is not associated with a value
2025-06-07 16:18:34,910 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 413, in train_from_sql
    avg_value = diagnose_training_data(lag_features_df, work_type)
                                       ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'lag_features_df' where it is not associated with a value

2025-06-07 16:18:34,912 - train_models - ERROR - SQL training failed. Check logs for details.
2025-06-07 16:18:43,780 - train_models - INFO - Starting the model training process
2025-06-07 16:18:43,780 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:18:43,781 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:18:43,787 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:18:44,102 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:18:45,072 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:18:45,170 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:18:45,252 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:18:45,253 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:18:45,282 - train_models - ERROR - Error in train_from_sql: cannot access local variable 'lag_features_df' where it is not associated with a value
2025-06-07 16:18:45,283 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 413, in train_from_sql
    avg_value = diagnose_training_data(lag_features_df, work_type)
                                       ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'lag_features_df' where it is not associated with a value

2025-06-07 16:18:45,286 - train_models - ERROR - SQL training failed. Check logs for details.
2025-06-07 16:26:35,012 - train_models - INFO - Starting the model training process
2025-06-07 16:26:35,012 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:26:35,013 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:26:35,018 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:26:35,293 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:26:35,983 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:26:36,059 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:26:36,106 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:26:36,106 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:26:36,128 - train_models - INFO - Engineering features...
2025-06-07 16:26:37,133 - utils.feature_engineering - INFO - Engineering features
2025-06-07 16:26:37,189 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-07 16:26:37,196 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 16:26:37,197 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 16:26:37,197 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 16:26:37,219 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-07 16:26:37,529 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 16:26:37,530 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-07 16:26:37,551 - train_models - INFO - Found 10 unique work types
2025-06-07 16:26:37,551 - train_models - INFO - Building models for 10 work types
2025-06-07 16:26:37,552 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:26:37,552 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-07 16:26:37,552 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-07 16:26:37,553 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-07 16:26:37,553 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 16:26:37,554 - train_models - INFO - Building model for WorkType: 202
2025-06-07 16:26:37,581 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-07 16:27:19,972 - train_models - INFO - Starting the model training process
2025-06-07 16:27:19,972 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:27:19,972 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:27:19,978 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:27:20,338 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:27:21,031 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:27:21,108 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:27:21,154 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:27:21,154 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:27:21,175 - train_models - INFO - Engineering features...
2025-06-07 16:27:21,984 - utils.feature_engineering - INFO - Engineering features
2025-06-07 16:27:22,040 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-07 16:27:22,047 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 16:27:22,048 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 16:27:22,048 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 16:27:22,067 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-07 16:27:22,373 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 16:27:22,374 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-07 16:27:22,394 - train_models - INFO - Found 10 unique work types
2025-06-07 16:27:22,395 - train_models - INFO - Building models for 10 work types
2025-06-07 16:27:22,395 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:27:22,395 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-07 16:27:22,396 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-07 16:27:22,396 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-07 16:27:22,397 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 16:27:22,397 - train_models - INFO - Building model for WorkType: 202
2025-06-07 16:27:22,423 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-07 16:27:59,283 - train_models - INFO - Model for 202 - MAE: 0.2060, RMSE: 0.3183, R²: 0.7758, MAPE: 9.95%
2025-06-07 16:27:59,284 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 16:27:59,284 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3945
2025-06-07 16:27:59,285 - train_models - INFO -   NoOfMan_7day_trend: 0.1995
2025-06-07 16:27:59,285 - train_models - INFO -   NoOfMan_1day_trend: 0.1272
2025-06-07 16:27:59,286 - train_models - INFO -   NoOfMan_lag_1: 0.0681
2025-06-07 16:27:59,286 - train_models - INFO -   NoOfMan_lag_7: 0.0660
2025-06-07 16:27:59,286 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0657
2025-06-07 16:27:59,287 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0385
2025-06-07 16:27:59,287 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0056
2025-06-07 16:27:59,288 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-06-07 16:27:59,288 - train_models - INFO -   Quantity_lag_1: 0.0026
2025-06-07 16:27:59,289 - train_models - INFO - Cross-validation details for 202:
2025-06-07 16:27:59,289 - train_models - INFO -   Fold 1: MAE=0.1933, RMSE=0.3631, R²=0.5378, MAPE=10.09%
2025-06-07 16:27:59,289 - train_models - INFO -   Fold 2: MAE=0.2063, RMSE=0.3166, R²=0.7691, MAPE=11.41%
2025-06-07 16:27:59,290 - train_models - INFO -   Fold 3: MAE=0.2291, RMSE=0.3526, R²=0.8065, MAPE=11.86%
2025-06-07 16:27:59,290 - train_models - INFO -   Fold 4: MAE=0.1778, RMSE=0.2307, R²=0.8917, MAPE=8.19%
2025-06-07 16:27:59,291 - train_models - INFO -   Fold 5: MAE=0.2233, RMSE=0.3282, R²=0.8739, MAPE=8.21%
2025-06-07 16:27:59,291 - train_models - INFO - Building model for WorkType: 203
2025-06-07 16:27:59,314 - train_models - INFO - Available features for 203: 24 numeric, 3 categorical
2025-06-07 16:28:42,129 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3238, R²: 0.9142, MAPE: 4.70%
2025-06-07 16:28:42,130 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 16:28:42,130 - train_models - INFO -   NoOfMan_7day_trend: 0.3018
2025-06-07 16:28:42,131 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2341
2025-06-07 16:28:42,131 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1184
2025-06-07 16:28:42,131 - train_models - INFO -   NoOfMan_1day_trend: 0.0947
2025-06-07 16:28:42,132 - train_models - INFO -   NoOfMan_lag_7: 0.0806
2025-06-07 16:28:42,132 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0713
2025-06-07 16:28:42,132 - train_models - INFO -   NoOfMan_lag_1: 0.0564
2025-06-07 16:28:42,133 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0061
2025-06-07 16:28:42,133 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-06-07 16:28:42,134 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0031
2025-06-07 16:28:42,134 - train_models - INFO - Cross-validation details for 203:
2025-06-07 16:28:42,134 - train_models - INFO -   Fold 1: MAE=0.2843, RMSE=0.3898, R²=0.8803, MAPE=5.66%
2025-06-07 16:28:42,135 - train_models - INFO -   Fold 2: MAE=0.2526, RMSE=0.3473, R²=0.9121, MAPE=4.96%
2025-06-07 16:28:42,135 - train_models - INFO -   Fold 3: MAE=0.2361, RMSE=0.3774, R²=0.8926, MAPE=4.36%
2025-06-07 16:28:42,136 - train_models - INFO -   Fold 4: MAE=0.1807, RMSE=0.2655, R²=0.9428, MAPE=4.20%
2025-06-07 16:28:42,136 - train_models - INFO -   Fold 5: MAE=0.1774, RMSE=0.2390, R²=0.9430, MAPE=4.31%
2025-06-07 16:28:42,136 - train_models - INFO - Building model for WorkType: 206
2025-06-07 16:28:42,159 - train_models - INFO - Available features for 206: 24 numeric, 3 categorical
2025-06-07 16:29:36,672 - train_models - INFO - Model for 206 - MAE: 1.3672, RMSE: 2.0797, R²: 0.9350, MAPE: 7.89%
2025-06-07 16:29:36,672 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 16:29:36,673 - train_models - INFO -   NoOfMan_same_dow_lag: 0.5202
2025-06-07 16:29:36,673 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1515
2025-06-07 16:29:36,674 - train_models - INFO -   NoOfMan_1day_trend: 0.0754
2025-06-07 16:29:36,674 - train_models - INFO -   DayOfWeek_feat_6: 0.0710
2025-06-07 16:29:36,675 - train_models - INFO -   NoOfMan_7day_trend: 0.0527
2025-06-07 16:29:36,675 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-06-07 16:29:36,676 - train_models - INFO -   NoOfMan_lag_1: 0.0288
2025-06-07 16:29:36,676 - train_models - INFO -   Quantity_rolling_mean_7: 0.0088
2025-06-07 16:29:36,676 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0070
2025-06-07 16:29:36,677 - train_models - INFO -   NoOfMan_lag_7: 0.0067
2025-06-07 16:29:36,677 - train_models - INFO - Cross-validation details for 206:
2025-06-07 16:29:36,678 - train_models - INFO -   Fold 1: MAE=1.6833, RMSE=2.3248, R²=0.9265, MAPE=9.82%
2025-06-07 16:29:36,678 - train_models - INFO -   Fold 2: MAE=1.5605, RMSE=2.2138, R²=0.9305, MAPE=8.54%
2025-06-07 16:29:36,678 - train_models - INFO -   Fold 3: MAE=1.5067, RMSE=2.6043, R²=0.8983, MAPE=8.79%
2025-06-07 16:29:36,679 - train_models - INFO -   Fold 4: MAE=0.9201, RMSE=1.4096, R²=0.9625, MAPE=6.19%
2025-06-07 16:29:36,679 - train_models - INFO -   Fold 5: MAE=1.1654, RMSE=1.8461, R²=0.9571, MAPE=6.12%
2025-06-07 16:29:36,680 - train_models - INFO - Building model for WorkType: 209
2025-06-07 16:29:36,705 - train_models - INFO - Available features for 209: 24 numeric, 3 categorical
2025-06-07 16:30:21,208 - train_models - INFO - Model for 209 - MAE: 0.8910, RMSE: 1.3922, R²: 0.8883, MAPE: 12.27%
2025-06-07 16:30:21,209 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 16:30:21,209 - train_models - INFO -   NoOfMan_7day_trend: 0.4067
2025-06-07 16:30:21,210 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2159
2025-06-07 16:30:21,210 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0955
2025-06-07 16:30:21,210 - train_models - INFO -   NoOfMan_1day_trend: 0.0728
2025-06-07 16:30:21,211 - train_models - INFO -   NoOfMan_lag_7: 0.0503
2025-06-07 16:30:21,211 - train_models - INFO -   Quantity_rolling_mean_7: 0.0487
2025-06-07 16:30:21,212 - train_models - INFO -   NoOfMan_lag_1: 0.0275
2025-06-07 16:30:21,212 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0205
2025-06-07 16:30:21,212 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0100
2025-06-07 16:30:21,213 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-06-07 16:30:21,213 - train_models - INFO - Cross-validation details for 209:
2025-06-07 16:30:21,214 - train_models - INFO -   Fold 1: MAE=0.9852, RMSE=1.4513, R²=0.8592, MAPE=13.47%
2025-06-07 16:30:21,214 - train_models - INFO -   Fold 2: MAE=1.0351, RMSE=1.7406, R²=0.8438, MAPE=15.20%
2025-06-07 16:30:21,215 - train_models - INFO -   Fold 3: MAE=0.6519, RMSE=0.8754, R²=0.9399, MAPE=10.47%
2025-06-07 16:30:21,215 - train_models - INFO -   Fold 4: MAE=0.8386, RMSE=1.3931, R²=0.9011, MAPE=10.85%
2025-06-07 16:30:21,216 - train_models - INFO -   Fold 5: MAE=0.9442, RMSE=1.5007, R²=0.8975, MAPE=11.35%
2025-06-07 16:30:21,216 - train_models - INFO - Building model for WorkType: 210
2025-06-07 16:30:21,239 - train_models - INFO - Available features for 210: 24 numeric, 3 categorical
2025-06-07 16:31:06,304 - train_models - INFO - Model for 210 - MAE: 0.8066, RMSE: 1.1843, R²: 0.8887, MAPE: 17.44%
2025-06-07 16:31:06,305 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 16:31:06,305 - train_models - INFO -   NoOfMan_7day_trend: 0.2797
2025-06-07 16:31:06,306 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1969
2025-06-07 16:31:06,306 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1741
2025-06-07 16:31:06,307 - train_models - INFO -   NoOfMan_1day_trend: 0.0857
2025-06-07 16:31:06,307 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0658
2025-06-07 16:31:06,308 - train_models - INFO -   NoOfMan_lag_7: 0.0394
2025-06-07 16:31:06,308 - train_models - INFO -   NoOfMan_lag_1: 0.0355
2025-06-07 16:31:06,308 - train_models - INFO -   DayOfWeek_feat_6: 0.0268
2025-06-07 16:31:06,309 - train_models - INFO -   Quantity_rolling_mean_7: 0.0139
2025-06-07 16:31:06,309 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-06-07 16:31:06,310 - train_models - INFO - Cross-validation details for 210:
2025-06-07 16:31:06,310 - train_models - INFO -   Fold 1: MAE=0.8194, RMSE=1.1372, R²=0.8840, MAPE=13.65%
2025-06-07 16:31:06,310 - train_models - INFO -   Fold 2: MAE=0.7315, RMSE=1.0827, R²=0.8926, MAPE=12.40%
2025-06-07 16:31:06,311 - train_models - INFO -   Fold 3: MAE=0.6101, RMSE=0.8482, R²=0.9310, MAPE=8.55%
2025-06-07 16:31:06,311 - train_models - INFO -   Fold 4: MAE=0.9206, RMSE=1.2887, R²=0.8728, MAPE=27.86%
2025-06-07 16:31:06,312 - train_models - INFO -   Fold 5: MAE=0.9515, RMSE=1.5648, R²=0.8630, MAPE=24.74%
2025-06-07 16:31:06,312 - train_models - INFO - Building model for WorkType: 211
2025-06-07 16:31:06,337 - train_models - INFO - Available features for 211: 24 numeric, 3 categorical
2025-06-07 16:31:53,418 - train_models - INFO - Model for 211 - MAE: 0.6309, RMSE: 0.9778, R²: 0.9135, MAPE: 10.72%
2025-06-07 16:31:53,419 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 16:31:53,420 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3604
2025-06-07 16:31:53,420 - train_models - INFO -   NoOfMan_1day_trend: 0.1886
2025-06-07 16:31:53,421 - train_models - INFO -   NoOfMan_7day_trend: 0.1815
2025-06-07 16:31:53,421 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0693
2025-06-07 16:31:53,421 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-06-07 16:31:53,422 - train_models - INFO -   NoOfMan_lag_7: 0.0359
2025-06-07 16:31:53,422 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0340
2025-06-07 16:31:53,423 - train_models - INFO -   DayOfWeek_feat_6: 0.0333
2025-06-07 16:31:53,423 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0058
2025-06-07 16:31:53,424 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0049
2025-06-07 16:31:53,424 - train_models - INFO - Cross-validation details for 211:
2025-06-07 16:31:53,424 - train_models - INFO -   Fold 1: MAE=1.0639, RMSE=1.6412, R²=0.8126, MAPE=16.32%
2025-06-07 16:31:53,425 - train_models - INFO -   Fold 2: MAE=0.6086, RMSE=0.9744, R²=0.9113, MAPE=9.76%
2025-06-07 16:31:53,425 - train_models - INFO -   Fold 3: MAE=0.4599, RMSE=0.7014, R²=0.9573, MAPE=8.25%
2025-06-07 16:31:53,426 - train_models - INFO -   Fold 4: MAE=0.5661, RMSE=0.9105, R²=0.9307, MAPE=10.46%
2025-06-07 16:31:53,426 - train_models - INFO -   Fold 5: MAE=0.4558, RMSE=0.6614, R²=0.9553, MAPE=8.81%
2025-06-07 16:31:53,426 - train_models - INFO - Building model for WorkType: 213
2025-06-07 16:31:53,449 - train_models - INFO - Available features for 213: 24 numeric, 3 categorical
2025-06-07 16:32:39,809 - train_models - INFO - Model for 213 - MAE: 0.3867, RMSE: 0.5703, R²: 0.8941, MAPE: 15.54%
2025-06-07 16:32:39,809 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 16:32:39,810 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4434
2025-06-07 16:32:39,810 - train_models - INFO -   NoOfMan_7day_trend: 0.2090
2025-06-07 16:32:39,811 - train_models - INFO -   NoOfMan_1day_trend: 0.1451
2025-06-07 16:32:39,811 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0520
2025-06-07 16:32:39,811 - train_models - INFO -   NoOfMan_lag_1: 0.0471
2025-06-07 16:32:39,812 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0302
2025-06-07 16:32:39,812 - train_models - INFO -   NoOfMan_lag_7: 0.0267
2025-06-07 16:32:39,813 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0066
2025-06-07 16:32:39,813 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0050
2025-06-07 16:32:39,813 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0040
2025-06-07 16:32:39,814 - train_models - INFO - Cross-validation details for 213:
2025-06-07 16:32:39,814 - train_models - INFO -   Fold 1: MAE=0.5203, RMSE=0.7658, R²=0.8627, MAPE=14.89%
2025-06-07 16:32:39,815 - train_models - INFO -   Fold 2: MAE=0.4477, RMSE=0.6054, R²=0.8742, MAPE=24.13%
2025-06-07 16:32:39,815 - train_models - INFO -   Fold 3: MAE=0.3160, RMSE=0.5208, R²=0.8995, MAPE=14.81%
2025-06-07 16:32:39,816 - train_models - INFO -   Fold 4: MAE=0.3301, RMSE=0.4815, R²=0.9120, MAPE=13.12%
2025-06-07 16:32:39,816 - train_models - INFO -   Fold 5: MAE=0.3195, RMSE=0.4781, R²=0.9222, MAPE=10.73%
2025-06-07 16:32:39,816 - train_models - INFO - Building model for WorkType: 214
2025-06-07 16:32:39,840 - train_models - INFO - Available features for 214: 24 numeric, 3 categorical
2025-06-07 16:33:23,645 - train_models - INFO - Model for 214 - MAE: 0.4551, RMSE: 0.6869, R²: 0.8921, MAPE: 10.18%
2025-06-07 16:33:23,646 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 16:33:23,646 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5040
2025-06-07 16:33:23,647 - train_models - INFO -   NoOfMan_7day_trend: 0.1867
2025-06-07 16:33:23,647 - train_models - INFO -   NoOfMan_1day_trend: 0.0849
2025-06-07 16:33:23,647 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0645
2025-06-07 16:33:23,648 - train_models - INFO -   NoOfMan_lag_7: 0.0534
2025-06-07 16:33:23,648 - train_models - INFO -   NoOfMan_lag_1: 0.0417
2025-06-07 16:33:23,649 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0119
2025-06-07 16:33:23,649 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-06-07 16:33:23,650 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0068
2025-06-07 16:33:23,650 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0067
2025-06-07 16:33:23,651 - train_models - INFO - Cross-validation details for 214:
2025-06-07 16:33:23,651 - train_models - INFO -   Fold 1: MAE=0.4930, RMSE=0.6834, R²=0.8373, MAPE=13.52%
2025-06-07 16:33:23,652 - train_models - INFO -   Fold 2: MAE=0.4115, RMSE=0.5240, R²=0.9235, MAPE=9.74%
2025-06-07 16:33:23,652 - train_models - INFO -   Fold 3: MAE=0.3050, RMSE=0.4275, R²=0.9502, MAPE=8.78%
2025-06-07 16:33:23,653 - train_models - INFO -   Fold 4: MAE=0.3088, RMSE=0.5360, R²=0.9332, MAPE=5.63%
2025-06-07 16:33:23,653 - train_models - INFO -   Fold 5: MAE=0.7573, RMSE=1.2635, R²=0.8162, MAPE=13.26%
2025-06-07 16:33:23,655 - train_models - INFO - Building model for WorkType: 215
2025-06-07 16:33:23,683 - train_models - INFO - Available features for 215: 24 numeric, 3 categorical
2025-06-07 16:34:13,810 - train_models - INFO - Model for 215 - MAE: 0.6548, RMSE: 1.0373, R²: 0.9009, MAPE: 14.98%
2025-06-07 16:43:13,709 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 16:43:13,710 - train_models - INFO -   NoOfMan_7day_trend: 0.1812
2025-06-07 16:51:01,541 - train_models - INFO - Starting the model training process
2025-06-07 16:51:01,542 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:51:01,542 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 16:51:01,550 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 16:51:01,861 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 16:51:02,712 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 16:51:02,835 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 16:51:02,887 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 16:51:02,888 - train_models - INFO - Converting Date column to datetime format
2025-06-07 16:51:02,921 - train_models - INFO - Engineering features...
2025-06-07 16:51:04,024 - utils.feature_engineering - INFO - Engineering features
2025-06-07 16:51:04,080 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-06-07 16:51:04,088 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 16:51:04,088 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 16:51:04,089 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 16:51:04,107 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-06-07 16:51:04,562 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 16:51:04,563 - utils.feature_engineering - INFO - Final shape: (15326, 64)
2025-06-07 16:51:04,589 - train_models - INFO - Found 10 unique work types
2025-06-07 16:51:04,590 - train_models - INFO - Building models for 10 work types
2025-06-07 16:51:04,591 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 16:51:04,592 - utils.feature_builder - INFO - Built feature set: 24 numeric, 3 categorical
2025-06-07 16:51:04,592 - train_models - INFO - Tiered feature system generated 24 numeric features and 3 categorical features
2025-06-07 16:51:04,593 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend']
2025-06-07 16:51:04,594 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 16:51:04,594 - train_models - INFO - Building model for WorkType: 202
2025-06-07 16:51:04,623 - train_models - INFO - Available features for 202: 24 numeric, 3 categorical
2025-06-07 16:51:27,215 - train_models - INFO - Model for 202 - MAE: 0.2086, RMSE: 0.3129, R²: 0.7859, MAPE: 10.19%
2025-06-07 16:51:27,215 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 16:51:27,216 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2986
2025-06-07 16:51:27,216 - train_models - INFO -   NoOfMan_7day_trend: 0.1700
2025-06-07 16:51:27,217 - train_models - INFO -   NoOfMan_1day_trend: 0.1582
2025-06-07 16:51:27,217 - train_models - INFO -   NoOfMan_lag_1: 0.1151
2025-06-07 16:51:27,218 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0862
2025-06-07 16:51:27,218 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0626
2025-06-07 16:51:27,218 - train_models - INFO -   NoOfMan_lag_7: 0.0501
2025-06-07 16:51:27,219 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0163
2025-06-07 16:51:27,219 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0083
2025-06-07 16:51:27,220 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0047
2025-06-07 16:51:27,220 - train_models - INFO - Cross-validation details for 202:
2025-06-07 16:51:27,221 - train_models - INFO -   Fold 1: MAE=0.1942, RMSE=0.3613, R²=0.5425, MAPE=10.25%
2025-06-07 16:51:27,221 - train_models - INFO -   Fold 2: MAE=0.1798, RMSE=0.2562, R²=0.8488, MAPE=10.31%
2025-06-07 16:51:27,221 - train_models - INFO -   Fold 3: MAE=0.2379, RMSE=0.3593, R²=0.7991, MAPE=12.70%
2025-06-07 16:51:27,222 - train_models - INFO -   Fold 4: MAE=0.1958, RMSE=0.2523, R²=0.8704, MAPE=9.11%
2025-06-07 16:51:27,222 - train_models - INFO -   Fold 5: MAE=0.2353, RMSE=0.3352, R²=0.8684, MAPE=8.56%
2025-06-07 16:51:27,223 - train_models - INFO - Building model for WorkType: 203
2025-06-07 16:51:27,245 - train_models - INFO - Available features for 203: 24 numeric, 3 categorical
2025-06-07 16:51:51,770 - train_models - INFO - Model for 203 - MAE: 0.2459, RMSE: 0.3483, R²: 0.9006, MAPE: 5.13%
2025-06-07 16:51:51,770 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 16:51:51,771 - train_models - INFO -   NoOfMan_7day_trend: 0.2655
2025-06-07 16:51:51,771 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2098
2025-06-07 16:51:51,772 - train_models - INFO -   NoOfMan_1day_trend: 0.1230
2025-06-07 16:51:51,772 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1155
2025-06-07 16:51:51,773 - train_models - INFO -   NoOfMan_lag_1: 0.0859
2025-06-07 16:51:51,773 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0714
2025-06-07 16:51:51,774 - train_models - INFO -   NoOfMan_lag_7: 0.0682
2025-06-07 16:51:51,774 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0154
2025-06-07 16:51:51,775 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0099
2025-06-07 16:51:51,775 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0037
2025-06-07 16:51:51,776 - train_models - INFO - Cross-validation details for 203:
2025-06-07 16:51:51,776 - train_models - INFO -   Fold 1: MAE=0.3020, RMSE=0.4206, R²=0.8607, MAPE=5.97%
2025-06-07 16:51:51,777 - train_models - INFO -   Fold 2: MAE=0.2729, RMSE=0.3818, R²=0.8938, MAPE=5.43%
2025-06-07 16:51:51,777 - train_models - INFO -   Fold 3: MAE=0.2657, RMSE=0.3992, R²=0.8799, MAPE=4.98%
2025-06-07 16:51:51,777 - train_models - INFO -   Fold 4: MAE=0.1904, RMSE=0.2775, R²=0.9375, MAPE=4.44%
2025-06-07 16:51:51,778 - train_models - INFO -   Fold 5: MAE=0.1984, RMSE=0.2624, R²=0.9313, MAPE=4.83%
2025-06-07 16:51:51,778 - train_models - INFO - Building model for WorkType: 206
2025-06-07 16:51:51,804 - train_models - INFO - Available features for 206: 24 numeric, 3 categorical
2025-06-07 16:52:23,239 - train_models - INFO - Model for 206 - MAE: 1.3273, RMSE: 1.9940, R²: 0.9399, MAPE: 7.70%
2025-06-07 16:52:23,239 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 16:52:23,240 - train_models - INFO -   NoOfMan_same_dow_lag: 0.4047
2025-06-07 16:52:23,240 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1284
2025-06-07 16:52:23,241 - train_models - INFO -   NoOfMan_1day_trend: 0.1249
2025-06-07 16:52:23,241 - train_models - INFO -   DayOfWeek_feat_6: 0.0989
2025-06-07 16:52:23,242 - train_models - INFO -   NoOfMan_7day_trend: 0.0663
2025-06-07 16:52:23,242 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0569
2025-06-07 16:52:23,243 - train_models - INFO -   NoOfMan_lag_1: 0.0428
2025-06-07 16:52:23,243 - train_models - INFO -   Quantity_rolling_mean_7: 0.0106
2025-06-07 16:52:23,243 - train_models - INFO -   NoOfMan_lag_7: 0.0097
2025-06-07 16:52:23,244 - train_models - INFO -   Quantity_lag_1: 0.0073
2025-06-07 16:52:23,244 - train_models - INFO - Cross-validation details for 206:
2025-06-07 16:52:23,245 - train_models - INFO -   Fold 1: MAE=1.5836, RMSE=2.1500, R²=0.9371, MAPE=9.21%
2025-06-07 16:52:23,245 - train_models - INFO -   Fold 2: MAE=1.4834, RMSE=2.0552, R²=0.9401, MAPE=8.26%
2025-06-07 16:52:23,246 - train_models - INFO -   Fold 3: MAE=1.4947, RMSE=2.6166, R²=0.8974, MAPE=8.73%
2025-06-07 16:52:23,246 - train_models - INFO -   Fold 4: MAE=0.8967, RMSE=1.3434, R²=0.9659, MAPE=5.95%
2025-06-07 16:52:23,247 - train_models - INFO -   Fold 5: MAE=1.1781, RMSE=1.8048, R²=0.9590, MAPE=6.34%
2025-06-07 16:52:23,247 - train_models - INFO - Building model for WorkType: 209
2025-06-07 16:52:23,272 - train_models - INFO - Available features for 209: 24 numeric, 3 categorical
2025-06-07 16:52:49,166 - train_models - INFO - Model for 209 - MAE: 0.9373, RMSE: 1.4208, R²: 0.8843, MAPE: 13.15%
2025-06-07 16:52:49,166 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 16:52:49,167 - train_models - INFO -   NoOfMan_7day_trend: 0.3524
2025-06-07 16:52:49,167 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2126
2025-06-07 16:52:49,168 - train_models - INFO -   NoOfMan_1day_trend: 0.0937
2025-06-07 16:52:49,168 - train_models - INFO -   Quantity_rolling_mean_7: 0.0880
2025-06-07 16:52:49,169 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0818
2025-06-07 16:52:49,169 - train_models - INFO -   NoOfMan_lag_7: 0.0425
2025-06-07 16:52:49,170 - train_models - INFO -   NoOfMan_lag_1: 0.0302
2025-06-07 16:52:49,170 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0227
2025-06-07 16:52:49,171 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0119
2025-06-07 16:52:49,171 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0112
2025-06-07 16:52:49,172 - train_models - INFO - Cross-validation details for 209:
2025-06-07 16:52:49,182 - train_models - INFO -   Fold 1: MAE=0.9937, RMSE=1.4329, R²=0.8628, MAPE=13.60%
2025-06-07 16:52:49,183 - train_models - INFO -   Fold 2: MAE=1.0783, RMSE=1.7522, R²=0.8417, MAPE=15.96%
2025-06-07 16:52:49,183 - train_models - INFO -   Fold 3: MAE=0.7218, RMSE=0.9481, R²=0.9295, MAPE=11.57%
2025-06-07 16:52:49,184 - train_models - INFO -   Fold 4: MAE=0.9103, RMSE=1.4523, R²=0.8925, MAPE=11.95%
2025-06-07 16:52:49,184 - train_models - INFO -   Fold 5: MAE=0.9823, RMSE=1.5182, R²=0.8951, MAPE=12.65%
2025-06-07 16:52:49,185 - train_models - INFO - Building model for WorkType: 210
2025-06-07 16:52:49,210 - train_models - INFO - Available features for 210: 24 numeric, 3 categorical
2025-06-07 16:53:15,872 - train_models - INFO - Model for 210 - MAE: 0.8532, RMSE: 1.2302, R²: 0.8801, MAPE: 18.45%
2025-06-07 16:53:15,873 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 16:53:15,873 - train_models - INFO -   NoOfMan_7day_trend: 0.2661
2025-06-07 16:53:15,874 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1939
2025-06-07 16:53:15,874 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1783
2025-06-07 16:53:15,875 - train_models - INFO -   NoOfMan_1day_trend: 0.0921
2025-06-07 16:53:15,875 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0533
2025-06-07 16:53:15,876 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-06-07 16:53:15,876 - train_models - INFO -   NoOfMan_lag_1: 0.0295
2025-06-07 16:53:15,877 - train_models - INFO -   Quantity_rolling_mean_7: 0.0269
2025-06-07 16:53:15,877 - train_models - INFO -   DayOfWeek_feat_6: 0.0242
2025-06-07 16:53:15,878 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0143
2025-06-07 16:53:15,878 - train_models - INFO - Cross-validation details for 210:
2025-06-07 16:53:15,879 - train_models - INFO -   Fold 1: MAE=0.8279, RMSE=1.1456, R²=0.8823, MAPE=13.83%
2025-06-07 16:53:15,879 - train_models - INFO -   Fold 2: MAE=0.7451, RMSE=1.0814, R²=0.8929, MAPE=12.53%
2025-06-07 16:53:15,879 - train_models - INFO -   Fold 3: MAE=0.6377, RMSE=0.8810, R²=0.9255, MAPE=9.04%
2025-06-07 16:53:15,880 - train_models - INFO -   Fold 4: MAE=0.9619, RMSE=1.3598, R²=0.8584, MAPE=29.94%
2025-06-07 16:53:15,880 - train_models - INFO -   Fold 5: MAE=1.0935, RMSE=1.6835, R²=0.8414, MAPE=26.90%
2025-06-07 16:53:15,881 - train_models - INFO - Building model for WorkType: 211
2025-06-07 16:53:15,906 - train_models - INFO - Available features for 211: 24 numeric, 3 categorical
2025-06-07 16:53:43,484 - train_models - INFO - Model for 211 - MAE: 0.6802, RMSE: 1.0188, R²: 0.9067, MAPE: 11.85%
2025-06-07 16:53:43,484 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 16:53:43,485 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2726
2025-06-07 16:53:43,485 - train_models - INFO -   NoOfMan_7day_trend: 0.1849
2025-06-07 16:53:43,486 - train_models - INFO -   NoOfMan_1day_trend: 0.1735
2025-06-07 16:53:43,486 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1051
2025-06-07 16:53:43,487 - train_models - INFO -   NoOfMan_lag_1: 0.0555
2025-06-07 16:53:43,487 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0529
2025-06-07 16:53:43,487 - train_models - INFO -   DayOfWeek_feat_6: 0.0509
2025-06-07 16:53:43,488 - train_models - INFO -   NoOfMan_lag_7: 0.0328
2025-06-07 16:53:43,488 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0176
2025-06-07 16:53:43,489 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0104
2025-06-07 16:53:43,489 - train_models - INFO - Cross-validation details for 211:
2025-06-07 16:53:43,490 - train_models - INFO -   Fold 1: MAE=1.0795, RMSE=1.6763, R²=0.8045, MAPE=17.20%
2025-06-07 16:53:43,490 - train_models - INFO -   Fold 2: MAE=0.6547, RMSE=1.0156, R²=0.9037, MAPE=10.40%
2025-06-07 16:53:43,491 - train_models - INFO -   Fold 3: MAE=0.5313, RMSE=0.7462, R²=0.9517, MAPE=9.51%
2025-06-07 16:53:43,491 - train_models - INFO -   Fold 4: MAE=0.6114, RMSE=0.9277, R²=0.9280, MAPE=11.39%
2025-06-07 16:53:43,491 - train_models - INFO -   Fold 5: MAE=0.5242, RMSE=0.7283, R²=0.9458, MAPE=10.76%
2025-06-07 16:53:43,492 - train_models - INFO - Building model for WorkType: 213
2025-06-07 16:53:43,516 - train_models - INFO - Available features for 213: 24 numeric, 3 categorical
2025-06-07 16:54:09,292 - train_models - INFO - Model for 213 - MAE: 0.4054, RMSE: 0.5829, R²: 0.8896, MAPE: 16.70%
2025-06-07 16:54:09,293 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 16:54:09,293 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3481
2025-06-07 16:54:09,294 - train_models - INFO -   NoOfMan_7day_trend: 0.2213
2025-06-07 16:54:09,294 - train_models - INFO -   NoOfMan_1day_trend: 0.1412
2025-06-07 16:54:09,295 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0855
2025-06-07 16:54:09,295 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0658
2025-06-07 16:54:09,296 - train_models - INFO -   NoOfMan_lag_1: 0.0440
2025-06-07 16:54:09,296 - train_models - INFO -   NoOfMan_lag_7: 0.0247
2025-06-07 16:54:09,296 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0197
2025-06-07 16:54:09,297 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-06-07 16:54:09,297 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0051
2025-06-07 16:54:09,298 - train_models - INFO - Cross-validation details for 213:
2025-06-07 16:54:09,298 - train_models - INFO -   Fold 1: MAE=0.5307, RMSE=0.7847, R²=0.8558, MAPE=15.23%
2025-06-07 16:54:09,299 - train_models - INFO -   Fold 2: MAE=0.4682, RMSE=0.6162, R²=0.8697, MAPE=26.53%
2025-06-07 16:54:09,299 - train_models - INFO -   Fold 3: MAE=0.3287, RMSE=0.5097, R²=0.9037, MAPE=15.75%
2025-06-07 16:54:09,300 - train_models - INFO -   Fold 4: MAE=0.3501, RMSE=0.4954, R²=0.9068, MAPE=13.91%
2025-06-07 16:54:09,300 - train_models - INFO -   Fold 5: MAE=0.3494, RMSE=0.5086, R²=0.9120, MAPE=12.05%
2025-06-07 16:54:09,301 - train_models - INFO - Building model for WorkType: 214
2025-06-07 16:54:09,325 - train_models - INFO - Available features for 214: 24 numeric, 3 categorical
2025-06-07 16:54:34,058 - train_models - INFO - Model for 214 - MAE: 0.4931, RMSE: 0.7211, R²: 0.8818, MAPE: 11.18%
2025-06-07 16:54:34,059 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 16:54:34,059 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3609
2025-06-07 16:54:34,060 - train_models - INFO -   NoOfMan_7day_trend: 0.1740
2025-06-07 16:54:34,060 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-06-07 16:54:34,060 - train_models - INFO -   NoOfMan_1day_trend: 0.0963
2025-06-07 16:54:34,061 - train_models - INFO -   NoOfMan_lag_7: 0.0434
2025-06-07 16:54:34,061 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0433
2025-06-07 16:54:34,062 - train_models - INFO -   NoOfMan_lag_1: 0.0421
2025-06-07 16:54:34,062 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0209
2025-06-07 16:54:34,063 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0128
2025-06-07 16:54:34,063 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0113
2025-06-07 16:54:34,064 - train_models - INFO - Cross-validation details for 214:
2025-06-07 16:54:34,064 - train_models - INFO -   Fold 1: MAE=0.5140, RMSE=0.6991, R²=0.8298, MAPE=14.43%
2025-06-07 16:54:34,064 - train_models - INFO -   Fold 2: MAE=0.4266, RMSE=0.5500, R²=0.9157, MAPE=10.16%
2025-06-07 16:54:34,065 - train_models - INFO -   Fold 3: MAE=0.3368, RMSE=0.4530, R²=0.9441, MAPE=9.88%
2025-06-07 16:54:34,065 - train_models - INFO -   Fold 4: MAE=0.3565, RMSE=0.5644, R²=0.9259, MAPE=6.87%
2025-06-07 16:54:34,066 - train_models - INFO -   Fold 5: MAE=0.8319, RMSE=1.3389, R²=0.7936, MAPE=14.55%
2025-06-07 16:54:34,066 - train_models - INFO - Building model for WorkType: 215
2025-06-07 16:54:34,091 - train_models - INFO - Available features for 215: 24 numeric, 3 categorical
2025-06-07 16:55:02,470 - train_models - INFO - Model for 215 - MAE: 0.6945, RMSE: 1.0888, R²: 0.8895, MAPE: 16.28%
2025-06-07 16:55:02,471 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 16:55:02,471 - train_models - INFO -   NoOfMan_7day_trend: 0.1882
2025-06-07 16:55:02,471 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1596
2025-06-07 16:55:02,472 - train_models - INFO -   NoOfMan_1day_trend: 0.1448
2025-06-07 16:55:02,472 - train_models - INFO -   DayOfWeek_feat_6: 0.1439
2025-06-07 16:55:02,473 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1433
2025-06-07 16:55:02,473 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0551
2025-06-07 16:55:02,474 - train_models - INFO -   NoOfMan_lag_1: 0.0318
2025-06-07 16:55:02,474 - train_models - INFO -   Quantity_rolling_mean_7: 0.0282
2025-06-07 16:55:02,475 - train_models - INFO -   NoOfMan_lag_7: 0.0278
2025-06-07 16:55:02,475 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0166
2025-06-07 16:55:02,475 - train_models - INFO - Cross-validation details for 215:
2025-06-07 16:55:02,476 - train_models - INFO -   Fold 1: MAE=1.0007, RMSE=1.6420, R²=0.7759, MAPE=27.18%
2025-06-07 16:55:02,476 - train_models - INFO -   Fold 2: MAE=0.6977, RMSE=0.9920, R²=0.9153, MAPE=16.55%
2025-06-07 16:55:02,477 - train_models - INFO -   Fold 3: MAE=0.6705, RMSE=1.0453, R²=0.9030, MAPE=12.39%
2025-06-07 16:55:02,477 - train_models - INFO -   Fold 4: MAE=0.5339, RMSE=0.8078, R²=0.9324, MAPE=13.43%
2025-06-07 16:55:02,478 - train_models - INFO -   Fold 5: MAE=0.5696, RMSE=0.9572, R²=0.9210, MAPE=11.82%
2025-06-07 16:55:02,478 - train_models - INFO - Building model for WorkType: 217
2025-06-07 16:55:02,503 - train_models - INFO - Available features for 217: 24 numeric, 3 categorical
2025-06-07 16:55:24,331 - train_models - INFO - Model for 217 - MAE: 0.4190, RMSE: 0.5514, R²: 0.9108, MAPE: 17.98%
2025-06-07 16:55:24,332 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 16:55:24,333 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4381
2025-06-07 16:55:24,333 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1434
2025-06-07 16:55:24,333 - train_models - INFO -   NoOfMan_7day_trend: 0.1089
2025-06-07 16:55:24,334 - train_models - INFO -   NoOfMan_lag_1: 0.0887
2025-06-07 16:55:24,334 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0821
2025-06-07 16:55:24,335 - train_models - INFO -   NoOfMan_1day_trend: 0.0782
2025-06-07 16:55:24,335 - train_models - INFO -   NoOfMan_lag_7: 0.0179
2025-06-07 16:55:24,336 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0110
2025-06-07 16:55:24,336 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0074
2025-06-07 16:55:24,337 - train_models - INFO -   NoOfMan_lag_3: 0.0025
2025-06-07 16:55:24,337 - train_models - INFO - Cross-validation details for 217:
2025-06-07 16:55:24,338 - train_models - INFO -   Fold 1: MAE=0.5878, RMSE=0.7082, R²=0.8254, MAPE=27.16%
2025-06-07 16:55:24,338 - train_models - INFO -   Fold 2: MAE=0.4308, RMSE=0.5665, R²=0.9023, MAPE=21.62%
2025-06-07 16:55:24,339 - train_models - INFO -   Fold 3: MAE=0.3772, RMSE=0.4912, R²=0.9427, MAPE=13.80%
2025-06-07 16:55:24,339 - train_models - INFO -   Fold 4: MAE=0.3274, RMSE=0.4231, R²=0.9617, MAPE=13.28%
2025-06-07 16:55:24,340 - train_models - INFO -   Fold 5: MAE=0.3717, RMSE=0.5682, R²=0.9216, MAPE=14.07%
2025-06-07 16:55:24,341 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 16:55:25,502 - train_models - INFO - Model files saved successfully
2025-06-07 16:55:25,502 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 16:55:25,503 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 16:55:25,508 - train_models - INFO - Model training completed successfully
2025-06-07 17:05:26,620 - train_models - INFO - Starting the model training process
2025-06-07 17:05:26,621 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 17:05:26,621 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 17:05:26,629 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 18:07:00,469 - train_models - INFO - Starting the model training process
2025-06-07 18:07:00,471 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:07:00,471 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 18:07:00,483 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 18:07:01,076 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 18:07:02,161 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 18:07:02,237 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 18:07:02,287 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 18:07:02,288 - train_models - INFO - Converting Date column to datetime format
2025-06-07 18:07:02,318 - train_models - INFO - Engineering features...
2025-06-07 18:07:03,515 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 18:07:03,516 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 18:07:03,516 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 18:07:03,847 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 18:07:03,848 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 18:07:03,869 - train_models - INFO - Found 10 unique work types
2025-06-07 18:07:03,869 - train_models - INFO - Building models for 10 work types
2025-06-07 18:07:03,870 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:07:03,870 - train_models - ERROR - Error building models: 'TREND_FEATURES'
2025-06-07 18:07:03,873 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 141, in build_models
    numeric_features, categorical_features = feature_builder.get_feature_lists()
                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\forlogssystems\work_utilization_app\utils\feature_builder.py", line 80, in get_feature_lists
    num_feat, cat_feat = self._build_intermediate_features()
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\forlogssystems\work_utilization_app\utils\feature_builder.py", line 148, in _build_intermediate_features
    for trend_name, base_feature, lag1, lag2 in INTERMEDIATE_FEATURES['TREND_FEATURES']:
                                                ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyError: 'TREND_FEATURES'

2025-06-07 18:07:03,874 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-07 18:07:04,440 - train_models - INFO - Model files saved successfully
2025-06-07 18:07:04,441 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 18:07:04,441 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 18:07:04,445 - train_models - INFO - Model training completed successfully
2025-06-07 18:08:10,995 - train_models - INFO - Starting the model training process
2025-06-07 18:08:10,995 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:08:10,996 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 18:08:11,003 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 18:08:11,397 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 18:08:12,170 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 18:08:12,249 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 18:08:12,299 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 18:08:12,300 - train_models - INFO - Converting Date column to datetime format
2025-06-07 18:08:12,335 - train_models - INFO - Engineering features...
2025-06-07 18:08:13,305 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 18:08:13,306 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 18:08:13,306 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 18:08:13,642 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 18:08:13,643 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 18:08:13,663 - train_models - INFO - Found 10 unique work types
2025-06-07 18:08:13,664 - train_models - INFO - Building models for 10 work types
2025-06-07 18:08:13,664 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:08:13,665 - train_models - ERROR - Error building models: 'TREND_FEATURES'
2025-06-07 18:08:13,668 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 141, in build_models
    numeric_features, categorical_features = feature_builder.get_feature_lists()
                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\forlogssystems\work_utilization_app\utils\feature_builder.py", line 80, in get_feature_lists
    num_feat, cat_feat = self._build_intermediate_features()
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\forlogssystems\work_utilization_app\utils\feature_builder.py", line 148, in _build_intermediate_features
    for trend_name, base_feature, lag1, lag2 in INTERMEDIATE_FEATURES['TREND_FEATURES']:
                                                ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyError: 'TREND_FEATURES'

2025-06-07 18:08:13,670 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-06-07 18:08:14,208 - train_models - INFO - Model files saved successfully
2025-06-07 18:08:14,209 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 18:08:14,209 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 18:08:14,213 - train_models - INFO - Model training completed successfully
2025-06-07 18:09:10,038 - train_models - INFO - Starting the model training process
2025-06-07 18:09:10,039 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:09:10,039 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 18:09:10,045 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 18:09:10,325 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 18:09:11,181 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 18:09:11,285 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 18:09:11,332 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 18:09:11,333 - train_models - INFO - Converting Date column to datetime format
2025-06-07 18:09:11,367 - train_models - INFO - Engineering features...
2025-06-07 18:09:12,334 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 18:09:12,335 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 18:09:12,335 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 18:09:12,657 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 18:09:12,657 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 18:09:12,677 - train_models - INFO - Found 10 unique work types
2025-06-07 18:09:12,678 - train_models - INFO - Building models for 10 work types
2025-06-07 18:09:12,678 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 18:09:12,679 - utils.feature_builder - INFO - Built feature set: 22 numeric, 3 categorical
2025-06-07 18:09:12,679 - train_models - INFO - Tiered feature system generated 22 numeric features and 3 categorical features
2025-06-07 18:09:12,680 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'Year_feat', 'DayOfMonth', 'WeekOfYear', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 18:09:12,680 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 18:09:12,681 - train_models - INFO - Building model for WorkType: 202
2025-06-07 18:09:12,705 - train_models - INFO - Available features for 202: 22 numeric, 3 categorical
2025-06-07 18:09:33,727 - train_models - INFO - Model for 202 - MAE: 0.4501, RMSE: 0.5719, R²: 0.3617, MAPE: 24.15%
2025-06-07 18:09:33,728 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 18:09:33,728 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3802
2025-06-07 18:09:33,728 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0947
2025-06-07 18:09:33,729 - train_models - INFO -   NoOfMan_lag_1: 0.0893
2025-06-07 18:09:33,729 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0878
2025-06-07 18:09:33,730 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0415
2025-06-07 18:09:33,730 - train_models - INFO -   NoOfMan_lag_3: 0.0313
2025-06-07 18:09:33,731 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0294
2025-06-07 18:09:33,731 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0278
2025-06-07 18:09:33,732 - train_models - INFO -   NoOfMan_lag_2: 0.0240
2025-06-07 18:09:33,732 - train_models - INFO -   Quantity_lag_7: 0.0202
2025-06-07 18:09:33,733 - train_models - INFO - Cross-validation details for 202:
2025-06-07 18:09:33,733 - train_models - INFO -   Fold 1: MAE=0.3235, RMSE=0.4622, R²=0.2512, MAPE=19.98%
2025-06-07 18:09:33,733 - train_models - INFO -   Fold 2: MAE=0.3740, RMSE=0.4767, R²=0.4766, MAPE=23.34%
2025-06-07 18:09:33,734 - train_models - INFO -   Fold 3: MAE=0.4901, RMSE=0.6239, R²=0.3943, MAPE=29.05%
2025-06-07 18:09:33,734 - train_models - INFO -   Fold 4: MAE=0.5059, RMSE=0.6140, R²=0.2328, MAPE=24.82%
2025-06-07 18:09:33,735 - train_models - INFO -   Fold 5: MAE=0.5573, RMSE=0.6829, R²=0.4539, MAPE=23.55%
2025-06-07 18:09:33,735 - train_models - INFO - Building model for WorkType: 203
2025-06-07 18:09:33,758 - train_models - INFO - Available features for 203: 22 numeric, 3 categorical
2025-06-07 18:09:57,610 - train_models - INFO - Model for 203 - MAE: 0.6541, RMSE: 0.8421, R²: 0.4229, MAPE: 13.77%
2025-06-07 18:09:57,610 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 18:09:57,611 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3121
2025-06-07 18:09:57,611 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1566
2025-06-07 18:09:57,612 - train_models - INFO -   NoOfMan_lag_1: 0.1019
2025-06-07 18:09:57,612 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0639
2025-06-07 18:09:57,612 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0476
2025-06-07 18:09:57,613 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0421
2025-06-07 18:09:57,613 - train_models - INFO -   NoOfMan_lag_3: 0.0296
2025-06-07 18:09:57,614 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0216
2025-06-07 18:09:57,614 - train_models - INFO -   Quantity_lag_7: 0.0195
2025-06-07 18:09:57,615 - train_models - INFO -   NoOfMan_lag_2: 0.0189
2025-06-07 18:09:57,615 - train_models - INFO - Cross-validation details for 203:
2025-06-07 18:09:57,615 - train_models - INFO -   Fold 1: MAE=0.6049, RMSE=0.7913, R²=0.5067, MAPE=11.96%
2025-06-07 18:09:57,616 - train_models - INFO -   Fold 2: MAE=0.6521, RMSE=0.8485, R²=0.4755, MAPE=13.09%
2025-06-07 18:09:57,616 - train_models - INFO -   Fold 3: MAE=0.7413, RMSE=0.9700, R²=0.2908, MAPE=14.57%
2025-06-07 18:09:57,617 - train_models - INFO -   Fold 4: MAE=0.6374, RMSE=0.8031, R²=0.4764, MAPE=14.09%
2025-06-07 18:09:57,617 - train_models - INFO -   Fold 5: MAE=0.6346, RMSE=0.7977, R²=0.3652, MAPE=15.12%
2025-06-07 18:09:57,618 - train_models - INFO - Building model for WorkType: 206
2025-06-07 18:09:57,644 - train_models - INFO - Available features for 206: 22 numeric, 3 categorical
2025-06-07 18:10:27,645 - train_models - INFO - Model for 206 - MAE: 2.1274, RMSE: 3.0923, R²: 0.8581, MAPE: 12.65%
2025-06-07 18:10:27,645 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 18:10:27,646 - train_models - INFO -   NoOfMan_same_dow_lag: 0.4151
2025-06-07 18:10:27,646 - train_models - INFO -   DayOfWeek_feat_6: 0.1648
2025-06-07 18:10:27,646 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1605
2025-06-07 18:10:27,647 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0445
2025-06-07 18:10:27,647 - train_models - INFO -   DayOfWeek_feat_4: 0.0388
2025-06-07 18:10:27,648 - train_models - INFO -   NoOfMan_lag_1: 0.0339
2025-06-07 18:10:27,648 - train_models - INFO -   Quantity_rolling_mean_7: 0.0188
2025-06-07 18:10:27,649 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0147
2025-06-07 18:10:27,649 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0113
2025-06-07 18:10:27,650 - train_models - INFO -   NoOfMan_lag_3: 0.0099
2025-06-07 18:10:27,650 - train_models - INFO - Cross-validation details for 206:
2025-06-07 18:10:27,651 - train_models - INFO -   Fold 1: MAE=2.2163, RMSE=3.0666, R²=0.8721, MAPE=13.14%
2025-06-07 18:10:27,651 - train_models - INFO -   Fold 2: MAE=2.2839, RMSE=3.1497, R²=0.8594, MAPE=12.54%
2025-06-07 18:10:27,652 - train_models - INFO -   Fold 3: MAE=2.2844, RMSE=3.6245, R²=0.8030, MAPE=13.53%
2025-06-07 18:10:27,652 - train_models - INFO -   Fold 4: MAE=1.7764, RMSE=2.6651, R²=0.8660, MAPE=12.55%
2025-06-07 18:10:27,652 - train_models - INFO -   Fold 5: MAE=2.0762, RMSE=2.9555, R²=0.8899, MAPE=11.49%
2025-06-07 18:10:27,653 - train_models - INFO - Building model for WorkType: 209
2025-06-07 18:10:27,676 - train_models - INFO - Available features for 209: 22 numeric, 3 categorical
2025-06-07 18:10:52,010 - train_models - INFO - Model for 209 - MAE: 1.9370, RMSE: 2.6889, R²: 0.5885, MAPE: 26.85%
2025-06-07 18:10:52,011 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 18:10:52,012 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3325
2025-06-07 18:10:52,012 - train_models - INFO -   Quantity_rolling_mean_7: 0.2054
2025-06-07 18:10:52,012 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0681
2025-06-07 18:10:52,013 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0417
2025-06-07 18:10:52,013 - train_models - INFO -   DayOfWeek_feat_1: 0.0329
2025-06-07 18:10:52,014 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0294
2025-06-07 18:10:52,014 - train_models - INFO -   NoOfMan_lag_2: 0.0285
2025-06-07 18:10:52,015 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0260
2025-06-07 18:10:52,015 - train_models - INFO -   Quantity_lag_1: 0.0212
2025-06-07 18:10:52,016 - train_models - INFO -   NoOfMan_lag_3: 0.0212
2025-06-07 18:10:52,016 - train_models - INFO - Cross-validation details for 209:
2025-06-07 18:10:52,017 - train_models - INFO -   Fold 1: MAE=1.7722, RMSE=2.4295, R²=0.6055, MAPE=24.25%
2025-06-07 18:10:52,017 - train_models - INFO -   Fold 2: MAE=2.1626, RMSE=3.1157, R²=0.4995, MAPE=30.28%
2025-06-07 18:10:52,017 - train_models - INFO -   Fold 3: MAE=1.6905, RMSE=2.2142, R²=0.6154, MAPE=25.63%
2025-06-07 18:10:52,018 - train_models - INFO -   Fold 4: MAE=1.8485, RMSE=2.5819, R²=0.6604, MAPE=25.40%
2025-06-07 18:10:52,018 - train_models - INFO -   Fold 5: MAE=2.2113, RMSE=3.1029, R²=0.5620, MAPE=28.69%
2025-06-07 18:10:52,019 - train_models - INFO - Building model for WorkType: 210
2025-06-07 18:10:52,043 - train_models - INFO - Available features for 210: 22 numeric, 3 categorical
2025-06-07 18:11:16,717 - train_models - INFO - Model for 210 - MAE: 1.5108, RMSE: 2.0857, R²: 0.6549, MAPE: 31.22%
2025-06-07 18:11:16,718 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 18:11:16,718 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3004
2025-06-07 18:11:16,719 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2359
2025-06-07 18:11:16,719 - train_models - INFO -   Quantity_rolling_mean_7: 0.0778
2025-06-07 18:11:16,719 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0529
2025-06-07 18:11:16,720 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0339
2025-06-07 18:11:16,720 - train_models - INFO -   DayOfWeek_feat_6: 0.0307
2025-06-07 18:11:16,721 - train_models - INFO -   NoOfMan_lag_2: 0.0249
2025-06-07 18:11:16,721 - train_models - INFO -   NoOfMan_lag_3: 0.0216
2025-06-07 18:11:16,722 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0160
2025-06-07 18:11:16,722 - train_models - INFO -   DayOfWeek_feat_1: 0.0158
2025-06-07 18:11:16,723 - train_models - INFO - Cross-validation details for 210:
2025-06-07 18:11:16,723 - train_models - INFO -   Fold 1: MAE=1.3297, RMSE=1.7594, R²=0.7224, MAPE=22.24%
2025-06-07 18:11:16,724 - train_models - INFO -   Fold 2: MAE=1.4460, RMSE=1.9881, R²=0.6379, MAPE=23.61%
2025-06-07 18:11:16,724 - train_models - INFO -   Fold 3: MAE=1.3081, RMSE=1.7820, R²=0.6953, MAPE=18.74%
2025-06-07 18:11:16,724 - train_models - INFO -   Fold 4: MAE=1.6169, RMSE=2.2623, R²=0.6081, MAPE=46.11%
2025-06-07 18:11:16,725 - train_models - INFO -   Fold 5: MAE=1.8532, RMSE=2.6369, R²=0.6108, MAPE=45.42%
2025-06-07 18:11:16,725 - train_models - INFO - Building model for WorkType: 211
2025-06-07 18:11:16,751 - train_models - INFO - Available features for 211: 22 numeric, 3 categorical
2025-06-07 18:11:43,215 - train_models - INFO - Model for 211 - MAE: 1.4734, RMSE: 2.0822, R²: 0.6219, MAPE: 24.62%
2025-06-07 18:11:43,215 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 18:11:43,216 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3661
2025-06-07 18:11:43,216 - train_models - INFO -   DayOfWeek_feat_6: 0.1287
2025-06-07 18:11:43,216 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1063
2025-06-07 18:11:43,217 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0893
2025-06-07 18:11:43,217 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0368
2025-06-07 18:11:43,218 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0248
2025-06-07 18:11:43,218 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0244
2025-06-07 18:11:43,218 - train_models - INFO -   NoOfMan_lag_3: 0.0244
2025-06-07 18:11:43,219 - train_models - INFO -   NoOfMan_lag_1: 0.0225
2025-06-07 18:11:43,219 - train_models - INFO -   Quantity_rolling_mean_7: 0.0192
2025-06-07 18:11:43,220 - train_models - INFO - Cross-validation details for 211:
2025-06-07 18:11:43,220 - train_models - INFO -   Fold 1: MAE=1.9876, RMSE=3.1080, R²=0.3281, MAPE=33.50%
2025-06-07 18:11:43,220 - train_models - INFO -   Fold 2: MAE=1.4825, RMSE=1.9329, R²=0.6511, MAPE=23.06%
2025-06-07 18:11:43,221 - train_models - INFO -   Fold 3: MAE=1.3370, RMSE=1.7697, R²=0.7281, MAPE=19.29%
2025-06-07 18:11:43,221 - train_models - INFO -   Fold 4: MAE=1.3389, RMSE=1.8827, R²=0.7035, MAPE=23.09%
2025-06-07 18:11:43,222 - train_models - INFO -   Fold 5: MAE=1.2213, RMSE=1.7177, R²=0.6987, MAPE=24.18%
2025-06-07 18:11:43,222 - train_models - INFO - Building model for WorkType: 213
2025-06-07 18:11:43,247 - train_models - INFO - Available features for 213: 22 numeric, 3 categorical
2025-06-07 18:12:06,922 - train_models - INFO - Model for 213 - MAE: 0.8661, RMSE: 1.1656, R²: 0.5529, MAPE: 37.87%
2025-06-07 18:12:06,923 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 18:12:06,923 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4361
2025-06-07 18:12:06,924 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1465
2025-06-07 18:12:06,924 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0578
2025-06-07 18:12:06,925 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0352
2025-06-07 18:12:06,925 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0322
2025-06-07 18:12:06,926 - train_models - INFO -   NoOfMan_lag_3: 0.0251
2025-06-07 18:12:06,926 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0249
2025-06-07 18:12:06,926 - train_models - INFO -   DayOfWeek_feat_1: 0.0222
2025-06-07 18:12:06,927 - train_models - INFO -   NoOfMan_lag_1: 0.0197
2025-06-07 18:12:06,927 - train_models - INFO -   NoOfMan_lag_14: 0.0196
2025-06-07 18:12:06,928 - train_models - INFO - Cross-validation details for 213:
2025-06-07 18:12:06,928 - train_models - INFO -   Fold 1: MAE=0.9448, RMSE=1.2929, R²=0.6087, MAPE=28.33%
2025-06-07 18:12:06,929 - train_models - INFO -   Fold 2: MAE=0.8987, RMSE=1.2167, R²=0.4919, MAPE=51.44%
2025-06-07 18:12:06,929 - train_models - INFO -   Fold 3: MAE=0.7983, RMSE=1.1494, R²=0.5103, MAPE=42.47%
2025-06-07 18:12:06,930 - train_models - INFO -   Fold 4: MAE=0.8238, RMSE=1.0799, R²=0.5571, MAPE=34.38%
2025-06-07 18:12:06,930 - train_models - INFO -   Fold 5: MAE=0.8650, RMSE=1.0893, R²=0.5964, MAPE=32.72%
2025-06-07 18:12:06,931 - train_models - INFO - Building model for WorkType: 214
2025-06-07 18:12:06,956 - train_models - INFO - Available features for 214: 22 numeric, 3 categorical
2025-06-07 18:12:32,164 - train_models - INFO - Model for 214 - MAE: 1.0461, RMSE: 1.3735, R²: 0.5716, MAPE: 24.53%
2025-06-07 18:12:32,165 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 18:12:32,165 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4576
2025-06-07 18:12:32,166 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1572
2025-06-07 18:12:32,166 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0399
2025-06-07 18:12:32,167 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0364
2025-06-07 18:12:32,167 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0305
2025-06-07 18:12:32,168 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0294
2025-06-07 18:12:32,168 - train_models - INFO -   NoOfMan_lag_1: 0.0222
2025-06-07 18:12:32,169 - train_models - INFO -   NoOfMan_lag_3: 0.0217
2025-06-07 18:12:32,169 - train_models - INFO -   DayOfWeek_feat_4: 0.0171
2025-06-07 18:12:32,170 - train_models - INFO -   DayOfWeek_feat_1: 0.0162
2025-06-07 18:12:32,170 - train_models - INFO - Cross-validation details for 214:
2025-06-07 18:12:32,170 - train_models - INFO -   Fold 1: MAE=0.9945, RMSE=1.2764, R²=0.4325, MAPE=27.62%
2025-06-07 18:12:32,171 - train_models - INFO -   Fold 2: MAE=0.9699, RMSE=1.2281, R²=0.5799, MAPE=23.97%
2025-06-07 18:12:32,171 - train_models - INFO -   Fold 3: MAE=0.7895, RMSE=1.0438, R²=0.7033, MAPE=21.80%
2025-06-07 18:12:32,172 - train_models - INFO -   Fold 4: MAE=0.9549, RMSE=1.2620, R²=0.6295, MAPE=20.28%
2025-06-07 18:12:32,172 - train_models - INFO -   Fold 5: MAE=1.5217, RMSE=2.0574, R²=0.5127, MAPE=28.95%
2025-06-07 18:12:32,173 - train_models - INFO - Building model for WorkType: 215
2025-06-07 18:12:32,195 - train_models - INFO - Available features for 215: 22 numeric, 3 categorical
2025-06-07 18:12:59,512 - train_models - INFO - Model for 215 - MAE: 1.2974, RMSE: 1.9031, R²: 0.6743, MAPE: 29.51%
2025-06-07 18:12:59,513 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 18:12:59,513 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2173
2025-06-07 18:12:59,514 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2021
2025-06-07 18:12:59,514 - train_models - INFO -   DayOfWeek_feat_6: 0.1694
2025-06-07 18:12:59,515 - train_models - INFO -   Quantity_rolling_mean_7: 0.0660
2025-06-07 18:12:59,515 - train_models - INFO -   DayOfWeek_feat_0: 0.0518
2025-06-07 18:12:59,515 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0392
2025-06-07 18:12:59,516 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0327
2025-06-07 18:12:59,516 - train_models - INFO -   NoOfMan_lag_1: 0.0227
2025-06-07 18:12:59,517 - train_models - INFO -   Quantity_lag_1: 0.0217
2025-06-07 18:12:59,517 - train_models - INFO -   ResourceKPI_lag_1: 0.0178
2025-06-07 18:12:59,517 - train_models - INFO - Cross-validation details for 215:
2025-06-07 18:12:59,518 - train_models - INFO -   Fold 1: MAE=1.5501, RMSE=2.3363, R²=0.5463, MAPE=42.24%
2025-06-07 18:12:59,518 - train_models - INFO -   Fold 2: MAE=1.2054, RMSE=1.6682, R²=0.7606, MAPE=27.59%
2025-06-07 18:12:59,518 - train_models - INFO -   Fold 3: MAE=1.3232, RMSE=1.8611, R²=0.6924, MAPE=24.51%
2025-06-07 18:12:59,519 - train_models - INFO -   Fold 4: MAE=1.1604, RMSE=1.7243, R²=0.6921, MAPE=27.61%
2025-06-07 18:12:59,519 - train_models - INFO -   Fold 5: MAE=1.2477, RMSE=1.9257, R²=0.6802, MAPE=25.60%
2025-06-07 18:12:59,520 - train_models - INFO - Building model for WorkType: 217
2025-06-07 18:12:59,545 - train_models - INFO - Available features for 217: 22 numeric, 3 categorical
2025-06-07 18:13:22,235 - train_models - INFO - Model for 217 - MAE: 0.8877, RMSE: 1.1526, R²: 0.6416, MAPE: 36.91%
2025-06-07 18:13:22,235 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 18:13:22,236 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4647
2025-06-07 18:13:22,236 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1659
2025-06-07 18:13:22,237 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1015
2025-06-07 18:13:22,237 - train_models - INFO -   NoOfMan_lag_1: 0.0750
2025-06-07 18:13:22,237 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0271
2025-06-07 18:13:22,238 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0154
2025-06-07 18:13:22,238 - train_models - INFO -   NoOfMan_lag_3: 0.0149
2025-06-07 18:13:22,239 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0139
2025-06-07 18:13:22,239 - train_models - INFO -   NoOfMan_lag_2: 0.0137
2025-06-07 18:13:22,239 - train_models - INFO -   NoOfMan_lag_7: 0.0130
2025-06-07 18:13:22,240 - train_models - INFO - Cross-validation details for 217:
2025-06-07 18:13:22,240 - train_models - INFO -   Fold 1: MAE=0.9657, RMSE=1.1608, R²=0.5310, MAPE=43.59%
2025-06-07 18:13:22,241 - train_models - INFO -   Fold 2: MAE=0.8077, RMSE=1.0493, R²=0.6649, MAPE=38.28%
2025-06-07 18:13:22,241 - train_models - INFO -   Fold 3: MAE=0.8200, RMSE=1.0838, R²=0.7210, MAPE=30.99%
2025-06-07 18:13:22,241 - train_models - INFO -   Fold 4: MAE=0.8575, RMSE=1.1297, R²=0.7267, MAPE=33.08%
2025-06-07 18:13:22,242 - train_models - INFO -   Fold 5: MAE=0.9877, RMSE=1.3395, R²=0.5645, MAPE=38.59%
2025-06-07 18:13:22,243 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 18:13:23,383 - train_models - INFO - Model files saved successfully
2025-06-07 18:13:23,383 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 18:13:23,384 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 18:13:23,388 - train_models - INFO - Model training completed successfully
2025-06-07 19:09:48,197 - train_models - INFO - Starting the model training process
2025-06-07 19:09:48,198 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 19:09:48,198 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 19:09:48,204 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 19:09:48,572 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 19:09:49,684 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 19:09:49,837 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 19:09:49,897 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 19:09:49,898 - train_models - INFO - Converting Date column to datetime format
2025-06-07 19:09:49,922 - train_models - INFO - Engineering features...
2025-06-07 19:09:51,433 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 19:09:51,433 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 19:09:51,434 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 19:09:51,830 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 19:09:51,830 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 19:09:51,852 - train_models - INFO - Found 10 unique work types
2025-06-07 19:09:51,852 - train_models - INFO - Building models for 10 work types
2025-06-07 19:09:51,852 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 19:09:51,853 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 19:09:51,853 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 19:09:51,854 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 19:09:51,854 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 19:09:51,855 - train_models - INFO - Building model for WorkType: 202
2025-06-07 19:09:51,882 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 19:10:09,808 - train_models - INFO - Model for 202 - MAE: 0.4528, RMSE: 0.5857, R²: 0.3409, MAPE: 24.18%
2025-06-07 19:10:09,808 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 19:10:09,809 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4652
2025-06-07 19:10:09,809 - train_models - INFO -   NoOfMan_lag_1: 0.1435
2025-06-07 19:10:09,810 - train_models - INFO -   Quantity_rolling_mean_7: 0.0436
2025-06-07 19:10:09,810 - train_models - INFO -   NoOfMan_lag_3: 0.0427
2025-06-07 19:10:09,811 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0381
2025-06-07 19:10:09,811 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0376
2025-06-07 19:10:09,811 - train_models - INFO -   NoOfMan_lag_2: 0.0302
2025-06-07 19:10:09,812 - train_models - INFO -   Quantity_lag_7: 0.0284
2025-06-07 19:10:09,812 - train_models - INFO -   NoOfMan_lag_14: 0.0237
2025-06-07 19:10:09,813 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-06-07 19:10:09,813 - train_models - INFO - Cross-validation details for 202:
2025-06-07 19:10:09,814 - train_models - INFO -   Fold 1: MAE=0.3103, RMSE=0.4451, R²=0.3057, MAPE=19.28%
2025-06-07 19:10:09,815 - train_models - INFO -   Fold 2: MAE=0.3711, RMSE=0.4804, R²=0.4684, MAPE=23.48%
2025-06-07 19:10:09,815 - train_models - INFO -   Fold 3: MAE=0.4850, RMSE=0.6414, R²=0.3597, MAPE=28.98%
2025-06-07 19:10:09,816 - train_models - INFO -   Fold 4: MAE=0.4994, RMSE=0.6236, R²=0.2085, MAPE=24.81%
2025-06-07 19:10:09,816 - train_models - INFO -   Fold 5: MAE=0.5984, RMSE=0.7382, R²=0.3619, MAPE=24.36%
2025-06-07 19:10:09,816 - train_models - INFO - Building model for WorkType: 203
2025-06-07 19:10:09,840 - train_models - INFO - Available features for 203: 15 numeric, 3 categorical
2025-06-07 19:10:30,286 - train_models - INFO - Model for 203 - MAE: 0.6396, RMSE: 0.8443, R²: 0.4229, MAPE: 13.34%
2025-06-07 19:10:30,287 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 19:10:30,288 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4006
2025-06-07 19:10:30,288 - train_models - INFO -   NoOfMan_lag_1: 0.1701
2025-06-07 19:10:30,288 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0562
2025-06-07 19:10:30,289 - train_models - INFO -   NoOfMan_lag_2: 0.0452
2025-06-07 19:10:30,289 - train_models - INFO -   NoOfMan_lag_3: 0.0431
2025-06-07 19:10:30,290 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0351
2025-06-07 19:10:30,290 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0286
2025-06-07 19:10:30,291 - train_models - INFO -   Quantity_rolling_mean_7: 0.0270
2025-06-07 19:10:30,291 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-06-07 19:10:30,291 - train_models - INFO -   Quantity_lag_7: 0.0261
2025-06-07 19:10:30,292 - train_models - INFO - Cross-validation details for 203:
2025-06-07 19:10:30,292 - train_models - INFO -   Fold 1: MAE=0.6075, RMSE=0.8062, R²=0.4880, MAPE=11.99%
2025-06-07 19:10:30,293 - train_models - INFO -   Fold 2: MAE=0.6490, RMSE=0.8897, R²=0.4233, MAPE=12.88%
2025-06-07 19:10:30,293 - train_models - INFO -   Fold 3: MAE=0.6967, RMSE=0.9126, R²=0.3723, MAPE=13.54%
2025-06-07 19:10:30,294 - train_models - INFO -   Fold 4: MAE=0.6497, RMSE=0.8376, R²=0.4304, MAPE=14.23%
2025-06-07 19:10:30,294 - train_models - INFO -   Fold 5: MAE=0.5953, RMSE=0.7752, R²=0.4005, MAPE=14.07%
2025-06-07 19:10:30,295 - train_models - INFO - Building model for WorkType: 206
2025-06-07 19:10:30,321 - train_models - INFO - Available features for 206: 15 numeric, 3 categorical
2025-06-07 19:10:54,222 - train_models - INFO - Model for 206 - MAE: 2.2065, RMSE: 3.1554, R²: 0.8523, MAPE: 12.98%
2025-06-07 19:10:54,222 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 19:10:54,223 - train_models - INFO -   NoOfMan_same_dow_lag: 0.4739
2025-06-07 19:10:54,223 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1768
2025-06-07 19:10:54,224 - train_models - INFO -   DayOfWeek_feat_6: 0.1378
2025-06-07 19:10:54,224 - train_models - INFO -   Quantity_rolling_mean_7: 0.0352
2025-06-07 19:10:54,224 - train_models - INFO -   DayOfWeek_feat_4: 0.0350
2025-06-07 19:10:54,225 - train_models - INFO -   NoOfMan_lag_1: 0.0300
2025-06-07 19:10:54,225 - train_models - INFO -   Quantity_lag_1: 0.0125
2025-06-07 19:10:54,226 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0119
2025-06-07 19:10:54,226 - train_models - INFO -   NoOfMan_lag_2: 0.0118
2025-06-07 19:10:54,227 - train_models - INFO -   NoOfMan_lag_3: 0.0118
2025-06-07 19:10:54,227 - train_models - INFO - Cross-validation details for 206:
2025-06-07 19:10:54,228 - train_models - INFO -   Fold 1: MAE=2.3443, RMSE=3.1491, R²=0.8651, MAPE=13.75%
2025-06-07 19:10:54,228 - train_models - INFO -   Fold 2: MAE=2.3578, RMSE=3.1861, R²=0.8561, MAPE=12.86%
2025-06-07 19:10:54,229 - train_models - INFO -   Fold 3: MAE=2.4024, RMSE=3.7130, R²=0.7933, MAPE=13.97%
2025-06-07 19:10:54,229 - train_models - INFO -   Fold 4: MAE=1.8139, RMSE=2.7032, R²=0.8621, MAPE=12.70%
2025-06-07 19:10:54,230 - train_models - INFO -   Fold 5: MAE=2.1140, RMSE=3.0257, R²=0.8846, MAPE=11.62%
2025-06-07 19:10:54,230 - train_models - INFO - Building model for WorkType: 209
2025-06-07 19:10:54,253 - train_models - INFO - Available features for 209: 15 numeric, 3 categorical
2025-06-07 19:11:13,810 - train_models - INFO - Model for 209 - MAE: 1.9629, RMSE: 2.7320, R²: 0.5750, MAPE: 27.26%
2025-06-07 19:11:13,811 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 19:11:13,811 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3740
2025-06-07 19:11:13,812 - train_models - INFO -   Quantity_rolling_mean_7: 0.2188
2025-06-07 19:11:13,812 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0654
2025-06-07 19:11:13,813 - train_models - INFO -   DayOfWeek_feat_1: 0.0339
2025-06-07 19:11:13,813 - train_models - INFO -   NoOfMan_lag_2: 0.0337
2025-06-07 19:11:13,814 - train_models - INFO -   Quantity_lag_1: 0.0286
2025-06-07 19:11:13,814 - train_models - INFO -   NoOfMan_lag_3: 0.0286
2025-06-07 19:11:13,815 - train_models - INFO -   ResourceKPI_lag_1: 0.0225
2025-06-07 19:11:13,815 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0218
2025-06-07 19:11:13,816 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-06-07 19:11:13,816 - train_models - INFO - Cross-validation details for 209:
2025-06-07 19:11:13,817 - train_models - INFO -   Fold 1: MAE=1.7573, RMSE=2.4228, R²=0.6077, MAPE=23.62%
2025-06-07 19:11:13,817 - train_models - INFO -   Fold 2: MAE=2.1995, RMSE=3.2003, R²=0.4719, MAPE=30.89%
2025-06-07 19:11:13,817 - train_models - INFO -   Fold 3: MAE=1.7360, RMSE=2.2691, R²=0.5961, MAPE=26.60%
2025-06-07 19:11:13,818 - train_models - INFO -   Fold 4: MAE=1.8686, RMSE=2.6049, R²=0.6543, MAPE=26.10%
2025-06-07 19:11:13,818 - train_models - INFO -   Fold 5: MAE=2.2533, RMSE=3.1626, R²=0.5450, MAPE=29.09%
2025-06-07 19:11:13,819 - train_models - INFO - Building model for WorkType: 210
2025-06-07 19:11:13,846 - train_models - INFO - Available features for 210: 15 numeric, 3 categorical
2025-06-07 19:11:33,925 - train_models - INFO - Model for 210 - MAE: 1.5256, RMSE: 2.1138, R²: 0.6445, MAPE: 31.98%
2025-06-07 19:11:33,925 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 19:11:33,926 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3047
2025-06-07 19:11:33,926 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2826
2025-06-07 19:11:33,927 - train_models - INFO -   Quantity_rolling_mean_7: 0.0928
2025-06-07 19:11:33,927 - train_models - INFO -   DayOfWeek_feat_6: 0.0339
2025-06-07 19:11:33,928 - train_models - INFO -   NoOfMan_lag_2: 0.0319
2025-06-07 19:11:33,928 - train_models - INFO -   NoOfMan_lag_3: 0.0288
2025-06-07 19:11:33,929 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0210
2025-06-07 19:11:33,929 - train_models - INFO -   NoOfMan_lag_1: 0.0199
2025-06-07 19:11:33,930 - train_models - INFO -   Quantity_lag_1: 0.0197
2025-06-07 19:11:33,930 - train_models - INFO -   NoOfMan_lag_7: 0.0181
2025-06-07 19:11:33,930 - train_models - INFO - Cross-validation details for 210:
2025-06-07 19:11:33,931 - train_models - INFO -   Fold 1: MAE=1.2977, RMSE=1.7268, R²=0.7326, MAPE=22.04%
2025-06-07 19:11:33,931 - train_models - INFO -   Fold 2: MAE=1.4647, RMSE=2.0466, R²=0.6162, MAPE=24.16%
2025-06-07 19:11:33,932 - train_models - INFO -   Fold 3: MAE=1.3840, RMSE=1.8811, R²=0.6605, MAPE=19.65%
2025-06-07 19:11:33,932 - train_models - INFO -   Fold 4: MAE=1.6186, RMSE=2.2825, R²=0.6010, MAPE=48.12%
2025-06-07 19:11:33,933 - train_models - INFO -   Fold 5: MAE=1.8629, RMSE=2.6319, R²=0.6123, MAPE=45.93%
2025-06-07 19:11:33,933 - train_models - INFO - Building model for WorkType: 211
2025-06-07 19:11:33,961 - train_models - INFO - Available features for 211: 15 numeric, 3 categorical
2025-06-07 19:11:55,175 - train_models - INFO - Model for 211 - MAE: 1.5232, RMSE: 2.1022, R²: 0.6177, MAPE: 24.47%
2025-06-07 19:11:55,175 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 19:11:55,176 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4056
2025-06-07 19:11:55,176 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1464
2025-06-07 19:11:55,177 - train_models - INFO -   DayOfWeek_feat_6: 0.1234
2025-06-07 19:11:55,177 - train_models - INFO -   NoOfMan_lag_1: 0.0538
2025-06-07 19:11:55,178 - train_models - INFO -   Quantity_rolling_mean_7: 0.0411
2025-06-07 19:11:55,178 - train_models - INFO -   NoOfMan_lag_3: 0.0310
2025-06-07 19:11:55,179 - train_models - INFO -   NoOfMan_lag_2: 0.0242
2025-06-07 19:11:55,179 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0225
2025-06-07 19:11:55,180 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-06-07 19:11:55,180 - train_models - INFO -   Quantity_lag_1: 0.0195
2025-06-07 19:11:55,180 - train_models - INFO - Cross-validation details for 211:
2025-06-07 19:11:55,181 - train_models - INFO -   Fold 1: MAE=2.0304, RMSE=2.9657, R²=0.3882, MAPE=33.89%
2025-06-07 19:11:55,182 - train_models - INFO -   Fold 2: MAE=1.5108, RMSE=1.9820, R²=0.6332, MAPE=22.36%
2025-06-07 19:11:55,182 - train_models - INFO -   Fold 3: MAE=1.3641, RMSE=1.8258, R²=0.7106, MAPE=18.63%
2025-06-07 19:11:55,183 - train_models - INFO -   Fold 4: MAE=1.4068, RMSE=1.9755, R²=0.6736, MAPE=23.79%
2025-06-07 19:11:55,183 - train_models - INFO -   Fold 5: MAE=1.3037, RMSE=1.7621, R²=0.6830, MAPE=23.68%
2025-06-07 19:11:55,183 - train_models - INFO - Building model for WorkType: 213
2025-06-07 19:11:55,208 - train_models - INFO - Available features for 213: 15 numeric, 3 categorical
2025-06-07 19:12:14,283 - train_models - INFO - Model for 213 - MAE: 0.8551, RMSE: 1.1601, R²: 0.5572, MAPE: 36.91%
2025-06-07 19:12:14,284 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 19:12:14,284 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4985
2025-06-07 19:12:14,285 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1152
2025-06-07 19:12:14,285 - train_models - INFO -   NoOfMan_lag_1: 0.0637
2025-06-07 19:12:14,286 - train_models - INFO -   NoOfMan_lag_3: 0.0389
2025-06-07 19:12:14,286 - train_models - INFO -   NoOfMan_lag_2: 0.0316
2025-06-07 19:12:14,286 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0296
2025-06-07 19:12:14,287 - train_models - INFO -   NoOfMan_lag_14: 0.0295
2025-06-07 19:12:14,287 - train_models - INFO -   NoOfMan_lag_7: 0.0247
2025-06-07 19:12:14,288 - train_models - INFO -   DayOfWeek_feat_1: 0.0209
2025-06-07 19:12:14,288 - train_models - INFO -   Quantity_rolling_mean_7: 0.0182
2025-06-07 19:12:14,289 - train_models - INFO - Cross-validation details for 213:
2025-06-07 19:12:14,289 - train_models - INFO -   Fold 1: MAE=0.9115, RMSE=1.2899, R²=0.6104, MAPE=26.68%
2025-06-07 19:12:14,289 - train_models - INFO -   Fold 2: MAE=0.9001, RMSE=1.2279, R²=0.4825, MAPE=48.98%
2025-06-07 19:12:14,290 - train_models - INFO -   Fold 3: MAE=0.7700, RMSE=1.1106, R²=0.5428, MAPE=40.17%
2025-06-07 19:12:14,290 - train_models - INFO -   Fold 4: MAE=0.8481, RMSE=1.0963, R²=0.5435, MAPE=36.39%
2025-06-07 19:12:14,291 - train_models - INFO -   Fold 5: MAE=0.8459, RMSE=1.0755, R²=0.6065, MAPE=32.32%
2025-06-07 19:12:14,291 - train_models - INFO - Building model for WorkType: 214
2025-06-07 19:12:14,314 - train_models - INFO - Available features for 214: 15 numeric, 3 categorical
2025-06-07 19:12:33,394 - train_models - INFO - Model for 214 - MAE: 1.0414, RMSE: 1.3729, R²: 0.5708, MAPE: 24.92%
2025-06-07 19:12:33,394 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 19:12:33,395 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5337
2025-06-07 19:12:33,395 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1015
2025-06-07 19:12:33,396 - train_models - INFO -   NoOfMan_lag_1: 0.0793
2025-06-07 19:12:33,396 - train_models - INFO -   NoOfMan_lag_3: 0.0343
2025-06-07 19:12:33,397 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0244
2025-06-07 19:12:33,397 - train_models - INFO -   NoOfMan_lag_2: 0.0219
2025-06-07 19:12:33,398 - train_models - INFO -   Quantity_rolling_mean_7: 0.0210
2025-06-07 19:12:33,398 - train_models - INFO -   NoOfMan_lag_7: 0.0186
2025-06-07 19:12:33,399 - train_models - INFO -   DayOfWeek_feat_1: 0.0183
2025-06-07 19:12:33,399 - train_models - INFO -   Quantity_lag_7: 0.0182
2025-06-07 19:12:33,399 - train_models - INFO - Cross-validation details for 214:
2025-06-07 19:12:33,400 - train_models - INFO -   Fold 1: MAE=0.9757, RMSE=1.2797, R²=0.4296, MAPE=27.70%
2025-06-07 19:12:33,400 - train_models - INFO -   Fold 2: MAE=0.9651, RMSE=1.2149, R²=0.5888, MAPE=24.30%
2025-06-07 19:12:33,401 - train_models - INFO -   Fold 3: MAE=0.7970, RMSE=1.0699, R²=0.6882, MAPE=22.28%
2025-06-07 19:12:33,401 - train_models - INFO -   Fold 4: MAE=0.9603, RMSE=1.2926, R²=0.6114, MAPE=20.64%
2025-06-07 19:12:33,402 - train_models - INFO -   Fold 5: MAE=1.5090, RMSE=2.0076, R²=0.5359, MAPE=29.68%
2025-06-07 19:12:33,402 - train_models - INFO - Building model for WorkType: 215
2025-06-07 19:12:33,429 - train_models - INFO - Available features for 215: 15 numeric, 3 categorical
2025-06-07 19:12:55,060 - train_models - INFO - Model for 215 - MAE: 1.3318, RMSE: 1.9332, R²: 0.6647, MAPE: 29.49%
2025-06-07 19:12:55,060 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 19:12:55,061 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2337
2025-06-07 19:12:55,061 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2307
2025-06-07 19:12:55,062 - train_models - INFO -   DayOfWeek_feat_6: 0.1691
2025-06-07 19:12:55,062 - train_models - INFO -   Quantity_rolling_mean_7: 0.0730
2025-06-07 19:12:55,063 - train_models - INFO -   DayOfWeek_feat_0: 0.0511
2025-06-07 19:12:55,063 - train_models - INFO -   Quantity_lag_1: 0.0308
2025-06-07 19:12:55,064 - train_models - INFO -   NoOfMan_lag_1: 0.0301
2025-06-07 19:12:55,064 - train_models - INFO -   NoOfMan_lag_2: 0.0235
2025-06-07 19:12:55,065 - train_models - INFO -   DayOfMonth: 0.0231
2025-06-07 19:12:55,065 - train_models - INFO -   ResourceKPI_lag_1: 0.0213
2025-06-07 19:12:55,065 - train_models - INFO - Cross-validation details for 215:
2025-06-07 19:12:55,066 - train_models - INFO -   Fold 1: MAE=1.5200, RMSE=2.3087, R²=0.5569, MAPE=40.40%
2025-06-07 19:12:55,066 - train_models - INFO -   Fold 2: MAE=1.2407, RMSE=1.7141, R²=0.7472, MAPE=27.40%
2025-06-07 19:12:55,067 - train_models - INFO -   Fold 3: MAE=1.3588, RMSE=1.9022, R²=0.6787, MAPE=24.94%
2025-06-07 19:12:55,067 - train_models - INFO -   Fold 4: MAE=1.2264, RMSE=1.7579, R²=0.6800, MAPE=28.54%
2025-06-07 19:12:55,068 - train_models - INFO -   Fold 5: MAE=1.3132, RMSE=1.9833, R²=0.6608, MAPE=26.19%
2025-06-07 19:12:55,068 - train_models - INFO - Building model for WorkType: 217
2025-06-07 19:12:55,093 - train_models - INFO - Available features for 217: 15 numeric, 3 categorical
2025-06-07 19:13:11,690 - train_models - INFO - Model for 217 - MAE: 0.8818, RMSE: 1.1729, R²: 0.6299, MAPE: 36.89%
2025-06-07 19:13:11,691 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 19:13:11,691 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5662
2025-06-07 19:13:11,691 - train_models - INFO -   NoOfMan_lag_1: 0.1850
2025-06-07 19:13:11,692 - train_models - INFO -   NoOfMan_lag_2: 0.0504
2025-06-07 19:13:11,692 - train_models - INFO -   NoOfMan_lag_3: 0.0276
2025-06-07 19:13:11,693 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0241
2025-06-07 19:13:11,693 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0202
2025-06-07 19:13:11,694 - train_models - INFO -   NoOfMan_lag_14: 0.0162
2025-06-07 19:13:11,694 - train_models - INFO -   NoOfMan_lag_7: 0.0162
2025-06-07 19:13:11,695 - train_models - INFO -   Quantity_rolling_mean_7: 0.0152
2025-06-07 19:13:11,695 - train_models - INFO -   Quantity_lag_7: 0.0149
2025-06-07 19:13:11,695 - train_models - INFO - Cross-validation details for 217:
2025-06-07 19:13:11,696 - train_models - INFO -   Fold 1: MAE=0.9334, RMSE=1.1699, R²=0.5237, MAPE=41.11%
2025-06-07 19:13:11,696 - train_models - INFO -   Fold 2: MAE=0.8049, RMSE=1.0735, R²=0.6493, MAPE=38.76%
2025-06-07 19:13:11,697 - train_models - INFO -   Fold 3: MAE=0.7959, RMSE=1.0916, R²=0.7170, MAPE=30.10%
2025-06-07 19:13:11,697 - train_models - INFO -   Fold 4: MAE=0.8957, RMSE=1.1783, R²=0.7026, MAPE=34.69%
2025-06-07 19:13:11,698 - train_models - INFO -   Fold 5: MAE=0.9789, RMSE=1.3514, R²=0.5568, MAPE=39.80%
2025-06-07 19:13:11,699 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 19:13:12,614 - train_models - INFO - Model files saved successfully
2025-06-07 19:13:12,615 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 19:13:12,615 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 19:13:12,620 - train_models - INFO - Model training completed successfully
2025-06-07 19:57:46,055 - train_models - INFO - Starting the model training process
2025-06-07 19:57:46,055 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 19:57:46,056 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 19:57:46,064 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 19:57:46,384 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                AND Date > '2024-05-01'
                ORDER BY Date
            
2025-06-07 19:57:46,952 - train_models - INFO - Read chunk of 2757 rows
2025-06-07 19:57:47,000 - train_models - INFO - Data loaded successfully. Total rows: 2757
2025-06-07 19:57:47,001 - train_models - INFO - Converting Date column to datetime format
2025-06-07 19:57:47,019 - train_models - INFO - Engineering features...
2025-06-07 19:57:48,535 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 19:57:48,535 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 19:57:48,536 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 19:57:48,750 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 19:57:48,751 - utils.feature_engineering - INFO - Final shape: (2757, 60)
2025-06-07 19:57:48,755 - train_models - INFO - Found 10 unique work types
2025-06-07 19:57:48,756 - train_models - INFO - Building models for 10 work types
2025-06-07 19:57:48,756 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 19:57:48,757 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 19:57:48,757 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 19:57:48,758 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 19:57:48,758 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 19:57:48,759 - train_models - INFO - Building model for WorkType: 202
2025-06-07 19:57:48,777 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 19:57:53,919 - train_models - INFO - Model for 202 - MAE: 0.5774, RMSE: 0.7276, R²: 0.2878, MAPE: 26.84%
2025-06-07 19:57:53,919 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 19:57:53,920 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4049
2025-06-07 19:57:53,920 - train_models - INFO -   NoOfMan_lag_1: 0.1295
2025-06-07 19:57:53,921 - train_models - INFO -   NoOfMan_lag_2: 0.0523
2025-06-07 19:57:53,921 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0479
2025-06-07 19:57:53,922 - train_models - INFO -   Quantity_rolling_mean_7: 0.0419
2025-06-07 19:57:53,922 - train_models - INFO -   NoOfMan_lag_3: 0.0362
2025-06-07 19:57:53,922 - train_models - INFO -   DayOfMonth: 0.0356
2025-06-07 19:57:53,923 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0315
2025-06-07 19:57:53,923 - train_models - INFO -   Quantity_lag_7: 0.0315
2025-06-07 19:57:53,924 - train_models - INFO -   NoOfMan_lag_7: 0.0298
2025-06-07 19:57:53,924 - train_models - INFO - Cross-validation details for 202:
2025-06-07 19:57:53,925 - train_models - INFO -   Fold 1: MAE=0.6245, RMSE=0.7678, R²=0.2131, MAPE=21.86%
2025-06-07 19:57:53,925 - train_models - INFO -   Fold 2: MAE=0.6504, RMSE=0.7989, R²=0.4416, MAPE=33.09%
2025-06-07 19:57:53,926 - train_models - INFO -   Fold 3: MAE=0.4665, RMSE=0.6334, R²=0.3385, MAPE=16.56%
2025-06-07 19:57:53,926 - train_models - INFO -   Fold 4: MAE=0.5360, RMSE=0.6836, R²=0.4010, MAPE=27.02%
2025-06-07 19:57:53,927 - train_models - INFO -   Fold 5: MAE=0.6095, RMSE=0.7540, R²=0.0446, MAPE=35.69%
2025-06-07 19:57:53,927 - train_models - INFO - Building model for WorkType: 203
2025-06-07 19:57:53,949 - train_models - INFO - Available features for 203: 15 numeric, 3 categorical
2025-06-07 19:57:59,432 - train_models - INFO - Model for 203 - MAE: 0.6649, RMSE: 0.8599, R²: -0.0558, MAPE: 15.62%
2025-06-07 19:57:59,433 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 19:57:59,433 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3286
2025-06-07 19:57:59,434 - train_models - INFO -   NoOfMan_lag_1: 0.1480
2025-06-07 19:57:59,434 - train_models - INFO -   NoOfMan_lag_3: 0.0582
2025-06-07 19:57:59,435 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0572
2025-06-07 19:57:59,435 - train_models - INFO -   NoOfMan_lag_2: 0.0512
2025-06-07 19:57:59,436 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0479
2025-06-07 19:57:59,436 - train_models - INFO -   NoOfMan_lag_14: 0.0469
2025-06-07 19:57:59,437 - train_models - INFO -   Quantity_rolling_mean_7: 0.0340
2025-06-07 19:57:59,437 - train_models - INFO -   Quantity_lag_7: 0.0322
2025-06-07 19:57:59,437 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0307
2025-06-07 19:57:59,438 - train_models - INFO - Cross-validation details for 203:
2025-06-07 19:57:59,438 - train_models - INFO -   Fold 1: MAE=0.7629, RMSE=0.9304, R²=-0.6831, MAPE=22.31%
2025-06-07 19:57:59,439 - train_models - INFO -   Fold 2: MAE=0.7108, RMSE=0.9029, R²=-0.3025, MAPE=13.89%
2025-06-07 19:57:59,439 - train_models - INFO -   Fold 3: MAE=0.6819, RMSE=0.9146, R²=0.1716, MAPE=14.82%
2025-06-07 19:57:59,440 - train_models - INFO -   Fold 4: MAE=0.5211, RMSE=0.6549, R²=0.2346, MAPE=12.29%
2025-06-07 19:57:59,440 - train_models - INFO -   Fold 5: MAE=0.6477, RMSE=0.8969, R²=0.3003, MAPE=14.77%
2025-06-07 19:57:59,440 - train_models - INFO - Building model for WorkType: 206
2025-06-07 19:57:59,462 - train_models - INFO - Available features for 206: 15 numeric, 3 categorical
2025-06-07 19:58:05,807 - train_models - INFO - Model for 206 - MAE: 2.9327, RMSE: 3.9147, R²: 0.7785, MAPE: 16.39%
2025-06-07 19:58:05,808 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 19:58:05,808 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3719
2025-06-07 19:58:05,809 - train_models - INFO -   DayOfWeek_feat_6: 0.1944
2025-06-07 19:58:05,809 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1260
2025-06-07 19:58:05,810 - train_models - INFO -   Quantity_rolling_mean_7: 0.1022
2025-06-07 19:58:05,810 - train_models - INFO -   NoOfMan_lag_1: 0.0391
2025-06-07 19:58:05,811 - train_models - INFO -   DayOfWeek_feat_4: 0.0313
2025-06-07 19:58:05,811 - train_models - INFO -   NoOfMan_lag_3: 0.0205
2025-06-07 19:58:05,812 - train_models - INFO -   ResourceKPI_lag_1: 0.0201
2025-06-07 19:58:05,812 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0140
2025-06-07 19:58:05,812 - train_models - INFO -   Quantity_lag_1: 0.0137
2025-06-07 19:58:05,813 - train_models - INFO - Cross-validation details for 206:
2025-06-07 19:58:05,813 - train_models - INFO -   Fold 1: MAE=2.2405, RMSE=2.6799, R²=0.8609, MAPE=14.74%
2025-06-07 19:58:05,814 - train_models - INFO -   Fold 2: MAE=3.3635, RMSE=4.6624, R²=0.7022, MAPE=13.76%
2025-06-07 19:58:05,814 - train_models - INFO -   Fold 3: MAE=5.6765, RMSE=7.2964, R²=0.6320, MAPE=33.63%
2025-06-07 19:58:05,815 - train_models - INFO -   Fold 4: MAE=1.4055, RMSE=1.9845, R²=0.9112, MAPE=7.11%
2025-06-07 19:58:05,815 - train_models - INFO -   Fold 5: MAE=1.9774, RMSE=2.9501, R²=0.7860, MAPE=12.73%
2025-06-07 19:58:05,815 - train_models - INFO - Building model for WorkType: 209
2025-06-07 19:58:05,835 - train_models - INFO - Available features for 209: 15 numeric, 3 categorical
2025-06-07 19:58:11,315 - train_models - INFO - Model for 209 - MAE: 2.4769, RMSE: 3.1037, R²: 0.2663, MAPE: 32.94%
2025-06-07 19:58:11,316 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 19:58:11,316 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2799
2025-06-07 19:58:11,316 - train_models - INFO -   Quantity_rolling_mean_7: 0.2244
2025-06-07 19:58:11,317 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1620
2025-06-07 19:58:11,317 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0398
2025-06-07 19:58:11,318 - train_models - INFO -   NoOfMan_lag_2: 0.0332
2025-06-07 19:58:11,318 - train_models - INFO -   NoOfMan_lag_3: 0.0299
2025-06-07 19:58:11,318 - train_models - INFO -   Quantity_lag_7: 0.0285
2025-06-07 19:58:11,319 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0263
2025-06-07 19:58:11,319 - train_models - INFO -   NoOfMan_lag_14: 0.0226
2025-06-07 19:58:11,320 - train_models - INFO -   NoOfMan_lag_1: 0.0219
2025-06-07 19:58:11,320 - train_models - INFO - Cross-validation details for 209:
2025-06-07 19:58:11,320 - train_models - INFO -   Fold 1: MAE=1.8574, RMSE=2.1780, R²=0.4935, MAPE=22.77%
2025-06-07 19:58:11,321 - train_models - INFO -   Fold 2: MAE=2.9483, RMSE=3.9473, R²=0.1929, MAPE=46.18%
2025-06-07 19:58:11,321 - train_models - INFO -   Fold 3: MAE=4.3591, RMSE=5.4955, R²=0.1534, MAPE=46.60%
2025-06-07 19:58:11,322 - train_models - INFO -   Fold 4: MAE=1.9359, RMSE=2.2357, R²=0.1885, MAPE=29.04%
2025-06-07 19:58:11,322 - train_models - INFO -   Fold 5: MAE=1.2838, RMSE=1.6620, R²=0.3030, MAPE=20.12%
2025-06-07 19:58:11,323 - train_models - INFO - Building model for WorkType: 210
2025-06-07 19:58:11,346 - train_models - INFO - Available features for 210: 15 numeric, 3 categorical
2025-06-07 19:58:18,793 - train_models - INFO - Model for 210 - MAE: 1.9698, RMSE: 2.5728, R²: 0.4283, MAPE: 32.37%
2025-06-07 19:58:18,793 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 19:58:18,794 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3423
2025-06-07 19:58:18,794 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2198
2025-06-07 19:58:18,795 - train_models - INFO -   DayOfWeek_feat_6: 0.1149
2025-06-07 19:58:18,795 - train_models - INFO -   Quantity_rolling_mean_7: 0.0710
2025-06-07 19:58:18,796 - train_models - INFO -   ResourceKPI_lag_1: 0.0298
2025-06-07 19:58:18,796 - train_models - INFO -   NoOfMan_lag_2: 0.0267
2025-06-07 19:58:18,796 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0235
2025-06-07 19:58:18,797 - train_models - INFO -   NoOfMan_lag_14: 0.0187
2025-06-07 19:58:18,797 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0176
2025-06-07 19:58:18,798 - train_models - INFO -   NoOfMan_lag_3: 0.0172
2025-06-07 19:58:18,798 - train_models - INFO - Cross-validation details for 210:
2025-06-07 19:58:18,799 - train_models - INFO -   Fold 1: MAE=1.5802, RMSE=2.0127, R²=0.5189, MAPE=24.85%
2025-06-07 19:58:18,799 - train_models - INFO -   Fold 2: MAE=1.6146, RMSE=2.2576, R²=0.6599, MAPE=24.38%
2025-06-07 19:58:18,800 - train_models - INFO -   Fold 3: MAE=3.7145, RMSE=4.7677, R²=0.4213, MAPE=58.26%
2025-06-07 19:58:18,800 - train_models - INFO -   Fold 4: MAE=1.8896, RMSE=2.5177, R²=-0.0107, MAPE=36.95%
2025-06-07 19:58:18,800 - train_models - INFO -   Fold 5: MAE=1.0499, RMSE=1.3080, R²=0.5520, MAPE=17.39%
2025-06-07 19:58:18,801 - train_models - INFO - Building model for WorkType: 211
2025-06-07 19:58:18,822 - train_models - INFO - Available features for 211: 15 numeric, 3 categorical
2025-06-07 19:58:26,525 - train_models - INFO - Model for 211 - MAE: 1.7377, RMSE: 2.2078, R²: 0.3364, MAPE: 35.80%
2025-06-07 19:58:26,526 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 19:58:26,526 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2968
2025-06-07 19:58:26,527 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2098
2025-06-07 19:58:26,527 - train_models - INFO -   DayOfWeek_feat_6: 0.1754
2025-06-07 19:58:26,528 - train_models - INFO -   Quantity_rolling_mean_7: 0.0661
2025-06-07 19:58:26,529 - train_models - INFO -   NoOfMan_lag_1: 0.0244
2025-06-07 19:58:26,529 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0233
2025-06-07 19:58:26,530 - train_models - INFO -   NoOfMan_lag_3: 0.0222
2025-06-07 19:58:26,530 - train_models - INFO -   Quantity_lag_7: 0.0214
2025-06-07 19:58:26,531 - train_models - INFO -   NoOfMan_lag_2: 0.0200
2025-06-07 19:58:26,532 - train_models - INFO -   Quantity_lag_1: 0.0174
2025-06-07 19:58:26,532 - train_models - INFO - Cross-validation details for 211:
2025-06-07 19:58:26,533 - train_models - INFO -   Fold 1: MAE=1.4294, RMSE=1.8091, R²=0.3499, MAPE=29.78%
2025-06-07 19:58:26,533 - train_models - INFO -   Fold 2: MAE=2.5775, RMSE=3.0137, R²=-0.1977, MAPE=41.49%
2025-06-07 19:58:26,534 - train_models - INFO -   Fold 3: MAE=2.0225, RMSE=2.6409, R²=0.4143, MAPE=44.81%
2025-06-07 19:58:26,535 - train_models - INFO -   Fold 4: MAE=1.1183, RMSE=1.4554, R²=0.5495, MAPE=16.79%
2025-06-07 19:58:26,535 - train_models - INFO -   Fold 5: MAE=1.5407, RMSE=2.1199, R²=0.5661, MAPE=46.14%
2025-06-07 19:58:26,536 - train_models - INFO - Building model for WorkType: 213
2025-06-07 19:58:26,573 - train_models - INFO - Available features for 213: 15 numeric, 3 categorical
2025-06-07 19:58:34,280 - train_models - INFO - Model for 213 - MAE: 0.9992, RMSE: 1.2129, R²: 0.1992, MAPE: 46.27%
2025-06-07 19:58:34,280 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 19:58:34,281 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3897
2025-06-07 19:58:34,281 - train_models - INFO -   Quantity_rolling_mean_7: 0.1213
2025-06-07 19:58:34,281 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1071
2025-06-07 19:58:34,282 - train_models - INFO -   DayOfWeek_feat_1: 0.0445
2025-06-07 19:58:34,282 - train_models - INFO -   NoOfMan_lag_14: 0.0444
2025-06-07 19:58:34,282 - train_models - INFO -   NoOfMan_lag_3: 0.0388
2025-06-07 19:58:34,283 - train_models - INFO -   Quantity_lag_1: 0.0356
2025-06-07 19:58:34,283 - train_models - INFO -   NoOfMan_lag_1: 0.0300
2025-06-07 19:58:34,284 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0286
2025-06-07 19:58:34,284 - train_models - INFO -   NoOfMan_lag_7: 0.0253
2025-06-07 19:58:34,284 - train_models - INFO - Cross-validation details for 213:
2025-06-07 19:58:34,285 - train_models - INFO -   Fold 1: MAE=1.6796, RMSE=2.0598, R²=0.0811, MAPE=99.85%
2025-06-07 19:58:34,285 - train_models - INFO -   Fold 2: MAE=1.1525, RMSE=1.3486, R²=0.0169, MAPE=41.03%
2025-06-07 19:58:34,285 - train_models - INFO -   Fold 3: MAE=1.0134, RMSE=1.2228, R²=0.3968, MAPE=32.16%
2025-06-07 19:58:34,286 - train_models - INFO -   Fold 4: MAE=0.6215, RMSE=0.7834, R²=0.3044, MAPE=29.33%
2025-06-07 19:58:34,286 - train_models - INFO -   Fold 5: MAE=0.5290, RMSE=0.6497, R²=0.1967, MAPE=29.00%
2025-06-07 19:58:34,287 - train_models - INFO - Building model for WorkType: 214
2025-06-07 19:58:34,307 - train_models - INFO - Available features for 214: 15 numeric, 3 categorical
2025-06-07 19:58:40,687 - train_models - INFO - Model for 214 - MAE: 1.4842, RMSE: 1.8653, R²: 0.0637, MAPE: 32.99%
2025-06-07 19:58:40,688 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 19:58:40,689 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3988
2025-06-07 19:58:40,691 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2557
2025-06-07 19:58:40,692 - train_models - INFO -   Quantity_rolling_mean_7: 0.0595
2025-06-07 19:58:40,693 - train_models - INFO -   NoOfMan_lag_1: 0.0385
2025-06-07 19:58:40,694 - train_models - INFO -   DayOfWeek_feat_6: 0.0339
2025-06-07 19:58:40,694 - train_models - INFO -   DayOfWeek_feat_1: 0.0229
2025-06-07 19:58:40,694 - train_models - INFO -   NoOfMan_lag_7: 0.0198
2025-06-07 19:58:40,695 - train_models - INFO -   NoOfMan_lag_3: 0.0197
2025-06-07 19:58:40,695 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0177
2025-06-07 19:58:40,696 - train_models - INFO -   Quantity_lag_1: 0.0161
2025-06-07 19:58:40,696 - train_models - INFO - Cross-validation details for 214:
2025-06-07 19:58:40,697 - train_models - INFO -   Fold 1: MAE=1.8080, RMSE=2.2051, R²=-0.0229, MAPE=35.79%
2025-06-07 19:58:40,697 - train_models - INFO -   Fold 2: MAE=1.5937, RMSE=1.8903, R²=0.1923, MAPE=20.80%
2025-06-07 19:58:40,698 - train_models - INFO -   Fold 3: MAE=2.1446, RMSE=2.8635, R²=0.2726, MAPE=56.06%
2025-06-07 19:58:40,698 - train_models - INFO -   Fold 4: MAE=1.0195, RMSE=1.2512, R²=-0.5257, MAPE=35.92%
2025-06-07 19:58:40,699 - train_models - INFO -   Fold 5: MAE=0.8555, RMSE=1.1163, R²=0.4022, MAPE=16.40%
2025-06-07 19:58:40,699 - train_models - INFO - Building model for WorkType: 215
2025-06-07 19:58:40,719 - train_models - INFO - Available features for 215: 15 numeric, 3 categorical
2025-06-07 19:58:47,893 - train_models - INFO - Model for 215 - MAE: 1.7072, RMSE: 2.2342, R²: 0.4438, MAPE: 34.88%
2025-06-07 19:58:47,894 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 19:58:47,894 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3037
2025-06-07 19:58:47,894 - train_models - INFO -   Quantity_rolling_mean_7: 0.1923
2025-06-07 19:58:47,895 - train_models - INFO -   DayOfWeek_feat_6: 0.1510
2025-06-07 19:58:47,895 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0964
2025-06-07 19:58:47,896 - train_models - INFO -   Quantity_lag_1: 0.0308
2025-06-07 19:58:47,896 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0267
2025-06-07 19:58:47,896 - train_models - INFO -   NoOfMan_lag_1: 0.0252
2025-06-07 19:58:47,897 - train_models - INFO -   NoOfMan_lag_2: 0.0236
2025-06-07 19:58:47,897 - train_models - INFO -   ResourceKPI_lag_1: 0.0226
2025-06-07 19:58:47,898 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0204
2025-06-07 19:58:47,898 - train_models - INFO - Cross-validation details for 215:
2025-06-07 19:58:47,898 - train_models - INFO -   Fold 1: MAE=1.1072, RMSE=1.3125, R²=0.6071, MAPE=33.79%
2025-06-07 19:58:47,899 - train_models - INFO -   Fold 2: MAE=2.0114, RMSE=2.5614, R²=0.2930, MAPE=32.36%
2025-06-07 19:58:47,899 - train_models - INFO -   Fold 3: MAE=2.7540, RMSE=3.8180, R²=0.1436, MAPE=51.12%
2025-06-07 19:58:47,900 - train_models - INFO -   Fold 4: MAE=1.4578, RMSE=1.8006, R²=0.6450, MAPE=20.31%
2025-06-07 19:58:47,900 - train_models - INFO -   Fold 5: MAE=1.2056, RMSE=1.6787, R²=0.5304, MAPE=36.80%
2025-06-07 19:58:47,900 - train_models - INFO - Building model for WorkType: 217
2025-06-07 19:58:47,919 - train_models - INFO - Available features for 217: 15 numeric, 3 categorical
2025-06-07 19:58:53,774 - train_models - INFO - Model for 217 - MAE: 1.2723, RMSE: 1.5617, R²: -0.3948, MAPE: 59.62%
2025-06-07 19:58:53,774 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 19:58:53,775 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4583
2025-06-07 19:58:53,775 - train_models - INFO -   Quantity_rolling_mean_7: 0.1041
2025-06-07 19:58:53,775 - train_models - INFO -   NoOfMan_lag_1: 0.0893
2025-06-07 19:58:53,776 - train_models - INFO -   NoOfMan_lag_3: 0.0457
2025-06-07 19:58:53,776 - train_models - INFO -   NoOfMan_lag_2: 0.0440
2025-06-07 19:58:53,777 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0337
2025-06-07 19:58:53,777 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0306
2025-06-07 19:58:53,777 - train_models - INFO -   ResourceKPI_lag_1: 0.0285
2025-06-07 19:58:53,778 - train_models - INFO -   Quantity_lag_1: 0.0266
2025-06-07 19:58:53,778 - train_models - INFO -   NoOfMan_lag_14: 0.0230
2025-06-07 19:58:53,778 - train_models - INFO - Cross-validation details for 217:
2025-06-07 19:58:53,779 - train_models - INFO -   Fold 1: MAE=1.4461, RMSE=1.5658, R²=-2.9011, MAPE=122.55%
2025-06-07 19:58:53,779 - train_models - INFO -   Fold 2: MAE=0.7754, RMSE=1.0005, R²=0.5142, MAPE=22.16%
2025-06-07 19:58:53,780 - train_models - INFO -   Fold 3: MAE=1.2718, RMSE=1.4999, R²=-0.0015, MAPE=57.26%
2025-06-07 19:58:53,780 - train_models - INFO -   Fold 4: MAE=1.7523, RMSE=2.2892, R²=0.1124, MAPE=45.23%
2025-06-07 19:58:53,781 - train_models - INFO -   Fold 5: MAE=1.1160, RMSE=1.4532, R²=0.3018, MAPE=50.90%
2025-06-07 19:58:53,782 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 19:58:54,734 - train_models - INFO - Model files saved successfully
2025-06-07 19:58:54,735 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 19:58:54,735 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 19:58:54,736 - train_models - INFO - Model training completed successfully
2025-06-07 20:26:55,490 - train_models - INFO - Starting the model training process
2025-06-07 20:26:55,491 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:26:55,492 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 20:26:55,499 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 20:27:00,564 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                AND Date > '2024-05-01'
                ORDER BY Date
            
2025-06-07 20:27:01,304 - train_models - INFO - Read chunk of 2757 rows
2025-06-07 20:27:01,356 - train_models - INFO - Data loaded successfully. Total rows: 2757
2025-06-07 20:27:01,357 - train_models - INFO - Converting Date column to datetime format
2025-06-07 20:27:01,373 - train_models - INFO - Engineering features...
2025-06-07 20:27:02,844 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 20:27:02,845 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 20:27:02,845 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 20:27:03,071 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 20:27:03,072 - utils.feature_engineering - INFO - Final shape: (2757, 60)
2025-06-07 20:27:03,076 - train_models - INFO - Found 10 unique work types
2025-06-07 20:27:03,076 - train_models - INFO - Building models for 10 work types
2025-06-07 20:27:03,077 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:27:03,077 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 20:27:03,078 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 20:27:03,078 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 20:27:03,079 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:03,079 - train_models - INFO - Building model for WorkType: 202
2025-06-07 20:27:03,097 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 20:27:03,098 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 20:27:03,098 - train_models - INFO - Total available features: 18
2025-06-07 20:27:03,099 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:03,099 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:03,099 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:08,329 - train_models - INFO - Model for 202 - MAE: 0.5774, RMSE: 0.7276, R²: 0.2878, MAPE: 26.84%
2025-06-07 20:27:08,330 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 20:27:08,330 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4049
2025-06-07 20:27:08,331 - train_models - INFO -   NoOfMan_lag_1: 0.1295
2025-06-07 20:27:08,331 - train_models - INFO -   NoOfMan_lag_2: 0.0523
2025-06-07 20:27:08,332 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0479
2025-06-07 20:27:08,332 - train_models - INFO -   Quantity_rolling_mean_7: 0.0419
2025-06-07 20:27:08,333 - train_models - INFO -   NoOfMan_lag_3: 0.0362
2025-06-07 20:27:08,333 - train_models - INFO -   DayOfMonth: 0.0356
2025-06-07 20:27:08,333 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0315
2025-06-07 20:27:08,334 - train_models - INFO -   Quantity_lag_7: 0.0315
2025-06-07 20:27:08,334 - train_models - INFO -   NoOfMan_lag_7: 0.0298
2025-06-07 20:27:08,335 - train_models - INFO - Cross-validation details for 202:
2025-06-07 20:27:08,335 - train_models - INFO -   Fold 1: MAE=0.6245, RMSE=0.7678, R²=0.2131, MAPE=21.86%
2025-06-07 20:27:08,336 - train_models - INFO -   Fold 2: MAE=0.6504, RMSE=0.7989, R²=0.4416, MAPE=33.09%
2025-06-07 20:27:08,336 - train_models - INFO -   Fold 3: MAE=0.4665, RMSE=0.6334, R²=0.3385, MAPE=16.56%
2025-06-07 20:27:08,337 - train_models - INFO -   Fold 4: MAE=0.5360, RMSE=0.6836, R²=0.4010, MAPE=27.02%
2025-06-07 20:27:08,338 - train_models - INFO -   Fold 5: MAE=0.6095, RMSE=0.7540, R²=0.0446, MAPE=35.69%
2025-06-07 20:27:08,338 - train_models - INFO - Building model for WorkType: 203
2025-06-07 20:27:08,359 - train_models - INFO - Available features for 203: 15 numeric, 3 categorical
2025-06-07 20:27:08,360 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 20:27:08,360 - train_models - INFO - Total available features: 18
2025-06-07 20:27:08,361 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:08,361 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:08,361 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:13,888 - train_models - INFO - Model for 203 - MAE: 0.6649, RMSE: 0.8599, R²: -0.0558, MAPE: 15.62%
2025-06-07 20:27:13,889 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 20:27:13,889 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3286
2025-06-07 20:27:13,890 - train_models - INFO -   NoOfMan_lag_1: 0.1480
2025-06-07 20:27:13,890 - train_models - INFO -   NoOfMan_lag_3: 0.0582
2025-06-07 20:27:13,890 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0572
2025-06-07 20:27:13,891 - train_models - INFO -   NoOfMan_lag_2: 0.0512
2025-06-07 20:27:13,891 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0479
2025-06-07 20:27:13,892 - train_models - INFO -   NoOfMan_lag_14: 0.0469
2025-06-07 20:27:13,892 - train_models - INFO -   Quantity_rolling_mean_7: 0.0340
2025-06-07 20:27:13,893 - train_models - INFO -   Quantity_lag_7: 0.0322
2025-06-07 20:27:13,893 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0307
2025-06-07 20:27:13,894 - train_models - INFO - Cross-validation details for 203:
2025-06-07 20:27:13,894 - train_models - INFO -   Fold 1: MAE=0.7629, RMSE=0.9304, R²=-0.6831, MAPE=22.31%
2025-06-07 20:27:13,895 - train_models - INFO -   Fold 2: MAE=0.7108, RMSE=0.9029, R²=-0.3025, MAPE=13.89%
2025-06-07 20:27:13,895 - train_models - INFO -   Fold 3: MAE=0.6819, RMSE=0.9146, R²=0.1716, MAPE=14.82%
2025-06-07 20:27:13,896 - train_models - INFO -   Fold 4: MAE=0.5211, RMSE=0.6549, R²=0.2346, MAPE=12.29%
2025-06-07 20:27:13,896 - train_models - INFO -   Fold 5: MAE=0.6477, RMSE=0.8969, R²=0.3003, MAPE=14.77%
2025-06-07 20:27:13,896 - train_models - INFO - Building model for WorkType: 206
2025-06-07 20:27:13,916 - train_models - INFO - Available features for 206: 15 numeric, 3 categorical
2025-06-07 20:27:13,917 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 20:27:13,917 - train_models - INFO - Total available features: 18
2025-06-07 20:27:13,918 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:13,918 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:13,919 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:19,569 - train_models - INFO - Model for 206 - MAE: 2.9327, RMSE: 3.9147, R²: 0.7785, MAPE: 16.39%
2025-06-07 20:27:19,570 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 20:27:19,570 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3719
2025-06-07 20:27:19,571 - train_models - INFO -   DayOfWeek_feat_6: 0.1944
2025-06-07 20:27:19,571 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1260
2025-06-07 20:27:19,572 - train_models - INFO -   Quantity_rolling_mean_7: 0.1022
2025-06-07 20:27:19,572 - train_models - INFO -   NoOfMan_lag_1: 0.0391
2025-06-07 20:27:19,573 - train_models - INFO -   DayOfWeek_feat_4: 0.0313
2025-06-07 20:27:19,573 - train_models - INFO -   NoOfMan_lag_3: 0.0205
2025-06-07 20:27:19,574 - train_models - INFO -   ResourceKPI_lag_1: 0.0201
2025-06-07 20:27:19,574 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0140
2025-06-07 20:27:19,574 - train_models - INFO -   Quantity_lag_1: 0.0137
2025-06-07 20:27:19,575 - train_models - INFO - Cross-validation details for 206:
2025-06-07 20:27:19,575 - train_models - INFO -   Fold 1: MAE=2.2405, RMSE=2.6799, R²=0.8609, MAPE=14.74%
2025-06-07 20:27:19,576 - train_models - INFO -   Fold 2: MAE=3.3635, RMSE=4.6624, R²=0.7022, MAPE=13.76%
2025-06-07 20:27:19,576 - train_models - INFO -   Fold 3: MAE=5.6765, RMSE=7.2964, R²=0.6320, MAPE=33.63%
2025-06-07 20:27:19,577 - train_models - INFO -   Fold 4: MAE=1.4055, RMSE=1.9845, R²=0.9112, MAPE=7.11%
2025-06-07 20:27:19,577 - train_models - INFO -   Fold 5: MAE=1.9774, RMSE=2.9501, R²=0.7860, MAPE=12.73%
2025-06-07 20:27:19,578 - train_models - INFO - Building model for WorkType: 209
2025-06-07 20:27:19,595 - train_models - INFO - Available features for 209: 15 numeric, 3 categorical
2025-06-07 20:27:19,596 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 20:27:19,596 - train_models - INFO - Total available features: 18
2025-06-07 20:27:19,597 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:19,597 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:19,598 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:24,629 - train_models - INFO - Model for 209 - MAE: 2.4769, RMSE: 3.1037, R²: 0.2663, MAPE: 32.94%
2025-06-07 20:27:24,630 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 20:27:24,630 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2799
2025-06-07 20:27:24,631 - train_models - INFO -   Quantity_rolling_mean_7: 0.2244
2025-06-07 20:27:24,631 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1620
2025-06-07 20:27:24,632 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0398
2025-06-07 20:27:24,632 - train_models - INFO -   NoOfMan_lag_2: 0.0332
2025-06-07 20:27:24,633 - train_models - INFO -   NoOfMan_lag_3: 0.0299
2025-06-07 20:27:24,633 - train_models - INFO -   Quantity_lag_7: 0.0285
2025-06-07 20:27:24,634 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0263
2025-06-07 20:27:24,634 - train_models - INFO -   NoOfMan_lag_14: 0.0226
2025-06-07 20:27:24,635 - train_models - INFO -   NoOfMan_lag_1: 0.0219
2025-06-07 20:27:24,635 - train_models - INFO - Cross-validation details for 209:
2025-06-07 20:27:24,636 - train_models - INFO -   Fold 1: MAE=1.8574, RMSE=2.1780, R²=0.4935, MAPE=22.77%
2025-06-07 20:27:24,636 - train_models - INFO -   Fold 2: MAE=2.9483, RMSE=3.9473, R²=0.1929, MAPE=46.18%
2025-06-07 20:27:24,637 - train_models - INFO -   Fold 3: MAE=4.3591, RMSE=5.4955, R²=0.1534, MAPE=46.60%
2025-06-07 20:27:24,637 - train_models - INFO -   Fold 4: MAE=1.9359, RMSE=2.2357, R²=0.1885, MAPE=29.04%
2025-06-07 20:27:24,638 - train_models - INFO -   Fold 5: MAE=1.2838, RMSE=1.6620, R²=0.3030, MAPE=20.12%
2025-06-07 20:27:24,638 - train_models - INFO - Building model for WorkType: 210
2025-06-07 20:27:24,657 - train_models - INFO - Available features for 210: 15 numeric, 3 categorical
2025-06-07 20:27:24,658 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 20:27:24,658 - train_models - INFO - Total available features: 18
2025-06-07 20:27:24,659 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:24,659 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:24,659 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:30,212 - train_models - INFO - Model for 210 - MAE: 1.9698, RMSE: 2.5728, R²: 0.4283, MAPE: 32.37%
2025-06-07 20:27:30,213 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 20:27:30,214 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3423
2025-06-07 20:27:30,214 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2198
2025-06-07 20:27:30,215 - train_models - INFO -   DayOfWeek_feat_6: 0.1149
2025-06-07 20:27:30,215 - train_models - INFO -   Quantity_rolling_mean_7: 0.0710
2025-06-07 20:27:30,216 - train_models - INFO -   ResourceKPI_lag_1: 0.0298
2025-06-07 20:27:30,216 - train_models - INFO -   NoOfMan_lag_2: 0.0267
2025-06-07 20:27:30,216 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0235
2025-06-07 20:27:30,217 - train_models - INFO -   NoOfMan_lag_14: 0.0187
2025-06-07 20:27:30,217 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0176
2025-06-07 20:27:30,218 - train_models - INFO -   NoOfMan_lag_3: 0.0172
2025-06-07 20:27:30,218 - train_models - INFO - Cross-validation details for 210:
2025-06-07 20:27:30,219 - train_models - INFO -   Fold 1: MAE=1.5802, RMSE=2.0127, R²=0.5189, MAPE=24.85%
2025-06-07 20:27:30,219 - train_models - INFO -   Fold 2: MAE=1.6146, RMSE=2.2576, R²=0.6599, MAPE=24.38%
2025-06-07 20:27:30,220 - train_models - INFO -   Fold 3: MAE=3.7145, RMSE=4.7677, R²=0.4213, MAPE=58.26%
2025-06-07 20:27:30,220 - train_models - INFO -   Fold 4: MAE=1.8896, RMSE=2.5177, R²=-0.0107, MAPE=36.95%
2025-06-07 20:27:30,220 - train_models - INFO -   Fold 5: MAE=1.0499, RMSE=1.3080, R²=0.5520, MAPE=17.39%
2025-06-07 20:27:30,221 - train_models - INFO - Building model for WorkType: 211
2025-06-07 20:27:30,239 - train_models - INFO - Available features for 211: 15 numeric, 3 categorical
2025-06-07 20:27:30,240 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 20:27:30,240 - train_models - INFO - Total available features: 18
2025-06-07 20:27:30,241 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:30,241 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:30,241 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:35,876 - train_models - INFO - Model for 211 - MAE: 1.7377, RMSE: 2.2078, R²: 0.3364, MAPE: 35.80%
2025-06-07 20:27:35,876 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 20:27:35,877 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2968
2025-06-07 20:27:35,877 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2098
2025-06-07 20:27:35,878 - train_models - INFO -   DayOfWeek_feat_6: 0.1754
2025-06-07 20:27:35,878 - train_models - INFO -   Quantity_rolling_mean_7: 0.0661
2025-06-07 20:27:35,879 - train_models - INFO -   NoOfMan_lag_1: 0.0244
2025-06-07 20:27:35,879 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0233
2025-06-07 20:27:35,880 - train_models - INFO -   NoOfMan_lag_3: 0.0222
2025-06-07 20:27:35,880 - train_models - INFO -   Quantity_lag_7: 0.0214
2025-06-07 20:27:35,881 - train_models - INFO -   NoOfMan_lag_2: 0.0200
2025-06-07 20:27:35,882 - train_models - INFO -   Quantity_lag_1: 0.0174
2025-06-07 20:27:35,882 - train_models - INFO - Cross-validation details for 211:
2025-06-07 20:27:35,883 - train_models - INFO -   Fold 1: MAE=1.4294, RMSE=1.8091, R²=0.3499, MAPE=29.78%
2025-06-07 20:27:35,883 - train_models - INFO -   Fold 2: MAE=2.5775, RMSE=3.0137, R²=-0.1977, MAPE=41.49%
2025-06-07 20:27:35,884 - train_models - INFO -   Fold 3: MAE=2.0225, RMSE=2.6409, R²=0.4143, MAPE=44.81%
2025-06-07 20:27:35,884 - train_models - INFO -   Fold 4: MAE=1.1183, RMSE=1.4554, R²=0.5495, MAPE=16.79%
2025-06-07 20:27:35,885 - train_models - INFO -   Fold 5: MAE=1.5407, RMSE=2.1199, R²=0.5661, MAPE=46.14%
2025-06-07 20:27:35,885 - train_models - INFO - Building model for WorkType: 213
2025-06-07 20:27:35,903 - train_models - INFO - Available features for 213: 15 numeric, 3 categorical
2025-06-07 20:27:35,904 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 20:27:35,904 - train_models - INFO - Total available features: 18
2025-06-07 20:27:35,905 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:35,905 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:35,906 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:41,109 - train_models - INFO - Model for 213 - MAE: 0.9992, RMSE: 1.2129, R²: 0.1992, MAPE: 46.27%
2025-06-07 20:27:41,109 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 20:27:41,110 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3897
2025-06-07 20:27:41,110 - train_models - INFO -   Quantity_rolling_mean_7: 0.1213
2025-06-07 20:27:41,110 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1071
2025-06-07 20:27:41,111 - train_models - INFO -   DayOfWeek_feat_1: 0.0445
2025-06-07 20:27:41,111 - train_models - INFO -   NoOfMan_lag_14: 0.0444
2025-06-07 20:27:41,112 - train_models - INFO -   NoOfMan_lag_3: 0.0388
2025-06-07 20:27:41,112 - train_models - INFO -   Quantity_lag_1: 0.0356
2025-06-07 20:27:41,113 - train_models - INFO -   NoOfMan_lag_1: 0.0300
2025-06-07 20:27:41,113 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0286
2025-06-07 20:27:41,114 - train_models - INFO -   NoOfMan_lag_7: 0.0253
2025-06-07 20:27:41,114 - train_models - INFO - Cross-validation details for 213:
2025-06-07 20:27:41,114 - train_models - INFO -   Fold 1: MAE=1.6796, RMSE=2.0598, R²=0.0811, MAPE=99.85%
2025-06-07 20:27:41,115 - train_models - INFO -   Fold 2: MAE=1.1525, RMSE=1.3486, R²=0.0169, MAPE=41.03%
2025-06-07 20:27:41,115 - train_models - INFO -   Fold 3: MAE=1.0134, RMSE=1.2228, R²=0.3968, MAPE=32.16%
2025-06-07 20:27:41,116 - train_models - INFO -   Fold 4: MAE=0.6215, RMSE=0.7834, R²=0.3044, MAPE=29.33%
2025-06-07 20:27:41,116 - train_models - INFO -   Fold 5: MAE=0.5290, RMSE=0.6497, R²=0.1967, MAPE=29.00%
2025-06-07 20:27:41,117 - train_models - INFO - Building model for WorkType: 214
2025-06-07 20:27:41,135 - train_models - INFO - Available features for 214: 15 numeric, 3 categorical
2025-06-07 20:27:41,135 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 20:27:41,136 - train_models - INFO - Total available features: 18
2025-06-07 20:27:41,136 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:41,137 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:41,137 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:46,582 - train_models - INFO - Model for 214 - MAE: 1.4842, RMSE: 1.8653, R²: 0.0637, MAPE: 32.99%
2025-06-07 20:27:46,583 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 20:27:46,583 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3988
2025-06-07 20:27:46,584 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2557
2025-06-07 20:27:46,584 - train_models - INFO -   Quantity_rolling_mean_7: 0.0595
2025-06-07 20:27:46,584 - train_models - INFO -   NoOfMan_lag_1: 0.0385
2025-06-07 20:27:46,585 - train_models - INFO -   DayOfWeek_feat_6: 0.0339
2025-06-07 20:27:46,585 - train_models - INFO -   DayOfWeek_feat_1: 0.0229
2025-06-07 20:27:46,586 - train_models - INFO -   NoOfMan_lag_7: 0.0198
2025-06-07 20:27:46,586 - train_models - INFO -   NoOfMan_lag_3: 0.0197
2025-06-07 20:27:46,587 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0177
2025-06-07 20:27:46,587 - train_models - INFO -   Quantity_lag_1: 0.0161
2025-06-07 20:27:46,588 - train_models - INFO - Cross-validation details for 214:
2025-06-07 20:27:46,588 - train_models - INFO -   Fold 1: MAE=1.8080, RMSE=2.2051, R²=-0.0229, MAPE=35.79%
2025-06-07 20:27:46,589 - train_models - INFO -   Fold 2: MAE=1.5937, RMSE=1.8903, R²=0.1923, MAPE=20.80%
2025-06-07 20:27:46,589 - train_models - INFO -   Fold 3: MAE=2.1446, RMSE=2.8635, R²=0.2726, MAPE=56.06%
2025-06-07 20:27:46,590 - train_models - INFO -   Fold 4: MAE=1.0195, RMSE=1.2512, R²=-0.5257, MAPE=35.92%
2025-06-07 20:27:46,590 - train_models - INFO -   Fold 5: MAE=0.8555, RMSE=1.1163, R²=0.4022, MAPE=16.40%
2025-06-07 20:27:46,591 - train_models - INFO - Building model for WorkType: 215
2025-06-07 20:27:46,608 - train_models - INFO - Available features for 215: 15 numeric, 3 categorical
2025-06-07 20:27:46,609 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 20:27:46,609 - train_models - INFO - Total available features: 18
2025-06-07 20:27:46,610 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:46,610 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:46,611 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:52,162 - train_models - INFO - Model for 215 - MAE: 1.7072, RMSE: 2.2342, R²: 0.4438, MAPE: 34.88%
2025-06-07 20:27:52,163 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 20:27:52,163 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3037
2025-06-07 20:27:52,164 - train_models - INFO -   Quantity_rolling_mean_7: 0.1923
2025-06-07 20:27:52,164 - train_models - INFO -   DayOfWeek_feat_6: 0.1510
2025-06-07 20:27:52,165 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0964
2025-06-07 20:27:52,165 - train_models - INFO -   Quantity_lag_1: 0.0308
2025-06-07 20:27:52,165 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0267
2025-06-07 20:27:52,166 - train_models - INFO -   NoOfMan_lag_1: 0.0252
2025-06-07 20:27:52,167 - train_models - INFO -   NoOfMan_lag_2: 0.0236
2025-06-07 20:27:52,167 - train_models - INFO -   ResourceKPI_lag_1: 0.0226
2025-06-07 20:27:52,167 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0204
2025-06-07 20:27:52,168 - train_models - INFO - Cross-validation details for 215:
2025-06-07 20:27:52,168 - train_models - INFO -   Fold 1: MAE=1.1072, RMSE=1.3125, R²=0.6071, MAPE=33.79%
2025-06-07 20:27:52,169 - train_models - INFO -   Fold 2: MAE=2.0114, RMSE=2.5614, R²=0.2930, MAPE=32.36%
2025-06-07 20:27:52,169 - train_models - INFO -   Fold 3: MAE=2.7540, RMSE=3.8180, R²=0.1436, MAPE=51.12%
2025-06-07 20:27:52,170 - train_models - INFO -   Fold 4: MAE=1.4578, RMSE=1.8006, R²=0.6450, MAPE=20.31%
2025-06-07 20:27:52,170 - train_models - INFO -   Fold 5: MAE=1.2056, RMSE=1.6787, R²=0.5304, MAPE=36.80%
2025-06-07 20:27:52,171 - train_models - INFO - Building model for WorkType: 217
2025-06-07 20:27:52,189 - train_models - INFO - Available features for 217: 15 numeric, 3 categorical
2025-06-07 20:27:52,189 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 20:27:52,190 - train_models - INFO - Total available features: 18
2025-06-07 20:27:52,190 - train_models - INFO - Numeric features: 15
2025-06-07 20:27:52,191 - train_models - INFO - Categorical features: 3
2025-06-07 20:27:52,191 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:27:57,173 - train_models - INFO - Model for 217 - MAE: 1.2723, RMSE: 1.5617, R²: -0.3948, MAPE: 59.62%
2025-06-07 20:27:57,174 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 20:27:57,174 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4583
2025-06-07 20:27:57,175 - train_models - INFO -   Quantity_rolling_mean_7: 0.1041
2025-06-07 20:27:57,175 - train_models - INFO -   NoOfMan_lag_1: 0.0893
2025-06-07 20:27:57,176 - train_models - INFO -   NoOfMan_lag_3: 0.0457
2025-06-07 20:27:57,176 - train_models - INFO -   NoOfMan_lag_2: 0.0440
2025-06-07 20:27:57,177 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0337
2025-06-07 20:27:57,177 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0306
2025-06-07 20:27:57,178 - train_models - INFO -   ResourceKPI_lag_1: 0.0285
2025-06-07 20:27:57,178 - train_models - INFO -   Quantity_lag_1: 0.0266
2025-06-07 20:27:57,179 - train_models - INFO -   NoOfMan_lag_14: 0.0230
2025-06-07 20:27:57,180 - train_models - INFO - Cross-validation details for 217:
2025-06-07 20:27:57,181 - train_models - INFO -   Fold 1: MAE=1.4461, RMSE=1.5658, R²=-2.9011, MAPE=122.55%
2025-06-07 20:27:57,182 - train_models - INFO -   Fold 2: MAE=0.7754, RMSE=1.0005, R²=0.5142, MAPE=22.16%
2025-06-07 20:27:57,183 - train_models - INFO -   Fold 3: MAE=1.2718, RMSE=1.4999, R²=-0.0015, MAPE=57.26%
2025-06-07 20:27:57,183 - train_models - INFO -   Fold 4: MAE=1.7523, RMSE=2.2892, R²=0.1124, MAPE=45.23%
2025-06-07 20:27:57,184 - train_models - INFO -   Fold 5: MAE=1.1160, RMSE=1.4532, R²=0.3018, MAPE=50.90%
2025-06-07 20:27:57,185 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 20:27:57,874 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-07 20:27:58,120 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 536, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-07 20:27:58,122 - train_models - INFO - Model training completed successfully
2025-06-07 20:29:38,456 - train_models - INFO - Starting the model training process
2025-06-07 20:29:38,456 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:29:38,457 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 20:29:38,463 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 20:29:38,807 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                AND Date > '2024-05-01'
                ORDER BY Date
            
2025-06-07 20:29:39,308 - train_models - INFO - Read chunk of 2757 rows
2025-06-07 20:29:39,353 - train_models - INFO - Data loaded successfully. Total rows: 2757
2025-06-07 20:29:39,353 - train_models - INFO - Converting Date column to datetime format
2025-06-07 20:29:39,371 - train_models - INFO - Engineering features...
2025-06-07 20:29:40,319 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 20:29:40,320 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 20:29:40,320 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 20:29:40,538 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 20:29:40,538 - utils.feature_engineering - INFO - Final shape: (2757, 60)
2025-06-07 20:29:40,543 - train_models - INFO - Found 10 unique work types
2025-06-07 20:29:40,543 - train_models - INFO - Building models for 10 work types
2025-06-07 20:29:40,544 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:29:40,544 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 20:29:40,545 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 20:29:40,545 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 20:29:40,546 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:29:40,546 - train_models - INFO - Building model for WorkType: 202
2025-06-07 20:29:40,567 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 20:29:40,567 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 20:29:40,568 - train_models - INFO - Total available features: 18
2025-06-07 20:29:40,570 - train_models - INFO - Numeric features: 15
2025-06-07 20:29:40,571 - train_models - INFO - Categorical features: 3
2025-06-07 20:29:40,571 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:29:45,256 - train_models - INFO - Model for 202 - MAE: 0.5774, RMSE: 0.7276, R²: 0.2878, MAPE: 26.84%
2025-06-07 20:29:45,257 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 20:29:45,257 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4049
2025-06-07 20:29:45,258 - train_models - INFO -   NoOfMan_lag_1: 0.1295
2025-06-07 20:29:45,258 - train_models - INFO -   NoOfMan_lag_2: 0.0523
2025-06-07 20:29:45,259 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0479
2025-06-07 20:29:45,259 - train_models - INFO -   Quantity_rolling_mean_7: 0.0419
2025-06-07 20:29:45,259 - train_models - INFO -   NoOfMan_lag_3: 0.0362
2025-06-07 20:29:45,260 - train_models - INFO -   DayOfMonth: 0.0356
2025-06-07 20:29:45,260 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0315
2025-06-07 20:29:45,261 - train_models - INFO -   Quantity_lag_7: 0.0315
2025-06-07 20:29:45,261 - train_models - INFO -   NoOfMan_lag_7: 0.0298
2025-06-07 20:29:45,262 - train_models - INFO - Cross-validation details for 202:
2025-06-07 20:29:45,262 - train_models - INFO -   Fold 1: MAE=0.6245, RMSE=0.7678, R²=0.2131, MAPE=21.86%
2025-06-07 20:29:45,263 - train_models - INFO -   Fold 2: MAE=0.6504, RMSE=0.7989, R²=0.4416, MAPE=33.09%
2025-06-07 20:29:45,263 - train_models - INFO -   Fold 3: MAE=0.4665, RMSE=0.6334, R²=0.3385, MAPE=16.56%
2025-06-07 20:29:45,263 - train_models - INFO -   Fold 4: MAE=0.5360, RMSE=0.6836, R²=0.4010, MAPE=27.02%
2025-06-07 20:29:45,264 - train_models - INFO -   Fold 5: MAE=0.6095, RMSE=0.7540, R²=0.0446, MAPE=35.69%
2025-06-07 20:29:45,264 - train_models - INFO - Building model for WorkType: 203
2025-06-07 20:29:45,282 - train_models - INFO - Available features for 203: 15 numeric, 3 categorical
2025-06-07 20:29:45,282 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 20:29:45,283 - train_models - INFO - Total available features: 18
2025-06-07 20:29:45,284 - train_models - INFO - Numeric features: 15
2025-06-07 20:29:45,284 - train_models - INFO - Categorical features: 3
2025-06-07 20:29:45,285 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:29:50,200 - train_models - INFO - Model for 203 - MAE: 0.6649, RMSE: 0.8599, R²: -0.0558, MAPE: 15.62%
2025-06-07 20:29:50,201 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 20:29:50,201 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3286
2025-06-07 20:29:50,202 - train_models - INFO -   NoOfMan_lag_1: 0.1480
2025-06-07 20:29:50,202 - train_models - INFO -   NoOfMan_lag_3: 0.0582
2025-06-07 20:29:50,203 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0572
2025-06-07 20:29:50,203 - train_models - INFO -   NoOfMan_lag_2: 0.0512
2025-06-07 20:29:50,204 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0479
2025-06-07 20:29:50,204 - train_models - INFO -   NoOfMan_lag_14: 0.0469
2025-06-07 20:29:50,205 - train_models - INFO -   Quantity_rolling_mean_7: 0.0340
2025-06-07 20:29:50,205 - train_models - INFO -   Quantity_lag_7: 0.0322
2025-06-07 20:29:50,205 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0307
2025-06-07 20:29:50,206 - train_models - INFO - Cross-validation details for 203:
2025-06-07 20:29:50,206 - train_models - INFO -   Fold 1: MAE=0.7629, RMSE=0.9304, R²=-0.6831, MAPE=22.31%
2025-06-07 20:29:50,207 - train_models - INFO -   Fold 2: MAE=0.7108, RMSE=0.9029, R²=-0.3025, MAPE=13.89%
2025-06-07 20:29:50,207 - train_models - INFO -   Fold 3: MAE=0.6819, RMSE=0.9146, R²=0.1716, MAPE=14.82%
2025-06-07 20:29:50,208 - train_models - INFO -   Fold 4: MAE=0.5211, RMSE=0.6549, R²=0.2346, MAPE=12.29%
2025-06-07 20:29:50,208 - train_models - INFO -   Fold 5: MAE=0.6477, RMSE=0.8969, R²=0.3003, MAPE=14.77%
2025-06-07 20:29:50,209 - train_models - INFO - Building model for WorkType: 206
2025-06-07 20:29:50,228 - train_models - INFO - Available features for 206: 15 numeric, 3 categorical
2025-06-07 20:29:50,228 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 20:29:50,229 - train_models - INFO - Total available features: 18
2025-06-07 20:29:50,229 - train_models - INFO - Numeric features: 15
2025-06-07 20:29:50,229 - train_models - INFO - Categorical features: 3
2025-06-07 20:29:50,230 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:29:55,746 - train_models - INFO - Model for 206 - MAE: 2.9327, RMSE: 3.9147, R²: 0.7785, MAPE: 16.39%
2025-06-07 20:29:55,746 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 20:29:55,747 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3719
2025-06-07 20:29:55,747 - train_models - INFO -   DayOfWeek_feat_6: 0.1944
2025-06-07 20:29:55,747 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1260
2025-06-07 20:29:55,748 - train_models - INFO -   Quantity_rolling_mean_7: 0.1022
2025-06-07 20:29:55,748 - train_models - INFO -   NoOfMan_lag_1: 0.0391
2025-06-07 20:29:55,748 - train_models - INFO -   DayOfWeek_feat_4: 0.0313
2025-06-07 20:29:55,749 - train_models - INFO -   NoOfMan_lag_3: 0.0205
2025-06-07 20:29:55,749 - train_models - INFO -   ResourceKPI_lag_1: 0.0201
2025-06-07 20:29:55,750 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0140
2025-06-07 20:29:55,750 - train_models - INFO -   Quantity_lag_1: 0.0137
2025-06-07 20:29:55,750 - train_models - INFO - Cross-validation details for 206:
2025-06-07 20:29:55,751 - train_models - INFO -   Fold 1: MAE=2.2405, RMSE=2.6799, R²=0.8609, MAPE=14.74%
2025-06-07 20:29:55,751 - train_models - INFO -   Fold 2: MAE=3.3635, RMSE=4.6624, R²=0.7022, MAPE=13.76%
2025-06-07 20:29:55,752 - train_models - INFO -   Fold 3: MAE=5.6765, RMSE=7.2964, R²=0.6320, MAPE=33.63%
2025-06-07 20:29:55,753 - train_models - INFO -   Fold 4: MAE=1.4055, RMSE=1.9845, R²=0.9112, MAPE=7.11%
2025-06-07 20:29:55,753 - train_models - INFO -   Fold 5: MAE=1.9774, RMSE=2.9501, R²=0.7860, MAPE=12.73%
2025-06-07 20:29:55,754 - train_models - INFO - Building model for WorkType: 209
2025-06-07 20:29:55,780 - train_models - INFO - Available features for 209: 15 numeric, 3 categorical
2025-06-07 20:29:55,781 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 20:29:55,782 - train_models - INFO - Total available features: 18
2025-06-07 20:29:55,782 - train_models - INFO - Numeric features: 15
2025-06-07 20:29:55,783 - train_models - INFO - Categorical features: 3
2025-06-07 20:29:55,784 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:00,881 - train_models - INFO - Model for 209 - MAE: 2.4769, RMSE: 3.1037, R²: 0.2663, MAPE: 32.94%
2025-06-07 20:30:00,882 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 20:30:00,882 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2799
2025-06-07 20:30:00,883 - train_models - INFO -   Quantity_rolling_mean_7: 0.2244
2025-06-07 20:30:00,883 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1620
2025-06-07 20:30:00,884 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0398
2025-06-07 20:30:00,884 - train_models - INFO -   NoOfMan_lag_2: 0.0332
2025-06-07 20:30:00,885 - train_models - INFO -   NoOfMan_lag_3: 0.0299
2025-06-07 20:30:00,885 - train_models - INFO -   Quantity_lag_7: 0.0285
2025-06-07 20:30:00,886 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0263
2025-06-07 20:30:00,886 - train_models - INFO -   NoOfMan_lag_14: 0.0226
2025-06-07 20:30:00,886 - train_models - INFO -   NoOfMan_lag_1: 0.0219
2025-06-07 20:30:00,887 - train_models - INFO - Cross-validation details for 209:
2025-06-07 20:30:00,887 - train_models - INFO -   Fold 1: MAE=1.8574, RMSE=2.1780, R²=0.4935, MAPE=22.77%
2025-06-07 20:30:00,888 - train_models - INFO -   Fold 2: MAE=2.9483, RMSE=3.9473, R²=0.1929, MAPE=46.18%
2025-06-07 20:30:00,888 - train_models - INFO -   Fold 3: MAE=4.3591, RMSE=5.4955, R²=0.1534, MAPE=46.60%
2025-06-07 20:30:00,889 - train_models - INFO -   Fold 4: MAE=1.9359, RMSE=2.2357, R²=0.1885, MAPE=29.04%
2025-06-07 20:30:00,889 - train_models - INFO -   Fold 5: MAE=1.2838, RMSE=1.6620, R²=0.3030, MAPE=20.12%
2025-06-07 20:30:00,890 - train_models - INFO - Building model for WorkType: 210
2025-06-07 20:30:00,908 - train_models - INFO - Available features for 210: 15 numeric, 3 categorical
2025-06-07 20:30:00,909 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 20:30:00,909 - train_models - INFO - Total available features: 18
2025-06-07 20:30:00,910 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:00,910 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:00,911 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:06,136 - train_models - INFO - Model for 210 - MAE: 1.9698, RMSE: 2.5728, R²: 0.4283, MAPE: 32.37%
2025-06-07 20:30:06,136 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 20:30:06,137 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3423
2025-06-07 20:30:06,137 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2198
2025-06-07 20:30:06,138 - train_models - INFO -   DayOfWeek_feat_6: 0.1149
2025-06-07 20:30:06,138 - train_models - INFO -   Quantity_rolling_mean_7: 0.0710
2025-06-07 20:30:06,139 - train_models - INFO -   ResourceKPI_lag_1: 0.0298
2025-06-07 20:30:06,139 - train_models - INFO -   NoOfMan_lag_2: 0.0267
2025-06-07 20:30:06,139 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0235
2025-06-07 20:30:06,140 - train_models - INFO -   NoOfMan_lag_14: 0.0187
2025-06-07 20:30:06,140 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0176
2025-06-07 20:30:06,141 - train_models - INFO -   NoOfMan_lag_3: 0.0172
2025-06-07 20:30:06,141 - train_models - INFO - Cross-validation details for 210:
2025-06-07 20:30:06,142 - train_models - INFO -   Fold 1: MAE=1.5802, RMSE=2.0127, R²=0.5189, MAPE=24.85%
2025-06-07 20:30:06,142 - train_models - INFO -   Fold 2: MAE=1.6146, RMSE=2.2576, R²=0.6599, MAPE=24.38%
2025-06-07 20:30:06,143 - train_models - INFO -   Fold 3: MAE=3.7145, RMSE=4.7677, R²=0.4213, MAPE=58.26%
2025-06-07 20:30:06,143 - train_models - INFO -   Fold 4: MAE=1.8896, RMSE=2.5177, R²=-0.0107, MAPE=36.95%
2025-06-07 20:30:06,144 - train_models - INFO -   Fold 5: MAE=1.0499, RMSE=1.3080, R²=0.5520, MAPE=17.39%
2025-06-07 20:30:06,144 - train_models - INFO - Building model for WorkType: 211
2025-06-07 20:30:06,162 - train_models - INFO - Available features for 211: 15 numeric, 3 categorical
2025-06-07 20:30:06,163 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 20:30:06,163 - train_models - INFO - Total available features: 18
2025-06-07 20:30:06,164 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:06,165 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:06,165 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:11,443 - train_models - INFO - Model for 211 - MAE: 1.7377, RMSE: 2.2078, R²: 0.3364, MAPE: 35.80%
2025-06-07 20:30:11,444 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 20:30:11,444 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2968
2025-06-07 20:30:11,444 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2098
2025-06-07 20:30:11,445 - train_models - INFO -   DayOfWeek_feat_6: 0.1754
2025-06-07 20:30:11,445 - train_models - INFO -   Quantity_rolling_mean_7: 0.0661
2025-06-07 20:30:11,446 - train_models - INFO -   NoOfMan_lag_1: 0.0244
2025-06-07 20:30:11,446 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0233
2025-06-07 20:30:11,447 - train_models - INFO -   NoOfMan_lag_3: 0.0222
2025-06-07 20:30:11,447 - train_models - INFO -   Quantity_lag_7: 0.0214
2025-06-07 20:30:11,448 - train_models - INFO -   NoOfMan_lag_2: 0.0200
2025-06-07 20:30:11,448 - train_models - INFO -   Quantity_lag_1: 0.0174
2025-06-07 20:30:11,448 - train_models - INFO - Cross-validation details for 211:
2025-06-07 20:30:11,449 - train_models - INFO -   Fold 1: MAE=1.4294, RMSE=1.8091, R²=0.3499, MAPE=29.78%
2025-06-07 20:30:11,449 - train_models - INFO -   Fold 2: MAE=2.5775, RMSE=3.0137, R²=-0.1977, MAPE=41.49%
2025-06-07 20:30:11,450 - train_models - INFO -   Fold 3: MAE=2.0225, RMSE=2.6409, R²=0.4143, MAPE=44.81%
2025-06-07 20:30:11,450 - train_models - INFO -   Fold 4: MAE=1.1183, RMSE=1.4554, R²=0.5495, MAPE=16.79%
2025-06-07 20:30:11,451 - train_models - INFO -   Fold 5: MAE=1.5407, RMSE=2.1199, R²=0.5661, MAPE=46.14%
2025-06-07 20:30:11,451 - train_models - INFO - Building model for WorkType: 213
2025-06-07 20:30:11,469 - train_models - INFO - Available features for 213: 15 numeric, 3 categorical
2025-06-07 20:30:11,470 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 20:30:11,470 - train_models - INFO - Total available features: 18
2025-06-07 20:30:11,470 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:11,471 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:11,471 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:16,646 - train_models - INFO - Model for 213 - MAE: 0.9992, RMSE: 1.2129, R²: 0.1992, MAPE: 46.27%
2025-06-07 20:30:16,647 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 20:30:16,647 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3897
2025-06-07 20:30:16,647 - train_models - INFO -   Quantity_rolling_mean_7: 0.1213
2025-06-07 20:30:16,648 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1071
2025-06-07 20:30:16,648 - train_models - INFO -   DayOfWeek_feat_1: 0.0445
2025-06-07 20:30:16,649 - train_models - INFO -   NoOfMan_lag_14: 0.0444
2025-06-07 20:30:16,649 - train_models - INFO -   NoOfMan_lag_3: 0.0388
2025-06-07 20:30:16,650 - train_models - INFO -   Quantity_lag_1: 0.0356
2025-06-07 20:30:16,650 - train_models - INFO -   NoOfMan_lag_1: 0.0300
2025-06-07 20:30:16,650 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0286
2025-06-07 20:30:16,651 - train_models - INFO -   NoOfMan_lag_7: 0.0253
2025-06-07 20:30:16,651 - train_models - INFO - Cross-validation details for 213:
2025-06-07 20:30:16,652 - train_models - INFO -   Fold 1: MAE=1.6796, RMSE=2.0598, R²=0.0811, MAPE=99.85%
2025-06-07 20:30:16,652 - train_models - INFO -   Fold 2: MAE=1.1525, RMSE=1.3486, R²=0.0169, MAPE=41.03%
2025-06-07 20:30:16,653 - train_models - INFO -   Fold 3: MAE=1.0134, RMSE=1.2228, R²=0.3968, MAPE=32.16%
2025-06-07 20:30:16,653 - train_models - INFO -   Fold 4: MAE=0.6215, RMSE=0.7834, R²=0.3044, MAPE=29.33%
2025-06-07 20:30:16,654 - train_models - INFO -   Fold 5: MAE=0.5290, RMSE=0.6497, R²=0.1967, MAPE=29.00%
2025-06-07 20:30:16,654 - train_models - INFO - Building model for WorkType: 214
2025-06-07 20:30:16,672 - train_models - INFO - Available features for 214: 15 numeric, 3 categorical
2025-06-07 20:30:16,673 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 20:30:16,673 - train_models - INFO - Total available features: 18
2025-06-07 20:30:16,674 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:16,675 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:16,675 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:21,727 - train_models - INFO - Model for 214 - MAE: 1.4842, RMSE: 1.8653, R²: 0.0637, MAPE: 32.99%
2025-06-07 20:30:21,728 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 20:30:21,728 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3988
2025-06-07 20:30:21,729 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2557
2025-06-07 20:30:21,729 - train_models - INFO -   Quantity_rolling_mean_7: 0.0595
2025-06-07 20:30:21,730 - train_models - INFO -   NoOfMan_lag_1: 0.0385
2025-06-07 20:30:21,730 - train_models - INFO -   DayOfWeek_feat_6: 0.0339
2025-06-07 20:30:21,731 - train_models - INFO -   DayOfWeek_feat_1: 0.0229
2025-06-07 20:30:21,731 - train_models - INFO -   NoOfMan_lag_7: 0.0198
2025-06-07 20:30:21,732 - train_models - INFO -   NoOfMan_lag_3: 0.0197
2025-06-07 20:30:21,732 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0177
2025-06-07 20:30:21,732 - train_models - INFO -   Quantity_lag_1: 0.0161
2025-06-07 20:30:21,733 - train_models - INFO - Cross-validation details for 214:
2025-06-07 20:30:21,733 - train_models - INFO -   Fold 1: MAE=1.8080, RMSE=2.2051, R²=-0.0229, MAPE=35.79%
2025-06-07 20:30:21,734 - train_models - INFO -   Fold 2: MAE=1.5937, RMSE=1.8903, R²=0.1923, MAPE=20.80%
2025-06-07 20:30:21,734 - train_models - INFO -   Fold 3: MAE=2.1446, RMSE=2.8635, R²=0.2726, MAPE=56.06%
2025-06-07 20:30:21,735 - train_models - INFO -   Fold 4: MAE=1.0195, RMSE=1.2512, R²=-0.5257, MAPE=35.92%
2025-06-07 20:30:21,735 - train_models - INFO -   Fold 5: MAE=0.8555, RMSE=1.1163, R²=0.4022, MAPE=16.40%
2025-06-07 20:30:21,736 - train_models - INFO - Building model for WorkType: 215
2025-06-07 20:30:21,754 - train_models - INFO - Available features for 215: 15 numeric, 3 categorical
2025-06-07 20:30:21,755 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 20:30:21,755 - train_models - INFO - Total available features: 18
2025-06-07 20:30:21,756 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:21,756 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:21,756 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:26,993 - train_models - INFO - Model for 215 - MAE: 1.7072, RMSE: 2.2342, R²: 0.4438, MAPE: 34.88%
2025-06-07 20:30:26,994 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 20:30:26,994 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3037
2025-06-07 20:30:26,995 - train_models - INFO -   Quantity_rolling_mean_7: 0.1923
2025-06-07 20:30:26,995 - train_models - INFO -   DayOfWeek_feat_6: 0.1510
2025-06-07 20:30:26,996 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0964
2025-06-07 20:30:26,996 - train_models - INFO -   Quantity_lag_1: 0.0308
2025-06-07 20:30:26,997 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0267
2025-06-07 20:30:26,997 - train_models - INFO -   NoOfMan_lag_1: 0.0252
2025-06-07 20:30:26,998 - train_models - INFO -   NoOfMan_lag_2: 0.0236
2025-06-07 20:30:26,998 - train_models - INFO -   ResourceKPI_lag_1: 0.0226
2025-06-07 20:30:26,998 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0204
2025-06-07 20:30:26,999 - train_models - INFO - Cross-validation details for 215:
2025-06-07 20:30:26,999 - train_models - INFO -   Fold 1: MAE=1.1072, RMSE=1.3125, R²=0.6071, MAPE=33.79%
2025-06-07 20:30:27,000 - train_models - INFO -   Fold 2: MAE=2.0114, RMSE=2.5614, R²=0.2930, MAPE=32.36%
2025-06-07 20:30:27,000 - train_models - INFO -   Fold 3: MAE=2.7540, RMSE=3.8180, R²=0.1436, MAPE=51.12%
2025-06-07 20:30:27,001 - train_models - INFO -   Fold 4: MAE=1.4578, RMSE=1.8006, R²=0.6450, MAPE=20.31%
2025-06-07 20:30:27,001 - train_models - INFO -   Fold 5: MAE=1.2056, RMSE=1.6787, R²=0.5304, MAPE=36.80%
2025-06-07 20:30:27,002 - train_models - INFO - Building model for WorkType: 217
2025-06-07 20:30:27,019 - train_models - INFO - Available features for 217: 15 numeric, 3 categorical
2025-06-07 20:30:27,019 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 20:30:27,020 - train_models - INFO - Total available features: 18
2025-06-07 20:30:27,020 - train_models - INFO - Numeric features: 15
2025-06-07 20:30:27,021 - train_models - INFO - Categorical features: 3
2025-06-07 20:30:27,021 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:30:31,785 - train_models - INFO - Model for 217 - MAE: 1.2723, RMSE: 1.5617, R²: -0.3948, MAPE: 59.62%
2025-06-07 20:30:31,786 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 20:30:31,786 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4583
2025-06-07 20:30:31,787 - train_models - INFO -   Quantity_rolling_mean_7: 0.1041
2025-06-07 20:30:31,787 - train_models - INFO -   NoOfMan_lag_1: 0.0893
2025-06-07 20:30:31,788 - train_models - INFO -   NoOfMan_lag_3: 0.0457
2025-06-07 20:30:31,788 - train_models - INFO -   NoOfMan_lag_2: 0.0440
2025-06-07 20:30:31,788 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0337
2025-06-07 20:30:31,789 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0306
2025-06-07 20:30:31,789 - train_models - INFO -   ResourceKPI_lag_1: 0.0285
2025-06-07 20:30:31,790 - train_models - INFO -   Quantity_lag_1: 0.0266
2025-06-07 20:30:31,790 - train_models - INFO -   NoOfMan_lag_14: 0.0230
2025-06-07 20:30:31,791 - train_models - INFO - Cross-validation details for 217:
2025-06-07 20:30:31,791 - train_models - INFO -   Fold 1: MAE=1.4461, RMSE=1.5658, R²=-2.9011, MAPE=122.55%
2025-06-07 20:30:31,792 - train_models - INFO -   Fold 2: MAE=0.7754, RMSE=1.0005, R²=0.5142, MAPE=22.16%
2025-06-07 20:30:31,792 - train_models - INFO -   Fold 3: MAE=1.2718, RMSE=1.4999, R²=-0.0015, MAPE=57.26%
2025-06-07 20:30:31,793 - train_models - INFO -   Fold 4: MAE=1.7523, RMSE=2.2892, R²=0.1124, MAPE=45.23%
2025-06-07 20:30:31,793 - train_models - INFO -   Fold 5: MAE=1.1160, RMSE=1.4532, R²=0.3018, MAPE=50.90%
2025-06-07 20:30:31,794 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 20:30:32,494 - train_models - INFO - Model files saved successfully
2025-06-07 20:30:32,495 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 20:30:32,495 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 20:30:32,496 - train_models - INFO - Model training completed successfully
2025-06-07 20:56:14,425 - train_models - INFO - Starting the model training process
2025-06-07 20:56:14,426 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:56:14,426 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 20:56:14,430 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 20:56:14,780 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 20:56:15,644 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 20:56:15,697 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 20:56:15,748 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 20:56:15,749 - train_models - INFO - Converting Date column to datetime format
2025-06-07 20:56:15,777 - train_models - INFO - Engineering features...
2025-06-07 20:56:16,514 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 20:56:16,514 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 20:56:16,514 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 20:56:16,718 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 20:56:16,718 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 20:56:16,730 - train_models - INFO - Found 10 unique work types
2025-06-07 20:56:16,731 - train_models - INFO - Building models for 10 work types
2025-06-07 20:56:16,731 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 20:56:16,731 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 20:56:16,732 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 20:56:16,732 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 20:56:16,732 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:56:16,732 - train_models - INFO - Building model for WorkType: 202
2025-06-07 20:56:16,745 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 20:56:16,746 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 20:56:16,746 - train_models - INFO - Total available features: 18
2025-06-07 20:56:16,746 - train_models - INFO - Numeric features: 15
2025-06-07 20:56:16,747 - train_models - INFO - Categorical features: 3
2025-06-07 20:56:16,747 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:56:25,707 - train_models - INFO - Model for 202 - MAE: 0.4528, RMSE: 0.5857, R²: 0.3409, MAPE: 24.18%
2025-06-07 20:56:25,707 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 20:56:25,708 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4652
2025-06-07 20:56:25,708 - train_models - INFO -   NoOfMan_lag_1: 0.1435
2025-06-07 20:56:25,708 - train_models - INFO -   Quantity_rolling_mean_7: 0.0436
2025-06-07 20:56:25,708 - train_models - INFO -   NoOfMan_lag_3: 0.0427
2025-06-07 20:56:25,709 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0381
2025-06-07 20:56:25,709 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0376
2025-06-07 20:56:25,709 - train_models - INFO -   NoOfMan_lag_2: 0.0302
2025-06-07 20:56:25,710 - train_models - INFO -   Quantity_lag_7: 0.0284
2025-06-07 20:56:25,710 - train_models - INFO -   NoOfMan_lag_14: 0.0237
2025-06-07 20:56:25,710 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-06-07 20:56:25,710 - train_models - INFO - Cross-validation details for 202:
2025-06-07 20:56:25,711 - train_models - INFO -   Fold 1: MAE=0.3103, RMSE=0.4451, R²=0.3057, MAPE=19.28%
2025-06-07 20:56:25,711 - train_models - INFO -   Fold 2: MAE=0.3711, RMSE=0.4804, R²=0.4684, MAPE=23.48%
2025-06-07 20:56:25,711 - train_models - INFO -   Fold 3: MAE=0.4850, RMSE=0.6414, R²=0.3597, MAPE=28.98%
2025-06-07 20:56:25,711 - train_models - INFO -   Fold 4: MAE=0.4994, RMSE=0.6236, R²=0.2085, MAPE=24.81%
2025-06-07 20:56:25,711 - train_models - INFO -   Fold 5: MAE=0.5984, RMSE=0.7382, R²=0.3619, MAPE=24.36%
2025-06-07 20:56:25,712 - train_models - INFO - Building model for WorkType: 203
2025-06-07 20:56:25,725 - train_models - INFO - Available features for 203: 15 numeric, 3 categorical
2025-06-07 20:56:25,726 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 20:56:25,726 - train_models - INFO - Total available features: 18
2025-06-07 20:56:25,727 - train_models - INFO - Numeric features: 15
2025-06-07 20:56:25,727 - train_models - INFO - Categorical features: 3
2025-06-07 20:56:25,727 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:56:36,069 - train_models - INFO - Model for 203 - MAE: 0.6396, RMSE: 0.8443, R²: 0.4229, MAPE: 13.34%
2025-06-07 20:56:36,069 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 20:56:36,070 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4006
2025-06-07 20:56:36,070 - train_models - INFO -   NoOfMan_lag_1: 0.1701
2025-06-07 20:56:36,070 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0562
2025-06-07 20:56:36,070 - train_models - INFO -   NoOfMan_lag_2: 0.0452
2025-06-07 20:56:36,071 - train_models - INFO -   NoOfMan_lag_3: 0.0431
2025-06-07 20:56:36,071 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0351
2025-06-07 20:56:36,071 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0286
2025-06-07 20:56:36,072 - train_models - INFO -   Quantity_rolling_mean_7: 0.0270
2025-06-07 20:56:36,072 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-06-07 20:56:36,072 - train_models - INFO -   Quantity_lag_7: 0.0261
2025-06-07 20:56:36,073 - train_models - INFO - Cross-validation details for 203:
2025-06-07 20:56:36,073 - train_models - INFO -   Fold 1: MAE=0.6075, RMSE=0.8062, R²=0.4880, MAPE=11.99%
2025-06-07 20:56:36,073 - train_models - INFO -   Fold 2: MAE=0.6490, RMSE=0.8897, R²=0.4233, MAPE=12.88%
2025-06-07 20:56:36,073 - train_models - INFO -   Fold 3: MAE=0.6967, RMSE=0.9126, R²=0.3723, MAPE=13.54%
2025-06-07 20:56:36,074 - train_models - INFO -   Fold 4: MAE=0.6497, RMSE=0.8376, R²=0.4304, MAPE=14.23%
2025-06-07 20:56:36,074 - train_models - INFO -   Fold 5: MAE=0.5953, RMSE=0.7752, R²=0.4005, MAPE=14.07%
2025-06-07 20:56:36,074 - train_models - INFO - Building model for WorkType: 206
2025-06-07 20:56:36,087 - train_models - INFO - Available features for 206: 15 numeric, 3 categorical
2025-06-07 20:56:36,088 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 20:56:36,088 - train_models - INFO - Total available features: 18
2025-06-07 20:56:36,088 - train_models - INFO - Numeric features: 15
2025-06-07 20:56:36,088 - train_models - INFO - Categorical features: 3
2025-06-07 20:56:36,089 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:56:52,947 - train_models - INFO - Model for 206 - MAE: 2.2065, RMSE: 3.1554, R²: 0.8523, MAPE: 12.98%
2025-06-07 20:56:52,948 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 20:56:52,948 - train_models - INFO -   NoOfMan_same_dow_lag: 0.4739
2025-06-07 20:56:52,949 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1768
2025-06-07 20:56:52,949 - train_models - INFO -   DayOfWeek_feat_6: 0.1378
2025-06-07 20:56:52,949 - train_models - INFO -   Quantity_rolling_mean_7: 0.0352
2025-06-07 20:56:52,949 - train_models - INFO -   DayOfWeek_feat_4: 0.0350
2025-06-07 20:56:52,950 - train_models - INFO -   NoOfMan_lag_1: 0.0300
2025-06-07 20:56:52,950 - train_models - INFO -   Quantity_lag_1: 0.0125
2025-06-07 20:56:52,950 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0119
2025-06-07 20:56:52,951 - train_models - INFO -   NoOfMan_lag_2: 0.0118
2025-06-07 20:56:52,951 - train_models - INFO -   NoOfMan_lag_3: 0.0118
2025-06-07 20:56:52,951 - train_models - INFO - Cross-validation details for 206:
2025-06-07 20:56:52,951 - train_models - INFO -   Fold 1: MAE=2.3443, RMSE=3.1491, R²=0.8651, MAPE=13.75%
2025-06-07 20:56:52,952 - train_models - INFO -   Fold 2: MAE=2.3578, RMSE=3.1861, R²=0.8561, MAPE=12.86%
2025-06-07 20:56:52,952 - train_models - INFO -   Fold 3: MAE=2.4024, RMSE=3.7130, R²=0.7933, MAPE=13.97%
2025-06-07 20:56:52,952 - train_models - INFO -   Fold 4: MAE=1.8139, RMSE=2.7032, R²=0.8621, MAPE=12.70%
2025-06-07 20:56:52,952 - train_models - INFO -   Fold 5: MAE=2.1140, RMSE=3.0257, R²=0.8846, MAPE=11.62%
2025-06-07 20:56:52,953 - train_models - INFO - Building model for WorkType: 209
2025-06-07 20:56:52,966 - train_models - INFO - Available features for 209: 15 numeric, 3 categorical
2025-06-07 20:56:52,967 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 20:56:52,967 - train_models - INFO - Total available features: 18
2025-06-07 20:56:52,967 - train_models - INFO - Numeric features: 15
2025-06-07 20:56:52,968 - train_models - INFO - Categorical features: 3
2025-06-07 20:56:52,968 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:57:05,195 - train_models - INFO - Model for 209 - MAE: 1.9629, RMSE: 2.7320, R²: 0.5750, MAPE: 27.26%
2025-06-07 20:57:05,196 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 20:57:05,196 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3740
2025-06-07 20:57:05,197 - train_models - INFO -   Quantity_rolling_mean_7: 0.2188
2025-06-07 20:57:05,197 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0654
2025-06-07 20:57:05,197 - train_models - INFO -   DayOfWeek_feat_1: 0.0339
2025-06-07 20:57:05,198 - train_models - INFO -   NoOfMan_lag_2: 0.0337
2025-06-07 20:57:05,198 - train_models - INFO -   Quantity_lag_1: 0.0286
2025-06-07 20:57:05,198 - train_models - INFO -   NoOfMan_lag_3: 0.0286
2025-06-07 20:57:05,199 - train_models - INFO -   ResourceKPI_lag_1: 0.0225
2025-06-07 20:57:05,199 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0218
2025-06-07 20:57:05,199 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-06-07 20:57:05,199 - train_models - INFO - Cross-validation details for 209:
2025-06-07 20:57:05,200 - train_models - INFO -   Fold 1: MAE=1.7573, RMSE=2.4228, R²=0.6077, MAPE=23.62%
2025-06-07 20:57:05,200 - train_models - INFO -   Fold 2: MAE=2.1995, RMSE=3.2003, R²=0.4719, MAPE=30.89%
2025-06-07 20:57:05,200 - train_models - INFO -   Fold 3: MAE=1.7360, RMSE=2.2691, R²=0.5961, MAPE=26.60%
2025-06-07 20:57:05,200 - train_models - INFO -   Fold 4: MAE=1.8686, RMSE=2.6049, R²=0.6543, MAPE=26.10%
2025-06-07 20:57:05,201 - train_models - INFO -   Fold 5: MAE=2.2533, RMSE=3.1626, R²=0.5450, MAPE=29.09%
2025-06-07 20:57:05,201 - train_models - INFO - Building model for WorkType: 210
2025-06-07 20:57:05,217 - train_models - INFO - Available features for 210: 15 numeric, 3 categorical
2025-06-07 20:57:05,218 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 20:57:05,218 - train_models - INFO - Total available features: 18
2025-06-07 20:57:05,218 - train_models - INFO - Numeric features: 15
2025-06-07 20:57:05,219 - train_models - INFO - Categorical features: 3
2025-06-07 20:57:05,219 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:57:18,249 - train_models - INFO - Model for 210 - MAE: 1.5256, RMSE: 2.1138, R²: 0.6445, MAPE: 31.98%
2025-06-07 20:57:18,250 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 20:57:18,250 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3047
2025-06-07 20:57:18,250 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2826
2025-06-07 20:57:18,251 - train_models - INFO -   Quantity_rolling_mean_7: 0.0928
2025-06-07 20:57:18,251 - train_models - INFO -   DayOfWeek_feat_6: 0.0339
2025-06-07 20:57:18,251 - train_models - INFO -   NoOfMan_lag_2: 0.0319
2025-06-07 20:57:18,251 - train_models - INFO -   NoOfMan_lag_3: 0.0288
2025-06-07 20:57:18,252 - train_models - INFO -   NoOfMan_same_dom_lag: 0.0210
2025-06-07 20:57:18,252 - train_models - INFO -   NoOfMan_lag_1: 0.0199
2025-06-07 20:57:18,252 - train_models - INFO -   Quantity_lag_1: 0.0197
2025-06-07 20:57:18,253 - train_models - INFO -   NoOfMan_lag_7: 0.0181
2025-06-07 20:57:18,253 - train_models - INFO - Cross-validation details for 210:
2025-06-07 20:57:18,253 - train_models - INFO -   Fold 1: MAE=1.2977, RMSE=1.7268, R²=0.7326, MAPE=22.04%
2025-06-07 20:57:18,254 - train_models - INFO -   Fold 2: MAE=1.4647, RMSE=2.0466, R²=0.6162, MAPE=24.16%
2025-06-07 20:57:18,254 - train_models - INFO -   Fold 3: MAE=1.3840, RMSE=1.8811, R²=0.6605, MAPE=19.65%
2025-06-07 20:57:18,254 - train_models - INFO -   Fold 4: MAE=1.6186, RMSE=2.2825, R²=0.6010, MAPE=48.12%
2025-06-07 20:57:18,255 - train_models - INFO -   Fold 5: MAE=1.8629, RMSE=2.6319, R²=0.6123, MAPE=45.93%
2025-06-07 20:57:18,255 - train_models - INFO - Building model for WorkType: 211
2025-06-07 20:57:18,270 - train_models - INFO - Available features for 211: 15 numeric, 3 categorical
2025-06-07 20:57:18,271 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 20:57:18,271 - train_models - INFO - Total available features: 18
2025-06-07 20:57:18,271 - train_models - INFO - Numeric features: 15
2025-06-07 20:57:18,271 - train_models - INFO - Categorical features: 3
2025-06-07 20:57:18,272 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:57:34,829 - train_models - INFO - Model for 211 - MAE: 1.5232, RMSE: 2.1022, R²: 0.6177, MAPE: 24.47%
2025-06-07 20:57:34,829 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 20:57:34,830 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4056
2025-06-07 20:57:34,830 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1464
2025-06-07 20:57:34,830 - train_models - INFO -   DayOfWeek_feat_6: 0.1234
2025-06-07 20:57:34,831 - train_models - INFO -   NoOfMan_lag_1: 0.0538
2025-06-07 20:57:34,831 - train_models - INFO -   Quantity_rolling_mean_7: 0.0411
2025-06-07 20:57:34,831 - train_models - INFO -   NoOfMan_lag_3: 0.0310
2025-06-07 20:57:34,831 - train_models - INFO -   NoOfMan_lag_2: 0.0242
2025-06-07 20:57:34,832 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0225
2025-06-07 20:57:34,832 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-06-07 20:57:34,832 - train_models - INFO -   Quantity_lag_1: 0.0195
2025-06-07 20:57:34,832 - train_models - INFO - Cross-validation details for 211:
2025-06-07 20:57:34,833 - train_models - INFO -   Fold 1: MAE=2.0304, RMSE=2.9657, R²=0.3882, MAPE=33.89%
2025-06-07 20:57:34,833 - train_models - INFO -   Fold 2: MAE=1.5108, RMSE=1.9820, R²=0.6332, MAPE=22.36%
2025-06-07 20:57:34,833 - train_models - INFO -   Fold 3: MAE=1.3641, RMSE=1.8258, R²=0.7106, MAPE=18.63%
2025-06-07 20:57:34,833 - train_models - INFO -   Fold 4: MAE=1.4068, RMSE=1.9755, R²=0.6736, MAPE=23.79%
2025-06-07 20:57:34,833 - train_models - INFO -   Fold 5: MAE=1.3037, RMSE=1.7621, R²=0.6830, MAPE=23.68%
2025-06-07 20:57:34,834 - train_models - INFO - Building model for WorkType: 213
2025-06-07 20:57:34,845 - train_models - INFO - Available features for 213: 15 numeric, 3 categorical
2025-06-07 20:57:34,845 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 20:57:34,846 - train_models - INFO - Total available features: 18
2025-06-07 20:57:34,846 - train_models - INFO - Numeric features: 15
2025-06-07 20:57:34,846 - train_models - INFO - Categorical features: 3
2025-06-07 20:57:34,846 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:57:46,567 - train_models - INFO - Model for 213 - MAE: 0.8551, RMSE: 1.1601, R²: 0.5572, MAPE: 36.91%
2025-06-07 20:57:46,568 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 20:57:46,568 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4985
2025-06-07 20:57:46,568 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1152
2025-06-07 20:57:46,569 - train_models - INFO -   NoOfMan_lag_1: 0.0637
2025-06-07 20:57:46,569 - train_models - INFO -   NoOfMan_lag_3: 0.0389
2025-06-07 20:57:46,569 - train_models - INFO -   NoOfMan_lag_2: 0.0316
2025-06-07 20:57:46,569 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0296
2025-06-07 20:57:46,570 - train_models - INFO -   NoOfMan_lag_14: 0.0295
2025-06-07 20:57:46,570 - train_models - INFO -   NoOfMan_lag_7: 0.0247
2025-06-07 20:57:46,570 - train_models - INFO -   DayOfWeek_feat_1: 0.0209
2025-06-07 20:57:46,571 - train_models - INFO -   Quantity_rolling_mean_7: 0.0182
2025-06-07 20:57:46,571 - train_models - INFO - Cross-validation details for 213:
2025-06-07 20:57:46,571 - train_models - INFO -   Fold 1: MAE=0.9115, RMSE=1.2899, R²=0.6104, MAPE=26.68%
2025-06-07 20:57:46,572 - train_models - INFO -   Fold 2: MAE=0.9001, RMSE=1.2279, R²=0.4825, MAPE=48.98%
2025-06-07 20:57:46,572 - train_models - INFO -   Fold 3: MAE=0.7700, RMSE=1.1106, R²=0.5428, MAPE=40.17%
2025-06-07 20:57:46,572 - train_models - INFO -   Fold 4: MAE=0.8481, RMSE=1.0963, R²=0.5435, MAPE=36.39%
2025-06-07 20:57:46,573 - train_models - INFO -   Fold 5: MAE=0.8459, RMSE=1.0755, R²=0.6065, MAPE=32.32%
2025-06-07 20:57:46,573 - train_models - INFO - Building model for WorkType: 214
2025-06-07 20:57:46,638 - train_models - INFO - Available features for 214: 15 numeric, 3 categorical
2025-06-07 20:57:46,639 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 20:57:46,639 - train_models - INFO - Total available features: 18
2025-06-07 20:57:46,639 - train_models - INFO - Numeric features: 15
2025-06-07 20:57:46,640 - train_models - INFO - Categorical features: 3
2025-06-07 20:57:46,640 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:57:58,615 - train_models - INFO - Model for 214 - MAE: 1.0414, RMSE: 1.3729, R²: 0.5708, MAPE: 24.92%
2025-06-07 20:57:58,616 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 20:57:58,616 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5337
2025-06-07 20:57:58,616 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1015
2025-06-07 20:57:58,617 - train_models - INFO -   NoOfMan_lag_1: 0.0793
2025-06-07 20:57:58,617 - train_models - INFO -   NoOfMan_lag_3: 0.0343
2025-06-07 20:57:58,617 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0244
2025-06-07 20:57:58,617 - train_models - INFO -   NoOfMan_lag_2: 0.0219
2025-06-07 20:57:58,618 - train_models - INFO -   Quantity_rolling_mean_7: 0.0210
2025-06-07 20:57:58,618 - train_models - INFO -   NoOfMan_lag_7: 0.0186
2025-06-07 20:57:58,618 - train_models - INFO -   DayOfWeek_feat_1: 0.0183
2025-06-07 20:57:58,619 - train_models - INFO -   Quantity_lag_7: 0.0182
2025-06-07 20:57:58,619 - train_models - INFO - Cross-validation details for 214:
2025-06-07 20:57:58,619 - train_models - INFO -   Fold 1: MAE=0.9757, RMSE=1.2797, R²=0.4296, MAPE=27.70%
2025-06-07 20:57:58,620 - train_models - INFO -   Fold 2: MAE=0.9651, RMSE=1.2149, R²=0.5888, MAPE=24.30%
2025-06-07 20:57:58,620 - train_models - INFO -   Fold 3: MAE=0.7970, RMSE=1.0699, R²=0.6882, MAPE=22.28%
2025-06-07 20:57:58,620 - train_models - INFO -   Fold 4: MAE=0.9603, RMSE=1.2926, R²=0.6114, MAPE=20.64%
2025-06-07 20:57:58,620 - train_models - INFO -   Fold 5: MAE=1.5090, RMSE=2.0076, R²=0.5359, MAPE=29.68%
2025-06-07 20:57:58,621 - train_models - INFO - Building model for WorkType: 215
2025-06-07 20:57:58,636 - train_models - INFO - Available features for 215: 15 numeric, 3 categorical
2025-06-07 20:57:58,636 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 20:57:58,637 - train_models - INFO - Total available features: 18
2025-06-07 20:57:58,637 - train_models - INFO - Numeric features: 15
2025-06-07 20:57:58,637 - train_models - INFO - Categorical features: 3
2025-06-07 20:57:58,637 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:58:12,302 - train_models - INFO - Model for 215 - MAE: 1.3318, RMSE: 1.9332, R²: 0.6647, MAPE: 29.49%
2025-06-07 20:58:12,303 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 20:58:12,303 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2337
2025-06-07 20:58:12,303 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2307
2025-06-07 20:58:12,303 - train_models - INFO -   DayOfWeek_feat_6: 0.1691
2025-06-07 20:58:12,304 - train_models - INFO -   Quantity_rolling_mean_7: 0.0730
2025-06-07 20:58:12,304 - train_models - INFO -   DayOfWeek_feat_0: 0.0511
2025-06-07 20:58:12,304 - train_models - INFO -   Quantity_lag_1: 0.0308
2025-06-07 20:58:12,305 - train_models - INFO -   NoOfMan_lag_1: 0.0301
2025-06-07 20:58:12,305 - train_models - INFO -   NoOfMan_lag_2: 0.0235
2025-06-07 20:58:12,305 - train_models - INFO -   DayOfMonth: 0.0231
2025-06-07 20:58:12,306 - train_models - INFO -   ResourceKPI_lag_1: 0.0213
2025-06-07 20:58:12,306 - train_models - INFO - Cross-validation details for 215:
2025-06-07 20:58:12,306 - train_models - INFO -   Fold 1: MAE=1.5200, RMSE=2.3087, R²=0.5569, MAPE=40.40%
2025-06-07 20:58:12,306 - train_models - INFO -   Fold 2: MAE=1.2407, RMSE=1.7141, R²=0.7472, MAPE=27.40%
2025-06-07 20:58:12,307 - train_models - INFO -   Fold 3: MAE=1.3588, RMSE=1.9022, R²=0.6787, MAPE=24.94%
2025-06-07 20:58:12,307 - train_models - INFO -   Fold 4: MAE=1.2264, RMSE=1.7579, R²=0.6800, MAPE=28.54%
2025-06-07 20:58:12,307 - train_models - INFO -   Fold 5: MAE=1.3132, RMSE=1.9833, R²=0.6608, MAPE=26.19%
2025-06-07 20:58:12,308 - train_models - INFO - Building model for WorkType: 217
2025-06-07 20:58:12,323 - train_models - INFO - Available features for 217: 15 numeric, 3 categorical
2025-06-07 20:58:12,323 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 20:58:12,324 - train_models - INFO - Total available features: 18
2025-06-07 20:58:12,324 - train_models - INFO - Numeric features: 15
2025-06-07 20:58:12,324 - train_models - INFO - Categorical features: 3
2025-06-07 20:58:12,324 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 20:58:24,100 - train_models - INFO - Model for 217 - MAE: 0.8818, RMSE: 1.1729, R²: 0.6299, MAPE: 36.89%
2025-06-07 20:58:24,101 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 20:58:24,101 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5662
2025-06-07 20:58:24,101 - train_models - INFO -   NoOfMan_lag_1: 0.1850
2025-06-07 20:58:24,102 - train_models - INFO -   NoOfMan_lag_2: 0.0504
2025-06-07 20:58:24,102 - train_models - INFO -   NoOfMan_lag_3: 0.0276
2025-06-07 20:58:24,102 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0241
2025-06-07 20:58:24,103 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0202
2025-06-07 20:58:24,103 - train_models - INFO -   NoOfMan_lag_14: 0.0162
2025-06-07 20:58:24,103 - train_models - INFO -   NoOfMan_lag_7: 0.0162
2025-06-07 20:58:24,103 - train_models - INFO -   Quantity_rolling_mean_7: 0.0152
2025-06-07 20:58:24,104 - train_models - INFO -   Quantity_lag_7: 0.0149
2025-06-07 20:58:24,104 - train_models - INFO - Cross-validation details for 217:
2025-06-07 20:58:24,104 - train_models - INFO -   Fold 1: MAE=0.9334, RMSE=1.1699, R²=0.5237, MAPE=41.11%
2025-06-07 20:58:24,104 - train_models - INFO -   Fold 2: MAE=0.8049, RMSE=1.0735, R²=0.6493, MAPE=38.76%
2025-06-07 20:58:24,105 - train_models - INFO -   Fold 3: MAE=0.7959, RMSE=1.0916, R²=0.7170, MAPE=30.10%
2025-06-07 20:58:24,105 - train_models - INFO -   Fold 4: MAE=0.8957, RMSE=1.1783, R²=0.7026, MAPE=34.69%
2025-06-07 20:58:24,105 - train_models - INFO -   Fold 5: MAE=0.9789, RMSE=1.3514, R²=0.5568, MAPE=39.80%
2025-06-07 20:58:24,106 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 20:58:24,756 - train_models - INFO - Model files saved successfully
2025-06-07 20:58:24,757 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 20:58:24,758 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 20:58:24,764 - train_models - INFO - Model training completed successfully
2025-06-07 21:21:23,903 - train_models - INFO - Starting the model training process
2025-06-07 21:21:23,904 - train_models - INFO - Feature tiers enabled: ['BASIC', 'INTERMEDIATE']
2025-06-07 21:21:23,904 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 21:21:23,909 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 21:21:24,552 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 21:21:25,485 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 21:21:25,603 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 21:21:25,649 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 21:21:25,650 - train_models - INFO - Converting Date column to datetime format
2025-06-07 21:21:25,672 - train_models - INFO - Engineering features...
2025-06-07 21:21:26,457 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 21:21:26,457 - train_models - INFO - Using lag days: [1, 2, 3, 7, 14, 30]
2025-06-07 21:21:26,457 - train_models - INFO - Using rolling windows: [7, 14, 30]
2025-06-07 21:21:26,623 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-06-07 21:21:26,624 - utils.feature_engineering - INFO - Final shape: (15326, 60)
2025-06-07 21:21:26,636 - train_models - INFO - Found 10 unique work types
2025-06-07 21:21:26,636 - train_models - INFO - Building models for 10 work types
2025-06-07 21:21:26,637 - train_models - INFO - Using feature tiers: ['BASIC', 'INTERMEDIATE']
2025-06-07 21:21:26,637 - utils.feature_builder - INFO - Built feature set: 15 numeric, 3 categorical
2025-06-07 21:21:26,637 - train_models - INFO - Tiered feature system generated 15 numeric features and 3 categorical features
2025-06-07 21:21:26,637 - train_models - INFO - Numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag']
2025-06-07 21:21:26,637 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 21:21:26,638 - train_models - INFO - Building model for WorkType: 202
2025-06-07 21:21:26,651 - train_models - INFO - Available features for 202: 15 numeric, 3 categorical
2025-06-07 21:21:26,651 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 21:21:26,651 - train_models - INFO - Total available features: 18
2025-06-07 21:21:26,651 - train_models - INFO - Numeric features: 15
2025-06-07 21:21:26,652 - train_models - INFO - Categorical features: 3
2025-06-07 21:21:26,652 - train_models - INFO - Features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_7', 'Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'NoOfMan_rolling_mean_7', 'Quantity_rolling_mean_7', 'DayOfMonth', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'DayOfWeek_feat', 'Month_feat', 'Quarter']
2025-06-07 21:47:14,919 - train_models - INFO - Starting the model training process
2025-06-07 21:47:14,931 - train_models - INFO - Feature groups enabled: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:47:14,931 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 21:47:14,938 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 21:47:19,811 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 21:47:20,792 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 21:47:20,898 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 21:47:20,955 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 21:47:20,955 - train_models - INFO - Converting Date column to datetime format
2025-06-07 21:47:20,996 - train_models - INFO - Engineering features...
2025-06-07 21:47:21,808 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 21:47:21,808 - train_models - INFO - Using essential lags: [1, 7, 28]
2025-06-07 21:47:21,808 - train_models - INFO - Using essential windows: [7, 30]
2025-06-07 21:47:21,867 - utils.feature_engineering - INFO - Created features using config: LAG_FEATURES=True, PRODUCTIVITY_FEATURES=True
2025-06-07 21:47:21,867 - utils.feature_engineering - INFO - Final shape: (15326, 16)
2025-06-07 21:47:21,871 - train_models - INFO - Found 10 unique work types
2025-06-07 21:47:21,872 - train_models - INFO - Building models for 10 work types
2025-06-07 21:47:21,872 - train_models - INFO - Using feature groups: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:47:21,872 - train_models - INFO - Config-driven features: 12 numeric, 2 categorical
2025-06-07 21:47:21,872 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'Workers_per_Hour', 'Quantity_per_Hour', 'Workload_Density', 'KPI_Performance']
2025-06-07 21:47:21,872 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-07 21:47:21,873 - train_models - INFO - Building model for WorkType: 202
2025-06-07 21:47:21,884 - train_models - INFO - Available features for 202: 8 numeric, 2 categorical
2025-06-07 21:47:21,885 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 21:47:21,885 - train_models - INFO - Total available features: 10
2025-06-07 21:47:21,885 - train_models - INFO - Numeric features: 8
2025-06-07 21:47:21,885 - train_models - INFO - Categorical features: 2
2025-06-07 21:47:21,886 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:47:42,356 - train_models - INFO - Model for 202 - MAE: 0.4600, RMSE: 0.5925, R²: 0.3177, MAPE: 24.72%
2025-06-07 21:47:42,356 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 21:47:42,356 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5011
2025-06-07 21:47:42,357 - train_models - INFO -   NoOfMan_lag_1: 0.1457
2025-06-07 21:47:42,357 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0763
2025-06-07 21:47:42,357 - train_models - INFO -   Quantity_lag_1: 0.0576
2025-06-07 21:47:42,358 - train_models - INFO -   NoOfMan_lag_7: 0.0496
2025-06-07 21:47:42,358 - train_models - INFO -   NoOfMan_lag_28: 0.0466
2025-06-07 21:47:42,358 - train_models - INFO -   DayOfMonth: 0.0435
2025-06-07 21:47:42,359 - train_models - INFO -   DayOfWeek_feat_4: 0.0151
2025-06-07 21:47:42,359 - train_models - INFO -   DayOfWeek_feat_0: 0.0066
2025-06-07 21:47:42,359 - train_models - INFO -   DayOfWeek_feat_1: 0.0064
2025-06-07 21:47:42,359 - train_models - INFO - Cross-validation details for 202:
2025-06-07 21:47:42,360 - train_models - INFO -   Fold 1: MAE=0.3287, RMSE=0.4650, R²=0.2419, MAPE=20.28%
2025-06-07 21:47:42,360 - train_models - INFO -   Fold 2: MAE=0.3780, RMSE=0.4837, R²=0.4610, MAPE=23.53%
2025-06-07 21:47:42,360 - train_models - INFO -   Fold 3: MAE=0.5030, RMSE=0.6619, R²=0.3181, MAPE=29.78%
2025-06-07 21:47:42,361 - train_models - INFO -   Fold 4: MAE=0.5227, RMSE=0.6458, R²=0.1512, MAPE=25.84%
2025-06-07 21:47:42,361 - train_models - INFO -   Fold 5: MAE=0.5676, RMSE=0.7062, R²=0.4161, MAPE=24.19%
2025-06-07 21:47:42,361 - train_models - INFO - Building model for WorkType: 203
2025-06-07 21:47:42,371 - train_models - INFO - Available features for 203: 8 numeric, 2 categorical
2025-06-07 21:47:42,371 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 21:47:42,371 - train_models - INFO - Total available features: 10
2025-06-07 21:47:42,371 - train_models - INFO - Numeric features: 8
2025-06-07 21:47:42,372 - train_models - INFO - Categorical features: 2
2025-06-07 21:47:42,372 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:48:06,470 - train_models - INFO - Model for 203 - MAE: 0.6611, RMSE: 0.8715, R²: 0.3833, MAPE: 13.81%
2025-06-07 21:48:06,470 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 21:48:06,470 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4367
2025-06-07 21:48:06,471 - train_models - INFO -   NoOfMan_lag_1: 0.1931
2025-06-07 21:48:06,471 - train_models - INFO -   Quantity_lag_1: 0.0609
2025-06-07 21:48:06,471 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0609
2025-06-07 21:48:06,472 - train_models - INFO -   NoOfMan_lag_7: 0.0582
2025-06-07 21:48:06,472 - train_models - INFO -   NoOfMan_lag_28: 0.0493
2025-06-07 21:48:06,472 - train_models - INFO -   DayOfMonth: 0.0456
2025-06-07 21:48:06,472 - train_models - INFO -   DayOfWeek_feat_4: 0.0141
2025-06-07 21:48:06,473 - train_models - INFO -   DayOfWeek_feat_0: 0.0141
2025-06-07 21:48:06,473 - train_models - INFO -   DayOfWeek_feat_1: 0.0088
2025-06-07 21:48:06,473 - train_models - INFO - Cross-validation details for 203:
2025-06-07 21:48:06,474 - train_models - INFO -   Fold 1: MAE=0.6105, RMSE=0.8202, R²=0.4701, MAPE=11.99%
2025-06-07 21:48:06,474 - train_models - INFO -   Fold 2: MAE=0.6597, RMSE=0.8928, R²=0.4193, MAPE=13.14%
2025-06-07 21:48:06,474 - train_models - INFO -   Fold 3: MAE=0.7223, RMSE=0.9505, R²=0.3191, MAPE=14.04%
2025-06-07 21:48:06,474 - train_models - INFO -   Fold 4: MAE=0.6740, RMSE=0.8715, R²=0.3834, MAPE=14.88%
2025-06-07 21:48:06,475 - train_models - INFO -   Fold 5: MAE=0.6388, RMSE=0.8226, R²=0.3249, MAPE=15.03%
2025-06-07 21:48:06,475 - train_models - INFO - Building model for WorkType: 206
2025-06-07 21:48:06,485 - train_models - INFO - Available features for 206: 8 numeric, 2 categorical
2025-06-07 21:48:06,486 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 21:48:06,486 - train_models - INFO - Total available features: 10
2025-06-07 21:48:06,486 - train_models - INFO - Numeric features: 8
2025-06-07 21:48:06,486 - train_models - INFO - Categorical features: 2
2025-06-07 21:48:06,487 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:48:37,061 - train_models - INFO - Model for 206 - MAE: 2.1424, RMSE: 3.1284, R²: 0.8551, MAPE: 12.87%
2025-06-07 21:48:37,062 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 21:48:37,062 - train_models - INFO -   DayOfWeek_feat_6: 0.3786
2025-06-07 21:48:37,062 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3139
2025-06-07 21:48:37,063 - train_models - INFO -   DayOfWeek_feat_4: 0.1126
2025-06-07 21:48:37,063 - train_models - INFO -   NoOfMan_lag_1: 0.0631
2025-06-07 21:48:37,063 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0216
2025-06-07 21:48:37,064 - train_models - INFO -   DayOfWeek_feat_5: 0.0169
2025-06-07 21:48:37,064 - train_models - INFO -   Quantity_lag_1: 0.0163
2025-06-07 21:48:37,064 - train_models - INFO -   IsWeekend_feat: 0.0160
2025-06-07 21:48:37,065 - train_models - INFO -   NoOfMan_lag_28: 0.0145
2025-06-07 21:48:37,065 - train_models - INFO -   NoOfMan_lag_7: 0.0143
2025-06-07 21:48:37,065 - train_models - INFO - Cross-validation details for 206:
2025-06-07 21:48:37,065 - train_models - INFO -   Fold 1: MAE=2.2645, RMSE=3.1139, R²=0.8681, MAPE=13.42%
2025-06-07 21:48:37,066 - train_models - INFO -   Fold 2: MAE=2.1686, RMSE=3.1018, R²=0.8636, MAPE=11.97%
2025-06-07 21:48:37,066 - train_models - INFO -   Fold 3: MAE=2.3301, RMSE=3.7017, R²=0.7946, MAPE=15.22%
2025-06-07 21:48:37,066 - train_models - INFO -   Fold 4: MAE=1.7899, RMSE=2.6227, R²=0.8702, MAPE=11.18%
2025-06-07 21:48:37,067 - train_models - INFO -   Fold 5: MAE=2.1590, RMSE=3.1016, R²=0.8788, MAPE=12.54%
2025-06-07 21:48:37,067 - train_models - INFO - Building model for WorkType: 209
2025-06-07 21:48:37,077 - train_models - INFO - Available features for 209: 8 numeric, 2 categorical
2025-06-07 21:48:37,078 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 21:48:37,078 - train_models - INFO - Total available features: 10
2025-06-07 21:48:37,078 - train_models - INFO - Numeric features: 8
2025-06-07 21:48:37,078 - train_models - INFO - Categorical features: 2
2025-06-07 21:48:37,079 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:49:01,411 - train_models - INFO - Model for 209 - MAE: 1.9863, RMSE: 2.7369, R²: 0.5725, MAPE: 27.16%
2025-06-07 21:49:01,411 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 21:49:01,412 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5196
2025-06-07 21:49:01,412 - train_models - INFO -   NoOfMan_lag_1: 0.0645
2025-06-07 21:49:01,412 - train_models - INFO -   Quantity_lag_1: 0.0603
2025-06-07 21:49:01,413 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0506
2025-06-07 21:49:01,413 - train_models - INFO -   DayOfWeek_feat_1: 0.0498
2025-06-07 21:49:01,413 - train_models - INFO -   NoOfMan_lag_7: 0.0468
2025-06-07 21:49:01,414 - train_models - INFO -   Month_feat_12: 0.0447
2025-06-07 21:49:01,414 - train_models - INFO -   NoOfMan_lag_28: 0.0423
2025-06-07 21:49:01,414 - train_models - INFO -   DayOfMonth: 0.0363
2025-06-07 21:49:01,414 - train_models - INFO -   DayOfWeek_feat_0: 0.0214
2025-06-07 21:49:01,415 - train_models - INFO - Cross-validation details for 209:
2025-06-07 21:49:01,415 - train_models - INFO -   Fold 1: MAE=1.9265, RMSE=2.6926, R²=0.5154, MAPE=25.81%
2025-06-07 21:49:01,415 - train_models - INFO -   Fold 2: MAE=2.1630, RMSE=3.0092, R²=0.5331, MAPE=30.77%
2025-06-07 21:49:01,416 - train_models - INFO -   Fold 3: MAE=1.7150, RMSE=2.2360, R²=0.6078, MAPE=25.14%
2025-06-07 21:49:01,416 - train_models - INFO -   Fold 4: MAE=1.9825, RMSE=2.7019, R²=0.6280, MAPE=26.68%
2025-06-07 21:49:01,416 - train_models - INFO -   Fold 5: MAE=2.1444, RMSE=3.0449, R²=0.5782, MAPE=27.41%
2025-06-07 21:49:01,417 - train_models - INFO - Building model for WorkType: 210
2025-06-07 21:49:01,426 - train_models - INFO - Available features for 210: 8 numeric, 2 categorical
2025-06-07 21:49:01,427 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 21:49:01,427 - train_models - INFO - Total available features: 10
2025-06-07 21:49:01,427 - train_models - INFO - Numeric features: 8
2025-06-07 21:49:01,427 - train_models - INFO - Categorical features: 2
2025-06-07 21:49:01,428 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:49:26,753 - train_models - INFO - Model for 210 - MAE: 1.5165, RMSE: 2.0876, R²: 0.6535, MAPE: 31.35%
2025-06-07 21:49:26,754 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 21:49:26,754 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5064
2025-06-07 21:49:26,755 - train_models - INFO -   DayOfWeek_feat_1: 0.0685
2025-06-07 21:49:26,755 - train_models - INFO -   DayOfWeek_feat_6: 0.0659
2025-06-07 21:49:26,755 - train_models - INFO -   DayOfWeek_feat_0: 0.0498
2025-06-07 21:49:26,756 - train_models - INFO -   NoOfMan_lag_1: 0.0479
2025-06-07 21:49:26,756 - train_models - INFO -   NoOfMan_lag_7: 0.0463
2025-06-07 21:49:26,756 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0448
2025-06-07 21:49:26,756 - train_models - INFO -   Quantity_lag_1: 0.0407
2025-06-07 21:49:26,757 - train_models - INFO -   NoOfMan_lag_28: 0.0319
2025-06-07 21:49:26,757 - train_models - INFO -   DayOfMonth: 0.0310
2025-06-07 21:49:26,757 - train_models - INFO - Cross-validation details for 210:
2025-06-07 21:49:26,758 - train_models - INFO -   Fold 1: MAE=1.2178, RMSE=1.6236, R²=0.7636, MAPE=21.28%
2025-06-07 21:49:26,758 - train_models - INFO -   Fold 2: MAE=1.4134, RMSE=1.9740, R²=0.6430, MAPE=22.26%
2025-06-07 21:49:26,758 - train_models - INFO -   Fold 3: MAE=1.4021, RMSE=1.8679, R²=0.6652, MAPE=19.45%
2025-06-07 21:49:26,758 - train_models - INFO -   Fold 4: MAE=1.6867, RMSE=2.2924, R²=0.5976, MAPE=47.08%
2025-06-07 21:49:26,759 - train_models - INFO -   Fold 5: MAE=1.8624, RMSE=2.6802, R²=0.5980, MAPE=46.67%
2025-06-07 21:49:26,759 - train_models - INFO - Building model for WorkType: 211
2025-06-07 21:49:26,769 - train_models - INFO - Available features for 211: 8 numeric, 2 categorical
2025-06-07 21:49:26,770 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 21:49:26,770 - train_models - INFO - Total available features: 10
2025-06-07 21:49:26,770 - train_models - INFO - Numeric features: 8
2025-06-07 21:49:26,770 - train_models - INFO - Categorical features: 2
2025-06-07 21:49:26,771 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:49:54,394 - train_models - INFO - Model for 211 - MAE: 1.5687, RMSE: 2.1736, R²: 0.5880, MAPE: 24.98%
2025-06-07 21:49:54,394 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 21:49:54,395 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4462
2025-06-07 21:49:54,395 - train_models - INFO -   DayOfWeek_feat_6: 0.1853
2025-06-07 21:49:54,395 - train_models - INFO -   NoOfMan_lag_1: 0.0958
2025-06-07 21:49:54,396 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0454
2025-06-07 21:49:54,396 - train_models - INFO -   NoOfMan_lag_7: 0.0428
2025-06-07 21:49:54,396 - train_models - INFO -   Quantity_lag_1: 0.0412
2025-06-07 21:49:54,397 - train_models - INFO -   NoOfMan_lag_28: 0.0379
2025-06-07 21:49:54,397 - train_models - INFO -   DayOfMonth: 0.0304
2025-06-07 21:49:54,397 - train_models - INFO -   DayOfWeek_feat_4: 0.0097
2025-06-07 21:49:54,398 - train_models - INFO -   DayOfWeek_feat_0: 0.0097
2025-06-07 21:49:54,398 - train_models - INFO - Cross-validation details for 211:
2025-06-07 21:49:54,398 - train_models - INFO -   Fold 1: MAE=2.1392, RMSE=3.2005, R²=0.2875, MAPE=38.54%
2025-06-07 21:49:54,398 - train_models - INFO -   Fold 2: MAE=1.5688, RMSE=2.0953, R²=0.5900, MAPE=22.36%
2025-06-07 21:49:54,399 - train_models - INFO -   Fold 3: MAE=1.3789, RMSE=1.8172, R²=0.7133, MAPE=16.61%
2025-06-07 21:49:54,399 - train_models - INFO -   Fold 4: MAE=1.4078, RMSE=1.9455, R²=0.6834, MAPE=23.49%
2025-06-07 21:49:54,399 - train_models - INFO -   Fold 5: MAE=1.3488, RMSE=1.8098, R²=0.6656, MAPE=23.88%
2025-06-07 21:49:54,399 - train_models - INFO - Building model for WorkType: 213
2025-06-07 21:49:54,412 - train_models - INFO - Available features for 213: 8 numeric, 2 categorical
2025-06-07 21:49:54,412 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 21:49:54,413 - train_models - INFO - Total available features: 10
2025-06-07 21:49:54,413 - train_models - INFO - Numeric features: 8
2025-06-07 21:49:54,413 - train_models - INFO - Categorical features: 2
2025-06-07 21:49:54,413 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:50:19,836 - train_models - INFO - Model for 213 - MAE: 0.8560, RMSE: 1.1594, R²: 0.5582, MAPE: 36.48%
2025-06-07 21:50:19,837 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 21:50:19,837 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5516
2025-06-07 21:50:19,838 - train_models - INFO -   NoOfMan_lag_1: 0.1139
2025-06-07 21:50:19,838 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0625
2025-06-07 21:50:19,838 - train_models - INFO -   NoOfMan_lag_7: 0.0492
2025-06-07 21:50:19,838 - train_models - INFO -   Quantity_lag_1: 0.0429
2025-06-07 21:50:19,839 - train_models - INFO -   NoOfMan_lag_28: 0.0399
2025-06-07 21:50:19,839 - train_models - INFO -   DayOfWeek_feat_1: 0.0281
2025-06-07 21:50:19,840 - train_models - INFO -   DayOfMonth: 0.0263
2025-06-07 21:50:19,840 - train_models - INFO -   DayOfWeek_feat_4: 0.0253
2025-06-07 21:50:19,840 - train_models - INFO -   Month_feat_7: 0.0122
2025-06-07 21:50:19,840 - train_models - INFO - Cross-validation details for 213:
2025-06-07 21:50:19,841 - train_models - INFO -   Fold 1: MAE=0.9192, RMSE=1.2814, R²=0.6156, MAPE=27.12%
2025-06-07 21:50:19,841 - train_models - INFO -   Fold 2: MAE=0.8546, RMSE=1.1910, R²=0.5131, MAPE=45.16%
2025-06-07 21:50:19,841 - train_models - INFO -   Fold 3: MAE=0.7695, RMSE=1.1106, R²=0.5428, MAPE=38.81%
2025-06-07 21:50:19,842 - train_models - INFO -   Fold 4: MAE=0.8572, RMSE=1.0850, R²=0.5529, MAPE=37.22%
2025-06-07 21:50:19,842 - train_models - INFO -   Fold 5: MAE=0.8795, RMSE=1.1290, R²=0.5664, MAPE=34.09%
2025-06-07 21:50:19,842 - train_models - INFO - Building model for WorkType: 214
2025-06-07 21:50:19,854 - train_models - INFO - Available features for 214: 8 numeric, 2 categorical
2025-06-07 21:50:19,855 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 21:50:19,855 - train_models - INFO - Total available features: 10
2025-06-07 21:50:19,855 - train_models - INFO - Numeric features: 8
2025-06-07 21:50:19,855 - train_models - INFO - Categorical features: 2
2025-06-07 21:50:19,856 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:50:45,539 - train_models - INFO - Model for 214 - MAE: 1.0450, RMSE: 1.3825, R²: 0.5637, MAPE: 25.00%
2025-06-07 21:50:45,539 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 21:50:45,539 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5694
2025-06-07 21:50:45,540 - train_models - INFO -   NoOfMan_lag_1: 0.1193
2025-06-07 21:50:45,540 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0501
2025-06-07 21:50:45,540 - train_models - INFO -   Quantity_lag_1: 0.0415
2025-06-07 21:50:45,541 - train_models - INFO -   NoOfMan_lag_7: 0.0409
2025-06-07 21:50:45,541 - train_models - INFO -   NoOfMan_lag_28: 0.0333
2025-06-07 21:50:45,541 - train_models - INFO -   DayOfMonth: 0.0301
2025-06-07 21:50:45,542 - train_models - INFO -   DayOfWeek_feat_6: 0.0301
2025-06-07 21:50:45,542 - train_models - INFO -   DayOfWeek_feat_4: 0.0237
2025-06-07 21:50:45,542 - train_models - INFO -   DayOfWeek_feat_1: 0.0224
2025-06-07 21:50:45,542 - train_models - INFO - Cross-validation details for 214:
2025-06-07 21:50:45,543 - train_models - INFO -   Fold 1: MAE=0.9730, RMSE=1.2695, R²=0.4387, MAPE=27.05%
2025-06-07 21:50:45,543 - train_models - INFO -   Fold 2: MAE=0.9872, RMSE=1.2623, R²=0.5561, MAPE=24.66%
2025-06-07 21:50:45,543 - train_models - INFO -   Fold 3: MAE=0.8145, RMSE=1.0969, R²=0.6723, MAPE=22.81%
2025-06-07 21:50:45,544 - train_models - INFO -   Fold 4: MAE=0.9747, RMSE=1.3150, R²=0.5978, MAPE=21.00%
2025-06-07 21:50:45,544 - train_models - INFO -   Fold 5: MAE=1.4757, RMSE=1.9689, R²=0.5537, MAPE=29.49%
2025-06-07 21:50:45,544 - train_models - INFO - Building model for WorkType: 215
2025-06-07 21:50:45,557 - train_models - INFO - Available features for 215: 8 numeric, 2 categorical
2025-06-07 21:50:45,558 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 21:50:45,558 - train_models - INFO - Total available features: 10
2025-06-07 21:50:45,558 - train_models - INFO - Numeric features: 8
2025-06-07 21:50:45,558 - train_models - INFO - Categorical features: 2
2025-06-07 21:50:45,559 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:51:15,270 - train_models - INFO - Model for 215 - MAE: 1.3383, RMSE: 1.9491, R²: 0.6597, MAPE: 30.14%
2025-06-07 21:51:15,270 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 21:51:15,271 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3765
2025-06-07 21:51:15,271 - train_models - INFO -   DayOfWeek_feat_6: 0.2536
2025-06-07 21:51:15,271 - train_models - INFO -   DayOfWeek_feat_0: 0.0724
2025-06-07 21:51:15,271 - train_models - INFO -   Quantity_lag_1: 0.0535
2025-06-07 21:51:15,272 - train_models - INFO -   NoOfMan_lag_1: 0.0510
2025-06-07 21:51:15,272 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0436
2025-06-07 21:51:15,272 - train_models - INFO -   NoOfMan_lag_7: 0.0373
2025-06-07 21:51:15,272 - train_models - INFO -   DayOfMonth: 0.0355
2025-06-07 21:51:15,273 - train_models - INFO -   NoOfMan_lag_28: 0.0280
2025-06-07 21:51:15,273 - train_models - INFO -   Month_feat_11: 0.0071
2025-06-07 21:51:15,273 - train_models - INFO - Cross-validation details for 215:
2025-06-07 21:51:15,274 - train_models - INFO -   Fold 1: MAE=1.4550, RMSE=2.2692, R²=0.5720, MAPE=41.48%
2025-06-07 21:51:15,274 - train_models - INFO -   Fold 2: MAE=1.2315, RMSE=1.7310, R²=0.7422, MAPE=27.30%
2025-06-07 21:51:15,274 - train_models - INFO -   Fold 3: MAE=1.3788, RMSE=1.9423, R²=0.6650, MAPE=25.77%
2025-06-07 21:51:15,274 - train_models - INFO -   Fold 4: MAE=1.2478, RMSE=1.7509, R²=0.6826, MAPE=28.69%
2025-06-07 21:51:15,275 - train_models - INFO -   Fold 5: MAE=1.3782, RMSE=2.0523, R²=0.6368, MAPE=27.45%
2025-06-07 21:51:15,275 - train_models - INFO - Building model for WorkType: 217
2025-06-07 21:51:15,285 - train_models - INFO - Available features for 217: 8 numeric, 2 categorical
2025-06-07 21:51:15,286 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 21:51:15,286 - train_models - INFO - Total available features: 10
2025-06-07 21:51:15,286 - train_models - INFO - Numeric features: 8
2025-06-07 21:51:15,287 - train_models - INFO - Categorical features: 2
2025-06-07 21:51:15,287 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:51:38,764 - train_models - INFO - Model for 217 - MAE: 0.9066, RMSE: 1.2062, R²: 0.6090, MAPE: 38.16%
2025-06-07 21:51:38,764 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 21:51:38,764 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6095
2025-06-07 21:51:38,765 - train_models - INFO -   NoOfMan_lag_1: 0.1785
2025-06-07 21:51:38,765 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0510
2025-06-07 21:51:38,765 - train_models - INFO -   NoOfMan_lag_7: 0.0389
2025-06-07 21:51:38,766 - train_models - INFO -   Quantity_lag_1: 0.0321
2025-06-07 21:51:38,766 - train_models - INFO -   NoOfMan_lag_28: 0.0271
2025-06-07 21:51:38,766 - train_models - INFO -   DayOfMonth: 0.0217
2025-06-07 21:51:38,767 - train_models - INFO -   DayOfWeek_feat_4: 0.0050
2025-06-07 21:51:38,767 - train_models - INFO -   DayOfWeek_feat_0: 0.0047
2025-06-07 21:51:38,767 - train_models - INFO -   Month_feat_1: 0.0046
2025-06-07 21:51:38,768 - train_models - INFO - Cross-validation details for 217:
2025-06-07 21:51:38,768 - train_models - INFO -   Fold 1: MAE=0.9587, RMSE=1.1941, R²=0.5038, MAPE=43.78%
2025-06-07 21:51:38,768 - train_models - INFO -   Fold 2: MAE=0.8029, RMSE=1.0915, R²=0.6374, MAPE=38.15%
2025-06-07 21:51:38,768 - train_models - INFO -   Fold 3: MAE=0.8325, RMSE=1.1305, R²=0.6965, MAPE=32.01%
2025-06-07 21:51:38,769 - train_models - INFO -   Fold 4: MAE=0.9247, RMSE=1.2103, R²=0.6862, MAPE=35.47%
2025-06-07 21:51:38,769 - train_models - INFO -   Fold 5: MAE=1.0142, RMSE=1.4048, R²=0.5211, MAPE=41.41%
2025-06-07 21:51:38,770 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 21:51:39,967 - train_models - ERROR - Error saving models: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'
2025-06-07 21:51:40,269 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 554, in save_models
    performance_df.to_excel(performance_file, index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\amila.g\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:/forlogssystems/Models\\model_performance_summary.xlsx'

2025-06-07 21:51:40,275 - train_models - INFO - Model training completed successfully
2025-06-07 21:53:30,228 - train_models - INFO - Starting the model training process
2025-06-07 21:53:30,228 - train_models - INFO - Feature groups enabled: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:53:30,228 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 21:53:30,233 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 21:53:30,625 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 21:53:31,772 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 21:53:31,857 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 21:53:31,901 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 21:53:31,902 - train_models - INFO - Converting Date column to datetime format
2025-06-07 21:53:31,923 - train_models - INFO - Engineering features...
2025-06-07 21:53:32,664 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 21:53:32,664 - train_models - INFO - Using essential lags: [1, 7, 28]
2025-06-07 21:53:32,664 - train_models - INFO - Using essential windows: [7, 30]
2025-06-07 21:53:32,836 - utils.feature_engineering - INFO - Created features using config: LAG_FEATURES=True, PRODUCTIVITY_FEATURES=True
2025-06-07 21:53:32,837 - utils.feature_engineering - INFO - Final shape: (15326, 16)
2025-06-07 21:53:32,845 - train_models - INFO - Found 10 unique work types
2025-06-07 21:53:32,845 - train_models - INFO - Building models for 10 work types
2025-06-07 21:53:32,846 - train_models - INFO - Using feature groups: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:53:32,847 - train_models - INFO - Config-driven features: 12 numeric, 2 categorical
2025-06-07 21:53:32,847 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'Workers_per_Hour', 'Quantity_per_Hour', 'Workload_Density', 'KPI_Performance']
2025-06-07 21:53:32,848 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-07 21:53:32,848 - train_models - INFO - Building model for WorkType: 202
2025-06-07 21:53:32,873 - train_models - INFO - Available features for 202: 8 numeric, 2 categorical
2025-06-07 21:53:32,874 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 21:53:32,874 - train_models - INFO - Total available features: 10
2025-06-07 21:53:32,875 - train_models - INFO - Numeric features: 8
2025-06-07 21:53:32,875 - train_models - INFO - Categorical features: 2
2025-06-07 21:53:32,876 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:53:53,126 - train_models - INFO - Model for 202 - MAE: 0.4600, RMSE: 0.5925, R²: 0.3177, MAPE: 24.72%
2025-06-07 21:53:53,126 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 21:53:53,127 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5011
2025-06-07 21:53:53,127 - train_models - INFO -   NoOfMan_lag_1: 0.1457
2025-06-07 21:53:53,127 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0763
2025-06-07 21:53:53,128 - train_models - INFO -   Quantity_lag_1: 0.0576
2025-06-07 21:53:53,128 - train_models - INFO -   NoOfMan_lag_7: 0.0496
2025-06-07 21:53:53,128 - train_models - INFO -   NoOfMan_lag_28: 0.0466
2025-06-07 21:53:53,128 - train_models - INFO -   DayOfMonth: 0.0435
2025-06-07 21:53:53,129 - train_models - INFO -   DayOfWeek_feat_4: 0.0151
2025-06-07 21:53:53,129 - train_models - INFO -   DayOfWeek_feat_0: 0.0066
2025-06-07 21:53:53,129 - train_models - INFO -   DayOfWeek_feat_1: 0.0064
2025-06-07 21:53:53,130 - train_models - INFO - Cross-validation details for 202:
2025-06-07 21:53:53,130 - train_models - INFO -   Fold 1: MAE=0.3287, RMSE=0.4650, R²=0.2419, MAPE=20.28%
2025-06-07 21:53:53,130 - train_models - INFO -   Fold 2: MAE=0.3780, RMSE=0.4837, R²=0.4610, MAPE=23.53%
2025-06-07 21:53:53,131 - train_models - INFO -   Fold 3: MAE=0.5030, RMSE=0.6619, R²=0.3181, MAPE=29.78%
2025-06-07 21:53:53,131 - train_models - INFO -   Fold 4: MAE=0.5227, RMSE=0.6458, R²=0.1512, MAPE=25.84%
2025-06-07 21:53:53,131 - train_models - INFO -   Fold 5: MAE=0.5676, RMSE=0.7062, R²=0.4161, MAPE=24.19%
2025-06-07 21:53:53,131 - train_models - INFO - Building model for WorkType: 203
2025-06-07 21:53:53,142 - train_models - INFO - Available features for 203: 8 numeric, 2 categorical
2025-06-07 21:53:53,142 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 21:53:53,142 - train_models - INFO - Total available features: 10
2025-06-07 21:53:53,142 - train_models - INFO - Numeric features: 8
2025-06-07 21:53:53,143 - train_models - INFO - Categorical features: 2
2025-06-07 21:53:53,143 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:54:17,027 - train_models - INFO - Model for 203 - MAE: 0.6611, RMSE: 0.8715, R²: 0.3833, MAPE: 13.81%
2025-06-07 21:54:17,028 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 21:54:17,028 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4367
2025-06-07 21:54:17,028 - train_models - INFO -   NoOfMan_lag_1: 0.1931
2025-06-07 21:54:17,029 - train_models - INFO -   Quantity_lag_1: 0.0609
2025-06-07 21:54:17,029 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0609
2025-06-07 21:54:17,029 - train_models - INFO -   NoOfMan_lag_7: 0.0582
2025-06-07 21:54:17,030 - train_models - INFO -   NoOfMan_lag_28: 0.0493
2025-06-07 21:54:17,030 - train_models - INFO -   DayOfMonth: 0.0456
2025-06-07 21:54:17,030 - train_models - INFO -   DayOfWeek_feat_4: 0.0141
2025-06-07 21:54:17,031 - train_models - INFO -   DayOfWeek_feat_0: 0.0141
2025-06-07 21:54:17,031 - train_models - INFO -   DayOfWeek_feat_1: 0.0088
2025-06-07 21:54:17,031 - train_models - INFO - Cross-validation details for 203:
2025-06-07 21:54:17,032 - train_models - INFO -   Fold 1: MAE=0.6105, RMSE=0.8202, R²=0.4701, MAPE=11.99%
2025-06-07 21:54:17,032 - train_models - INFO -   Fold 2: MAE=0.6597, RMSE=0.8928, R²=0.4193, MAPE=13.14%
2025-06-07 21:54:17,032 - train_models - INFO -   Fold 3: MAE=0.7223, RMSE=0.9505, R²=0.3191, MAPE=14.04%
2025-06-07 21:54:17,032 - train_models - INFO -   Fold 4: MAE=0.6740, RMSE=0.8715, R²=0.3834, MAPE=14.88%
2025-06-07 21:54:17,033 - train_models - INFO -   Fold 5: MAE=0.6388, RMSE=0.8226, R²=0.3249, MAPE=15.03%
2025-06-07 21:54:17,033 - train_models - INFO - Building model for WorkType: 206
2025-06-07 21:54:17,043 - train_models - INFO - Available features for 206: 8 numeric, 2 categorical
2025-06-07 21:54:17,043 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 21:54:17,043 - train_models - INFO - Total available features: 10
2025-06-07 21:54:17,043 - train_models - INFO - Numeric features: 8
2025-06-07 21:54:17,044 - train_models - INFO - Categorical features: 2
2025-06-07 21:54:17,044 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:54:45,662 - train_models - INFO - Model for 206 - MAE: 2.1424, RMSE: 3.1284, R²: 0.8551, MAPE: 12.87%
2025-06-07 21:54:45,662 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 21:54:45,662 - train_models - INFO -   DayOfWeek_feat_6: 0.3786
2025-06-07 21:54:45,663 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3139
2025-06-07 21:54:45,663 - train_models - INFO -   DayOfWeek_feat_4: 0.1126
2025-06-07 21:54:45,663 - train_models - INFO -   NoOfMan_lag_1: 0.0631
2025-06-07 21:54:45,663 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0216
2025-06-07 21:54:45,664 - train_models - INFO -   DayOfWeek_feat_5: 0.0169
2025-06-07 21:54:45,664 - train_models - INFO -   Quantity_lag_1: 0.0163
2025-06-07 21:54:45,664 - train_models - INFO -   IsWeekend_feat: 0.0160
2025-06-07 21:54:45,665 - train_models - INFO -   NoOfMan_lag_28: 0.0145
2025-06-07 21:54:45,665 - train_models - INFO -   NoOfMan_lag_7: 0.0143
2025-06-07 21:54:45,665 - train_models - INFO - Cross-validation details for 206:
2025-06-07 21:54:45,666 - train_models - INFO -   Fold 1: MAE=2.2645, RMSE=3.1139, R²=0.8681, MAPE=13.42%
2025-06-07 21:54:45,666 - train_models - INFO -   Fold 2: MAE=2.1686, RMSE=3.1018, R²=0.8636, MAPE=11.97%
2025-06-07 21:54:45,666 - train_models - INFO -   Fold 3: MAE=2.3301, RMSE=3.7017, R²=0.7946, MAPE=15.22%
2025-06-07 21:54:45,666 - train_models - INFO -   Fold 4: MAE=1.7899, RMSE=2.6227, R²=0.8702, MAPE=11.18%
2025-06-07 21:54:45,667 - train_models - INFO -   Fold 5: MAE=2.1590, RMSE=3.1016, R²=0.8788, MAPE=12.54%
2025-06-07 21:54:45,667 - train_models - INFO - Building model for WorkType: 209
2025-06-07 21:54:45,676 - train_models - INFO - Available features for 209: 8 numeric, 2 categorical
2025-06-07 21:54:45,677 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 21:54:45,677 - train_models - INFO - Total available features: 10
2025-06-07 21:54:45,677 - train_models - INFO - Numeric features: 8
2025-06-07 21:54:45,677 - train_models - INFO - Categorical features: 2
2025-06-07 21:54:45,677 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:55:10,242 - train_models - INFO - Model for 209 - MAE: 1.9863, RMSE: 2.7369, R²: 0.5725, MAPE: 27.16%
2025-06-07 21:55:10,242 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 21:55:10,242 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5196
2025-06-07 21:55:10,243 - train_models - INFO -   NoOfMan_lag_1: 0.0645
2025-06-07 21:55:10,243 - train_models - INFO -   Quantity_lag_1: 0.0603
2025-06-07 21:55:10,243 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0506
2025-06-07 21:55:10,244 - train_models - INFO -   DayOfWeek_feat_1: 0.0498
2025-06-07 21:55:10,244 - train_models - INFO -   NoOfMan_lag_7: 0.0468
2025-06-07 21:55:10,244 - train_models - INFO -   Month_feat_12: 0.0447
2025-06-07 21:55:10,244 - train_models - INFO -   NoOfMan_lag_28: 0.0423
2025-06-07 21:55:10,245 - train_models - INFO -   DayOfMonth: 0.0363
2025-06-07 21:55:10,245 - train_models - INFO -   DayOfWeek_feat_0: 0.0214
2025-06-07 21:55:10,245 - train_models - INFO - Cross-validation details for 209:
2025-06-07 21:55:10,246 - train_models - INFO -   Fold 1: MAE=1.9265, RMSE=2.6926, R²=0.5154, MAPE=25.81%
2025-06-07 21:55:10,246 - train_models - INFO -   Fold 2: MAE=2.1630, RMSE=3.0092, R²=0.5331, MAPE=30.77%
2025-06-07 21:55:10,246 - train_models - INFO -   Fold 3: MAE=1.7150, RMSE=2.2360, R²=0.6078, MAPE=25.14%
2025-06-07 21:55:10,247 - train_models - INFO -   Fold 4: MAE=1.9825, RMSE=2.7019, R²=0.6280, MAPE=26.68%
2025-06-07 21:55:10,247 - train_models - INFO -   Fold 5: MAE=2.1444, RMSE=3.0449, R²=0.5782, MAPE=27.41%
2025-06-07 21:55:10,247 - train_models - INFO - Building model for WorkType: 210
2025-06-07 21:55:10,257 - train_models - INFO - Available features for 210: 8 numeric, 2 categorical
2025-06-07 21:55:10,257 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 21:55:10,257 - train_models - INFO - Total available features: 10
2025-06-07 21:55:10,257 - train_models - INFO - Numeric features: 8
2025-06-07 21:55:10,258 - train_models - INFO - Categorical features: 2
2025-06-07 21:55:10,258 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:55:35,422 - train_models - INFO - Model for 210 - MAE: 1.5165, RMSE: 2.0876, R²: 0.6535, MAPE: 31.35%
2025-06-07 21:55:35,423 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 21:55:35,423 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5064
2025-06-07 21:55:35,424 - train_models - INFO -   DayOfWeek_feat_1: 0.0685
2025-06-07 21:55:35,424 - train_models - INFO -   DayOfWeek_feat_6: 0.0659
2025-06-07 21:55:35,424 - train_models - INFO -   DayOfWeek_feat_0: 0.0498
2025-06-07 21:55:35,425 - train_models - INFO -   NoOfMan_lag_1: 0.0479
2025-06-07 21:55:35,425 - train_models - INFO -   NoOfMan_lag_7: 0.0463
2025-06-07 21:55:35,425 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0448
2025-06-07 21:55:35,426 - train_models - INFO -   Quantity_lag_1: 0.0407
2025-06-07 21:55:35,426 - train_models - INFO -   NoOfMan_lag_28: 0.0319
2025-06-07 21:55:35,426 - train_models - INFO -   DayOfMonth: 0.0310
2025-06-07 21:55:35,427 - train_models - INFO - Cross-validation details for 210:
2025-06-07 21:55:35,427 - train_models - INFO -   Fold 1: MAE=1.2178, RMSE=1.6236, R²=0.7636, MAPE=21.28%
2025-06-07 21:55:35,427 - train_models - INFO -   Fold 2: MAE=1.4134, RMSE=1.9740, R²=0.6430, MAPE=22.26%
2025-06-07 21:55:35,428 - train_models - INFO -   Fold 3: MAE=1.4021, RMSE=1.8679, R²=0.6652, MAPE=19.45%
2025-06-07 21:55:35,428 - train_models - INFO -   Fold 4: MAE=1.6867, RMSE=2.2924, R²=0.5976, MAPE=47.08%
2025-06-07 21:55:35,428 - train_models - INFO -   Fold 5: MAE=1.8624, RMSE=2.6802, R²=0.5980, MAPE=46.67%
2025-06-07 21:55:35,429 - train_models - INFO - Building model for WorkType: 211
2025-06-07 21:55:35,440 - train_models - INFO - Available features for 211: 8 numeric, 2 categorical
2025-06-07 21:55:35,440 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 21:55:35,440 - train_models - INFO - Total available features: 10
2025-06-07 21:55:35,440 - train_models - INFO - Numeric features: 8
2025-06-07 21:55:35,441 - train_models - INFO - Categorical features: 2
2025-06-07 21:55:35,441 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:56:03,325 - train_models - INFO - Model for 211 - MAE: 1.5687, RMSE: 2.1736, R²: 0.5880, MAPE: 24.98%
2025-06-07 21:56:03,325 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 21:56:03,326 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4462
2025-06-07 21:56:03,326 - train_models - INFO -   DayOfWeek_feat_6: 0.1853
2025-06-07 21:56:03,326 - train_models - INFO -   NoOfMan_lag_1: 0.0958
2025-06-07 21:56:03,327 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0454
2025-06-07 21:56:03,327 - train_models - INFO -   NoOfMan_lag_7: 0.0428
2025-06-07 21:56:03,327 - train_models - INFO -   Quantity_lag_1: 0.0412
2025-06-07 21:56:03,327 - train_models - INFO -   NoOfMan_lag_28: 0.0379
2025-06-07 21:56:03,328 - train_models - INFO -   DayOfMonth: 0.0304
2025-06-07 21:56:03,328 - train_models - INFO -   DayOfWeek_feat_4: 0.0097
2025-06-07 21:56:03,328 - train_models - INFO -   DayOfWeek_feat_0: 0.0097
2025-06-07 21:56:03,329 - train_models - INFO - Cross-validation details for 211:
2025-06-07 21:56:03,329 - train_models - INFO -   Fold 1: MAE=2.1392, RMSE=3.2005, R²=0.2875, MAPE=38.54%
2025-06-07 21:56:03,329 - train_models - INFO -   Fold 2: MAE=1.5688, RMSE=2.0953, R²=0.5900, MAPE=22.36%
2025-06-07 21:56:03,330 - train_models - INFO -   Fold 3: MAE=1.3789, RMSE=1.8172, R²=0.7133, MAPE=16.61%
2025-06-07 21:56:03,330 - train_models - INFO -   Fold 4: MAE=1.4078, RMSE=1.9455, R²=0.6834, MAPE=23.49%
2025-06-07 21:56:03,330 - train_models - INFO -   Fold 5: MAE=1.3488, RMSE=1.8098, R²=0.6656, MAPE=23.88%
2025-06-07 21:56:03,330 - train_models - INFO - Building model for WorkType: 213
2025-06-07 21:56:03,340 - train_models - INFO - Available features for 213: 8 numeric, 2 categorical
2025-06-07 21:56:03,341 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 21:56:03,341 - train_models - INFO - Total available features: 10
2025-06-07 21:56:03,341 - train_models - INFO - Numeric features: 8
2025-06-07 21:56:03,342 - train_models - INFO - Categorical features: 2
2025-06-07 21:56:03,342 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:56:28,926 - train_models - INFO - Model for 213 - MAE: 0.8560, RMSE: 1.1594, R²: 0.5582, MAPE: 36.48%
2025-06-07 21:56:28,926 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 21:56:28,927 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5516
2025-06-07 21:56:28,927 - train_models - INFO -   NoOfMan_lag_1: 0.1139
2025-06-07 21:56:28,927 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0625
2025-06-07 21:56:28,928 - train_models - INFO -   NoOfMan_lag_7: 0.0492
2025-06-07 21:56:28,928 - train_models - INFO -   Quantity_lag_1: 0.0429
2025-06-07 21:56:28,928 - train_models - INFO -   NoOfMan_lag_28: 0.0399
2025-06-07 21:56:28,929 - train_models - INFO -   DayOfWeek_feat_1: 0.0281
2025-06-07 21:56:28,929 - train_models - INFO -   DayOfMonth: 0.0263
2025-06-07 21:56:28,929 - train_models - INFO -   DayOfWeek_feat_4: 0.0253
2025-06-07 21:56:28,929 - train_models - INFO -   Month_feat_7: 0.0122
2025-06-07 21:56:28,930 - train_models - INFO - Cross-validation details for 213:
2025-06-07 21:56:28,930 - train_models - INFO -   Fold 1: MAE=0.9192, RMSE=1.2814, R²=0.6156, MAPE=27.12%
2025-06-07 21:56:28,930 - train_models - INFO -   Fold 2: MAE=0.8546, RMSE=1.1910, R²=0.5131, MAPE=45.16%
2025-06-07 21:56:28,930 - train_models - INFO -   Fold 3: MAE=0.7695, RMSE=1.1106, R²=0.5428, MAPE=38.81%
2025-06-07 21:56:28,931 - train_models - INFO -   Fold 4: MAE=0.8572, RMSE=1.0850, R²=0.5529, MAPE=37.22%
2025-06-07 21:56:28,931 - train_models - INFO -   Fold 5: MAE=0.8795, RMSE=1.1290, R²=0.5664, MAPE=34.09%
2025-06-07 21:56:28,931 - train_models - INFO - Building model for WorkType: 214
2025-06-07 21:56:28,942 - train_models - INFO - Available features for 214: 8 numeric, 2 categorical
2025-06-07 21:56:28,943 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 21:56:28,943 - train_models - INFO - Total available features: 10
2025-06-07 21:56:28,943 - train_models - INFO - Numeric features: 8
2025-06-07 21:56:28,944 - train_models - INFO - Categorical features: 2
2025-06-07 21:56:28,944 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:56:54,539 - train_models - INFO - Model for 214 - MAE: 1.0450, RMSE: 1.3825, R²: 0.5637, MAPE: 25.00%
2025-06-07 21:56:54,540 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 21:56:54,540 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5694
2025-06-07 21:56:54,541 - train_models - INFO -   NoOfMan_lag_1: 0.1193
2025-06-07 21:56:54,541 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0501
2025-06-07 21:56:54,541 - train_models - INFO -   Quantity_lag_1: 0.0415
2025-06-07 21:56:54,542 - train_models - INFO -   NoOfMan_lag_7: 0.0409
2025-06-07 21:56:54,542 - train_models - INFO -   NoOfMan_lag_28: 0.0333
2025-06-07 21:56:54,542 - train_models - INFO -   DayOfMonth: 0.0301
2025-06-07 21:56:54,542 - train_models - INFO -   DayOfWeek_feat_6: 0.0301
2025-06-07 21:56:54,543 - train_models - INFO -   DayOfWeek_feat_4: 0.0237
2025-06-07 21:56:54,543 - train_models - INFO -   DayOfWeek_feat_1: 0.0224
2025-06-07 21:56:54,543 - train_models - INFO - Cross-validation details for 214:
2025-06-07 21:56:54,544 - train_models - INFO -   Fold 1: MAE=0.9730, RMSE=1.2695, R²=0.4387, MAPE=27.05%
2025-06-07 21:56:54,544 - train_models - INFO -   Fold 2: MAE=0.9872, RMSE=1.2623, R²=0.5561, MAPE=24.66%
2025-06-07 21:56:54,544 - train_models - INFO -   Fold 3: MAE=0.8145, RMSE=1.0969, R²=0.6723, MAPE=22.81%
2025-06-07 21:56:54,545 - train_models - INFO -   Fold 4: MAE=0.9747, RMSE=1.3150, R²=0.5978, MAPE=21.00%
2025-06-07 21:56:54,545 - train_models - INFO -   Fold 5: MAE=1.4757, RMSE=1.9689, R²=0.5537, MAPE=29.49%
2025-06-07 21:56:54,545 - train_models - INFO - Building model for WorkType: 215
2025-06-07 21:56:54,557 - train_models - INFO - Available features for 215: 8 numeric, 2 categorical
2025-06-07 21:56:54,557 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 21:56:54,558 - train_models - INFO - Total available features: 10
2025-06-07 21:56:54,558 - train_models - INFO - Numeric features: 8
2025-06-07 21:56:54,558 - train_models - INFO - Categorical features: 2
2025-06-07 21:56:54,558 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:57:24,388 - train_models - INFO - Model for 215 - MAE: 1.3383, RMSE: 1.9491, R²: 0.6597, MAPE: 30.14%
2025-06-07 21:57:24,389 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 21:57:24,389 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3765
2025-06-07 21:57:24,390 - train_models - INFO -   DayOfWeek_feat_6: 0.2536
2025-06-07 21:57:24,390 - train_models - INFO -   DayOfWeek_feat_0: 0.0724
2025-06-07 21:57:24,390 - train_models - INFO -   Quantity_lag_1: 0.0535
2025-06-07 21:57:24,391 - train_models - INFO -   NoOfMan_lag_1: 0.0510
2025-06-07 21:57:24,391 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0436
2025-06-07 21:57:24,391 - train_models - INFO -   NoOfMan_lag_7: 0.0373
2025-06-07 21:57:24,391 - train_models - INFO -   DayOfMonth: 0.0355
2025-06-07 21:57:24,392 - train_models - INFO -   NoOfMan_lag_28: 0.0280
2025-06-07 21:57:24,392 - train_models - INFO -   Month_feat_11: 0.0071
2025-06-07 21:57:24,392 - train_models - INFO - Cross-validation details for 215:
2025-06-07 21:57:24,393 - train_models - INFO -   Fold 1: MAE=1.4550, RMSE=2.2692, R²=0.5720, MAPE=41.48%
2025-06-07 21:57:24,393 - train_models - INFO -   Fold 2: MAE=1.2315, RMSE=1.7310, R²=0.7422, MAPE=27.30%
2025-06-07 21:57:24,393 - train_models - INFO -   Fold 3: MAE=1.3788, RMSE=1.9423, R²=0.6650, MAPE=25.77%
2025-06-07 21:57:24,393 - train_models - INFO -   Fold 4: MAE=1.2478, RMSE=1.7509, R²=0.6826, MAPE=28.69%
2025-06-07 21:57:24,394 - train_models - INFO -   Fold 5: MAE=1.3782, RMSE=2.0523, R²=0.6368, MAPE=27.45%
2025-06-07 21:57:24,394 - train_models - INFO - Building model for WorkType: 217
2025-06-07 21:57:24,404 - train_models - INFO - Available features for 217: 8 numeric, 2 categorical
2025-06-07 21:57:24,405 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 21:57:24,405 - train_models - INFO - Total available features: 10
2025-06-07 21:57:24,405 - train_models - INFO - Numeric features: 8
2025-06-07 21:57:24,406 - train_models - INFO - Categorical features: 2
2025-06-07 21:57:24,406 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:57:47,601 - train_models - INFO - Model for 217 - MAE: 0.9066, RMSE: 1.2062, R²: 0.6090, MAPE: 38.16%
2025-06-07 21:57:47,602 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 21:57:47,602 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6095
2025-06-07 21:57:47,602 - train_models - INFO -   NoOfMan_lag_1: 0.1785
2025-06-07 21:57:47,602 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0510
2025-06-07 21:57:47,603 - train_models - INFO -   NoOfMan_lag_7: 0.0389
2025-06-07 21:57:47,603 - train_models - INFO -   Quantity_lag_1: 0.0321
2025-06-07 21:57:47,603 - train_models - INFO -   NoOfMan_lag_28: 0.0271
2025-06-07 21:57:47,604 - train_models - INFO -   DayOfMonth: 0.0217
2025-06-07 21:57:47,604 - train_models - INFO -   DayOfWeek_feat_4: 0.0050
2025-06-07 21:57:47,604 - train_models - INFO -   DayOfWeek_feat_0: 0.0047
2025-06-07 21:57:47,605 - train_models - INFO -   Month_feat_1: 0.0046
2025-06-07 21:57:47,605 - train_models - INFO - Cross-validation details for 217:
2025-06-07 21:57:47,605 - train_models - INFO -   Fold 1: MAE=0.9587, RMSE=1.1941, R²=0.5038, MAPE=43.78%
2025-06-07 21:57:47,606 - train_models - INFO -   Fold 2: MAE=0.8029, RMSE=1.0915, R²=0.6374, MAPE=38.15%
2025-06-07 21:57:47,606 - train_models - INFO -   Fold 3: MAE=0.8325, RMSE=1.1305, R²=0.6965, MAPE=32.01%
2025-06-07 21:57:47,606 - train_models - INFO -   Fold 4: MAE=0.9247, RMSE=1.2103, R²=0.6862, MAPE=35.47%
2025-06-07 21:57:47,606 - train_models - INFO -   Fold 5: MAE=1.0142, RMSE=1.4048, R²=0.5211, MAPE=41.41%
2025-06-07 21:57:47,607 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 21:57:49,123 - train_models - ERROR - Error saving models: name 'FEATURE_TIERS' is not defined
2025-06-07 21:57:49,143 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 558, in save_models
    'feature_tiers': FEATURE_TIERS,
                     ^^^^^^^^^^^^^
NameError: name 'FEATURE_TIERS' is not defined. Did you mean: 'FEATURE_GROUPS'?

2025-06-07 21:57:49,147 - train_models - INFO - Model training completed successfully
2025-06-07 21:59:35,264 - train_models - INFO - Starting the model training process
2025-06-07 21:59:35,265 - train_models - INFO - Feature groups enabled: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:59:35,265 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 21:59:35,270 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 21:59:35,609 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 21:59:36,586 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 21:59:36,664 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 21:59:36,712 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 21:59:36,713 - train_models - INFO - Converting Date column to datetime format
2025-06-07 21:59:36,739 - train_models - INFO - Engineering features...
2025-06-07 21:59:37,271 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 21:59:37,272 - train_models - INFO - Using essential lags: [1, 7, 28]
2025-06-07 21:59:37,273 - train_models - INFO - Using essential windows: [7, 30]
2025-06-07 21:59:37,417 - utils.feature_engineering - INFO - Created features using config: LAG_FEATURES=True, PRODUCTIVITY_FEATURES=True
2025-06-07 21:59:37,417 - utils.feature_engineering - INFO - Final shape: (15326, 16)
2025-06-07 21:59:37,423 - train_models - INFO - Found 10 unique work types
2025-06-07 21:59:37,423 - train_models - INFO - Building models for 10 work types
2025-06-07 21:59:37,423 - train_models - INFO - Using feature groups: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES']
2025-06-07 21:59:37,424 - train_models - INFO - Config-driven features: 12 numeric, 2 categorical
2025-06-07 21:59:37,424 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'Workers_per_Hour', 'Quantity_per_Hour', 'Workload_Density', 'KPI_Performance']
2025-06-07 21:59:37,424 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-07 21:59:37,425 - train_models - INFO - Building model for WorkType: 202
2025-06-07 21:59:37,436 - train_models - INFO - Available features for 202: 8 numeric, 2 categorical
2025-06-07 21:59:37,436 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 21:59:37,436 - train_models - INFO - Total available features: 10
2025-06-07 21:59:37,437 - train_models - INFO - Numeric features: 8
2025-06-07 21:59:37,437 - train_models - INFO - Categorical features: 2
2025-06-07 21:59:37,437 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 21:59:59,118 - train_models - INFO - Model for 202 - MAE: 0.4600, RMSE: 0.5925, R²: 0.3177, MAPE: 24.72%
2025-06-07 21:59:59,118 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 21:59:59,119 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5011
2025-06-07 21:59:59,119 - train_models - INFO -   NoOfMan_lag_1: 0.1457
2025-06-07 21:59:59,119 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0763
2025-06-07 21:59:59,119 - train_models - INFO -   Quantity_lag_1: 0.0576
2025-06-07 21:59:59,120 - train_models - INFO -   NoOfMan_lag_7: 0.0496
2025-06-07 21:59:59,120 - train_models - INFO -   NoOfMan_lag_28: 0.0466
2025-06-07 21:59:59,120 - train_models - INFO -   DayOfMonth: 0.0435
2025-06-07 21:59:59,121 - train_models - INFO -   DayOfWeek_feat_4: 0.0151
2025-06-07 21:59:59,121 - train_models - INFO -   DayOfWeek_feat_0: 0.0066
2025-06-07 21:59:59,121 - train_models - INFO -   DayOfWeek_feat_1: 0.0064
2025-06-07 21:59:59,121 - train_models - INFO - Cross-validation details for 202:
2025-06-07 21:59:59,122 - train_models - INFO -   Fold 1: MAE=0.3287, RMSE=0.4650, R²=0.2419, MAPE=20.28%
2025-06-07 21:59:59,122 - train_models - INFO -   Fold 2: MAE=0.3780, RMSE=0.4837, R²=0.4610, MAPE=23.53%
2025-06-07 21:59:59,122 - train_models - INFO -   Fold 3: MAE=0.5030, RMSE=0.6619, R²=0.3181, MAPE=29.78%
2025-06-07 21:59:59,122 - train_models - INFO -   Fold 4: MAE=0.5227, RMSE=0.6458, R²=0.1512, MAPE=25.84%
2025-06-07 21:59:59,123 - train_models - INFO -   Fold 5: MAE=0.5676, RMSE=0.7062, R²=0.4161, MAPE=24.19%
2025-06-07 21:59:59,123 - train_models - INFO - Building model for WorkType: 203
2025-06-07 21:59:59,134 - train_models - INFO - Available features for 203: 8 numeric, 2 categorical
2025-06-07 21:59:59,135 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 21:59:59,135 - train_models - INFO - Total available features: 10
2025-06-07 21:59:59,135 - train_models - INFO - Numeric features: 8
2025-06-07 21:59:59,135 - train_models - INFO - Categorical features: 2
2025-06-07 21:59:59,135 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:00:25,331 - train_models - INFO - Model for 203 - MAE: 0.6611, RMSE: 0.8715, R²: 0.3833, MAPE: 13.81%
2025-06-07 22:00:25,332 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 22:00:25,332 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4367
2025-06-07 22:00:25,332 - train_models - INFO -   NoOfMan_lag_1: 0.1931
2025-06-07 22:00:25,332 - train_models - INFO -   Quantity_lag_1: 0.0609
2025-06-07 22:00:25,333 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0609
2025-06-07 22:00:25,333 - train_models - INFO -   NoOfMan_lag_7: 0.0582
2025-06-07 22:00:25,333 - train_models - INFO -   NoOfMan_lag_28: 0.0493
2025-06-07 22:00:25,334 - train_models - INFO -   DayOfMonth: 0.0456
2025-06-07 22:00:25,334 - train_models - INFO -   DayOfWeek_feat_4: 0.0141
2025-06-07 22:00:25,334 - train_models - INFO -   DayOfWeek_feat_0: 0.0141
2025-06-07 22:00:25,334 - train_models - INFO -   DayOfWeek_feat_1: 0.0088
2025-06-07 22:00:25,335 - train_models - INFO - Cross-validation details for 203:
2025-06-07 22:00:25,335 - train_models - INFO -   Fold 1: MAE=0.6105, RMSE=0.8202, R²=0.4701, MAPE=11.99%
2025-06-07 22:00:25,335 - train_models - INFO -   Fold 2: MAE=0.6597, RMSE=0.8928, R²=0.4193, MAPE=13.14%
2025-06-07 22:00:25,336 - train_models - INFO -   Fold 3: MAE=0.7223, RMSE=0.9505, R²=0.3191, MAPE=14.04%
2025-06-07 22:00:25,336 - train_models - INFO -   Fold 4: MAE=0.6740, RMSE=0.8715, R²=0.3834, MAPE=14.88%
2025-06-07 22:00:25,336 - train_models - INFO -   Fold 5: MAE=0.6388, RMSE=0.8226, R²=0.3249, MAPE=15.03%
2025-06-07 22:00:25,337 - train_models - INFO - Building model for WorkType: 206
2025-06-07 22:00:25,347 - train_models - INFO - Available features for 206: 8 numeric, 2 categorical
2025-06-07 22:00:25,347 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 22:00:25,348 - train_models - INFO - Total available features: 10
2025-06-07 22:00:25,348 - train_models - INFO - Numeric features: 8
2025-06-07 22:00:25,348 - train_models - INFO - Categorical features: 2
2025-06-07 22:00:25,349 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:00:56,014 - train_models - INFO - Model for 206 - MAE: 2.1424, RMSE: 3.1284, R²: 0.8551, MAPE: 12.87%
2025-06-07 22:00:56,015 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 22:00:56,015 - train_models - INFO -   DayOfWeek_feat_6: 0.3786
2025-06-07 22:00:56,015 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3139
2025-06-07 22:00:56,016 - train_models - INFO -   DayOfWeek_feat_4: 0.1126
2025-06-07 22:00:56,016 - train_models - INFO -   NoOfMan_lag_1: 0.0631
2025-06-07 22:00:56,016 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0216
2025-06-07 22:00:56,017 - train_models - INFO -   DayOfWeek_feat_5: 0.0169
2025-06-07 22:00:56,017 - train_models - INFO -   Quantity_lag_1: 0.0163
2025-06-07 22:00:56,017 - train_models - INFO -   IsWeekend_feat: 0.0160
2025-06-07 22:00:56,017 - train_models - INFO -   NoOfMan_lag_28: 0.0145
2025-06-07 22:00:56,018 - train_models - INFO -   NoOfMan_lag_7: 0.0143
2025-06-07 22:00:56,018 - train_models - INFO - Cross-validation details for 206:
2025-06-07 22:00:56,018 - train_models - INFO -   Fold 1: MAE=2.2645, RMSE=3.1139, R²=0.8681, MAPE=13.42%
2025-06-07 22:00:56,019 - train_models - INFO -   Fold 2: MAE=2.1686, RMSE=3.1018, R²=0.8636, MAPE=11.97%
2025-06-07 22:00:56,019 - train_models - INFO -   Fold 3: MAE=2.3301, RMSE=3.7017, R²=0.7946, MAPE=15.22%
2025-06-07 22:00:56,019 - train_models - INFO -   Fold 4: MAE=1.7899, RMSE=2.6227, R²=0.8702, MAPE=11.18%
2025-06-07 22:00:56,019 - train_models - INFO -   Fold 5: MAE=2.1590, RMSE=3.1016, R²=0.8788, MAPE=12.54%
2025-06-07 22:00:56,020 - train_models - INFO - Building model for WorkType: 209
2025-06-07 22:00:56,029 - train_models - INFO - Available features for 209: 8 numeric, 2 categorical
2025-06-07 22:00:56,030 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 22:00:56,030 - train_models - INFO - Total available features: 10
2025-06-07 22:00:56,030 - train_models - INFO - Numeric features: 8
2025-06-07 22:00:56,031 - train_models - INFO - Categorical features: 2
2025-06-07 22:00:56,031 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:01:21,257 - train_models - INFO - Model for 209 - MAE: 1.9863, RMSE: 2.7369, R²: 0.5725, MAPE: 27.16%
2025-06-07 22:01:21,258 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 22:01:21,258 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5196
2025-06-07 22:01:21,259 - train_models - INFO -   NoOfMan_lag_1: 0.0645
2025-06-07 22:01:21,259 - train_models - INFO -   Quantity_lag_1: 0.0603
2025-06-07 22:01:21,259 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0506
2025-06-07 22:01:21,260 - train_models - INFO -   DayOfWeek_feat_1: 0.0498
2025-06-07 22:01:21,260 - train_models - INFO -   NoOfMan_lag_7: 0.0468
2025-06-07 22:01:21,260 - train_models - INFO -   Month_feat_12: 0.0447
2025-06-07 22:01:21,260 - train_models - INFO -   NoOfMan_lag_28: 0.0423
2025-06-07 22:01:21,261 - train_models - INFO -   DayOfMonth: 0.0363
2025-06-07 22:01:21,261 - train_models - INFO -   DayOfWeek_feat_0: 0.0214
2025-06-07 22:01:21,261 - train_models - INFO - Cross-validation details for 209:
2025-06-07 22:01:21,262 - train_models - INFO -   Fold 1: MAE=1.9265, RMSE=2.6926, R²=0.5154, MAPE=25.81%
2025-06-07 22:01:21,262 - train_models - INFO -   Fold 2: MAE=2.1630, RMSE=3.0092, R²=0.5331, MAPE=30.77%
2025-06-07 22:01:21,262 - train_models - INFO -   Fold 3: MAE=1.7150, RMSE=2.2360, R²=0.6078, MAPE=25.14%
2025-06-07 22:01:21,263 - train_models - INFO -   Fold 4: MAE=1.9825, RMSE=2.7019, R²=0.6280, MAPE=26.68%
2025-06-07 22:01:21,263 - train_models - INFO -   Fold 5: MAE=2.1444, RMSE=3.0449, R²=0.5782, MAPE=27.41%
2025-06-07 22:01:21,263 - train_models - INFO - Building model for WorkType: 210
2025-06-07 22:01:21,274 - train_models - INFO - Available features for 210: 8 numeric, 2 categorical
2025-06-07 22:01:21,275 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 22:01:21,275 - train_models - INFO - Total available features: 10
2025-06-07 22:01:21,276 - train_models - INFO - Numeric features: 8
2025-06-07 22:01:21,276 - train_models - INFO - Categorical features: 2
2025-06-07 22:01:21,277 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:01:48,181 - train_models - INFO - Model for 210 - MAE: 1.5165, RMSE: 2.0876, R²: 0.6535, MAPE: 31.35%
2025-06-07 22:01:48,182 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 22:01:48,182 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5064
2025-06-07 22:01:48,183 - train_models - INFO -   DayOfWeek_feat_1: 0.0685
2025-06-07 22:01:48,183 - train_models - INFO -   DayOfWeek_feat_6: 0.0659
2025-06-07 22:01:48,183 - train_models - INFO -   DayOfWeek_feat_0: 0.0498
2025-06-07 22:01:48,184 - train_models - INFO -   NoOfMan_lag_1: 0.0479
2025-06-07 22:01:48,184 - train_models - INFO -   NoOfMan_lag_7: 0.0463
2025-06-07 22:01:48,184 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0448
2025-06-07 22:01:48,184 - train_models - INFO -   Quantity_lag_1: 0.0407
2025-06-07 22:01:48,185 - train_models - INFO -   NoOfMan_lag_28: 0.0319
2025-06-07 22:01:48,185 - train_models - INFO -   DayOfMonth: 0.0310
2025-06-07 22:01:48,185 - train_models - INFO - Cross-validation details for 210:
2025-06-07 22:01:48,186 - train_models - INFO -   Fold 1: MAE=1.2178, RMSE=1.6236, R²=0.7636, MAPE=21.28%
2025-06-07 22:01:48,186 - train_models - INFO -   Fold 2: MAE=1.4134, RMSE=1.9740, R²=0.6430, MAPE=22.26%
2025-06-07 22:01:48,186 - train_models - INFO -   Fold 3: MAE=1.4021, RMSE=1.8679, R²=0.6652, MAPE=19.45%
2025-06-07 22:01:48,187 - train_models - INFO -   Fold 4: MAE=1.6867, RMSE=2.2924, R²=0.5976, MAPE=47.08%
2025-06-07 22:01:48,187 - train_models - INFO -   Fold 5: MAE=1.8624, RMSE=2.6802, R²=0.5980, MAPE=46.67%
2025-06-07 22:01:48,187 - train_models - INFO - Building model for WorkType: 211
2025-06-07 22:01:48,199 - train_models - INFO - Available features for 211: 8 numeric, 2 categorical
2025-06-07 22:01:48,205 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 22:01:48,205 - train_models - INFO - Total available features: 10
2025-06-07 22:01:48,206 - train_models - INFO - Numeric features: 8
2025-06-07 22:01:48,206 - train_models - INFO - Categorical features: 2
2025-06-07 22:01:48,206 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:02:16,150 - train_models - INFO - Model for 211 - MAE: 1.5687, RMSE: 2.1736, R²: 0.5880, MAPE: 24.98%
2025-06-07 22:02:16,151 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 22:02:16,151 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4462
2025-06-07 22:02:16,151 - train_models - INFO -   DayOfWeek_feat_6: 0.1853
2025-06-07 22:02:16,152 - train_models - INFO -   NoOfMan_lag_1: 0.0958
2025-06-07 22:02:16,152 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0454
2025-06-07 22:02:16,152 - train_models - INFO -   NoOfMan_lag_7: 0.0428
2025-06-07 22:02:16,153 - train_models - INFO -   Quantity_lag_1: 0.0412
2025-06-07 22:02:16,153 - train_models - INFO -   NoOfMan_lag_28: 0.0379
2025-06-07 22:02:16,153 - train_models - INFO -   DayOfMonth: 0.0304
2025-06-07 22:02:16,154 - train_models - INFO -   DayOfWeek_feat_4: 0.0097
2025-06-07 22:02:16,154 - train_models - INFO -   DayOfWeek_feat_0: 0.0097
2025-06-07 22:02:16,154 - train_models - INFO - Cross-validation details for 211:
2025-06-07 22:02:16,154 - train_models - INFO -   Fold 1: MAE=2.1392, RMSE=3.2005, R²=0.2875, MAPE=38.54%
2025-06-07 22:02:16,155 - train_models - INFO -   Fold 2: MAE=1.5688, RMSE=2.0953, R²=0.5900, MAPE=22.36%
2025-06-07 22:02:16,155 - train_models - INFO -   Fold 3: MAE=1.3789, RMSE=1.8172, R²=0.7133, MAPE=16.61%
2025-06-07 22:02:16,155 - train_models - INFO -   Fold 4: MAE=1.4078, RMSE=1.9455, R²=0.6834, MAPE=23.49%
2025-06-07 22:02:16,155 - train_models - INFO -   Fold 5: MAE=1.3488, RMSE=1.8098, R²=0.6656, MAPE=23.88%
2025-06-07 22:02:16,156 - train_models - INFO - Building model for WorkType: 213
2025-06-07 22:02:16,166 - train_models - INFO - Available features for 213: 8 numeric, 2 categorical
2025-06-07 22:02:16,167 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 22:02:16,167 - train_models - INFO - Total available features: 10
2025-06-07 22:02:16,167 - train_models - INFO - Numeric features: 8
2025-06-07 22:02:16,168 - train_models - INFO - Categorical features: 2
2025-06-07 22:02:16,168 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:02:41,804 - train_models - INFO - Model for 213 - MAE: 0.8560, RMSE: 1.1594, R²: 0.5582, MAPE: 36.48%
2025-06-07 22:02:41,805 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 22:02:41,805 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5516
2025-06-07 22:02:41,806 - train_models - INFO -   NoOfMan_lag_1: 0.1139
2025-06-07 22:02:41,806 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0625
2025-06-07 22:02:41,806 - train_models - INFO -   NoOfMan_lag_7: 0.0492
2025-06-07 22:02:41,806 - train_models - INFO -   Quantity_lag_1: 0.0429
2025-06-07 22:02:41,807 - train_models - INFO -   NoOfMan_lag_28: 0.0399
2025-06-07 22:02:41,807 - train_models - INFO -   DayOfWeek_feat_1: 0.0281
2025-06-07 22:02:41,807 - train_models - INFO -   DayOfMonth: 0.0263
2025-06-07 22:02:41,808 - train_models - INFO -   DayOfWeek_feat_4: 0.0253
2025-06-07 22:02:41,808 - train_models - INFO -   Month_feat_7: 0.0122
2025-06-07 22:02:41,808 - train_models - INFO - Cross-validation details for 213:
2025-06-07 22:02:41,809 - train_models - INFO -   Fold 1: MAE=0.9192, RMSE=1.2814, R²=0.6156, MAPE=27.12%
2025-06-07 22:02:41,809 - train_models - INFO -   Fold 2: MAE=0.8546, RMSE=1.1910, R²=0.5131, MAPE=45.16%
2025-06-07 22:02:41,809 - train_models - INFO -   Fold 3: MAE=0.7695, RMSE=1.1106, R²=0.5428, MAPE=38.81%
2025-06-07 22:02:41,810 - train_models - INFO -   Fold 4: MAE=0.8572, RMSE=1.0850, R²=0.5529, MAPE=37.22%
2025-06-07 22:02:41,810 - train_models - INFO -   Fold 5: MAE=0.8795, RMSE=1.1290, R²=0.5664, MAPE=34.09%
2025-06-07 22:02:41,810 - train_models - INFO - Building model for WorkType: 214
2025-06-07 22:02:41,821 - train_models - INFO - Available features for 214: 8 numeric, 2 categorical
2025-06-07 22:02:41,821 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 22:02:41,821 - train_models - INFO - Total available features: 10
2025-06-07 22:02:41,822 - train_models - INFO - Numeric features: 8
2025-06-07 22:02:41,822 - train_models - INFO - Categorical features: 2
2025-06-07 22:02:41,822 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:03:08,087 - train_models - INFO - Model for 214 - MAE: 1.0450, RMSE: 1.3825, R²: 0.5637, MAPE: 25.00%
2025-06-07 22:03:08,088 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 22:03:08,088 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5694
2025-06-07 22:03:08,089 - train_models - INFO -   NoOfMan_lag_1: 0.1193
2025-06-07 22:03:08,089 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0501
2025-06-07 22:03:08,089 - train_models - INFO -   Quantity_lag_1: 0.0415
2025-06-07 22:03:08,089 - train_models - INFO -   NoOfMan_lag_7: 0.0409
2025-06-07 22:03:08,090 - train_models - INFO -   NoOfMan_lag_28: 0.0333
2025-06-07 22:03:08,090 - train_models - INFO -   DayOfMonth: 0.0301
2025-06-07 22:03:08,090 - train_models - INFO -   DayOfWeek_feat_6: 0.0301
2025-06-07 22:03:08,091 - train_models - INFO -   DayOfWeek_feat_4: 0.0237
2025-06-07 22:03:08,091 - train_models - INFO -   DayOfWeek_feat_1: 0.0224
2025-06-07 22:03:08,091 - train_models - INFO - Cross-validation details for 214:
2025-06-07 22:03:08,091 - train_models - INFO -   Fold 1: MAE=0.9730, RMSE=1.2695, R²=0.4387, MAPE=27.05%
2025-06-07 22:03:08,092 - train_models - INFO -   Fold 2: MAE=0.9872, RMSE=1.2623, R²=0.5561, MAPE=24.66%
2025-06-07 22:03:08,092 - train_models - INFO -   Fold 3: MAE=0.8145, RMSE=1.0969, R²=0.6723, MAPE=22.81%
2025-06-07 22:03:08,092 - train_models - INFO -   Fold 4: MAE=0.9747, RMSE=1.3150, R²=0.5978, MAPE=21.00%
2025-06-07 22:03:08,092 - train_models - INFO -   Fold 5: MAE=1.4757, RMSE=1.9689, R²=0.5537, MAPE=29.49%
2025-06-07 22:03:08,093 - train_models - INFO - Building model for WorkType: 215
2025-06-07 22:03:08,103 - train_models - INFO - Available features for 215: 8 numeric, 2 categorical
2025-06-07 22:03:08,103 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 22:03:08,103 - train_models - INFO - Total available features: 10
2025-06-07 22:03:08,104 - train_models - INFO - Numeric features: 8
2025-06-07 22:03:08,104 - train_models - INFO - Categorical features: 2
2025-06-07 22:03:08,104 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:03:37,449 - train_models - INFO - Model for 215 - MAE: 1.3383, RMSE: 1.9491, R²: 0.6597, MAPE: 30.14%
2025-06-07 22:03:37,449 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 22:03:37,450 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3765
2025-06-07 22:03:37,450 - train_models - INFO -   DayOfWeek_feat_6: 0.2536
2025-06-07 22:03:37,450 - train_models - INFO -   DayOfWeek_feat_0: 0.0724
2025-06-07 22:03:37,451 - train_models - INFO -   Quantity_lag_1: 0.0535
2025-06-07 22:03:37,451 - train_models - INFO -   NoOfMan_lag_1: 0.0510
2025-06-07 22:03:37,451 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0436
2025-06-07 22:03:37,452 - train_models - INFO -   NoOfMan_lag_7: 0.0373
2025-06-07 22:03:37,452 - train_models - INFO -   DayOfMonth: 0.0355
2025-06-07 22:03:37,452 - train_models - INFO -   NoOfMan_lag_28: 0.0280
2025-06-07 22:03:37,453 - train_models - INFO -   Month_feat_11: 0.0071
2025-06-07 22:03:37,453 - train_models - INFO - Cross-validation details for 215:
2025-06-07 22:03:37,453 - train_models - INFO -   Fold 1: MAE=1.4550, RMSE=2.2692, R²=0.5720, MAPE=41.48%
2025-06-07 22:03:37,453 - train_models - INFO -   Fold 2: MAE=1.2315, RMSE=1.7310, R²=0.7422, MAPE=27.30%
2025-06-07 22:03:37,454 - train_models - INFO -   Fold 3: MAE=1.3788, RMSE=1.9423, R²=0.6650, MAPE=25.77%
2025-06-07 22:03:37,454 - train_models - INFO -   Fold 4: MAE=1.2478, RMSE=1.7509, R²=0.6826, MAPE=28.69%
2025-06-07 22:03:37,454 - train_models - INFO -   Fold 5: MAE=1.3782, RMSE=2.0523, R²=0.6368, MAPE=27.45%
2025-06-07 22:03:37,455 - train_models - INFO - Building model for WorkType: 217
2025-06-07 22:03:37,468 - train_models - INFO - Available features for 217: 8 numeric, 2 categorical
2025-06-07 22:03:37,469 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 22:03:37,469 - train_models - INFO - Total available features: 10
2025-06-07 22:03:37,469 - train_models - INFO - Numeric features: 8
2025-06-07 22:03:37,470 - train_models - INFO - Categorical features: 2
2025-06-07 22:03:37,470 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:04:00,710 - train_models - INFO - Model for 217 - MAE: 0.9066, RMSE: 1.2062, R²: 0.6090, MAPE: 38.16%
2025-06-07 22:04:00,711 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 22:04:00,711 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6095
2025-06-07 22:04:00,711 - train_models - INFO -   NoOfMan_lag_1: 0.1785
2025-06-07 22:04:00,712 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0510
2025-06-07 22:04:00,712 - train_models - INFO -   NoOfMan_lag_7: 0.0389
2025-06-07 22:04:00,712 - train_models - INFO -   Quantity_lag_1: 0.0321
2025-06-07 22:04:00,713 - train_models - INFO -   NoOfMan_lag_28: 0.0271
2025-06-07 22:04:00,713 - train_models - INFO -   DayOfMonth: 0.0217
2025-06-07 22:04:00,713 - train_models - INFO -   DayOfWeek_feat_4: 0.0050
2025-06-07 22:04:00,714 - train_models - INFO -   DayOfWeek_feat_0: 0.0047
2025-06-07 22:04:00,714 - train_models - INFO -   Month_feat_1: 0.0046
2025-06-07 22:04:00,714 - train_models - INFO - Cross-validation details for 217:
2025-06-07 22:04:00,715 - train_models - INFO -   Fold 1: MAE=0.9587, RMSE=1.1941, R²=0.5038, MAPE=43.78%
2025-06-07 22:04:00,715 - train_models - INFO -   Fold 2: MAE=0.8029, RMSE=1.0915, R²=0.6374, MAPE=38.15%
2025-06-07 22:04:00,715 - train_models - INFO -   Fold 3: MAE=0.8325, RMSE=1.1305, R²=0.6965, MAPE=32.01%
2025-06-07 22:04:00,715 - train_models - INFO -   Fold 4: MAE=0.9247, RMSE=1.2103, R²=0.6862, MAPE=35.47%
2025-06-07 22:04:00,716 - train_models - INFO -   Fold 5: MAE=1.0142, RMSE=1.4048, R²=0.5211, MAPE=41.41%
2025-06-07 22:04:00,717 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 22:04:02,185 - train_models - INFO - Model files saved successfully
2025-06-07 22:04:02,186 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 22:04:02,186 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 22:04:02,188 - train_models - INFO - Model training completed successfully
2025-06-07 22:21:06,153 - train_models - INFO - Starting the model training process
2025-06-07 22:21:06,154 - train_models - INFO - Feature groups enabled: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES', 'CYCLICAL_FEATURES']
2025-06-07 22:21:06,154 - train_models - INFO - Training from SQL database (command line argument)
2025-06-07 22:21:06,163 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-06-07 22:21:06,565 - train_models - INFO - Executing SQL query: 
                SELECT Date, PunchCode as WorkType, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 210, 217) 
                AND Hours > 0 
                AND NoOfMan > 0 
                AND SystemHours > 0 
                AND Quantity > 0
                ORDER BY Date
            
2025-06-07 22:21:07,478 - train_models - INFO - Read chunk of 10000 rows
2025-06-07 22:21:07,554 - train_models - INFO - Read chunk of 5326 rows
2025-06-07 22:21:07,597 - train_models - INFO - Data loaded successfully. Total rows: 15326
2025-06-07 22:21:07,598 - train_models - INFO - Converting Date column to datetime format
2025-06-07 22:21:07,625 - train_models - INFO - Engineering features...
2025-06-07 22:21:08,480 - train_models - INFO - Creating lag features with tiered configuration...
2025-06-07 22:21:08,481 - train_models - INFO - Using essential lags: [1, 7, 28]
2025-06-07 22:21:08,482 - train_models - INFO - Using essential windows: [7, 30]
2025-06-07 22:21:08,601 - utils.feature_engineering - INFO - Created features using config: LAG_FEATURES=True, PRODUCTIVITY_FEATURES=True
2025-06-07 22:21:08,602 - utils.feature_engineering - INFO - Final shape: (15326, 16)
2025-06-07 22:21:08,606 - train_models - INFO - Found 10 unique work types
2025-06-07 22:21:08,606 - train_models - INFO - Building models for 10 work types
2025-06-07 22:21:08,606 - train_models - INFO - Using feature groups: ['LAG_FEATURES', 'ROLLING_FEATURES', 'DATE_FEATURES', 'PRODUCTIVITY_FEATURES', 'CYCLICAL_FEATURES']
2025-06-07 22:21:08,607 - train_models - INFO - Config-driven features: 12 numeric, 2 categorical
2025-06-07 22:21:08,607 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'Workers_per_Hour', 'Quantity_per_Hour', 'Workload_Density', 'KPI_Performance']
2025-06-07 22:21:08,607 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-06-07 22:21:08,608 - train_models - INFO - Building model for WorkType: 202
2025-06-07 22:21:08,621 - train_models - INFO - Available features for 202: 8 numeric, 2 categorical
2025-06-07 22:21:08,622 - train_models - INFO - === FEATURE COUNT TRAINING - 202 ===
2025-06-07 22:21:08,622 - train_models - INFO - Total available features: 10
2025-06-07 22:21:08,622 - train_models - INFO - Numeric features: 8
2025-06-07 22:21:08,623 - train_models - INFO - Categorical features: 2
2025-06-07 22:21:08,623 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:21:29,589 - train_models - INFO - Model for 202 - MAE: 0.4600, RMSE: 0.5925, R²: 0.3177, MAPE: 24.72%
2025-06-07 22:21:29,589 - train_models - INFO - Top 10 most important features for 202:
2025-06-07 22:21:29,590 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5011
2025-06-07 22:21:29,590 - train_models - INFO -   NoOfMan_lag_1: 0.1457
2025-06-07 22:21:29,590 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0763
2025-06-07 22:21:29,591 - train_models - INFO -   Quantity_lag_1: 0.0576
2025-06-07 22:21:29,591 - train_models - INFO -   NoOfMan_lag_7: 0.0496
2025-06-07 22:21:29,591 - train_models - INFO -   NoOfMan_lag_28: 0.0466
2025-06-07 22:21:29,591 - train_models - INFO -   DayOfMonth: 0.0435
2025-06-07 22:21:29,592 - train_models - INFO -   DayOfWeek_feat_4: 0.0151
2025-06-07 22:21:29,592 - train_models - INFO -   DayOfWeek_feat_0: 0.0066
2025-06-07 22:21:29,592 - train_models - INFO -   DayOfWeek_feat_1: 0.0064
2025-06-07 22:21:29,592 - train_models - INFO - Cross-validation details for 202:
2025-06-07 22:21:29,593 - train_models - INFO -   Fold 1: MAE=0.3287, RMSE=0.4650, R²=0.2419, MAPE=20.28%
2025-06-07 22:21:29,593 - train_models - INFO -   Fold 2: MAE=0.3780, RMSE=0.4837, R²=0.4610, MAPE=23.53%
2025-06-07 22:21:29,593 - train_models - INFO -   Fold 3: MAE=0.5030, RMSE=0.6619, R²=0.3181, MAPE=29.78%
2025-06-07 22:21:29,594 - train_models - INFO -   Fold 4: MAE=0.5227, RMSE=0.6458, R²=0.1512, MAPE=25.84%
2025-06-07 22:21:29,594 - train_models - INFO -   Fold 5: MAE=0.5676, RMSE=0.7062, R²=0.4161, MAPE=24.19%
2025-06-07 22:21:29,594 - train_models - INFO - Building model for WorkType: 203
2025-06-07 22:21:29,603 - train_models - INFO - Available features for 203: 8 numeric, 2 categorical
2025-06-07 22:21:29,604 - train_models - INFO - === FEATURE COUNT TRAINING - 203 ===
2025-06-07 22:21:29,604 - train_models - INFO - Total available features: 10
2025-06-07 22:21:29,604 - train_models - INFO - Numeric features: 8
2025-06-07 22:21:29,605 - train_models - INFO - Categorical features: 2
2025-06-07 22:21:29,605 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:21:52,956 - train_models - INFO - Model for 203 - MAE: 0.6611, RMSE: 0.8715, R²: 0.3833, MAPE: 13.81%
2025-06-07 22:21:52,957 - train_models - INFO - Top 10 most important features for 203:
2025-06-07 22:21:52,957 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4367
2025-06-07 22:21:52,958 - train_models - INFO -   NoOfMan_lag_1: 0.1931
2025-06-07 22:21:52,958 - train_models - INFO -   Quantity_lag_1: 0.0609
2025-06-07 22:21:52,958 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0609
2025-06-07 22:21:52,958 - train_models - INFO -   NoOfMan_lag_7: 0.0582
2025-06-07 22:21:52,959 - train_models - INFO -   NoOfMan_lag_28: 0.0493
2025-06-07 22:21:52,959 - train_models - INFO -   DayOfMonth: 0.0456
2025-06-07 22:21:52,959 - train_models - INFO -   DayOfWeek_feat_4: 0.0141
2025-06-07 22:21:52,960 - train_models - INFO -   DayOfWeek_feat_0: 0.0141
2025-06-07 22:21:52,960 - train_models - INFO -   DayOfWeek_feat_1: 0.0088
2025-06-07 22:21:52,960 - train_models - INFO - Cross-validation details for 203:
2025-06-07 22:21:52,960 - train_models - INFO -   Fold 1: MAE=0.6105, RMSE=0.8202, R²=0.4701, MAPE=11.99%
2025-06-07 22:21:52,961 - train_models - INFO -   Fold 2: MAE=0.6597, RMSE=0.8928, R²=0.4193, MAPE=13.14%
2025-06-07 22:21:52,961 - train_models - INFO -   Fold 3: MAE=0.7223, RMSE=0.9505, R²=0.3191, MAPE=14.04%
2025-06-07 22:21:52,961 - train_models - INFO -   Fold 4: MAE=0.6740, RMSE=0.8715, R²=0.3834, MAPE=14.88%
2025-06-07 22:21:52,962 - train_models - INFO -   Fold 5: MAE=0.6388, RMSE=0.8226, R²=0.3249, MAPE=15.03%
2025-06-07 22:21:52,962 - train_models - INFO - Building model for WorkType: 206
2025-06-07 22:21:52,975 - train_models - INFO - Available features for 206: 8 numeric, 2 categorical
2025-06-07 22:21:52,976 - train_models - INFO - === FEATURE COUNT TRAINING - 206 ===
2025-06-07 22:21:52,977 - train_models - INFO - Total available features: 10
2025-06-07 22:21:52,977 - train_models - INFO - Numeric features: 8
2025-06-07 22:21:52,978 - train_models - INFO - Categorical features: 2
2025-06-07 22:21:52,978 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:22:21,638 - train_models - INFO - Model for 206 - MAE: 2.1424, RMSE: 3.1284, R²: 0.8551, MAPE: 12.87%
2025-06-07 22:22:21,638 - train_models - INFO - Top 10 most important features for 206:
2025-06-07 22:22:21,638 - train_models - INFO -   DayOfWeek_feat_6: 0.3786
2025-06-07 22:22:21,639 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3139
2025-06-07 22:22:21,639 - train_models - INFO -   DayOfWeek_feat_4: 0.1126
2025-06-07 22:22:21,639 - train_models - INFO -   NoOfMan_lag_1: 0.0631
2025-06-07 22:22:21,640 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0216
2025-06-07 22:22:21,640 - train_models - INFO -   DayOfWeek_feat_5: 0.0169
2025-06-07 22:22:21,640 - train_models - INFO -   Quantity_lag_1: 0.0163
2025-06-07 22:22:21,640 - train_models - INFO -   IsWeekend_feat: 0.0160
2025-06-07 22:22:21,641 - train_models - INFO -   NoOfMan_lag_28: 0.0145
2025-06-07 22:22:21,641 - train_models - INFO -   NoOfMan_lag_7: 0.0143
2025-06-07 22:22:21,641 - train_models - INFO - Cross-validation details for 206:
2025-06-07 22:22:21,641 - train_models - INFO -   Fold 1: MAE=2.2645, RMSE=3.1139, R²=0.8681, MAPE=13.42%
2025-06-07 22:22:21,642 - train_models - INFO -   Fold 2: MAE=2.1686, RMSE=3.1018, R²=0.8636, MAPE=11.97%
2025-06-07 22:22:21,642 - train_models - INFO -   Fold 3: MAE=2.3301, RMSE=3.7017, R²=0.7946, MAPE=15.22%
2025-06-07 22:22:21,642 - train_models - INFO -   Fold 4: MAE=1.7899, RMSE=2.6227, R²=0.8702, MAPE=11.18%
2025-06-07 22:22:21,643 - train_models - INFO -   Fold 5: MAE=2.1590, RMSE=3.1016, R²=0.8788, MAPE=12.54%
2025-06-07 22:22:21,643 - train_models - INFO - Building model for WorkType: 209
2025-06-07 22:22:21,653 - train_models - INFO - Available features for 209: 8 numeric, 2 categorical
2025-06-07 22:22:21,653 - train_models - INFO - === FEATURE COUNT TRAINING - 209 ===
2025-06-07 22:22:21,654 - train_models - INFO - Total available features: 10
2025-06-07 22:22:21,654 - train_models - INFO - Numeric features: 8
2025-06-07 22:22:21,654 - train_models - INFO - Categorical features: 2
2025-06-07 22:22:21,655 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:22:46,009 - train_models - INFO - Model for 209 - MAE: 1.9863, RMSE: 2.7369, R²: 0.5725, MAPE: 27.16%
2025-06-07 22:22:46,010 - train_models - INFO - Top 10 most important features for 209:
2025-06-07 22:22:46,010 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5196
2025-06-07 22:22:46,010 - train_models - INFO -   NoOfMan_lag_1: 0.0645
2025-06-07 22:22:46,011 - train_models - INFO -   Quantity_lag_1: 0.0603
2025-06-07 22:22:46,011 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0506
2025-06-07 22:22:46,011 - train_models - INFO -   DayOfWeek_feat_1: 0.0498
2025-06-07 22:22:46,011 - train_models - INFO -   NoOfMan_lag_7: 0.0468
2025-06-07 22:22:46,012 - train_models - INFO -   Month_feat_12: 0.0447
2025-06-07 22:22:46,012 - train_models - INFO -   NoOfMan_lag_28: 0.0423
2025-06-07 22:22:46,012 - train_models - INFO -   DayOfMonth: 0.0363
2025-06-07 22:22:46,012 - train_models - INFO -   DayOfWeek_feat_0: 0.0214
2025-06-07 22:22:46,013 - train_models - INFO - Cross-validation details for 209:
2025-06-07 22:22:46,013 - train_models - INFO -   Fold 1: MAE=1.9265, RMSE=2.6926, R²=0.5154, MAPE=25.81%
2025-06-07 22:22:46,013 - train_models - INFO -   Fold 2: MAE=2.1630, RMSE=3.0092, R²=0.5331, MAPE=30.77%
2025-06-07 22:22:46,013 - train_models - INFO -   Fold 3: MAE=1.7150, RMSE=2.2360, R²=0.6078, MAPE=25.14%
2025-06-07 22:22:46,014 - train_models - INFO -   Fold 4: MAE=1.9825, RMSE=2.7019, R²=0.6280, MAPE=26.68%
2025-06-07 22:22:46,014 - train_models - INFO -   Fold 5: MAE=2.1444, RMSE=3.0449, R²=0.5782, MAPE=27.41%
2025-06-07 22:22:46,014 - train_models - INFO - Building model for WorkType: 210
2025-06-07 22:22:46,023 - train_models - INFO - Available features for 210: 8 numeric, 2 categorical
2025-06-07 22:22:46,024 - train_models - INFO - === FEATURE COUNT TRAINING - 210 ===
2025-06-07 22:22:46,024 - train_models - INFO - Total available features: 10
2025-06-07 22:22:46,024 - train_models - INFO - Numeric features: 8
2025-06-07 22:22:46,024 - train_models - INFO - Categorical features: 2
2025-06-07 22:22:46,025 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:23:10,999 - train_models - INFO - Model for 210 - MAE: 1.5165, RMSE: 2.0876, R²: 0.6535, MAPE: 31.35%
2025-06-07 22:23:10,999 - train_models - INFO - Top 10 most important features for 210:
2025-06-07 22:23:10,999 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5064
2025-06-07 22:23:11,000 - train_models - INFO -   DayOfWeek_feat_1: 0.0685
2025-06-07 22:23:11,000 - train_models - INFO -   DayOfWeek_feat_6: 0.0659
2025-06-07 22:23:11,000 - train_models - INFO -   DayOfWeek_feat_0: 0.0498
2025-06-07 22:23:11,001 - train_models - INFO -   NoOfMan_lag_1: 0.0479
2025-06-07 22:23:11,001 - train_models - INFO -   NoOfMan_lag_7: 0.0463
2025-06-07 22:23:11,001 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0448
2025-06-07 22:23:11,002 - train_models - INFO -   Quantity_lag_1: 0.0407
2025-06-07 22:23:11,002 - train_models - INFO -   NoOfMan_lag_28: 0.0319
2025-06-07 22:23:11,002 - train_models - INFO -   DayOfMonth: 0.0310
2025-06-07 22:23:11,003 - train_models - INFO - Cross-validation details for 210:
2025-06-07 22:23:11,003 - train_models - INFO -   Fold 1: MAE=1.2178, RMSE=1.6236, R²=0.7636, MAPE=21.28%
2025-06-07 22:23:11,003 - train_models - INFO -   Fold 2: MAE=1.4134, RMSE=1.9740, R²=0.6430, MAPE=22.26%
2025-06-07 22:23:11,004 - train_models - INFO -   Fold 3: MAE=1.4021, RMSE=1.8679, R²=0.6652, MAPE=19.45%
2025-06-07 22:23:11,004 - train_models - INFO -   Fold 4: MAE=1.6867, RMSE=2.2924, R²=0.5976, MAPE=47.08%
2025-06-07 22:23:11,004 - train_models - INFO -   Fold 5: MAE=1.8624, RMSE=2.6802, R²=0.5980, MAPE=46.67%
2025-06-07 22:23:11,004 - train_models - INFO - Building model for WorkType: 211
2025-06-07 22:23:11,016 - train_models - INFO - Available features for 211: 8 numeric, 2 categorical
2025-06-07 22:23:11,017 - train_models - INFO - === FEATURE COUNT TRAINING - 211 ===
2025-06-07 22:23:11,017 - train_models - INFO - Total available features: 10
2025-06-07 22:23:11,017 - train_models - INFO - Numeric features: 8
2025-06-07 22:23:11,018 - train_models - INFO - Categorical features: 2
2025-06-07 22:23:11,018 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:23:38,313 - train_models - INFO - Model for 211 - MAE: 1.5687, RMSE: 2.1736, R²: 0.5880, MAPE: 24.98%
2025-06-07 22:23:38,313 - train_models - INFO - Top 10 most important features for 211:
2025-06-07 22:23:38,314 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4462
2025-06-07 22:23:38,314 - train_models - INFO -   DayOfWeek_feat_6: 0.1853
2025-06-07 22:23:38,314 - train_models - INFO -   NoOfMan_lag_1: 0.0958
2025-06-07 22:23:38,314 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0454
2025-06-07 22:23:38,315 - train_models - INFO -   NoOfMan_lag_7: 0.0428
2025-06-07 22:23:38,315 - train_models - INFO -   Quantity_lag_1: 0.0412
2025-06-07 22:23:38,315 - train_models - INFO -   NoOfMan_lag_28: 0.0379
2025-06-07 22:23:38,315 - train_models - INFO -   DayOfMonth: 0.0304
2025-06-07 22:23:38,316 - train_models - INFO -   DayOfWeek_feat_4: 0.0097
2025-06-07 22:23:38,316 - train_models - INFO -   DayOfWeek_feat_0: 0.0097
2025-06-07 22:23:38,316 - train_models - INFO - Cross-validation details for 211:
2025-06-07 22:23:38,317 - train_models - INFO -   Fold 1: MAE=2.1392, RMSE=3.2005, R²=0.2875, MAPE=38.54%
2025-06-07 22:23:38,317 - train_models - INFO -   Fold 2: MAE=1.5688, RMSE=2.0953, R²=0.5900, MAPE=22.36%
2025-06-07 22:23:38,317 - train_models - INFO -   Fold 3: MAE=1.3789, RMSE=1.8172, R²=0.7133, MAPE=16.61%
2025-06-07 22:23:38,318 - train_models - INFO -   Fold 4: MAE=1.4078, RMSE=1.9455, R²=0.6834, MAPE=23.49%
2025-06-07 22:23:38,318 - train_models - INFO -   Fold 5: MAE=1.3488, RMSE=1.8098, R²=0.6656, MAPE=23.88%
2025-06-07 22:23:38,318 - train_models - INFO - Building model for WorkType: 213
2025-06-07 22:23:38,330 - train_models - INFO - Available features for 213: 8 numeric, 2 categorical
2025-06-07 22:23:38,330 - train_models - INFO - === FEATURE COUNT TRAINING - 213 ===
2025-06-07 22:23:38,330 - train_models - INFO - Total available features: 10
2025-06-07 22:23:38,331 - train_models - INFO - Numeric features: 8
2025-06-07 22:23:38,331 - train_models - INFO - Categorical features: 2
2025-06-07 22:23:38,331 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:24:02,477 - train_models - INFO - Model for 213 - MAE: 0.8560, RMSE: 1.1594, R²: 0.5582, MAPE: 36.48%
2025-06-07 22:24:02,478 - train_models - INFO - Top 10 most important features for 213:
2025-06-07 22:24:02,478 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5516
2025-06-07 22:24:02,478 - train_models - INFO -   NoOfMan_lag_1: 0.1139
2025-06-07 22:24:02,479 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0625
2025-06-07 22:24:02,479 - train_models - INFO -   NoOfMan_lag_7: 0.0492
2025-06-07 22:24:02,479 - train_models - INFO -   Quantity_lag_1: 0.0429
2025-06-07 22:24:02,480 - train_models - INFO -   NoOfMan_lag_28: 0.0399
2025-06-07 22:24:02,480 - train_models - INFO -   DayOfWeek_feat_1: 0.0281
2025-06-07 22:24:02,480 - train_models - INFO -   DayOfMonth: 0.0263
2025-06-07 22:24:02,481 - train_models - INFO -   DayOfWeek_feat_4: 0.0253
2025-06-07 22:24:02,481 - train_models - INFO -   Month_feat_7: 0.0122
2025-06-07 22:24:02,481 - train_models - INFO - Cross-validation details for 213:
2025-06-07 22:24:02,482 - train_models - INFO -   Fold 1: MAE=0.9192, RMSE=1.2814, R²=0.6156, MAPE=27.12%
2025-06-07 22:24:02,482 - train_models - INFO -   Fold 2: MAE=0.8546, RMSE=1.1910, R²=0.5131, MAPE=45.16%
2025-06-07 22:24:02,482 - train_models - INFO -   Fold 3: MAE=0.7695, RMSE=1.1106, R²=0.5428, MAPE=38.81%
2025-06-07 22:24:02,482 - train_models - INFO -   Fold 4: MAE=0.8572, RMSE=1.0850, R²=0.5529, MAPE=37.22%
2025-06-07 22:24:02,483 - train_models - INFO -   Fold 5: MAE=0.8795, RMSE=1.1290, R²=0.5664, MAPE=34.09%
2025-06-07 22:24:02,483 - train_models - INFO - Building model for WorkType: 214
2025-06-07 22:24:02,494 - train_models - INFO - Available features for 214: 8 numeric, 2 categorical
2025-06-07 22:24:02,495 - train_models - INFO - === FEATURE COUNT TRAINING - 214 ===
2025-06-07 22:24:02,495 - train_models - INFO - Total available features: 10
2025-06-07 22:24:02,495 - train_models - INFO - Numeric features: 8
2025-06-07 22:24:02,496 - train_models - INFO - Categorical features: 2
2025-06-07 22:24:02,496 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:24:28,140 - train_models - INFO - Model for 214 - MAE: 1.0450, RMSE: 1.3825, R²: 0.5637, MAPE: 25.00%
2025-06-07 22:24:28,141 - train_models - INFO - Top 10 most important features for 214:
2025-06-07 22:24:28,141 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5694
2025-06-07 22:24:28,142 - train_models - INFO -   NoOfMan_lag_1: 0.1193
2025-06-07 22:24:28,142 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0501
2025-06-07 22:24:28,142 - train_models - INFO -   Quantity_lag_1: 0.0415
2025-06-07 22:24:28,143 - train_models - INFO -   NoOfMan_lag_7: 0.0409
2025-06-07 22:24:28,143 - train_models - INFO -   NoOfMan_lag_28: 0.0333
2025-06-07 22:24:28,144 - train_models - INFO -   DayOfMonth: 0.0301
2025-06-07 22:24:28,144 - train_models - INFO -   DayOfWeek_feat_6: 0.0301
2025-06-07 22:24:28,144 - train_models - INFO -   DayOfWeek_feat_4: 0.0237
2025-06-07 22:24:28,145 - train_models - INFO -   DayOfWeek_feat_1: 0.0224
2025-06-07 22:24:28,145 - train_models - INFO - Cross-validation details for 214:
2025-06-07 22:24:28,145 - train_models - INFO -   Fold 1: MAE=0.9730, RMSE=1.2695, R²=0.4387, MAPE=27.05%
2025-06-07 22:24:28,145 - train_models - INFO -   Fold 2: MAE=0.9872, RMSE=1.2623, R²=0.5561, MAPE=24.66%
2025-06-07 22:24:28,146 - train_models - INFO -   Fold 3: MAE=0.8145, RMSE=1.0969, R²=0.6723, MAPE=22.81%
2025-06-07 22:24:28,146 - train_models - INFO -   Fold 4: MAE=0.9747, RMSE=1.3150, R²=0.5978, MAPE=21.00%
2025-06-07 22:24:28,146 - train_models - INFO -   Fold 5: MAE=1.4757, RMSE=1.9689, R²=0.5537, MAPE=29.49%
2025-06-07 22:24:28,147 - train_models - INFO - Building model for WorkType: 215
2025-06-07 22:24:28,159 - train_models - INFO - Available features for 215: 8 numeric, 2 categorical
2025-06-07 22:24:28,160 - train_models - INFO - === FEATURE COUNT TRAINING - 215 ===
2025-06-07 22:24:28,160 - train_models - INFO - Total available features: 10
2025-06-07 22:24:28,160 - train_models - INFO - Numeric features: 8
2025-06-07 22:24:28,160 - train_models - INFO - Categorical features: 2
2025-06-07 22:24:28,161 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:24:56,036 - train_models - INFO - Model for 215 - MAE: 1.3383, RMSE: 1.9491, R²: 0.6597, MAPE: 30.14%
2025-06-07 22:24:56,036 - train_models - INFO - Top 10 most important features for 215:
2025-06-07 22:24:56,037 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3765
2025-06-07 22:24:56,037 - train_models - INFO -   DayOfWeek_feat_6: 0.2536
2025-06-07 22:24:56,037 - train_models - INFO -   DayOfWeek_feat_0: 0.0724
2025-06-07 22:24:56,037 - train_models - INFO -   Quantity_lag_1: 0.0535
2025-06-07 22:24:56,038 - train_models - INFO -   NoOfMan_lag_1: 0.0510
2025-06-07 22:24:56,038 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0436
2025-06-07 22:24:56,038 - train_models - INFO -   NoOfMan_lag_7: 0.0373
2025-06-07 22:24:56,039 - train_models - INFO -   DayOfMonth: 0.0355
2025-06-07 22:24:56,039 - train_models - INFO -   NoOfMan_lag_28: 0.0280
2025-06-07 22:24:56,039 - train_models - INFO -   Month_feat_11: 0.0071
2025-06-07 22:24:56,040 - train_models - INFO - Cross-validation details for 215:
2025-06-07 22:24:56,040 - train_models - INFO -   Fold 1: MAE=1.4550, RMSE=2.2692, R²=0.5720, MAPE=41.48%
2025-06-07 22:24:56,040 - train_models - INFO -   Fold 2: MAE=1.2315, RMSE=1.7310, R²=0.7422, MAPE=27.30%
2025-06-07 22:24:56,041 - train_models - INFO -   Fold 3: MAE=1.3788, RMSE=1.9423, R²=0.6650, MAPE=25.77%
2025-06-07 22:24:56,041 - train_models - INFO -   Fold 4: MAE=1.2478, RMSE=1.7509, R²=0.6826, MAPE=28.69%
2025-06-07 22:24:56,041 - train_models - INFO -   Fold 5: MAE=1.3782, RMSE=2.0523, R²=0.6368, MAPE=27.45%
2025-06-07 22:24:56,041 - train_models - INFO - Building model for WorkType: 217
2025-06-07 22:24:56,053 - train_models - INFO - Available features for 217: 8 numeric, 2 categorical
2025-06-07 22:24:56,053 - train_models - INFO - === FEATURE COUNT TRAINING - 217 ===
2025-06-07 22:24:56,054 - train_models - INFO - Total available features: 10
2025-06-07 22:24:56,054 - train_models - INFO - Numeric features: 8
2025-06-07 22:24:56,054 - train_models - INFO - Categorical features: 2
2025-06-07 22:24:56,054 - train_models - INFO - Features: ['NoOfMan_lag_1', 'NoOfMan_lag_7', 'NoOfMan_lag_28', 'Quantity_lag_1', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_mean_30', 'IsWeekend_feat', 'DayOfMonth', 'DayOfWeek_feat', 'Month_feat']
2025-06-07 22:25:18,254 - train_models - INFO - Model for 217 - MAE: 0.9066, RMSE: 1.2062, R²: 0.6090, MAPE: 38.16%
2025-06-07 22:25:18,255 - train_models - INFO - Top 10 most important features for 217:
2025-06-07 22:25:18,255 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6095
2025-06-07 22:25:18,255 - train_models - INFO -   NoOfMan_lag_1: 0.1785
2025-06-07 22:25:18,256 - train_models - INFO -   NoOfMan_rolling_mean_30: 0.0510
2025-06-07 22:25:18,256 - train_models - INFO -   NoOfMan_lag_7: 0.0389
2025-06-07 22:25:18,256 - train_models - INFO -   Quantity_lag_1: 0.0321
2025-06-07 22:25:18,257 - train_models - INFO -   NoOfMan_lag_28: 0.0271
2025-06-07 22:25:18,257 - train_models - INFO -   DayOfMonth: 0.0217
2025-06-07 22:25:18,257 - train_models - INFO -   DayOfWeek_feat_4: 0.0050
2025-06-07 22:25:18,257 - train_models - INFO -   DayOfWeek_feat_0: 0.0047
2025-06-07 22:25:18,258 - train_models - INFO -   Month_feat_1: 0.0046
2025-06-07 22:25:18,258 - train_models - INFO - Cross-validation details for 217:
2025-06-07 22:25:18,258 - train_models - INFO -   Fold 1: MAE=0.9587, RMSE=1.1941, R²=0.5038, MAPE=43.78%
2025-06-07 22:25:18,258 - train_models - INFO -   Fold 2: MAE=0.8029, RMSE=1.0915, R²=0.6374, MAPE=38.15%
2025-06-07 22:25:18,259 - train_models - INFO -   Fold 3: MAE=0.8325, RMSE=1.1305, R²=0.6965, MAPE=32.01%
2025-06-07 22:25:18,259 - train_models - INFO -   Fold 4: MAE=0.9247, RMSE=1.2103, R²=0.6862, MAPE=35.47%
2025-06-07 22:25:18,259 - train_models - INFO -   Fold 5: MAE=1.0142, RMSE=1.4048, R²=0.5211, MAPE=41.41%
2025-06-07 22:25:18,260 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-06-07 22:25:19,781 - train_models - INFO - Model files saved successfully
2025-06-07 22:25:19,781 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-06-07 22:25:19,781 - train_models - INFO - Training configuration saved to C:/forlogssystems/Models\training_config.json
2025-06-07 22:25:19,783 - train_models - INFO - Model training completed successfully
